import{r as e,j as n}from"./react-vendor-BXVC7v0l.js";import{m as s}from"./sessionFetch-Cu9xsAce.js";import"./usePlanHierarchy-fXt-6sDq.js";import{C as a,B as t,a as i,i as o,T as c,d,t as r,I as l,f as h,b as p,u as m,l as u}from"./polaris-LiLfZG0r.js";import"./app-bridge-DUY42B6P.js";import"./vendor-Cs_VgJ2r.js";import"./index-wdC_vXec.js";const j=(e,n="")=>{try{return new URLSearchParams(window.location.search).get(e)||n}catch{return n}};function g({shop:g}){const f=g||j("shop","");j("shop","");const[x,y]=e.useState(0),[S,_]=e.useState(!0),[v,b]=e.useState({organization:null,website:null,products:[]}),[w,k]=e.useState(""),O=e.useMemo(()=>s(),[]),[I,A]=e.useState(""),[D,T]=e.useState(null);e.useEffect(()=>{f&&(C(),q())},[f,O]);const q=async()=>{var e,n;try{const s="\n        query PlansMe($shop:String!) {\n          plansMe(shop:$shop) {\n            shop\n            plan\n            planKey\n          }\n        }\n      ",a=await O("/graphql",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:s,variables:{shop:f}})});T(null==(n=null==(e=null==a?void 0:a.data)?void 0:e.plansMe)?void 0:n.plan)}catch(s){}},C=async()=>{_(!0);try{const e=`/api/schema/preview?shop=${encodeURIComponent(f)}`,n=await O(e,{headers:{"X-Shop":f}});n.ok?(b(n.schemas),z(n.schemas)):k(`Error: ${n.error}`)}catch(e){k(`Failed to load schemas: ${e.message}`)}finally{_(!1)}},z=e=>{const n=[];e.organization&&n.push(e.organization),e.website&&n.push(e.website);const s=`<script type="application/ld+json">\n${JSON.stringify(n,null,2)}\n<\/script>`;A(s)};return S?n.jsx(a,{children:n.jsx(t,{padding:"400",children:n.jsxs(i,{gap:"400",align:"center",children:[n.jsx(o,{}),n.jsx(c,{children:"Loading schema data..."})]})})}):n.jsxs(n.Fragment,{children:[n.jsx(a,{children:n.jsx(t,{padding:"400",children:n.jsxs(i,{gap:"400",children:[n.jsx(c,{as:"h3",variant:"headingMd",children:"Schema.org Structured Data"}),n.jsx(d,{tone:"info",children:n.jsx(c,{children:"Schema.org structured data helps AI models understand your store content better, improving your visibility and search results."})}),n.jsxs(r,{tabs:[{id:"overview",content:"Overview",accessibilityLabel:"Overview"},{id:"installation",content:"Installation",accessibilityLabel:"Installation"}],selected:x,onSelect:y,children:[0===x&&n.jsx(t,{paddingBlockStart:"400",children:n.jsxs(i,{gap:"400",children:[n.jsx(a,{children:n.jsx(t,{padding:"300",children:n.jsxs(i,{gap:"300",children:[n.jsxs(l,{align:"space-between",children:[n.jsx(c,{as:"h4",variant:"headingSm",children:"Organization Schema"}),n.jsx(h,{tone:v.organization?"success":"warning",children:v.organization?"Active":"Not configured"})]}),!v.organization&&n.jsx(c,{as:"p",tone:"subdued",children:"Configure organization details in Store Metadata to enable this schema."})]})})}),n.jsx(a,{children:n.jsx(t,{padding:"300",children:n.jsxs(i,{gap:"300",children:[n.jsxs(l,{align:"space-between",children:[n.jsx(c,{as:"h4",variant:"headingSm",children:"WebSite Schema"}),n.jsx(h,{tone:v.website?"success":"warning",children:v.website?"Active":"Not configured"})]}),!v.website&&n.jsx(c,{as:"p",tone:"subdued",children:"Website schema is automatically generated from your store information."})]})})}),n.jsx(a,{children:n.jsx(t,{padding:"300",children:n.jsxs(i,{gap:"300",children:[n.jsxs(l,{align:"space-between",children:[n.jsx(c,{as:"h4",variant:"headingSm",children:"Product Schemas"}),n.jsx(h,{tone:"success",children:"Auto-generated"})]}),n.jsxs(c,{tone:"subdued",children:["Product schemas are automatically generated from your AI Optimisation data when pages load.",v.products.length>0&&` ${v.products.length} products have SEO data.`]})]})})}),n.jsxs(l,{gap:"300",children:[n.jsx(p,{onClick:async()=>{_(!0);try{const e=`/api/schema/generate?shop=${encodeURIComponent(f)}`,n=await O(e,{method:"POST",headers:{"X-Shop":f},body:{shop:f}});n.ok?(k("Schemas regenerated successfully!"),C()):k(`Error: ${n.error}`)}catch(e){k(`Failed to regenerate: ${e.message}`)}finally{_(!1)}},loading:S,children:"Regenerate Schemas"}),n.jsx(p,{variant:"plain",url:"https://developers.google.com/search/docs/appearance/structured-data",children:"Learn about Schema.org"})]})]})}),1===x&&n.jsx(t,{paddingBlockStart:"400",children:n.jsxs(i,{gap:"400",children:[n.jsx(d,{tone:"info",children:n.jsxs(i,{gap:"300",children:[n.jsx(c,{as:"h4",variant:"headingSm",children:"Theme Installation"}),n.jsxs(m,{type:"number",children:[n.jsx(m.Item,{children:"Go to your Shopify Admin → Online Store → Themes"}),n.jsx(m.Item,{children:'Click "Actions" → "Edit code" on your current theme'}),n.jsxs(m.Item,{children:["Open the file: ",n.jsx("code",{children:"layout/theme.liquid"})]}),n.jsxs(m.Item,{children:["Add this code before the closing ",n.jsx("code",{children:"</head>"})," tag:"]})]})]})}),n.jsx(a,{children:n.jsx(t,{padding:"300",children:n.jsxs(i,{gap:"300",children:[n.jsx(c,{as:"h4",variant:"headingSm",children:"Code to Install"}),n.jsx(t,{background:"bg-surface-secondary",padding:"200",borderRadius:"200",children:n.jsx("pre",{style:{fontSize:"12px",overflow:"auto",whiteSpace:"pre-wrap"},children:'{%- comment -%} Advanced Schema Data - Auto-generated by indexAIze - Unlock AI Search {%- endcomment -%}\n\n{%- comment -%} Organization & WebSite Schema (site-wide) {%- endcomment -%}\n{%- if shop.metafields.advanced_schema.shop_schemas -%}\n  <script type="application/ld+json">\n{{ shop.metafields.advanced_schema.shop_schemas.value }}\n  <\/script>\n{%- endif -%}\n\n{%- comment -%} Product Schema (product pages only) {%- endcomment -%}\n{%- if product -%}\n  {%- comment -%} Try Advanced Schema first (requires tokens/Enterprise plan) {%- endcomment -%}\n  {%- assign schema_key = \'schemas_\' | append: request.locale.iso_code -%}\n  {%- assign schemas_json = product.metafields.advanced_schema[schema_key].value -%}\n  {%- if schemas_json -%}\n    <script type="application/ld+json">\n{{ schemas_json }}\n    <\/script>\n  {%- else -%}\n    {%- comment -%} Fallback to basic SEO JSON-LD (available for all plans) {%- endcomment -%}\n    {%- assign seo_key = \'seo__\' | append: request.locale.iso_code -%}\n    {%- assign seo_data_json = product.metafields.seo_ai[seo_key].value | default: product.metafields.seo_ai.seo__en.value -%}\n    {%- if seo_data_json -%}\n      <script type="application/ld+json" id="seo-basic-jsonld-{{ product.id }}">\n      <\/script>\n      <script>\n        (function() {\n          try {\n            var seoData = JSON.parse({{ seo_data_json | json }});\n            if (seoData && seoData.jsonLd) {\n              var scriptTag = document.getElementById(\'seo-basic-jsonld-{{ product.id }}\');\n              if (scriptTag) {\n                scriptTag.textContent = JSON.stringify(seoData.jsonLd);\n              }\n            }\n          } catch(e) {\n            console.error(\'Failed to parse SEO JSON-LD:\', e);\n          }\n        })();\n      <\/script>\n    {%- endif -%}\n  {%- endif -%}\n{%- endif -%}\n\n{%- comment -%} Site-wide FAQ Schema {%- endcomment -%}\n{%- if shop.metafields.advanced_schema.site_faq -%}\n  <script type="application/ld+json">\n{{ shop.metafields.advanced_schema.site_faq.value }}\n  <\/script>\n{%- endif -%}'})}),n.jsx(l,{align:"end",children:n.jsx(p,{onClick:()=>{navigator.clipboard.writeText('{%- comment -%} Advanced Schema Data - Auto-generated by indexAIze - Unlock AI Search {%- endcomment -%}\n\n{%- comment -%} Organization & WebSite Schema (site-wide) {%- endcomment -%}\n{%- if shop.metafields.advanced_schema.shop_schemas -%}\n  <script type="application/ld+json">\n{{ shop.metafields.advanced_schema.shop_schemas.value }}\n  <\/script>\n{%- endif -%}\n\n{%- comment -%} Product Schema (product pages only) {%- endcomment -%}\n{%- if product -%}\n  {%- comment -%} Try Advanced Schema first (requires tokens/Enterprise plan) {%- endcomment -%}\n  {%- assign schema_key = \'schemas_\' | append: request.locale.iso_code -%}\n  {%- assign schemas_json = product.metafields.advanced_schema[schema_key].value -%}\n  {%- if schemas_json -%}\n    <script type="application/ld+json">\n{{ schemas_json }}\n    <\/script>\n  {%- else -%}\n    {%- comment -%} Fallback to basic SEO JSON-LD (available for all plans) {%- endcomment -%}\n    {%- assign seo_key = \'seo__\' | append: request.locale.iso_code -%}\n    {%- assign seo_data_json = product.metafields.seo_ai[seo_key].value | default: product.metafields.seo_ai.seo__en.value -%}\n    {%- if seo_data_json -%}\n      <script type="application/ld+json" id="seo-basic-jsonld-{{ product.id }}">\n      <\/script>\n      <script>\n        (function() {\n          try {\n            var seoData = JSON.parse({{ seo_data_json | json }});\n            if (seoData && seoData.jsonLd) {\n              var scriptTag = document.getElementById(\'seo-basic-jsonld-{{ product.id }}\');\n              if (scriptTag) {\n                scriptTag.textContent = JSON.stringify(seoData.jsonLd);\n              }\n            }\n          } catch(e) {\n            console.error(\'Failed to parse SEO JSON-LD:\', e);\n          }\n        })();\n      <\/script>\n    {%- endif -%}\n  {%- endif -%}\n{%- endif -%}\n\n{%- comment -%} Site-wide FAQ Schema {%- endcomment -%}\n{%- if shop.metafields.advanced_schema.site_faq -%}\n  <script type="application/ld+json">\n{{ shop.metafields.advanced_schema.site_faq.value }}\n  <\/script>\n{%- endif -%}'),k("Code copied to clipboard!")},children:"Copy Code"})}),n.jsx(d,{tone:"warning",children:n.jsx(c,{children:"Always backup your theme before making changes!"})})]})})}),n.jsx(a,{children:n.jsx(t,{padding:"300",children:n.jsxs(i,{gap:"300",children:[n.jsx(c,{as:"h4",variant:"headingSm",children:"Testing Your Installation"}),n.jsxs(m,{children:[n.jsx(m.Item,{children:"After installation, visit your store's homepage and product pages"}),n.jsx(m.Item,{children:"View the page source (right-click → View Source)"}),n.jsxs(m.Item,{children:["Search for ",n.jsx("code",{children:"application/ld+json"})," to find your schemas"]}),n.jsx(m.Item,{children:"Use the Validation tab to test with Google's tools"})]})]})})})]})})]})]})})}),w&&n.jsx(u,{content:w,onDismiss:()=>k("")})]})}export{g as default};
