import{r as V,j as e}from"./react-vendor-6uwpMgJP.js";import{C as Y,B as $,a as m,T as r,D as L,I as M,e as A,d as H}from"./polaris-B96_d87K.js";const K={productsJson:"Products JSON Feed",basicSitemap:"Basic Sitemap",robotsTxt:"robots.txt.liquid",schemaData:"Schema Data (theme.liquid)",welcomePage:"AI Welcome Page",collectionsJson:"Collections JSON Feed",storeMetadata:"Store Metadata",aiSitemap:"AI-Enhanced Sitemap",advancedSchemaApi:"Advanced Schema Data"};function _({testResults:D={},aiTestResults:I={},stats:O={}}){const E=d=>{const t=Math.max(0,Math.min(100,d))/100,c=239,n=68,l=68,o=16,b=185,g=129,x=Math.round(c+(o-c)*t),k=Math.round(n+(b-n)*t),j=Math.round(l+(g-l)*t);return`rgb(${x}, ${k}, ${j})`},G=d=>{const t=d*3.6,c=Math.max(0,Math.min(100,d))/100;let n=[];if(c<=.2)n=["#ef4444 0deg",`#ef4444 ${t}deg`,`#e5e7eb ${t}deg`,"#e5e7eb 360deg"];else if(c<=.4)n=["#ef4444 0deg",`#f97316 ${t*.5}deg`,`#f97316 ${t}deg`,`#e5e7eb ${t}deg`,"#e5e7eb 360deg"];else if(c<=.6){const l=t*.33,o=t*.66;n=["#ef4444 0deg",`#f97316 ${l}deg`,`#f59e0b ${o}deg`,`#f59e0b ${t}deg`,`#e5e7eb ${t}deg`,"#e5e7eb 360deg"]}else if(c<=.8){const l=t*.2,o=t*.4,b=60*3.6,g=Math.max(b,t*.7);n=["#ef4444 0deg",`#f97316 ${l}deg`,`#f59e0b ${o}deg`,`#22c55e ${g}deg`,`#22c55e ${t}deg`,`#e5e7eb ${t}deg`,"#e5e7eb 360deg"]}else{const l=t*.15,o=t*.3,b=60*3.6,g=Math.max(b,t*.5);n=["#ef4444 0deg",`#f97316 ${l}deg`,`#f59e0b ${o}deg`,`#10b981 ${g}deg`,`#10b981 ${t}deg`,`#e5e7eb ${t}deg`,"#e5e7eb 360deg"]}return`conic-gradient(${n.join(", ")})`},i=V.useMemo(()=>((t,c,n,l)=>{var P,B,W,T,F,J,q;const o={endpointAvailability:0,aiValidationQuality:0,optimizationCoverage:0,structuredDataQuality:0,total:0},b={productsJson:5,basicSitemap:4,robotsTxt:2,schemaData:2,welcomePage:3,collectionsJson:4,storeMetadata:4,aiSitemap:3,advancedSchemaApi:3};let g=0,x=0;for(const[a,s]of Object.entries(t||{})){const u=b[a]||1;x+=u,s.status==="success"?g+=u:s.status==="warning"?g+=u*.7:s.status==="locked"&&(g+=u*.3)}o.endpointAvailability=x>0?Math.round(g/x*30):0;const k={excellent:1,good:.75,fair:.5,poor:.25,unavailable:0,locked:.1};let j=0,C=0;for(const[a,s]of Object.entries(c||{})){if(a==="robotsTxt"||a==="schemaData")continue;const u=((P=s.rating)==null?void 0:P.toLowerCase())||"unavailable",p=k[u]||0,S=b[a]||1;j+=p*S,C+=S}o.aiValidationQuality=C>0?Math.round(j/C*40):0;const z=n.totalProducts||0,N=n.optimizedProducts||0,Q=n.totalCollections||0,U=n.optimizedCollections||0;let w=0;if(z>0){const a=N/z;w+=a*12}if(Q>0){const a=U/Q;w+=a*8}else z>0&&(w+=8);o.optimizationCoverage=Math.round(w);let f=0;if(((B=t==null?void 0:t.schemaData)==null?void 0:B.status)==="success"&&(f+=3),((W=t==null?void 0:t.storeMetadata)==null?void 0:W.status)==="success"){f+=3;const a=(F=(T=c==null?void 0:c.storeMetadata)==null?void 0:T.rating)==null?void 0:F.toLowerCase();a==="excellent"?f+=4:a==="good"&&(f+=2)}else((J=t==null?void 0:t.storeMetadata)==null?void 0:J.status)==="locked"&&(f+=1);((q=t==null?void 0:t.advancedSchemaApi)==null?void 0:q.status)==="success"&&(f+=2),o.structuredDataQuality=Math.min(10,Math.round(f)),o.total=Math.min(100,o.endpointAvailability+o.aiValidationQuality+o.optimizationCoverage+o.structuredDataQuality);let v="E",y="#ef4444";o.total>=80?(v="A",y="#10b981"):o.total>=60?(v="B",y="#3b82f6"):o.total>=40?(v="C",y="#f59e0b"):o.total>=20&&(v="D",y="#f97316");const h=[];if(o.endpointAvailability<20){const a=Object.entries(t||{}).filter(([u,p])=>p.status==="locked").length,s=Object.entries(t||{}).filter(([u,p])=>p.status==="error"||p.status==="failed").length;a>0&&s===0?h.push("Several AI discovery endpoints are locked due to plan limitations. Upgrade your plan to unlock them."):a>0&&s>0?h.push("Some endpoints are missing or not working. Others are locked due to plan limitations. Fix endpoint issues and upgrade your plan to improve your score."):h.push("Several AI discovery endpoints are missing or not working. Fix endpoint issues to improve your score.")}if(o.aiValidationQuality<30){const a=Object.entries(c||{}).filter(([s,u])=>{var S;const p=(S=u.rating)==null?void 0:S.toLowerCase();return(p==="poor"||p==="fair")&&s!=="robotsTxt"&&s!=="schemaData"}).map(([s])=>l[s]||s);a.length>0&&(h.push(`${a.length} endpoint(s) have low data quality ratings. Improve content quality to boost your score.`),h.push(`Review and improve: ${a.join(", ")}`))}return o.optimizationCoverage<15&&(h.push("Low optimization coverage. Optimize more products and collections to improve your score."),h.push("Go to Search Optimization for AI and optimize your products/collections")),o.structuredDataQuality<7&&h.push("Structured data could be improved. Add organization schema and enhance product schema."),{score:o.total,grade:v,gradeColor:y,breakdown:o,recommendations:h.length>0?h:["Your store is well-optimized for AI search engines!"]}})(D,I,O,K),[D,I,O]);return i?(console.log("[AIEOScoreCard] Rendering with score:",i.score),e.jsx(Y,{children:e.jsx($,{padding:"400",children:e.jsxs(m,{gap:"300",children:[e.jsxs(m,{gap:"100",children:[e.jsx(r,{as:"h3",variant:"headingMd",children:"AIEO Score"}),e.jsx(r,{variant:"bodySm",tone:"subdued",children:"Overall AI Engine Optimization rating"})]}),e.jsx(L,{}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"24px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"24px"},children:[e.jsx($,{style:{width:"138px",height:"138px",borderRadius:"50%",background:G(i.score),display:"flex",alignItems:"center",justifyContent:"center",position:"relative",flexShrink:0},children:e.jsx($,{style:{width:"103.5px",height:"103.5px",borderRadius:"50%",background:"white",position:"absolute",zIndex:1}})}),e.jsxs(m,{gap:"100",children:[e.jsxs(r,{variant:"headingMd",fontWeight:"semibold",style:{color:E(i.score)},children:["AIEO Score = ",i.score]}),e.jsxs(r,{variant:"headingMd",fontWeight:"bold",style:{color:E(i.score)},children:["AIEO Rating = ",i.grade]})]})]}),e.jsxs(m,{gap:"200",children:[e.jsx(r,{variant:"headingSm",children:"Score Breakdown"}),e.jsxs(m,{gap:"100",children:[e.jsxs(M,{align:"space-between",children:[e.jsx(r,{variant:"bodyMd",children:"Endpoint Availability"}),e.jsxs(r,{variant:"bodyMd",fontWeight:"semibold",children:[i.breakdown.endpointAvailability,"/30"]})]}),e.jsx(A,{progress:Math.round(i.breakdown.endpointAvailability/30*100),size:"small",tone:"success"})]}),e.jsxs(m,{gap:"100",children:[e.jsxs(M,{align:"space-between",children:[e.jsx(r,{variant:"bodyMd",children:"AI Validation Quality"}),e.jsxs(r,{variant:"bodyMd",fontWeight:"semibold",children:[i.breakdown.aiValidationQuality,"/40"]})]}),e.jsx(A,{progress:Math.round(i.breakdown.aiValidationQuality/40*100),size:"small",tone:"success"})]}),e.jsxs(m,{gap:"100",children:[e.jsxs(M,{align:"space-between",children:[e.jsx(r,{variant:"bodyMd",children:"Optimization Coverage"}),e.jsxs(r,{variant:"bodyMd",fontWeight:"semibold",children:[i.breakdown.optimizationCoverage,"/20"]})]}),e.jsx(A,{progress:Math.round(i.breakdown.optimizationCoverage/20*100),size:"small",tone:"success"})]}),e.jsxs(m,{gap:"100",children:[e.jsxs(M,{align:"space-between",children:[e.jsx(r,{variant:"bodyMd",children:"Structured Data Quality"}),e.jsxs(r,{variant:"bodyMd",fontWeight:"semibold",children:[i.breakdown.structuredDataQuality,"/10"]})]}),e.jsx(A,{progress:Math.round(i.breakdown.structuredDataQuality/10*100),size:"small",tone:"success"})]})]})]}),i.recommendations&&i.recommendations.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(L,{}),e.jsxs(m,{gap:"200",children:[e.jsx(r,{variant:"headingSm",children:"Recommendations"}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:i.recommendations.map((d,t)=>e.jsx(H,{tone:d.includes("Fix")||d.includes("Improve")||d.includes("low")?"critical":d.includes("Review")?"warning":"info",children:e.jsx(r,{variant:"bodyMd",children:d})},t))})]})]})]})})})):(console.error("[AIEOScoreCard] calculatedAIEOScore is null/undefined"),null)}export{_ as A};
