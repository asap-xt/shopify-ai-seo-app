import{r as e,j as t}from"./react-vendor-BXVC7v0l.js";import{m as n}from"./sessionFetch-pkDhgt49.js";import{g as s}from"./usePlanHierarchy-CpsbOjPs.js";import{d as i}from"./index-iNn-oBGi.js";import{A as o}from"./AIEOScoreCard-D2hU0Uip.js";import{L as r,C as a,B as d,T as l,a as c,I as u,b as h,c as p,D as g,d as m,e as x,f as b,g as y}from"./polaris-LiLfZG0r.js";import"./app-bridge-DUY42B6P.js";import"./vendor-Cs_VgJ2r.js";function j({shop:j}){var v,S,f,w,k,M,A,I,C,z,P,T;const D=j||((e,t="")=>{try{return new URLSearchParams(window.location.search).get(e)||t}catch{return t}})("shop",""),$=e.useMemo(()=>n(),[]),E=e=>{const t=new URLSearchParams(window.location.search),n=t.toString()?`?${t.toString()}`:"";window.location.href=`${e}${n}`},[L,O]=e.useState(!0),[W,B]=e.useState(null),[N,_]=e.useState(null),[F,G]=e.useState(null),[U,R]=e.useState([]),[V,J]=e.useState({}),[q,H]=e.useState({}),[Y,Q]=e.useState(null),[K,X]=e.useState(!1),[Z,ee]=e.useState(!1),[te,ne]=e.useState(()=>{try{const e=localStorage.getItem(`syncCardExpanded_${D}`);return null===e||"true"===e}catch{return!0}}),se=e.useRef(null),ie=e.useRef(!1),oe=e.useRef(null),[re,ae]=e.useState(()=>{try{return!("true"===localStorage.getItem(`gettingStartedSeenOnce_${D}`))}catch{return!1}}),[de,le]=e.useState(()=>{try{return"true"===localStorage.getItem(`dismissedUpgradeBanner_${D}`)}catch{return!1}}),[ce,ue]=e.useState(()=>{try{return"true"===localStorage.getItem(`dismissedTokenBanner_${D}`)}catch{return!1}}),he=e.useRef(null);e.useEffect(()=>(pe(!0),ge(),(()=>{try{const e=localStorage.getItem(`ai-test-results-${D}`);if(e){const t=JSON.parse(e);t.results&&J(t.results)}const t=localStorage.getItem(`ai-validation-results-${D}`);if(t){const e=JSON.parse(t);e.results&&H(e.results)}const n=localStorage.getItem(`dashboard-stats-${D}`);n&&JSON.parse(n)}catch(e){}})(),()=>{se.current&&(clearInterval(se.current),se.current=null),he.current&&clearTimeout(he.current),oe.current&&(clearTimeout(oe.current),oe.current=null)}),[D]),e.useEffect(()=>{if(!L&&(null==N?void 0:N.plan)&&re)try{"true"===localStorage.getItem(`gettingStartedSeenOnce_${D}`)||oe.current||(oe.current=setTimeout(()=>{try{localStorage.setItem(`gettingStartedSeenOnce_${D}`,"true")}catch(e){}},1e4))}catch(e){}return()=>{oe.current&&(clearTimeout(oe.current),oe.current=null)}},[L,null==N?void 0:N.plan,re,D]),e.useEffect(()=>{Y&&Y.autoSyncEnabled&&!K&&!ie.current&&(i("[Dashboard] Auto-sync is enabled, triggering sync..."),ie.current=!0,me())},[null==Y?void 0:Y.autoSyncEnabled]);const pe=async(e=!1)=>(!e&&he.current&&clearTimeout(he.current),new Promise(t=>{he.current=setTimeout(async()=>{var e,n,s,i;try{O(!0);const[r,a,d]=await Promise.all([$(`/api/dashboard/stats?shop=${D}`),$(`/api/billing/tokens/balance?shop=${D}`),$(`/api/billing/info?shop=${D}`)]);if(r){B(r),_(r.subscription);try{const t={totalProducts:(null==(e=null==r?void 0:r.products)?void 0:e.total)||0,optimizedProducts:(null==(n=null==r?void 0:r.products)?void 0:n.optimized)||0,totalCollections:(null==(s=null==r?void 0:r.collections)?void 0:s.total)||0,optimizedCollections:(null==(i=null==r?void 0:r.collections)?void 0:i.optimized)||0,timestamp:(new Date).toISOString()};localStorage.setItem(`dashboard-stats-${D}`,JSON.stringify(t))}catch(o){}}(null==d?void 0:d.plans)&&R(d.plans),a&&G(a),t()}catch(r){t()}finally{O(!1)}},e?0:500)})),ge=async()=>{try{const e=await $(`/api/dashboard/sync-status?shop=${D}`);e&&(Q(e),ee(e.autoSyncEnabled||!1),X(!!e.inProgress))}catch(e){}},me=async()=>{try{X(!0);const e=await $(`/api/dashboard/sync?shop=${D}`,{method:"POST"});i("[Dashboard] Sync start response:",e),(null==e?void 0:e.success)||(null==e?void 0:e.inProgress)?(se.current&&clearInterval(se.current),se.current=setInterval(async()=>{try{const e=await $(`/api/dashboard/sync-status?shop=${D}`);e&&(Q(e),e.inProgress||(se.current&&(clearInterval(se.current),se.current=null),X(!1),pe()))}catch(e){}},2e3)):X(!1)}catch(e){X(!1)}},xe=(null==(v=null==W?void 0:W.products)?void 0:v.total)>0?Math.round(W.products.optimized/W.products.total*100):0,be=(null==(S=null==W?void 0:W.collections)?void 0:S.total)>0?Math.round(W.collections.optimized/W.collections.total*100):0;s(null==N?void 0:N.plan);const ye=e=>{const t=null==e?void 0:e.toLowerCase().replace(/_/g," "),n=U.find(n=>n.key===t||n.key===e);return(null==n?void 0:n.price)||0},je=(null==N?void 0:N.price)&&N.price>0?N.price:(null==N?void 0:N.plan)?ye(N.plan):void 0,ve=e=>({starter:1,professional:2,professional_plus:2.5,"professional plus":2.5,growth:3,growth_plus:3.5,"growth plus":3.5,growth_extra:4,"growth extra":4,enterprise:5}[e]||0),Se=()=>{var e,t;if(!W||0===U.length)return null;const n=(null==(e=W.products)?void 0:e.total)||0,s=(null==(t=W.languages)?void 0:t.length)||1,i=(null==N?void 0:N.plan)||"starter",o=ve(i),r=["growth"];let a=null,d=null;for(const u of U)if(!r.includes(u.key)&&n<=u.productLimit&&s<=u.languageLimit){a=u.key,d=u;break}a||(d=U.find(e=>"enterprise"===e.key),a="enterprise");if(ve(a)<=o)return null;const l=(e=>{const t=null==e?void 0:e.toLowerCase().replace(/_/g," "),n=U.find(n=>n.key===t||n.key===e);return n?{products:n.productLimit||0,languages:n.languageLimit||1}:{products:0,languages:0}})(i);let c="";return n>l.products?c=`Your store has ${n} products, exceeding the ${l.products}-product limit of your current plan.`:s>l.languages&&(c=`Your store has ${s} language(s), exceeding the ${l.languages}-language limit of your current plan.`),{plan:a,planName:(null==d?void 0:d.name)||a.replace("_"," ").toUpperCase(),price:(null==d?void 0:d.price)||ye(a),productLimit:(null==d?void 0:d.productLimit)||0,languageLimit:(null==d?void 0:d.languageLimit)||1,reason:c}},fe=e.useMemo(()=>Se(),[W,N,U]),we=e.useMemo(()=>{if(!(null==N?void 0:N.plan))return!1;const e=N.plan;if(!["professional","professional_plus","professional plus","growth","growth_plus","growth plus"].includes(e))return!1;return!(((null==F?void 0:F.balance)||0)>=1e3)},[N,F]);if(L)return t.jsx(r,{children:t.jsx(r.Section,{children:t.jsx(a,{children:t.jsx(d,{padding:"400",children:t.jsx(l,{children:"Loading dashboard..."})})})})});const ke=!(null==Y?void 0:Y.synced);return t.jsxs(r,{children:[t.jsx(r.Section,{children:t.jsx(a,{children:t.jsxs(c,{gap:"300",children:[t.jsxs(u,{align:"space-between",blockAlign:"center",children:[t.jsx(l,{variant:"headingMd",children:"Getting Started"}),t.jsxs(h,{onClick:()=>{const e=!re;if(ae(e),re&&!e)try{localStorage.setItem(`gettingStartedSeenOnce_${D}`,"true"),oe.current&&(clearTimeout(oe.current),oe.current=null)}catch(t){}},disclosure:re?"up":"down",children:[re?"Hide":"Show"," Guide"]})]}),t.jsx(p,{open:re,id:"onboarding-collapsible",transition:{duration:"200ms",timingFunction:"ease-in-out"},children:t.jsx(d,{paddingBlockStart:"300",children:t.jsxs(c,{gap:"400",children:[t.jsx(g,{}),t.jsxs(c,{gap:"300",children:[t.jsx(l,{variant:"headingMd",as:"h3",children:"What This App Does"}),t.jsxs(l,{variant:"bodyMd",tone:"subdued",children:["This app helps optimize your Shopify store for ",t.jsx("strong",{children:"AI search engines"})," (like ChatGPT, Claude, Perplexity) by structuring your existing product data in a format that AI bots can easily understand and reference."]}),t.jsxs(l,{variant:"bodyMd",tone:"subdued",children:[t.jsx("strong",{children:"Important:"})," This app primarily ",t.jsx("strong",{children:"structures"})," your existing data rather than creating new content. AI-enhanced features are supplementary and require additional tokens (unless you're on Growth Extra or Enterprise plans)."]})]}),t.jsx(g,{}),t.jsxs(c,{gap:"200",children:[t.jsx(l,{variant:"headingMd",as:"h3",children:"Video Tutorial"}),t.jsx(d,{padding:"400",background:"bg-surface-secondary",borderRadius:"200",children:t.jsx("div",{style:{position:"relative",paddingBottom:"56.25%",height:0,overflow:"hidden",maxWidth:"100%",borderRadius:"8px"},children:t.jsx("iframe",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",border:"none"},src:"https://www.youtube-nocookie.com/embed/bNfDsyDQEkc?origin=https://admin.shopify.com",title:"Video Tutorial",referrerPolicy:"no-referrer-when-downgrade",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0})})})]}),t.jsx(g,{}),t.jsxs(c,{gap:"300",children:[t.jsx(l,{variant:"headingMd",as:"h3",children:"Quick Start Guide"}),t.jsxs(c,{gap:"200",children:[t.jsx(l,{variant:"bodyMd",fontWeight:"semibold",children:"1. Sync Your Store Data"}),t.jsx(l,{variant:"bodyMd",tone:"subdued",children:'Click "Sync Now" to fetch your products, collections, languages, and markets from Shopify. This is required before you can start optimizing. Enable "Auto-sync on load" to keep your data fresh.'}),t.jsx(l,{variant:"bodyMd",fontWeight:"semibold",children:"2. Plan Selection & Token Management"}),t.jsx(l,{variant:"bodyMd",tone:"subdued",children:'Plan selection happens during app installation. Visit "Plans & Billing" to upgrade your plan or purchase additional tokens for AI-enhanced features (Professional/Growth plans).'}),t.jsx(l,{variant:"bodyMd",fontWeight:"semibold",children:"3. Structure Your Product Data"}),t.jsxs(l,{variant:"bodyMd",tone:"subdued",children:['Go to "Store Optimization for AI" → Products tab. First, create ',t.jsx("strong",{children:"basic optimization"})," by structuring existing titles, descriptions, and metadata for better AI consumption. This is essential - without basic optimization, AI-enhanced features cannot be applied."]}),t.jsxs(l,{variant:"bodyMd",tone:"subdued",children:["Also optimize your ",t.jsx("strong",{children:"Collections"})," to help AI bots understand your product categories and relationships."]}),t.jsx(l,{variant:"bodyMd",fontWeight:"semibold",children:"4. Configure Store Metadata"}),t.jsx(l,{variant:"bodyMd",tone:"subdued",children:'Go to "Store Metadata" to configure store description, keywords, business information, and contact details (Professional+ plans). This helps AI bots understand your brand and business context.'}),t.jsx(l,{variant:"bodyMd",fontWeight:"semibold",children:"5. Generate Sitemaps"}),t.jsxs(l,{variant:"bodyMd",tone:"subdued",children:["Navigate to Sitemap tab to generate your ",t.jsx("strong",{children:"standard sitemap"})," for search engines. For advanced optimization, go to Settings → Sitemap to configure ",t.jsx("strong",{children:"AI-enhanced sitemap"}),"with structured data that helps AI search engines discover and index your products (Growth Extra+ plans)."]}),t.jsx(l,{variant:"bodyMd",fontWeight:"semibold",children:"6. AI-Enhanced Features (Optional)"}),t.jsxs(l,{variant:"bodyMd",tone:"subdued",children:["Use AI-enhanced add-ons to ",t.jsx("strong",{children:"supplement and strengthen"})," your data discovery by AI bots, increasing your store's chances of being well-represented. These include:"]}),t.jsxs(l,{variant:"bodyMd",tone:"subdued",children:["• ",t.jsx("strong",{children:"AI Testing:"})," Test how AI bots respond to your products (Professional+)"]}),t.jsxs(l,{variant:"bodyMd",tone:"subdued",children:["• ",t.jsx("strong",{children:"AI Discovery Endpoints:"})," Advanced AI simulation features (Growth Extra+)"]}),t.jsxs(l,{variant:"bodyMd",tone:"subdued",children:["• ",t.jsx("strong",{children:"Advanced Schema Data:"})," Rich structured data markup (Enterprise only)"]}),t.jsx(l,{variant:"bodyMd",tone:"subdued",children:"These features require additional tokens unless you're on Growth Extra or Enterprise plans."}),t.jsx(l,{variant:"bodyMd",fontWeight:"semibold",children:"7. Configure AI Discovery Settings"}),t.jsx(l,{variant:"bodyMd",tone:"subdued",children:'Visit "AI Discovery Features" to configure:'}),t.jsxs(l,{variant:"bodyMd",tone:"subdued",children:["• ",t.jsx("strong",{children:"AI Bot Access Control:"})," Select which AI bots (OpenAI, Claude, Google, etc.) can access your store's structured data"]}),t.jsxs(l,{variant:"bodyMd",tone:"subdued",children:["• ",t.jsx("strong",{children:"AI Discovery Features:"})," Enable Products JSON Feed, Collections JSON Feed, Store Metadata, AI Welcome Page, AI-Enhanced Sitemap, and Advanced Schema Data"]}),t.jsxs(l,{variant:"bodyMd",tone:"subdued",children:["• Click ",t.jsx("strong",{children:'"Save Settings"'})," to save your configuration"]}),t.jsx(l,{variant:"bodyMd",fontWeight:"semibold",children:"8. Install robots.txt (REQUIRED)"}),t.jsxs(l,{variant:"bodyMd",tone:"subdued",children:[t.jsx("strong",{children:"Critical:"})," After saving Settings, you must manually install robots.txt in your theme for AI bots to access your endpoints:"]}),t.jsxs(l,{variant:"bodyMd",tone:"subdued",children:['• In Settings, scroll to "robots.txt Configuration" section and click ',t.jsx("strong",{children:'"View & Copy robots.txt Code"'})]}),t.jsx(l,{variant:"bodyMd",tone:"subdued",children:"• Copy the generated robots.txt content"}),t.jsxs(l,{variant:"bodyMd",tone:"subdued",children:["• Go to ",t.jsx("strong",{children:"Online Store → Themes"})," → ",t.jsx("strong",{children:"Actions → Edit code"})," on your active theme"]}),t.jsxs(l,{variant:"bodyMd",tone:"subdued",children:["• Click ",t.jsx("strong",{children:'"Add a new file"'})," and type: ",t.jsx("code",{children:"templates/robots.txt.liquid"})]}),t.jsxs(l,{variant:"bodyMd",tone:"subdued",children:["• Paste the copied content and click ",t.jsx("strong",{children:"Save"})]}),t.jsx(l,{variant:"bodyMd",tone:"subdued",children:t.jsx("strong",{children:"Without this step, AI bots cannot discover your store's endpoints!"})}),t.jsx(l,{variant:"bodyMd",fontWeight:"semibold",children:"9. Optional: Advanced Features"}),t.jsx(l,{variant:"bodyMd",tone:"subdued",children:"Additional features available in Settings:"}),t.jsxs(l,{variant:"bodyMd",tone:"subdued",children:["• ",t.jsx("strong",{children:"Advanced Schema Data:"})," Generate rich structured data markup for your products (Professional Plus/Enterprise plans)"]}),t.jsxs(l,{variant:"bodyMd",tone:"subdued",children:["• ",t.jsx("strong",{children:"AI Testing:"})," Test how AI bots respond to your products (Professional+ plans)"]}),t.jsx(l,{variant:"bodyMd",tone:"subdued",children:"These features may require additional tokens depending on your plan."}),t.jsx(l,{variant:"bodyMd",fontWeight:"semibold",children:"10. Monitor & Improve"}),t.jsx(l,{variant:"bodyMd",tone:"subdued",children:"Return to Dashboard regularly to track optimization progress, monitor token usage, and review plan recommendations."})]})]}),t.jsx(d,{paddingBlockStart:"200",children:t.jsxs(u,{gap:"200",children:[t.jsx(h,{variant:"primary",onClick:()=>E("/ai-seo/products"),children:"Start Optimizing"}),t.jsx(h,{onClick:()=>E("/billing"),children:"View Plans"})]})})]})})})]})})}),ke&&t.jsx(r.Section,{children:t.jsx(m,{title:"Sync your store",tone:"info",action:{content:K?"Syncing...":"Sync Now",onAction:me,loading:K},children:t.jsxs(c,{gap:"200",children:[t.jsx(l,{children:"Sync products, collections, languages, and markets to get started with AI optimization."}),K&&t.jsxs(d,{paddingBlockStart:"200",children:[t.jsx(x,{progress:50,size:"small",tone:"highlight"}),t.jsx(d,{paddingBlockStart:"100",children:t.jsx(l,{variant:"bodySm",tone:"subdued",children:"Fetching store data..."})})]})]})})}),!ke&&Y&&t.jsx(r.Section,{children:t.jsx(a,{children:te?t.jsxs(c,{gap:"300",children:[t.jsxs(u,{align:"space-between",blockAlign:"center",children:[t.jsxs("div",{children:[t.jsx(l,{variant:"bodyMd",fontWeight:"semibold",children:"Store Sync"}),t.jsx(d,{paddingBlockStart:"050",children:t.jsxs(l,{variant:"bodySm",tone:"subdued",children:["Last synced: ",Y.lastSyncDate?new Date(Y.lastSyncDate).toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"Never"]})})]}),t.jsxs(u,{gap:"200",children:[t.jsx(h,{onClick:me,loading:K,children:"Sync Now"}),t.jsx(h,{onClick:()=>{ne(!1);try{localStorage.setItem(`syncCardExpanded_${D}`,"false")}catch(e){}},variant:"plain",children:"Close"})]})]}),t.jsx(g,{}),t.jsx(y,{label:"Auto-sync on load",checked:Z,onChange:async e=>{try{i("[Dashboard] Toggling auto-sync to:",e),ee(e);const t=await $(`/api/dashboard/auto-sync?shop=${D}`,{method:"POST",body:{enabled:e}});i("[Dashboard] Auto-sync toggle response:",t),(null==t?void 0:t.success)&&(ee(!!t.autoSyncEnabled),Q({...Y||{},autoSyncEnabled:!!t.autoSyncEnabled}))}catch(t){ee(!e)}},helpText:"Automatically sync store data when you open the dashboard"})]}):t.jsxs(u,{align:"space-between",blockAlign:"center",gap:"400",children:[t.jsxs(u,{gap:"200",blockAlign:"center",children:[Z&&t.jsx(b,{tone:"success",children:"Auto-sync enabled"}),t.jsxs(l,{variant:"bodySm",tone:"subdued",children:["Last synced: ",Y.lastSyncDate?new Date(Y.lastSyncDate).toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"Never"]})]}),t.jsxs(u,{gap:"200",children:[t.jsx(h,{onClick:me,loading:K,size:"slim",children:"Sync Now"}),t.jsx(h,{onClick:()=>{ne(!0);try{localStorage.setItem(`syncCardExpanded_${D}`,"true")}catch(e){}},size:"slim",variant:"plain",children:"Expand"})]})]})})}),fe&&!de&&t.jsx(r.Section,{children:t.jsx(m,{title:`Upgrade to ${fe.planName} Plan`,tone:"warning",action:{content:"View Plans",onAction:()=>E("/billing")},onDismiss:()=>{try{localStorage.setItem(`dismissedUpgradeBanner_${D}`,"true"),le(!0)}catch(e){}},children:t.jsxs(c,{gap:"200",children:[t.jsx(l,{children:fe.reason}),t.jsxs(l,{variant:"bodySm",tone:"subdued",children:["The ",fe.planName," plan supports up to ",fe.productLimit," products in ",fe.languageLimit," language",fe.languageLimit>1?"s":"","for $",fe.price,"/month."]})]})})}),we&&!ce&&t.jsx(r.Section,{children:t.jsx(m,{title:"Buy Tokens to Unlock AI Features",tone:"info",action:{content:"Buy Tokens",onAction:()=>E("/billing")},onDismiss:()=>{try{localStorage.setItem(`dismissedTokenBanner_${D}`,"true"),ue(!0)}catch(e){}},children:t.jsx(l,{children:"Purchase tokens to access AI-enhanced optimization features like AEO generation, AI Discovery and more."})})}),t.jsx(r.Section,{children:t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(320px, 1fr))",gap:"16px"},children:[t.jsx("div",{style:{display:"grid",gap:16},children:t.jsx(a,{children:t.jsxs(c,{gap:"400",children:[t.jsx(l,{variant:"headingMd",children:"Products & Collections"}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(220px, 1fr))",gap:12},children:[t.jsxs(c,{gap:"150",children:[t.jsx(l,{variant:"bodyMd",fontWeight:"semibold",children:"Products"}),t.jsxs(u,{align:"space-between",children:[t.jsx(l,{variant:"bodySm",tone:"subdued",children:"Total"}),t.jsx(l,{variant:"bodySm",fontWeight:"semibold",children:(null==(f=null==W?void 0:W.products)?void 0:f.total)||0})]}),t.jsxs(u,{align:"space-between",children:[t.jsx(l,{variant:"bodySm",tone:"subdued",children:"Optimized"}),t.jsx(l,{variant:"bodySm",fontWeight:"semibold",tone:"success",children:(null==(w=null==W?void 0:W.products)?void 0:w.optimized)||0})]}),t.jsxs(u,{align:"space-between",children:[t.jsx(l,{variant:"bodySm",tone:"subdued",children:"Unoptimized"}),t.jsx(l,{variant:"bodySm",fontWeight:"semibold",children:Math.max(((null==(k=null==W?void 0:W.products)?void 0:k.total)||0)-((null==(M=null==W?void 0:W.products)?void 0:M.optimized)||0),0)})]}),t.jsxs(d,{paddingBlockStart:"100",children:[t.jsx(x,{progress:xe,size:"small",tone:100===xe?"success":"primary"}),t.jsx(d,{paddingBlockStart:"050",children:t.jsxs(l,{variant:"bodySm",tone:"subdued",children:[xe,"% optimized"]})})]})]}),t.jsxs(c,{gap:"150",children:[t.jsx(l,{variant:"bodyMd",fontWeight:"semibold",children:"Collections"}),t.jsxs(u,{align:"space-between",children:[t.jsx(l,{variant:"bodySm",tone:"subdued",children:"Total"}),t.jsx(l,{variant:"bodySm",fontWeight:"semibold",children:(null==(A=null==W?void 0:W.collections)?void 0:A.total)||0})]}),t.jsxs(u,{align:"space-between",children:[t.jsx(l,{variant:"bodySm",tone:"subdued",children:"Optimized"}),t.jsx(l,{variant:"bodySm",fontWeight:"semibold",tone:"success",children:(null==(I=null==W?void 0:W.collections)?void 0:I.optimized)||0})]}),t.jsxs(u,{align:"space-between",children:[t.jsx(l,{variant:"bodySm",tone:"subdued",children:"Unoptimized"}),t.jsx(l,{variant:"bodySm",fontWeight:"semibold",children:Math.max(((null==(C=null==W?void 0:W.collections)?void 0:C.total)||0)-((null==(z=null==W?void 0:W.collections)?void 0:z.optimized)||0),0)})]}),t.jsxs(d,{paddingBlockStart:"100",children:[t.jsx(x,{progress:be,size:"small",tone:100===be?"success":"primary"}),t.jsx(d,{paddingBlockStart:"050",children:t.jsxs(l,{variant:"bodySm",tone:"subdued",children:[be,"% optimized"]})})]})]})]}),t.jsx(g,{}),t.jsx(u,{align:"space-between",children:t.jsxs(l,{variant:"bodySm",tone:"subdued",children:["Last synced: ",(null==Y?void 0:Y.lastSyncDate)?new Date(Y.lastSyncDate).toLocaleString():"Never"]})})]})})}),t.jsxs("div",{style:{display:"grid",gap:16},children:[t.jsx(a,{children:t.jsxs(c,{gap:"400",children:[t.jsx(l,{variant:"headingMd",children:"Languages & Markets"}),t.jsx(c,{gap:"200",children:(null==W?void 0:W.languages)&&W.languages.length>0?t.jsxs(t.Fragment,{children:[W.languages.slice().sort((e,t)=>(t.primary?1:0)-(e.primary?1:0)||(t.totalCount||0)-(e.totalCount||0)).slice(0,3).map((e,n)=>{const s=e.totalCount>0?Math.round(e.optimizedCount/e.totalCount*100):0;return t.jsxs(c,{gap:"050",children:[t.jsxs(u,{align:"space-between",children:[t.jsxs(l,{variant:"bodyMd",tone:"subdued",children:[e.name||e.code," ",e.primary?"★":""]}),t.jsxs(l,{variant:"bodySm",fontWeight:"semibold",children:[e.optimizedCount||0,"/",e.totalCount||0]})]}),t.jsx(x,{progress:s,size:"small",tone:100===s?"success":"primary"})]},n)}),W.languages.length>3&&t.jsxs(l,{variant:"bodySm",tone:"subdued",children:["+",W.languages.length-3," more..."]})]}):t.jsx(l,{variant:"bodyMd",tone:"subdued",children:"No language data"})}),(null==W?void 0:W.storeMarkets)&&W.storeMarkets.length>0&&t.jsxs(d,{paddingBlockStart:"200",children:[t.jsx(g,{}),t.jsx(d,{paddingBlockStart:"200",children:t.jsxs(l,{variant:"bodySm",tone:"subdued",children:["Markets: ",W.storeMarkets.slice(0,2).map(e=>e.name).join(", "),W.storeMarkets.length>2?" +"+(W.storeMarkets.length-2):""]})})]})]})}),t.jsx(a,{children:t.jsxs(c,{gap:"300",children:[t.jsx(l,{variant:"headingMd",children:"Last Optimization"}),t.jsx(l,{variant:"bodyLg",fontWeight:"semibold",children:(null==W?void 0:W.lastOptimization)?new Date(W.lastOptimization).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"Never"}),t.jsx(h,{onClick:()=>E("/ai-seo/products"),children:"Optimize Now"})]})})]})]})}),t.jsx(r.Section,{children:t.jsx(o,{testResults:V,aiTestResults:q,stats:(()=>{var e,t,n,s;if(W)return{totalProducts:(null==(e=null==W?void 0:W.products)?void 0:e.total)||0,optimizedProducts:(null==(t=null==W?void 0:W.products)?void 0:t.optimized)||0,totalCollections:(null==(n=null==W?void 0:W.collections)?void 0:n.total)||0,optimizedCollections:(null==(s=null==W?void 0:W.collections)?void 0:s.optimized)||0};try{const e=localStorage.getItem(`dashboard-stats-${D}`);if(e){const t=JSON.parse(e);return{totalProducts:t.totalProducts||0,optimizedProducts:t.optimizedProducts||0,totalCollections:t.totalCollections||0,optimizedCollections:t.optimizedCollections||0}}}catch(i){}return{totalProducts:0,optimizedProducts:0,totalCollections:0,optimizedCollections:0}})(),shop:D,api:$,onTestsComplete:e=>{J(e),pe(!0)}})}),t.jsx(r.Section,{children:t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(320px, 1fr))",gap:"16px"},children:[t.jsx(a,{style:{height:220,minHeight:220},children:t.jsxs(c,{gap:"300",children:[t.jsxs(u,{align:"space-between",blockAlign:"center",children:[t.jsxs("div",{children:[t.jsx(l,{variant:"headingMd",children:"Current Plan"}),t.jsx(d,{paddingBlockStart:"100",children:t.jsxs(l,{variant:"bodySm",tone:"subdued",children:[je?`$${je.toFixed(2)}`:"—","/month"]})})]}),t.jsx(b,{tone:"info",size:"large",children:(null==(P=null==N?void 0:N.plan)?void 0:P.replace("_"," ").toUpperCase())||"N/A"})]}),t.jsx(h,{onClick:()=>E("/billing"),children:"View Plans & Billing"})]})}),t.jsx(a,{style:{height:220,minHeight:220},children:t.jsxs(c,{gap:"300",children:[t.jsx(l,{variant:"headingMd",children:"Token Balance"}),t.jsxs(l,{variant:"bodyLg",fontWeight:"semibold",children:[(null==(T=null==F?void 0:F.balance)?void 0:T.toLocaleString())||0," tokens"]}),("growth_extra"===(null==N?void 0:N.plan)||"enterprise"===(null==N?void 0:N.plan))&&t.jsxs(l,{variant:"bodySm",tone:"subdued",children:["growth_extra"===(null==N?void 0:N.plan)?"100M":"300M"," included monthly"]}),t.jsx(h,{onClick:()=>E("/billing"),children:"Manage Tokens"})]})})]})})]})}export{j as default};
