const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Dashboard-Bf9Vuyv3-1761108908032.js","assets/app-bridge-DO040ZyZ-1761108908032.js","assets/react-vendor-tAaa2TlE-1761108908032.js","assets/sessionFetch-CJepNHo3-1761108908032.js","assets/polaris-DKKYRD6p-1761108908032.js","assets/BulkEdit-HPHtRv4b-1761108908032.js","assets/StoreMetadataBanner-BuAaEwnC-1761108908032.js","assets/Collections-Dt-tlguk-1761108908032.js","assets/Sitemap-Cx6qpOZu-1761108908032.js","assets/StoreMetadata-oPbgvsfc-1761108908032.js","assets/SchemaData-B03ptIwH-1761108908032.js","assets/Settings-CSMzdbU5-1761108908032.js","assets/AiTesting-DYq4nkHE-1761108908032.js","assets/Billing-DOJ11mOM-1761108908032.js","assets/CleanUninstall-53ceRiSv-1761108908032.js"])))=>i.map(i=>d[i]);
import{j as t}from"./app-bridge-DO040ZyZ-1761108908032.js";import{a as B,r as u,R as g}from"./react-vendor-tAaa2TlE-1761108908032.js";import{P as W,A as G,B as V,I as v,T as j,a as E,C as M,b as F,F as Y,c as K}from"./polaris-DKKYRD6p-1761108908032.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))c(o);new MutationObserver(o=>{for(const e of o)if(e.type==="childList")for(const r of e.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&c(r)}).observe(document,{childList:!0,subtree:!0});function i(o){const e={};return o.integrity&&(e.integrity=o.integrity),o.referrerPolicy&&(e.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?e.credentials="include":o.crossOrigin==="anonymous"?e.credentials="omit":e.credentials="same-origin",e}function c(o){if(o.ep)return;o.ep=!0;const e=i(o);fetch(o.href,e)}})();var U,R=B;U=R.createRoot,R.hydrateRoot;const H="modulepreload",q=function(n){return"/"+n},O={},h=function(a,i,c){let o=Promise.resolve();if(i&&i.length>0){document.getElementsByTagName("link");const r=document.querySelector("meta[property=csp-nonce]"),l=(r==null?void 0:r.nonce)||(r==null?void 0:r.getAttribute("nonce"));o=Promise.allSettled(i.map(s=>{if(s=q(s),s in O)return;O[s]=!0;const d=s.endsWith(".css"),_=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${s}"]${_}`))return;const p=document.createElement("link");if(p.rel=d?"stylesheet":H,d||(p.as="script"),p.crossOrigin="",p.href=s,l&&p.setAttribute("nonce",l),document.head.appendChild(p),d)return new Promise((x,f)=>{p.addEventListener("load",x),p.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${s}`)))})}))}function e(r){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=r,window.dispatchEvent(l),!l.defaultPrevented)throw r}return o.then(r=>{for(const l of r||[])l.status==="rejected"&&e(l.reason);return a().catch(e)})},I=["en","de","es","fr"],k={en:"ðŸ‡¬ðŸ‡§",de:"ðŸ‡©ðŸ‡ª",es:"ðŸ‡ªðŸ‡¸",fr:"ðŸ‡«ðŸ‡·"},N={en:"English",de:"Deutsch",es:"EspaÃ±ol",fr:"FranÃ§ais"};function J({lang:n="en",setLang:a,t:i}){const[c,o]=u.useState(!1);u.useEffect(()=>{if(!I.includes(n)){try{localStorage.setItem("app_lang","en")}catch{}typeof a=="function"&&a("en")}},[n,a]);const e=I.includes(n)?n:"en",r=t.jsx(V,{onClick:()=>o(s=>!s),disclosure:!0,children:t.jsxs(v,{gap:"200",blockAlign:"center",children:[t.jsx("span",{"aria-hidden":!0,children:k[e]}),t.jsx(j,{as:"span",variant:"bodyMd",children:N[e]})]})}),l=u.useMemo(()=>I.map(s=>({content:`${k[s]} ${N[s]}`,active:s===e,onAction:()=>{try{localStorage.setItem("app_lang",s)}catch{}typeof a=="function"&&a(s),o(!1)}})),[e,a]);return t.jsx(W,{active:c,activator:r,onClose:()=>o(!1),autofocusTarget:"first-node",children:t.jsx(G,{items:l})})}function Q({sectionTitle:n,lang:a,setLang:i,t:c}){return t.jsx(E,{padding:"400",borderBlockEndWidth:"025",borderColor:"border",background:"bg",children:t.jsxs(v,{align:"space-between",blockAlign:"center",children:[t.jsx(j,{as:"h1",variant:"headingLg",children:n}),t.jsx(J,{lang:a,setLang:i,t:c})]})})}const D="en",b={en:()=>h(()=>import("./en-DY--Skhq-1761108908032.js"),[]),de:()=>h(()=>import("./de-BYtsvH6H-1761108908032.js"),[]),es:()=>h(()=>import("./es-Cshzw9pa-1761108908032.js"),[]),fr:()=>h(()=>import("./fr-DGTXCiho-1761108908032.js"),[])},$=Object.keys(b);function X(){try{const n=localStorage.getItem("app_lang");return $.includes(n)?n:null}catch{return null}}function Z(n){try{localStorage.setItem("app_lang",n)}catch{}}function ee(){const[n,a]=u.useState(()=>X()||D),[i,c]=u.useState({});u.useEffect(()=>{let e=!1;async function r(){const s=await(b[n]||b[D])();e||c(s.default||s)}return r(),Z(n),()=>{e=!0}},[n]);const o=u.useMemo(()=>(e,r="")=>{const l=e==null?void 0:e.split(".").reduce((s,d)=>s&&s[d]!==void 0?s[d]:void 0,i);return l!=null?String(l):r||e},[i]);return{lang:n,setLang:a,t:o,dict:i,langs:$}}const te=g.lazy(()=>h(()=>import("./Dashboard-Bf9Vuyv3-1761108908032.js"),__vite__mapDeps([0,1,2,3,4]))),ne=g.lazy(()=>h(()=>import("./BulkEdit-HPHtRv4b-1761108908032.js"),__vite__mapDeps([5,1,2,6,4]))),oe=g.lazy(()=>h(()=>import("./Collections-Dt-tlguk-1761108908032.js"),__vite__mapDeps([7,1,2,3,6,4]))),re=g.lazy(()=>h(()=>import("./Sitemap-Cx6qpOZu-1761108908032.js"),__vite__mapDeps([8,1,2,3,4]))),se=g.lazy(()=>h(()=>import("./StoreMetadata-oPbgvsfc-1761108908032.js"),__vite__mapDeps([9,1,2,3,4]))),ae=g.lazy(()=>h(()=>import("./SchemaData-B03ptIwH-1761108908032.js"),__vite__mapDeps([10,1,2,3,4]))),ie=g.lazy(()=>(console.log("[APP] ===== LOADING SETTINGS COMPONENT ====="),h(()=>import("./Settings-CSMzdbU5-1761108908032.js"),__vite__mapDeps([11,1,2,3,4])))),ce=g.lazy(()=>h(()=>import("./AiTesting-DYq4nkHE-1761108908032.js"),__vite__mapDeps([12,1,2,3,4]))),le=g.lazy(()=>h(()=>import("./Billing-DOJ11mOM-1761108908032.js"),__vite__mapDeps([13,1,2,4]))),de=g.lazy(()=>h(()=>import("./CleanUninstall-53ceRiSv-1761108908032.js"),__vite__mapDeps([14,1,2,3,4]))),ue={Polaris:{ResourceList:{sortingLabel:"Sort by"}}},z=(n,a="")=>{try{return new URLSearchParams(window.location.search).get(n)||a}catch{return a}};function he(){const n=c=>c.replace(/^\/apps\/[^/]+/,"")||"/",[a,i]=u.useState(()=>n(window.location.pathname));return u.useEffect(()=>{let c=!1;const o=()=>{if(c)return;const r=n(window.location.pathname);console.log("[useRoute] Location changed to:",r),i(r)};window.addEventListener("popstate",o);const e=r=>{const l=r.target.closest("a");if(!l||!l.href||!l.href.startsWith(window.location.origin))return;const s=new URL(l.href),d=window.location.pathname+window.location.search,_=s.pathname+s.search;if(d===_)return;console.log("[useRoute] Navigation click detected, from:",d,"to:",_),r.preventDefault(),r.stopPropagation(),c=!0,window.history.pushState({},"",_);const p=n(s.pathname);i(p),setTimeout(()=>{c=!1},100)};return document.addEventListener("click",e,!0),()=>{window.removeEventListener("popstate",o),document.removeEventListener("click",e,!0)}},[]),{path:a}}function pe({active:n,shop:a}){n==="/"||n.startsWith("/dashboard"),n.startsWith("/ai-seo"),n.startsWith("/billing"),n.startsWith("/settings");const c=new URLSearchParams(window.location.search).get("host"),o=new URLSearchParams;a&&o.set("shop",a),c&&o.set("host",c);const e=o.toString()?`?${o.toString()}`:"";return t.jsxs("ui-nav-menu",{children:[t.jsx("a",{href:`/${e}`,rel:"home",children:"Home"}),t.jsx("a",{href:`/dashboard${e}`,children:"Dashboard"}),t.jsx("a",{href:`/ai-seo${e}`,children:"Search Optimization for AI"}),t.jsx("a",{href:`/settings${e}`,children:"Settings"}),t.jsx("a",{href:`/ai-testing${e}`,children:"AI Testing"}),t.jsx("a",{href:`/billing${e}`,children:"Plans & Billing"}),t.jsx("a",{href:`/clean-uninstall${e}`,children:"Clean & Uninstall"})]})}const fe=g.memo(({shop:n,plan:a})=>{const i=n||z("shop",""),c=window.location.pathname,e=c==="/ai-seo"||c==="/ai-seo/products"?"products":c==="/ai-seo/collections"?"collections":c==="/ai-seo/sitemap"?"sitemap":c==="/ai-seo/store-metadata"?"store-metadata":c==="/ai-seo/schema-data"?"schema-data":"products",r=l=>{const s=new URLSearchParams(window.location.search),d=s.toString()?`?${s.toString()}`:"";return l==="products"?`/ai-seo${d}`:`/ai-seo/${l}${d}`};return t.jsxs("div",{children:[t.jsx(E,{paddingBlockEnd:"400",children:t.jsx(M,{children:t.jsx(E,{padding:"200",children:t.jsxs(v,{gap:"100",children:[t.jsx("a",{href:r("products"),style:{padding:"8px 16px",borderRadius:"4px",backgroundColor:e==="products"?"#008060":"#f6f6f7",color:e==="products"?"white":"#202223",textDecoration:"none",display:"inline-block"},children:"Products"}),t.jsx("a",{href:r("collections"),style:{padding:"8px 16px",borderRadius:"4px",backgroundColor:e==="collections"?"#008060":"#f6f6f7",color:e==="collections"?"white":"#202223",textDecoration:"none",display:"inline-block"},children:"Collections"}),t.jsx("a",{href:r("sitemap"),style:{padding:"8px 16px",borderRadius:"4px",backgroundColor:e==="sitemap"?"#008060":"#f6f6f7",color:e==="sitemap"?"white":"#202223",textDecoration:"none",display:"inline-block"},children:"Sitemap"}),t.jsx("a",{href:r("store-metadata"),style:{padding:"8px 16px",borderRadius:"4px",backgroundColor:e==="store-metadata"?"#008060":"#f6f6f7",color:e==="store-metadata"?"white":"#202223",textDecoration:"none",display:"inline-block"},children:"Store metadata"}),t.jsx("a",{href:r("schema-data"),style:{padding:"8px 16px",borderRadius:"4px",backgroundColor:e==="schema-data"?"#008060":"#f6f6f7",color:e==="schema-data"?"white":"#202223",textDecoration:"none",display:"inline-block"},children:"Schema Data"})]})})})}),t.jsxs("div",{children:[e==="products"&&t.jsx(ne,{shop:i,globalPlan:a}),e==="collections"&&t.jsx(oe,{shop:i,globalPlan:a}),e==="sitemap"&&t.jsx(re,{shop:i}),e==="store-metadata"&&t.jsx(se,{shop:i}),e==="schema-data"&&t.jsx(ae,{shop:i})]})]})});function me(){const{path:n}=he(),{lang:a,setLang:i,t:c}=ee(),o=!!new URLSearchParams(window.location.search).get("host"),e=z("shop",""),[r,l]=u.useState(null);u.useEffect(()=>{const _=async()=>{const x=new URLSearchParams(window.location.search),f=x.get("shop"),S=x.get("id_token");if(f&&S)try{console.log("[APP] Performing initial token exchange for shop:",f);const m=await fetch("/token-exchange",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({shop:f,id_token:S})});if(!m.ok){const T=await m.json();console.error("[APP] Token exchange failed:",T);return}const A=await m.json();console.log("[APP] Token exchange successful:",A);const w=new URL(window.location);w.searchParams.delete("id_token"),window.history.replaceState({},"",w),await p(f)}catch(m){console.error("[APP] Token exchange error:",m)}else f&&await p(f)},p=async x=>{var f;try{const m=await fetch("/graphql",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:`
          query PlansMe($shop:String!) {
            plansMe(shop:$shop) {
              shop
              plan
              planKey
              priceUsd
              product_limit
              providersAllowed
              modelsSuggested
              trial {
                active
                ends_at
                days_left
              }
            }
          }
        `,variables:{shop:x}})});if(m.status===202&&(await m.json()).error==="token_exchange_required"){console.log("[APP] Token exchange required, but no id_token available"),window.location.href=`/auth?shop=${encodeURIComponent(x)}`;return}if(!m.ok){console.error("[APP] Failed to load plans:",await m.text());return}const A=await m.json(),w=(f=A==null?void 0:A.data)==null?void 0:f.plansMe;w&&l(w)}catch(S){console.error("[APP] Error loading initial data:",S)}};_()},[]);const s=u.useMemo(()=>n.startsWith("/ai-seo")?"Search Optimization for AI":n.startsWith("/billing")?"Plans & Billing":n.startsWith("/settings")?"Settings":n.startsWith("/ai-testing")?"AI Testing":n.startsWith("/clean-uninstall")?"Clean & Uninstall":"Dashboard",[n]),d=()=>n==="/"||n==="/dashboard"?t.jsx(te,{shop:e}):n.startsWith("/ai-seo")?t.jsx(fe,{shop:e,plan:r}):n==="/billing"?t.jsx(le,{shop:e}):n==="/settings"?(console.log("[APP] ===== RENDERING SETTINGS PAGE ====="),t.jsx(ie,{shop:e})):n==="/ai-testing"?(console.log("[APP] ===== RENDERING AI TESTING PAGE ====="),console.log("[APP] Path:",n),console.log("[APP] Shop:",e),t.jsx(ce,{shop:e})):n==="/clean-uninstall"?t.jsx(de,{shop:e}):t.jsx(M,{children:t.jsxs(E,{padding:"400",children:[t.jsx(j,{variant:"headingMd",children:"Page not found"}),t.jsx(E,{paddingBlockStart:"200",children:t.jsxs(j,{children:['The page "',n,'" does not exist.']})})]})});return t.jsxs(F,{i18n:ue,children:[o&&t.jsx(pe,{active:n,shop:e}),t.jsx(Y,{children:t.jsxs(K,{children:[t.jsx(Q,{sectionTitle:s,lang:a,setLang:i,t:c,shop:e}),d()]})})]})}const L=new URLSearchParams(window.location.search),y=L.get("host"),P=L.get("shop"),C=L.get("embedded")==="1";console.log("[MAIN] Public App - Host:",y,"Shop:",P);console.log("[MAIN] Full URL:",window.location.href);function ge(){const[n,a]=u.useState(!1),i=u.useMemo(()=>(console.log("[MAIN] Checking for API key..."),console.log("[MAIN] window.__SHOPIFY_API_KEY:",window.__SHOPIFY_API_KEY),console.log("[MAIN] import.meta.env.VITE_SHOPIFY_API_KEY:","2749a2f6d38ff5796ed256b5c9dc70a1"),window.__SHOPIFY_API_KEY?(console.log("[MAIN] Using injected API key:",window.__SHOPIFY_API_KEY),window.__SHOPIFY_API_KEY):(console.log("[MAIN] Using env API key:","2749a2f6d38ff5796ed256b5c9dc70a1"),"2749a2f6d38ff5796ed256b5c9dc70a1")),[]);return u.useEffect(()=>{setTimeout(()=>a(!0),100)},[]),!C||!y||!P?(console.log("[MAIN] Not embedded or missing params"),t.jsxs("div",{style:{padding:"20px",textAlign:"center"},children:[t.jsx("h1",{children:"Error: App must be loaded from Shopify Admin"}),t.jsxs("p",{children:["Shop: ",P||"Missing"]}),t.jsxs("p",{children:["Host: ",y||"Missing"]}),t.jsxs("p",{children:["Embedded: ",C?"Yes":"No"]}),t.jsx("a",{href:`https://admin.shopify.com/store/${P==null?void 0:P.replace(".myshopify.com","")}/apps`,children:"Go to Shopify Admin"})]})):i?(console.log("[MAIN] App config:",{apiKey:i?"SET":"MISSING",host:y?"SET":"MISSING",shop:P?"SET":"MISSING"}),n?t.jsx(me,{}):t.jsx("div",{children:"Loading..."})):t.jsxs("div",{style:{padding:"20px",textAlign:"center"},children:[t.jsx("h1",{children:"Configuration Error"}),t.jsx("p",{children:"Shopify API key is not configured."}),t.jsx("p",{children:"Please contact support."})]})}U(document.getElementById("root")).render(t.jsx(ge,{}));export{ee as u};
