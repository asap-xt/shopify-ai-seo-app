import{j as a}from"./app-bridge-s4l-sa3A-1761331988846.js";import{r as y}from"./react-vendor-tAaa2TlE-1761331988846.js";import{u as K}from"./useShopApi-CFtfjZWF-1761331988846.js";import{a as g,e as v,T as b,d as z,C as T,I as R,j as k,y as A,B as U}from"./polaris-Mgc-1wWQ-1761331988846.js";class S{constructor(s=0,t="Network Error"){this.status=s,this.text=t}}const W=()=>{if(!(typeof localStorage>"u"))return{get:e=>Promise.resolve(localStorage.getItem(e)),set:(e,s)=>Promise.resolve(localStorage.setItem(e,s)),remove:e=>Promise.resolve(localStorage.removeItem(e))}},n={origin:"https://api.emailjs.com",blockHeadless:!1,storageProvider:W()},P=e=>e?typeof e=="string"?{publicKey:e}:e.toString()==="[object Object]"?e:{}:{},$=(e,s="https://api.emailjs.com")=>{if(!e)return;const t=P(e);n.publicKey=t.publicKey,n.blockHeadless=t.blockHeadless,n.storageProvider=t.storageProvider,n.blockList=t.blockList,n.limitRate=t.limitRate,n.origin=t.origin||s},_=async(e,s,t={})=>{const o=await fetch(n.origin+e,{method:"POST",headers:t,body:s}),i=await o.text(),h=new S(o.status,i);if(o.ok)return h;throw h},C=(e,s,t)=>{if(!e||typeof e!="string")throw"The public key is required. Visit https://dashboard.emailjs.com/admin/account";if(!s||typeof s!="string")throw"The service ID is required. Visit https://dashboard.emailjs.com/admin";if(!t||typeof t!="string")throw"The template ID is required. Visit https://dashboard.emailjs.com/admin/templates"},J=e=>{if(e&&e.toString()!=="[object Object]")throw"The template params have to be the object. Visit https://www.emailjs.com/docs/sdk/send/"},F=e=>e.webdriver||!e.languages||e.languages.length===0,M=()=>new S(451,"Unavailable For Headless Browser"),Q=(e,s)=>{if(!Array.isArray(e))throw"The BlockList list has to be an array";if(typeof s!="string")throw"The BlockList watchVariable has to be a string"},Y=e=>{var s;return!((s=e.list)!=null&&s.length)||!e.watchVariable},X=(e,s)=>e instanceof FormData?e.get(s):e[s],B=(e,s)=>{if(Y(e))return!1;Q(e.list,e.watchVariable);const t=X(s,e.watchVariable);return typeof t!="string"?!1:e.list.includes(t)},E=()=>new S(403,"Forbidden"),Z=(e,s)=>{if(typeof e!="number"||e<0)throw"The LimitRate throttle has to be a positive number";if(s&&typeof s!="string")throw"The LimitRate ID has to be a non-empty string"},ee=async(e,s,t)=>{const o=Number(await t.get(e)||0);return s-Date.now()+o},q=async(e,s,t)=>{if(!s.throttle||!t)return!1;Z(s.throttle,s.id);const o=s.id||e;return await ee(o,s.throttle,t)>0?!0:(await t.set(o,Date.now().toString()),!1)},H=()=>new S(429,"Too Many Requests"),te=async(e,s,t,o)=>{const i=P(o),h=i.publicKey||n.publicKey,f=i.blockHeadless||n.blockHeadless,d=i.storageProvider||n.storageProvider,j={...n.blockList,...i.blockList},m={...n.limitRate,...i.limitRate};return f&&F(navigator)?Promise.reject(M()):(C(h,e,s),J(t),t&&B(j,t)?Promise.reject(E()):await q(location.pathname,m,d)?Promise.reject(H()):_("/api/v1.0/email/send",JSON.stringify({lib_version:"4.4.1",user_id:h,service_id:e,template_id:s,template_params:t}),{"Content-type":"application/json"}))},se=e=>{if(!e||e.nodeName!=="FORM")throw"The 3rd parameter is expected to be the HTML form element or the style selector of the form"},ae=e=>typeof e=="string"?document.querySelector(e):e,re=async(e,s,t,o)=>{const i=P(o),h=i.publicKey||n.publicKey,f=i.blockHeadless||n.blockHeadless,d=n.storageProvider||i.storageProvider,j={...n.blockList,...i.blockList},m={...n.limitRate,...i.limitRate};if(f&&F(navigator))return Promise.reject(M());const c=ae(t);C(h,e,s),se(c);const p=new FormData(c);return B(j,p)?Promise.reject(E()):await q(location.pathname,m,d)?Promise.reject(H()):(p.append("lib_version","4.4.1"),p.append("service_id",e),p.append("template_id",s),p.append("user_id",h),_("/api/v1.0/email/send-form",p))},ie={init:$,send:te,sendForm:re,EmailJSResponseStatus:S},L=[{label:"Bug Report",value:"bug_report"},{label:"Feature Request",value:"feature_request"},{label:"Billing Issue",value:"billing_issue"},{label:"General Question",value:"general_question"},{label:"Technical Support",value:"technical_support"}];function de({shop:e}){const{api:s}=K(),[t,o]=y.useState({name:"",email:"",subject:"general_question",message:"",file:null}),[i,h]=y.useState(!1),[f,d]=y.useState(null),[j,m]=y.useState(""),[c,p]=y.useState(null),w=e||((r,u="")=>{try{return new URLSearchParams(window.location.search).get(r)||u}catch{return u}})("shop","");y.useEffect(()=>{O()},[w]);const O=async()=>{try{const r=await s(`/api/shop/info?shop=${encodeURIComponent(w)}`);p(r),o(u=>({...u,name:(r==null?void 0:r.name)||"",email:(r==null?void 0:r.email)||""}))}catch(r){console.error("[ContactSupport] Error loading shop info:",r)}},x=(r,u)=>{o(l=>({...l,[r]:u}))},N=r=>{if(r.length>0){const u=r[0];if(!u.type.startsWith("image/")){d("error"),m("Only image files are allowed (JPG, PNG, GIF, etc.)");return}if(u.size>5*1024*1024){d("error"),m("File size must be less than 5MB");return}o(l=>({...l,file:u}))}},G=()=>t.name.trim()?t.email.trim()?t.message.trim()?!0:(d("error"),m("Please enter your message"),!1):(d("error"),m("Please enter your email"),!1):(d("error"),m("Please enter your name"),!1),V=async r=>{var u;if(r.preventDefault(),!!G()){h(!0),d(null),m("");try{let l={name:t.name,email:t.email,subject:((u=L.find(I=>I.value===t.subject))==null?void 0:u.label)||t.subject,message:t.message,shop_name:(c==null?void 0:c.name)||w,shop_url:`https://${w}`,time:new Date().toLocaleString()};t.file&&(l.message+=`

ðŸ“Ž ATTACHED IMAGE:
Name: ${t.file.name}
Size: ${(t.file.size/1024).toFixed(1)} KB
Type: ${t.file.type}`),console.log("[ContactSupport] Sending email with params:",l);const D=await ie.send("service_c8j657n","template_zrftkfg",l,"-0N7g1SCh9fSknb6q");console.log("[ContactSupport] Email sent successfully:",D),d("success"),m("Message sent successfully! We'll get back to you within 24 hours."),o({name:(c==null?void 0:c.name)||"",email:(c==null?void 0:c.email)||"",subject:"general_question",message:"",file:null})}catch(l){console.error("[ContactSupport] Error sending email:",l),console.error("[ContactSupport] Error details:",{message:l.message,status:l.status,text:l.text,stack:l.stack}),d("error"),m(`Failed to send message: ${l.message||"Unknown error"}`)}finally{h(!1)}}};return a.jsx(g,{padding:"400",children:a.jsxs(v,{gap:"400",children:[a.jsx(b,{variant:"bodyMd",tone:"subdued",children:"Need help? Send us a message and we'll get back to you within 24 hours."}),f&&a.jsx(z,{tone:f==="success"?"success":"critical",children:j}),a.jsx(T,{children:a.jsx(g,{padding:"400",children:a.jsx("form",{onSubmit:V,children:a.jsxs(v,{gap:"400",children:[a.jsxs(R,{gap:"400",wrap:!0,children:[a.jsx(g,{flexGrow:1,children:a.jsx(k,{label:"Name",value:t.name,onChange:r=>x("name",r),placeholder:"Your name",required:!0,disabled:i})}),a.jsx(g,{flexGrow:1,children:a.jsx(k,{label:"Email",type:"email",value:t.email,onChange:r=>x("email",r),placeholder:"your@email.com",required:!0,disabled:i})})]}),a.jsx(A,{label:"Subject",options:L,value:t.subject,onChange:r=>x("subject",r),disabled:i}),a.jsx(k,{label:"Message",value:t.message,onChange:r=>x("message",r),multiline:4,placeholder:"Describe your issue or question...",required:!0,disabled:i}),a.jsxs(g,{children:[a.jsx(b,{as:"label",variant:"bodyMd",fontWeight:"medium",children:"Attach Image (Optional)"}),a.jsx(g,{paddingBlockStart:"100",children:a.jsx("input",{type:"file",accept:"image/*",onChange:r=>N(r.target.files),disabled:i,style:{padding:"8px",border:"1px solid #d1d5db",borderRadius:"4px",fontSize:"14px",width:"100%"}})}),a.jsx(b,{variant:"bodySm",tone:"subdued",children:"Only image files allowed (JPG, PNG, GIF, etc.) â€¢ Maximum file size: 5MB"})]}),a.jsx(R,{gap:"200",align:"end",children:a.jsx(U,{variant:"primary",submit:!0,loading:i,disabled:i,children:i?"Sending...":"Send Message"})})]})})})}),a.jsx(T,{children:a.jsx(g,{padding:"400",children:a.jsxs(v,{gap:"200",children:[a.jsx(b,{as:"h3",variant:"headingMd",children:"Other Ways to Reach Us"}),a.jsx(b,{variant:"bodyMd",tone:"subdued",children:"â€¢ Email: indexaize@gmail.com"}),a.jsx(b,{variant:"bodyMd",tone:"subdued",children:"â€¢ Response time: Within 24 hours"}),a.jsxs(b,{variant:"bodyMd",tone:"subdued",children:["â€¢ Include your shop name: ",w]})]})})})]})})}export{de as default};
