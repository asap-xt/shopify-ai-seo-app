import{r as h,j as e,R as et}from"./react-vendor-6uwpMgJP.js";import{m as tt}from"./sessionFetch-D9_xSJR0.js";import{I as st}from"./InsufficientTokensModal-CWgAibhb.js";import{T as nt}from"./TrialActivationModal-D5G7vt1Y.js";import{g as De}from"./usePlanHierarchy-BjUEvxZF.js";import{a as l,d as S,T as s,C as Y,B as b,D as $,I as d,e as J,L as ce,b as g,f as r,h as it,k as at,M as F}from"./polaris-B96_d87K.js";import"./app-bridge-ugs9K9zh.js";import"./vendor-BC2YhXnC.js";import"./index-g_zq82l6.js";const ot=(_,u="")=>{try{return new URLSearchParams(window.location.search).get(_)||u}catch{return u}};function ft({shop:_}){const u=_||ot("shop",""),Ee=i=>{const t=new URLSearchParams(window.location.search),a=t.toString()?`?${t.toString()}`:"";window.location.href=`${i}${a}`},[le,f]=h.useState(""),T=h.useMemo(()=>tt(),[]),[z,de]=h.useState(null),[he,E]=h.useState(""),[Oe,ue]=h.useState(!1),[P,qe]=h.useState(null),[H,Je]=h.useState(""),[Fe,U]=h.useState(!1),[Ue,ee]=h.useState(!1),[Le,te]=h.useState(!1),[p,I]=h.useState(null),[Re,ge]=h.useState(!1),[M,rt]=h.useState(null),[y,se]=h.useState({}),[O,pe]=h.useState(!1),[We,me]=h.useState(0),[n,xe]=h.useState({}),[L,je]=h.useState(!1),[Be,be]=h.useState(0),[ne,ie]=h.useState(null),[ct,fe]=h.useState(null),[lt,ae]=h.useState(null),[Se,Ge]=h.useState({totalProducts:0,optimizedProducts:0,totalCollections:0,optimizedCollections:0}),[ye,ve]=h.useState(null);h.useEffect(()=>{u&&(Ve(),R(),Ye(),Ne())},[u,T]);const Ne=()=>{try{const i=localStorage.getItem(`ai-test-results-${u}`);if(i){const t=JSON.parse(i);t.results&&t.timestamp&&(se(t.results),ve(new Date(t.timestamp)))}}catch(i){console.error("[AI-TESTING] Error loading saved test results:",i)}},Qe=i=>{try{const t={results:i,timestamp:new Date().toISOString()};localStorage.setItem(`ai-test-results-${u}`,JSON.stringify(t)),ve(new Date)}catch(t){console.error("[AI-TESTING] Error saving test results:",t)}};h.useEffect(()=>{const i=()=>{!document.hidden&&u&&R()};return document.addEventListener("visibilitychange",i),()=>{document.removeEventListener("visibilitychange",i)}},[u,T]);const Ve=async()=>{var i,t,a;try{const c=await T(`/api/billing/info?shop=${u}`),o=((i=c==null?void 0:c.subscription)==null?void 0:i.plan)||"Starter";de(o),ie(((t=c==null?void 0:c.tokens)==null?void 0:t.balance)||0),fe(((a=c==null?void 0:c.subscription)==null?void 0:a.trialEndsAt)||null)}catch(c){console.error("[AI-TESTING] Error loading billing info:",c),de("Starter"),ie(0)}},R=async()=>{var i,t;try{const a=await T(`/api/billing/info?shop=${u}`);ie(((i=a==null?void 0:a.tokens)==null?void 0:i.balance)||0),fe(((t=a==null?void 0:a.subscription)==null?void 0:t.trialEndsAt)||null)}catch(a){console.error("[AI-TESTING] Error loading token balance:",a)}},Ye=async()=>{var i,t,a,c;try{const o=await T(`/api/dashboard/stats?shop=${u}`);Ge({totalProducts:((i=o==null?void 0:o.products)==null?void 0:i.total)||0,optimizedProducts:((t=o==null?void 0:o.products)==null?void 0:t.optimized)||0,totalCollections:((a=o==null?void 0:o.collections)==null?void 0:a.total)||0,optimizedCollections:((c=o==null?void 0:o.collections)==null?void 0:c.optimized)||0})}catch(o){console.error("[AI-TESTING] Error loading stats:",o)}},we={productsJson:"Products JSON Feed",basicSitemap:"Basic Sitemap",robotsTxt:"robots.txt.liquid",schemaData:"Schema Data (theme.liquid)",welcomePage:"AI Welcome Page",collectionsJson:"Collections JSON Feed",storeMetadata:"Store Metadata",aiSitemap:"AI-Enhanced Sitemap",advancedSchemaApi:"Advanced Schema Data"},Ae=i=>{const t=Math.max(0,Math.min(100,i))/100,a=239,c=68,o=68,v=16,w=185,B=129,oe=Math.round(a+(v-a)*t),X=Math.round(c+(w-c)*t),G=Math.round(o+(B-o)*t);return`rgb(${oe}, ${X}, ${G})`},He=i=>{const t=i*3.6,a=Math.max(0,Math.min(100,i))/100;let c=[];if(a<=.2)c=["#ef4444 0deg",`#ef4444 ${t}deg`,`#e5e7eb ${t}deg`,"#e5e7eb 360deg"];else if(a<=.4)c=["#ef4444 0deg",`#f97316 ${t*.5}deg`,`#f97316 ${t}deg`,`#e5e7eb ${t}deg`,"#e5e7eb 360deg"];else if(a<=.6){const o=t*.33,v=t*.66;c=["#ef4444 0deg",`#f97316 ${o}deg`,`#f59e0b ${v}deg`,`#f59e0b ${t}deg`,`#e5e7eb ${t}deg`,"#e5e7eb 360deg"]}else if(a<=.8){const o=t*.25,v=t*.5,w=t*.75;c=["#ef4444 0deg",`#f97316 ${o}deg`,`#f59e0b ${v}deg`,`#22c55e ${w}deg`,`#22c55e ${t}deg`,`#e5e7eb ${t}deg`,"#e5e7eb 360deg"]}else{const o=t*.2,v=t*.4,w=t*.6;c=["#ef4444 0deg",`#f97316 ${o}deg`,`#f59e0b ${v}deg`,`#10b981 ${w}deg`,`#10b981 ${t}deg`,`#e5e7eb ${t}deg`,"#e5e7eb 360deg"]}return`conic-gradient(${c.join(", ")})`},x=h.useMemo(()=>((t,a,c)=>{var Te,Pe,Ie,Me,Ce,$e,ze;const o={endpointAvailability:0,aiValidationQuality:0,optimizationCoverage:0,structuredDataQuality:0,total:0},v={productsJson:5,basicSitemap:4,robotsTxt:2,schemaData:2,welcomePage:3,collectionsJson:4,storeMetadata:4,aiSitemap:3,advancedSchemaApi:3};let w=0,B=0;for(const[m,j]of Object.entries(t||{})){const k=v[m]||1;B+=k,j.status==="success"?w+=k:j.status==="warning"?w+=k*.7:j.status==="locked"&&(w+=k*.3)}o.endpointAvailability=B>0?Math.round(w/B*30):0;const oe={excellent:1,good:.75,fair:.5,poor:.25,unavailable:0,locked:.1};let X=0,G=0;for(const[m,j]of Object.entries(a||{})){if(m==="robotsTxt"||m==="schemaData")continue;const k=((Te=j.rating)==null?void 0:Te.toLowerCase())||"unavailable",C=oe[k]||0,V=v[m]||1;X+=C*V,G+=V}o.aiValidationQuality=G>0?Math.round(X/G*40):0;const re=c.totalProducts||0,Ze=c.optimizedProducts||0,ke=c.totalCollections||0,_e=c.optimizedCollections||0;let Z=0;if(re>0){const m=Ze/re;Z+=m*12}if(ke>0){const m=_e/ke;Z+=m*8}else re>0&&(Z+=8);o.optimizationCoverage=Math.round(Z);let D=0;if(((Pe=t==null?void 0:t.schemaData)==null?void 0:Pe.status)==="success"&&(D+=3),((Ie=t==null?void 0:t.storeMetadata)==null?void 0:Ie.status)==="success"){D+=3;const m=(Ce=(Me=a==null?void 0:a.storeMetadata)==null?void 0:Me.rating)==null?void 0:Ce.toLowerCase();m==="excellent"?D+=4:m==="good"&&(D+=2)}else(($e=t==null?void 0:t.storeMetadata)==null?void 0:$e.status)==="locked"&&(D+=1);((ze=t==null?void 0:t.advancedSchemaApi)==null?void 0:ze.status)==="success"&&(D+=2),o.structuredDataQuality=Math.min(10,Math.round(D)),o.total=Math.min(100,o.endpointAvailability+o.aiValidationQuality+o.optimizationCoverage+o.structuredDataQuality);let N="E",Q="#ef4444";o.total>=80?(N="A",Q="#10b981"):o.total>=60?(N="B",Q="#3b82f6"):o.total>=40?(N="C",Q="#f59e0b"):o.total>=20&&(N="D",Q="#f97316");const A=[];if(o.endpointAvailability<20){const m=Object.entries(t||{}).filter(([k,C])=>C.status==="locked").length,j=Object.entries(t||{}).filter(([k,C])=>C.status==="error"||C.status==="failed").length;m>0&&j===0?A.push("Several AI discovery endpoints are locked due to plan limitations. Upgrade your plan to unlock them."):m>0&&j>0?A.push("Some endpoints are missing or not working. Others are locked due to plan limitations. Fix endpoint issues and upgrade your plan to improve your score."):A.push("Several AI discovery endpoints are missing or not working. Fix endpoint issues to improve your score.")}if(o.aiValidationQuality<30){const m=Object.entries(a||{}).filter(([j,k])=>{var V;const C=(V=k.rating)==null?void 0:V.toLowerCase();return(C==="poor"||C==="fair")&&j!=="robotsTxt"&&j!=="schemaData"}).map(([j])=>we[j]||j);m.length>0&&(A.push(`${m.length} endpoint(s) have low data quality ratings. Improve content quality to boost your score.`),A.push(`Review and improve: ${m.join(", ")}`))}return o.optimizationCoverage<15&&(A.push("Low optimization coverage. Optimize more products and collections to improve your score."),A.push("Go to Search Optimization for AI and optimize your products/collections")),o.structuredDataQuality<7&&A.push("Structured data could be improved. Add organization schema and enhance product schema."),{score:o.total,grade:N,gradeColor:Q,breakdown:o,recommendations:A.length>0?A:["Your store is well-optimized for AI search engines!"]}})(y,n,Se),[y,n,Se,we]),q=i=>{if(!z)return!1;const t=De(z);switch(i){case"productsJson":return t>=0;case"storeMetadata":return t>=1;case"welcomePage":case"collectionsJson":return t>=2;case"aiSitemap":return t>=3;case"schemaData":return t>=4;case"meta":return t>=0;case"claude":return t>=0;case"gemini":return t>=1;case"chatgpt":return t>=2;case"perplexity":return t>=3;case"deepseek":return t>=4;default:return!1}},K=(i,t)=>{qe({name:i,url:t}),ue(!0)},Ke=async()=>{pe(!0),me(0),se({});try{const i=await T("/api/ai-testing/run-tests",{method:"POST",body:{shop:u}});i.results?(se(i.results),me(100),Qe(i.results),f("Basic tests completed!")):f("Testing failed. Please try again.")}catch(i){console.error("[AI-TESTING] Error running tests:",i),f("Failed to run tests. Please try again.")}finally{pe(!1)}},Xe=async()=>{if(De(z)<1){I({message:"AI-powered validation requires Professional plan or higher",requiredPlan:"Professional",currentPlan:z||"Starter"}),U(!0);return}je(!0),be(0),xe({});try{const t=await T("/api/ai-testing/ai-validate",{method:"POST",body:{shop:u,endpointResults:y}});if(t&&t.results){if(xe(t.results),be(100),t.aiEOScore){const a=t.aiEOScore;ae(a),f(`AI validation completed! Score: ${a.score||"N/A"}/100 (${t.tokensUsed||0} tokens used)`)}else ae(null),f(`AI validation completed! (${t.tokensUsed||0} tokens used)`);R()}else ae(null),f("AI validation failed. Please try again.")}catch(t){if(t.status===402){if(t.trialRestriction&&t.requiresActivation){I(t),te(!0);return}if(t.requiresUpgrade){I(t),U(!0);return}if(t.requiresPurchase){I(t),ee(!0);return}}f("Failed to run AI validation. Please try again.")}finally{je(!1)}},W=async(i,t=null)=>{try{E("Generating AI response...");let a=`/api/ai-discovery/simulate?shop=${u}&type=${i}`;t&&(a+=`&question=${encodeURIComponent(t)}`);const c=await T(a,{method:"GET"});E(c.response||"No response generated")}catch(a){if(console.error("[AI-TESTING] Simulation error:",a),a.status===402){if(a.trialRestriction&&a.requiresActivation){I(a),te(!0),E("");return}if(a.requiresUpgrade){I(a),U(!0),E("");return}if(a.requiresPurchase){I(a),ee(!0),E("");return}}E("Error generating response. Please try again."),f("Failed to simulate AI response")}};return e.jsxs(e.Fragment,{children:[e.jsxs(l,{gap:"400",children:[e.jsx(S,{tone:"info",children:e.jsx(s,{children:"Test how AI models discover and understand your store content. Check if your structured data and AI Discovery features are working correctly."})}),e.jsx(Y,{children:e.jsx(b,{padding:"400",children:e.jsxs(l,{gap:"300",children:[e.jsxs(l,{gap:"100",children:[e.jsx(s,{as:"h3",variant:"headingMd",children:"AIEO Score"}),e.jsx(s,{variant:"bodySm",tone:"subdued",children:"Overall AI Engine Optimization rating"})]}),e.jsx($,{}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"24px"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"24px"},children:[e.jsx(b,{style:{width:"138px",height:"138px",borderRadius:"50%",background:He(x.score),display:"flex",alignItems:"center",justifyContent:"center",position:"relative",flexShrink:0},children:e.jsx(b,{style:{width:"103.5px",height:"103.5px",borderRadius:"50%",background:"white",position:"absolute",zIndex:1}})}),e.jsxs(l,{gap:"100",children:[e.jsxs(s,{variant:"headingMd",fontWeight:"semibold",style:{color:Ae(x.score)},children:["AIEO Score = ",x.score]}),e.jsxs(s,{variant:"headingMd",fontWeight:"bold",style:{color:Ae(x.score)},children:["AIEO Rating = ",x.grade]})]})]}),e.jsxs(l,{gap:"200",children:[e.jsx(s,{variant:"headingSm",children:"Score Breakdown"}),e.jsxs(l,{gap:"100",children:[e.jsxs(d,{align:"space-between",children:[e.jsx(s,{variant:"bodyMd",children:"Endpoint Availability"}),e.jsxs(s,{variant:"bodyMd",fontWeight:"semibold",children:[x.breakdown.endpointAvailability,"/30"]})]}),e.jsx(J,{progress:Math.round(x.breakdown.endpointAvailability/30*100),size:"small",tone:"success"})]}),e.jsxs(l,{gap:"100",children:[e.jsxs(d,{align:"space-between",children:[e.jsx(s,{variant:"bodyMd",children:"AI Validation Quality"}),e.jsxs(s,{variant:"bodyMd",fontWeight:"semibold",children:[x.breakdown.aiValidationQuality,"/40"]})]}),e.jsx(J,{progress:Math.round(x.breakdown.aiValidationQuality/40*100),size:"small",tone:"success"})]}),e.jsxs(l,{gap:"100",children:[e.jsxs(d,{align:"space-between",children:[e.jsx(s,{variant:"bodyMd",children:"Optimization Coverage"}),e.jsxs(s,{variant:"bodyMd",fontWeight:"semibold",children:[x.breakdown.optimizationCoverage,"/20"]})]}),e.jsx(J,{progress:Math.round(x.breakdown.optimizationCoverage/20*100),size:"small",tone:"success"})]}),e.jsxs(l,{gap:"100",children:[e.jsxs(d,{align:"space-between",children:[e.jsx(s,{variant:"bodyMd",children:"Structured Data Quality"}),e.jsxs(s,{variant:"bodyMd",fontWeight:"semibold",children:[x.breakdown.structuredDataQuality,"/10"]})]}),e.jsx(J,{progress:Math.round(x.breakdown.structuredDataQuality/10*100),size:"small",tone:"success"})]})]})]}),x.recommendations&&x.recommendations.length>0&&e.jsxs(e.Fragment,{children:[e.jsx($,{}),e.jsxs(l,{gap:"200",children:[e.jsx(s,{variant:"headingSm",children:"Recommendations"}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"12px"},children:x.recommendations.map((i,t)=>e.jsx(S,{tone:i.includes("Fix")||i.includes("Improve")||i.includes("low")?"critical":i.includes("Review")?"warning":"info",children:e.jsx(s,{variant:"bodyMd",children:i})},t))})]})]})]})})}),e.jsxs(ce,{children:[e.jsx(ce.Section,{variant:"oneHalf",children:e.jsx(Y,{children:e.jsx(b,{padding:"300",children:e.jsxs(l,{gap:"400",children:[e.jsxs(d,{align:"space-between",blockAlign:"center",children:[e.jsxs(l,{gap:"100",children:[e.jsx(s,{as:"h3",variant:"headingMd",children:"ðŸ”§ Basic AIEO Tests"}),e.jsx(s,{variant:"bodySm",tone:"subdued",children:"Quick check if endpoints are accessible and returning data"})]}),e.jsx(g,{onClick:Ke,loading:O,disabled:O,children:O?"Testing...":"Run Basic Tests"})]}),ye&&Object.keys(y).length>0&&!O&&e.jsx(S,{tone:"info",children:e.jsxs(s,{variant:"bodySm",children:["These results are from ",ye.toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),". Run Basic Tests again to refresh."]})}),O&&e.jsx(b,{children:e.jsxs(l,{gap:"200",children:[e.jsx(s,{variant:"bodySm",children:"Testing endpoints..."}),e.jsx(J,{progress:We,size:"small"})]})}),Object.keys(y).length>0&&e.jsx(l,{gap:"300",children:Object.entries(y).map(([i,t],a)=>{const c=a===Object.entries(y).length-1;return e.jsxs(et.Fragment,{children:[e.jsx(d,{align:"space-between",blockAlign:"center",children:e.jsxs(l,{gap:"100",children:[e.jsxs(d,{gap:"200",blockAlign:"center",children:[e.jsx(s,{variant:"bodyMd",fontWeight:"semibold",children:t.name}),t.status==="success"&&e.jsx(r,{tone:"success",children:"âœ“ OK"}),t.status==="warning"&&e.jsx(r,{tone:"warning",children:"âš ï¸ Warning"}),t.status==="error"&&e.jsx(r,{tone:"critical",children:"âœ— Failed"}),t.status==="locked"&&e.jsx(r,{children:"ðŸ”’ Locked"})]}),e.jsx(s,{variant:"bodySm",tone:"subdued",children:t.message}),t.actionLink&&e.jsx(g,{size:"slim",onClick:()=>Ee(t.actionLink),children:i==="basicSitemap"?"Go to Sitemap":i==="aiSitemap"?"Go to Settings":"Go"})]})}),!c&&e.jsx($,{})]},i)})}),Object.keys(y).length===0&&!O&&e.jsx(S,{tone:"info",children:e.jsx(s,{children:'Click "Run Basic Tests" to check if your AI Discovery endpoints are configured correctly.'})})]})})})}),e.jsx(ce.Section,{variant:"oneHalf",children:e.jsx(Y,{children:e.jsx(b,{padding:"300",children:e.jsxs(l,{gap:"400",children:[e.jsxs(d,{align:"space-between",blockAlign:"center",children:[e.jsxs(l,{gap:"100",children:[e.jsxs(d,{gap:"200",blockAlign:"center",children:[e.jsx(s,{as:"h3",variant:"headingMd",children:"ðŸ¤– AI-Powered Validation"}),ne!==null&&e.jsxs(r,{tone:ne>50?"success":"warning",children:[ne," tokens"]}),e.jsx(g,{size:"micro",onClick:()=>R(),accessibilityLabel:"Refresh token balance",children:"ðŸ”„"})]}),e.jsx(s,{variant:"bodySm",tone:"subdued",children:"Deep analysis with AI bot"}),z&&e.jsx(s,{variant:"bodySm",tone:"subdued",children:"Requires: Professional+ plan & pay-per-use tokens"})]}),e.jsx(g,{onClick:Xe,loading:L,disabled:L||Object.keys(y).length===0,variant:"primary",children:L?"Validating...":"Test with AI Bot"})]}),L&&e.jsx(b,{children:e.jsxs(l,{gap:"200",children:[e.jsx(s,{variant:"bodySm",children:"AI is analyzing your endpoints..."}),e.jsx(J,{progress:Be,size:"small",tone:"primary"})]})}),Object.keys(n).length>0&&e.jsxs(l,{gap:"300",children:[n.productsJson&&e.jsxs(e.Fragment,{children:[e.jsx(d,{align:"space-between",blockAlign:"center",children:e.jsxs(l,{gap:"100",children:[e.jsxs(d,{gap:"200",blockAlign:"center",children:[e.jsx(s,{variant:"bodyMd",fontWeight:"semibold",children:"Products JSON Feed"}),n.productsJson.rating==="excellent"&&e.jsx(r,{tone:"success",children:"ðŸ¤– Excellent"}),n.productsJson.rating==="good"&&e.jsx(r,{tone:"success",children:"ðŸ¤– Good"}),n.productsJson.rating==="fair"&&e.jsx(r,{tone:"warning",children:"ðŸ¤– Fair"}),n.productsJson.rating==="poor"&&e.jsx(r,{tone:"critical",children:"ðŸ¤– Poor"}),n.productsJson.rating==="locked"&&e.jsx(r,{children:"ðŸ”’ Locked"}),n.productsJson.rating==="unavailable"&&e.jsx(r,{tone:"critical",children:"âŒ Unavailable"})]}),e.jsx(s,{variant:"bodySm",children:n.productsJson.feedback}),n.productsJson.suggestions&&e.jsxs(s,{variant:"bodySm",tone:"subdued",children:["ðŸ’¡ ",n.productsJson.suggestions]})]})}),e.jsx($,{})]}),n.storeMetadata&&e.jsxs(e.Fragment,{children:[e.jsx(d,{align:"space-between",blockAlign:"center",children:e.jsxs(l,{gap:"100",children:[e.jsxs(d,{gap:"200",blockAlign:"center",children:[e.jsx(s,{variant:"bodyMd",fontWeight:"semibold",children:"Store Metadata"}),n.storeMetadata.rating==="excellent"&&e.jsx(r,{tone:"success",children:"ðŸ¤– Excellent"}),n.storeMetadata.rating==="good"&&e.jsx(r,{tone:"success",children:"ðŸ¤– Good"}),n.storeMetadata.rating==="fair"&&e.jsx(r,{tone:"warning",children:"ðŸ¤– Fair"}),n.storeMetadata.rating==="poor"&&e.jsx(r,{tone:"critical",children:"ðŸ¤– Poor"}),n.storeMetadata.rating==="locked"&&e.jsx(r,{children:"ðŸ”’ Locked"}),n.storeMetadata.rating==="unavailable"&&e.jsx(r,{tone:"critical",children:"âŒ Unavailable"})]}),e.jsx(s,{variant:"bodySm",children:n.storeMetadata.feedback}),n.storeMetadata.suggestions&&e.jsxs(s,{variant:"bodySm",tone:"subdued",children:["ðŸ’¡ ",n.storeMetadata.suggestions]})]})}),e.jsx($,{})]}),n.welcomePage&&e.jsxs(e.Fragment,{children:[e.jsx(d,{align:"space-between",blockAlign:"center",children:e.jsxs(l,{gap:"100",children:[e.jsxs(d,{gap:"200",blockAlign:"center",children:[e.jsx(s,{variant:"bodyMd",fontWeight:"semibold",children:"AI Welcome Page"}),n.welcomePage.rating==="excellent"&&e.jsx(r,{tone:"success",children:"ðŸ¤– Excellent"}),n.welcomePage.rating==="good"&&e.jsx(r,{tone:"success",children:"ðŸ¤– Good"}),n.welcomePage.rating==="fair"&&e.jsx(r,{tone:"warning",children:"ðŸ¤– Fair"}),n.welcomePage.rating==="poor"&&e.jsx(r,{tone:"critical",children:"ðŸ¤– Poor"}),n.welcomePage.rating==="locked"&&e.jsx(r,{children:"ðŸ”’ Locked"}),n.welcomePage.rating==="unavailable"&&e.jsx(r,{tone:"critical",children:"âŒ Unavailable"})]}),e.jsx(s,{variant:"bodySm",children:n.welcomePage.feedback}),n.welcomePage.suggestions&&e.jsxs(s,{variant:"bodySm",tone:"subdued",children:["ðŸ’¡ ",n.welcomePage.suggestions]})]})}),e.jsx($,{})]}),n.collectionsJson&&e.jsxs(e.Fragment,{children:[e.jsx(d,{align:"space-between",blockAlign:"center",children:e.jsxs(l,{gap:"100",children:[e.jsxs(d,{gap:"200",blockAlign:"center",children:[e.jsx(s,{variant:"bodyMd",fontWeight:"semibold",children:"Collections JSON Feed"}),n.collectionsJson.rating==="excellent"&&e.jsx(r,{tone:"success",children:"ðŸ¤– Excellent"}),n.collectionsJson.rating==="good"&&e.jsx(r,{tone:"success",children:"ðŸ¤– Good"}),n.collectionsJson.rating==="fair"&&e.jsx(r,{tone:"warning",children:"ðŸ¤– Fair"}),n.collectionsJson.rating==="poor"&&e.jsx(r,{tone:"critical",children:"ðŸ¤– Poor"}),n.collectionsJson.rating==="locked"&&e.jsx(r,{children:"ðŸ”’ Locked"}),n.collectionsJson.rating==="unavailable"&&e.jsx(r,{tone:"critical",children:"âŒ Unavailable"})]}),e.jsx(s,{variant:"bodySm",children:n.collectionsJson.feedback}),n.collectionsJson.suggestions&&e.jsxs(s,{variant:"bodySm",tone:"subdued",children:["ðŸ’¡ ",n.collectionsJson.suggestions]})]})}),e.jsx($,{})]}),n.aiSitemap&&e.jsxs(e.Fragment,{children:[e.jsx(d,{align:"space-between",blockAlign:"center",children:e.jsxs(l,{gap:"100",children:[e.jsxs(d,{gap:"200",blockAlign:"center",children:[e.jsx(s,{variant:"bodyMd",fontWeight:"semibold",children:"AI-Enhanced Sitemap"}),n.aiSitemap.rating==="excellent"&&e.jsx(r,{tone:"success",children:"ðŸ¤– Excellent"}),n.aiSitemap.rating==="good"&&e.jsx(r,{tone:"success",children:"ðŸ¤– Good"}),n.aiSitemap.rating==="fair"&&e.jsx(r,{tone:"warning",children:"ðŸ¤– Fair"}),n.aiSitemap.rating==="poor"&&e.jsx(r,{tone:"critical",children:"ðŸ¤– Poor"}),n.aiSitemap.rating==="locked"&&e.jsx(r,{children:"ðŸ”’ Locked"}),n.aiSitemap.rating==="unavailable"&&e.jsx(r,{tone:"critical",children:"âŒ Unavailable"})]}),e.jsx(s,{variant:"bodySm",children:n.aiSitemap.feedback}),n.aiSitemap.suggestions&&e.jsxs(s,{variant:"bodySm",tone:"subdued",children:["ðŸ’¡ ",n.aiSitemap.suggestions]})]})}),e.jsx($,{})]}),n.schemaData&&e.jsx(d,{align:"space-between",blockAlign:"center",children:e.jsxs(l,{gap:"100",children:[e.jsxs(d,{gap:"200",blockAlign:"center",children:[e.jsx(s,{variant:"bodyMd",fontWeight:"semibold",children:"Advanced Schema Data"}),n.schemaData.rating==="excellent"&&e.jsx(r,{tone:"success",children:"ðŸ¤– Excellent"}),n.schemaData.rating==="good"&&e.jsx(r,{tone:"success",children:"ðŸ¤– Good"}),n.schemaData.rating==="fair"&&e.jsx(r,{tone:"warning",children:"ðŸ¤– Fair"}),n.schemaData.rating==="poor"&&e.jsx(r,{tone:"critical",children:"ðŸ¤– Poor"}),n.schemaData.rating==="locked"&&e.jsx(r,{children:"ðŸ”’ Locked"}),n.schemaData.rating==="unavailable"&&e.jsx(r,{tone:"critical",children:"âŒ Unavailable"})]}),e.jsx(s,{variant:"bodySm",children:n.schemaData.feedback}),n.schemaData.suggestions&&e.jsxs(s,{variant:"bodySm",tone:"subdued",children:["ðŸ’¡ ",n.schemaData.suggestions]})]})})]}),Object.keys(n).length===0&&!L&&e.jsx(S,{tone:"info",children:e.jsx(s,{children:Object.keys(y).length===0?"Run Basic Tests first, then use AI validation for deep analysis":'Click "Test with AI Bot" to get AI-powered feedback on your endpoint data quality'})}),!z&&e.jsx(S,{tone:"warning",children:e.jsx(s,{children:"Loading plan information..."})})]})})})})]}),e.jsx(Y,{children:e.jsx(b,{padding:"300",children:e.jsxs(l,{gap:"400",children:[e.jsx(s,{as:"h3",variant:"headingMd",children:"Test with Real AI Bots"}),e.jsx(s,{variant:"bodyMd",tone:"subdued",children:"Manually test your store with real AI search engines"}),e.jsxs(l,{gap:"200",children:[e.jsxs(d,{align:"space-between",children:[e.jsx(s,{children:"Meta AI Search"}),q("meta")?e.jsx(g,{onClick:()=>K("Meta AI","https://www.meta.ai/"),size:"slim",children:"Test"}):e.jsx(g,{disabled:!0,size:"slim",children:"Plan upgrade required"})]}),e.jsxs(d,{align:"space-between",children:[e.jsx(s,{children:"Claude AI Search"}),q("claude")?e.jsx(g,{onClick:()=>K("Claude AI","https://claude.ai/"),size:"slim",children:"Test"}):e.jsx(g,{disabled:!0,size:"slim",children:"Plan upgrade required"})]}),e.jsxs(d,{align:"space-between",children:[e.jsx(s,{children:"Gemini AI Search"}),q("gemini")?e.jsx(g,{onClick:()=>K("Gemini AI","https://gemini.google.com/"),size:"slim",children:"Test"}):e.jsx(g,{disabled:!0,size:"slim",children:"Plan upgrade required"})]}),e.jsxs(d,{align:"space-between",children:[e.jsx(s,{children:"ChatGPT Web Search"}),q("chatgpt")?e.jsx(g,{url:`https://chat.openai.com/?q=What+products+does+${u}+sell%3F+Tell+me+about+this+business+and+what+they+offer`,external:!0,size:"slim",children:"Test"}):e.jsx(g,{disabled:!0,size:"slim",children:"Plan upgrade required"})]}),e.jsxs(d,{align:"space-between",children:[e.jsx(s,{children:"Perplexity AI Search"}),q("perplexity")?e.jsx(g,{url:`https://www.perplexity.ai/search?q=What+products+does+${u}+sell%3F+Tell+me+about+this+business+and+what+they+offer`,external:!0,size:"slim",children:"Test"}):e.jsx(g,{disabled:!0,size:"slim",children:"Plan upgrade required"})]}),e.jsxs(d,{align:"space-between",children:[e.jsx(s,{children:"DeepSeek AI Search"}),q("deepseek")?e.jsx(g,{onClick:()=>K("DeepSeek AI","https://chat.deepseek.com/"),size:"slim",children:"Test"}):e.jsx(g,{disabled:!0,size:"slim",children:"Plan upgrade required"})]})]}),e.jsx(S,{tone:"info",children:e.jsxs(s,{children:[e.jsx("strong",{children:"How to test with AI bots:"}),e.jsx("br",{}),"â€¢ ",e.jsx("strong",{children:"Perplexity & ChatGPT:"}),' Click "Test" - they support URL parameters',e.jsx("br",{}),"â€¢ ",e.jsx("strong",{children:"Meta AI, Claude, Gemini, DeepSeek:"}),' Click "Test" to open a modal with the prompt to copy']})})]})})}),e.jsx(Y,{children:e.jsx(b,{padding:"300",children:e.jsxs(l,{gap:"300",children:[e.jsx(s,{as:"h4",variant:"headingSm",children:"AI Search Simulation"}),e.jsx(s,{variant:"bodyMd",tone:"subdued",children:"Test how AI bots would respond to questions about your store based on your structured data."}),e.jsx(S,{tone:"info",children:e.jsxs(l,{gap:"100",children:[e.jsx(s,{variant:"bodySm",fontWeight:"semibold",children:"Simulation Details:"}),e.jsxs(s,{variant:"bodySm",children:["â€¢ ",e.jsx("strong",{children:"Data Source:"})," Your store's products, collections, and metadata"]}),e.jsxs(s,{variant:"bodySm",children:["â€¢ ",e.jsx("strong",{children:"Response Style:"})," Concise (2-3 sentences), natural language"]}),e.jsxs(s,{variant:"bodySm",children:["â€¢ ",e.jsx("strong",{children:"Best For:"})," General store info, products, categories, contact details"]}),e.jsxs(s,{variant:"bodySm",children:["â€¢ ",e.jsx("strong",{children:"Limitations:"})," May not have real-time data (current stock, active promotions, exact shipping times)"]})]})}),e.jsxs(l,{gap:"200",children:[e.jsxs(d,{align:"space-between",children:[e.jsx(s,{children:"What products does this store sell?"}),e.jsx(g,{onClick:()=>W("products"),size:"slim",children:"Simulate Response"})]}),e.jsxs(d,{align:"space-between",children:[e.jsx(s,{children:"Tell me about this business"}),e.jsx(g,{onClick:()=>W("business"),size:"slim",children:"Simulate Response"})]}),e.jsxs(d,{align:"space-between",children:[e.jsx(s,{children:"What categories does this store have?"}),e.jsx(g,{onClick:()=>W("categories"),size:"slim",children:"Simulate Response"})]}),e.jsxs(d,{align:"space-between",children:[e.jsx(s,{children:"What is this store's contact information?"}),e.jsx(g,{onClick:()=>W("contact"),size:"slim",children:"Simulate Response"})]})]}),e.jsx($,{}),e.jsxs(l,{gap:"200",children:[e.jsx(s,{variant:"headingSm",children:"Ask Your Own Question"}),e.jsx(it,{label:"",value:H,onChange:Je,placeholder:"e.g., What are your return policies? Do you ship internationally?",autoComplete:"off",connectedRight:e.jsx(g,{onClick:()=>{H.trim()?W("custom",H):f("Please enter a question")},disabled:!H.trim(),children:"Ask AI"})})]}),he&&e.jsxs(b,{background:"bg-surface-secondary",padding:"300",borderRadius:"200",children:[e.jsx(s,{variant:"bodyMd",fontWeight:"semibold",children:"AI Bot Response:"}),e.jsx(b,{paddingBlockStart:"200",children:e.jsx(s,{variant:"bodyMd",children:he})})]})]})})})]}),le&&e.jsx(at,{content:le,onDismiss:()=>f("")}),e.jsx(F,{open:Oe,onClose:()=>ue(!1),title:`Test with ${P==null?void 0:P.name}`,primaryAction:{content:"Open AI Bot",url:P==null?void 0:P.url,external:!0},secondaryActions:[{content:"Copy Prompt",onAction:()=>{navigator.clipboard.writeText(`What products does ${u} sell? Tell me about this business and what they offer.`),f("Prompt copied to clipboard!")}}],children:e.jsx(F.Section,{children:e.jsxs(l,{gap:"300",children:[e.jsx(s,{variant:"bodyMd",children:'1. Click "Copy Prompt" (left button)'}),e.jsxs(s,{variant:"bodyMd",children:['2. Click "Open AI Bot" (right button) to visit ',P==null?void 0:P.name]}),e.jsx(s,{variant:"bodyMd",children:"3. Paste the prompt and send"}),e.jsxs(b,{background:"bg-surface-secondary",padding:"300",borderRadius:"200",children:[e.jsx(s,{variant:"bodyMd",fontWeight:"semibold",children:"Prompt to test:"}),e.jsx(b,{paddingBlockStart:"200",children:e.jsxs(s,{variant:"bodyMd",as:"p",children:["What products does ",u," sell? Tell me about this business and what they offer."]})})]}),e.jsx(S,{tone:"info",children:e.jsx(s,{children:"The AI bot will search the web and use your store's structured data to answer."})})]})})}),e.jsx(F,{open:Re,onClose:()=>ge(!1),title:"Upgrade Required",primaryAction:{content:"View Plans",onAction:()=>{const i=new URLSearchParams(window.location.search),t=i.toString()?`?${i.toString()}`:"";window.location.href=`/billing${t}`}},secondaryActions:[{content:"Cancel",onAction:()=>ge(!1)}],children:e.jsx(F.Section,{children:e.jsxs(l,{gap:"300",children:[e.jsxs(s,{variant:"bodyMd",children:[e.jsx("strong",{children:M==null?void 0:M.endpoint})," requires ",e.jsx("strong",{children:M==null?void 0:M.requiredPlan})," plan or higher."]}),e.jsxs(s,{variant:"bodyMd",tone:"subdued",children:["Your current plan: ",e.jsx("strong",{children:M==null?void 0:M.currentPlan})]}),e.jsx(S,{tone:"info",children:e.jsx(s,{children:"Upgrade to access this advanced AI Discovery feature."})})]})})}),e.jsx(F,{open:Fe,onClose:()=>U(!1),title:"Upgrade Required",primaryAction:{content:"View Plans",onAction:()=>{const i=new URLSearchParams(window.location.search),t=i.toString()?`?${i.toString()}`:"";window.location.href=`/billing${t}`}},secondaryActions:[{content:"Cancel",onAction:()=>U(!1)}],children:e.jsx(F.Section,{children:e.jsxs(l,{gap:"300",children:[e.jsxs(s,{variant:"bodyMd",children:["AI Testing requires ",e.jsx("strong",{children:(p==null?void 0:p.minimumPlan)||"Professional"})," plan or higher."]}),e.jsxs(s,{variant:"bodyMd",tone:"subdued",children:["Your current plan: ",e.jsx("strong",{children:(p==null?void 0:p.currentPlan)||"Starter"})]}),e.jsx(S,{tone:"info",children:e.jsx(s,{children:"Upgrade to test AI responses with real store data."})})]})})}),e.jsx(st,{open:Ue,onClose:()=>{ee(!1),I(null),R()},tokensRequired:(p==null?void 0:p.tokensRequired)||0,tokensAvailable:(p==null?void 0:p.tokensAvailable)||0,tokensNeeded:(p==null?void 0:p.tokensNeeded)||0,feature:"ai-testing-simulation",shop:u,needsUpgrade:!1,returnTo:"/ai-testing"}),p&&e.jsx(nt,{open:Le,onClose:()=>{te(!1),I(null)},feature:p.feature||"ai-testing-simulation",trialEndsAt:p.trialEndsAt,currentPlan:p.currentPlan||z,tokensRequired:p.tokensRequired||0,onActivatePlan:async()=>{try{const i=await T("/api/billing/activate",{method:"POST",body:JSON.stringify({shop:u,endTrial:!0,returnTo:"/ai-testing"})});if(i.requiresApproval&&i.confirmationUrl){window.top.location.href=i.confirmationUrl;return}window.location.reload()}catch(i){console.error("[AI-TESTING] âŒ Activation failed:",i);const t=new URLSearchParams(window.location.search),a=t.get("host"),c=t.get("embedded");window.location.href=`/billing?shop=${encodeURIComponent(u)}&embedded=${c}&host=${encodeURIComponent(a)}`}},onPurchaseTokens:()=>{const i=new URLSearchParams(window.location.search),t=i.get("host"),a=i.get("embedded");window.location.href=`/billing?shop=${encodeURIComponent(u)}&embedded=${a}&host=${encodeURIComponent(t)}&returnTo=${encodeURIComponent("/ai-testing")}`}})]})}export{ft as default};
