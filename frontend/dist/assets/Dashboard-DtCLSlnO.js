import{r as e,j as t}from"./react-vendor-BXVC7v0l.js";import{m as n}from"./sessionFetch-D6j4ykx5.js";import{g as s,P as o}from"./usePlanHierarchy-fXt-6sDq.js";import{d as r}from"./index-j2Ll2eEg.js";import{A as i}from"./AIEOScoreCard-D-1vw88j.js";import{L as a,C as d,B as l,T as c,a as u,I as h,b as p,c as g,D as x,d as m,e as b,f as y,g as j}from"./polaris-CyaoFo5Q.js";import"./app-bridge-DUY42B6P.js";import"./vendor-Cs_VgJ2r.js";function v({shop:v}){var S,f,w,M,k,A,I,C,z,P,T,D;const $=v||((e,t="")=>{try{return new URLSearchParams(window.location.search).get(e)||t}catch{return t}})("shop",""),E=e.useMemo(()=>n(),[]),O=e=>{const t=new URLSearchParams(window.location.search),n=t.toString()?`?${t.toString()}`:"";window.location.href=`${e}${n}`},[W,_]=e.useState(!0),[B,N]=e.useState(null),[L,G]=e.useState(null),[U,F]=e.useState(null),[R,V]=e.useState({}),[J,q]=e.useState({}),[H,Y]=e.useState(null),[Q,K]=e.useState(!1),[X,Z]=e.useState(!1),[ee,te]=e.useState(()=>{try{const e=localStorage.getItem(`syncCardExpanded_${$}`);return null===e||"true"===e}catch{return!0}}),ne=e.useRef(null),se=e.useRef(!1),oe=e.useRef(null),[re,ie]=e.useState(()=>{try{return!("true"===localStorage.getItem(`gettingStartedSeenOnce_${$}`))}catch{return!1}}),[ae,de]=e.useState(()=>{try{return"true"===localStorage.getItem(`dismissedUpgradeBanner_${$}`)}catch{return!1}}),[le,ce]=e.useState(()=>{try{return"true"===localStorage.getItem(`dismissedTokenBanner_${$}`)}catch{return!1}}),ue=e.useRef(null);e.useEffect(()=>(he(!0),pe(),(()=>{try{const e=localStorage.getItem(`ai-test-results-${$}`);if(e){const t=JSON.parse(e);t.results&&V(t.results)}const t=localStorage.getItem(`ai-validation-results-${$}`);if(t){const e=JSON.parse(t);e.results&&q(e.results)}const n=localStorage.getItem(`dashboard-stats-${$}`);n&&JSON.parse(n)}catch(e){}})(),()=>{ne.current&&(clearInterval(ne.current),ne.current=null),ue.current&&clearTimeout(ue.current),oe.current&&(clearTimeout(oe.current),oe.current=null)}),[$]),e.useEffect(()=>{if(!W&&(null==L?void 0:L.plan)&&re)try{"true"===localStorage.getItem(`gettingStartedSeenOnce_${$}`)||oe.current||(oe.current=setTimeout(()=>{try{localStorage.setItem(`gettingStartedSeenOnce_${$}`,"true")}catch(e){}},1e4))}catch(e){}return()=>{oe.current&&(clearTimeout(oe.current),oe.current=null)}},[W,null==L?void 0:L.plan,re,$]),e.useEffect(()=>{H&&H.autoSyncEnabled&&!Q&&!se.current&&(r("[Dashboard] Auto-sync is enabled, triggering sync..."),se.current=!0,ge())},[null==H?void 0:H.autoSyncEnabled]);const he=async(e=!1)=>(!e&&ue.current&&clearTimeout(ue.current),new Promise(t=>{ue.current=setTimeout(async()=>{var e,n,s,o;try{_(!0);const[i,a]=await Promise.all([E(`/api/dashboard/stats?shop=${$}`),E(`/api/billing/tokens/balance?shop=${$}`)]);if(i){N(i),G(i.subscription);try{const t={totalProducts:(null==(e=null==i?void 0:i.products)?void 0:e.total)||0,optimizedProducts:(null==(n=null==i?void 0:i.products)?void 0:n.optimized)||0,totalCollections:(null==(s=null==i?void 0:i.collections)?void 0:s.total)||0,optimizedCollections:(null==(o=null==i?void 0:i.collections)?void 0:o.optimized)||0,timestamp:(new Date).toISOString()};localStorage.setItem(`dashboard-stats-${$}`,JSON.stringify(t))}catch(r){}}a&&F(a),t()}catch(i){t()}finally{_(!1)}},e?0:500)})),pe=async()=>{try{const e=await E(`/api/dashboard/sync-status?shop=${$}`);e&&(Y(e),Z(e.autoSyncEnabled||!1),K(!!e.inProgress))}catch(e){}},ge=async()=>{try{K(!0);const e=await E(`/api/dashboard/sync?shop=${$}`,{method:"POST"});r("[Dashboard] Sync start response:",e),(null==e?void 0:e.success)||(null==e?void 0:e.inProgress)?(ne.current&&clearInterval(ne.current),ne.current=setInterval(async()=>{try{const e=await E(`/api/dashboard/sync-status?shop=${$}`);e&&(Y(e),e.inProgress||(ne.current&&(clearInterval(ne.current),ne.current=null),K(!1),he()))}catch(e){}},2e3)):K(!1)}catch(e){K(!1)}},xe=(null==(S=null==B?void 0:B.products)?void 0:S.total)>0?Math.round(B.products.optimized/B.products.total*100):0,me=(null==(f=null==B?void 0:B.collections)?void 0:f.total)>0?Math.round(B.collections.optimized/B.collections.total*100):0;s(null==L?void 0:L.plan);const be=e.useMemo(()=>({starter:9.99,professional:15.99,professional_plus:19.99,"professional plus":19.99,growth:29.99,growth_plus:35.99,"growth plus":35.99,growth_extra:79.99,"growth extra":79.99,enterprise:139.99}),[]),ye=(null==L?void 0:L.price)&&L.price>0?L.price:(null==L?void 0:L.plan)?be[L.plan]:void 0,je=e=>{switch(e){case"starter":case"professional":return{products:70,languages:1};case"professional_plus":case"professional plus":return{products:200,languages:2};case"growth":case"growth_plus":case"growth plus":return{products:450,languages:3};case"growth_extra":case"growth extra":return{products:750,languages:6};case"enterprise":return{products:1200,languages:10};default:return{products:0,languages:0}}},ve=e=>({starter:1,professional:2,professional_plus:2.5,"professional plus":2.5,growth:3,growth_plus:3.5,"growth plus":3.5,growth_extra:4,"growth extra":4,enterprise:5}[e]||0),Se=e.useMemo(()=>(()=>{var e,t;if(!B)return null;const n=(null==(e=B.products)?void 0:e.total)||0,s=(null==(t=B.languages)?void 0:t.length)||1,r=(null==L?void 0:L.plan)||"starter",i=ve(r),a=o;let d=null;for(const o of a){const e=je(o);if(n<=e.products&&s<=e.languages){d=o;break}}if(d||(d="enterprise"),ve(d)<=i)return null;const l=je(r),c=je(d);let u="";return n>l.products?u=`Your store has ${n} products, exceeding the ${l.products}-product limit of your current plan.`:s>l.languages&&(u=`Your store has ${s} language(s), exceeding the ${l.languages}-language limit of your current plan.`),{plan:d,planName:d.replace("_"," ").toUpperCase(),price:be[d],productLimit:c.products,languageLimit:c.languages,reason:u}})(),[B,L]),fe=e.useMemo(()=>{if(!(null==L?void 0:L.plan))return!1;const e=L.plan;if(!["professional","professional_plus","professional plus","growth","growth_plus","growth plus"].includes(e))return!1;return!(((null==U?void 0:U.balance)||0)>=1e3)},[L,U]);if(W)return t.jsx(a,{children:t.jsx(a.Section,{children:t.jsx(d,{children:t.jsx(l,{padding:"400",children:t.jsx(c,{children:"Loading dashboard..."})})})})});const we=!(null==H?void 0:H.synced);return t.jsxs(a,{children:[t.jsx(a.Section,{children:t.jsx(d,{children:t.jsxs(u,{gap:"300",children:[t.jsxs(h,{align:"space-between",blockAlign:"center",children:[t.jsx(c,{variant:"headingMd",children:"Getting Started"}),t.jsxs(p,{onClick:()=>{const e=!re;if(ie(e),re&&!e)try{localStorage.setItem(`gettingStartedSeenOnce_${$}`,"true"),oe.current&&(clearTimeout(oe.current),oe.current=null)}catch(t){}},disclosure:re?"up":"down",children:[re?"Hide":"Show"," Guide"]})]}),t.jsx(g,{open:re,id:"onboarding-collapsible",transition:{duration:"200ms",timingFunction:"ease-in-out"},children:t.jsx(l,{paddingBlockStart:"300",children:t.jsxs(u,{gap:"400",children:[t.jsx(x,{}),t.jsxs(u,{gap:"300",children:[t.jsx(c,{variant:"headingMd",as:"h3",children:"What This App Does"}),t.jsxs(c,{variant:"bodyMd",tone:"subdued",children:["This app helps optimize your Shopify store for ",t.jsx("strong",{children:"AI search engines"})," (like ChatGPT, Claude, Perplexity) by structuring your existing product data in a format that AI bots can easily understand and reference."]}),t.jsxs(c,{variant:"bodyMd",tone:"subdued",children:[t.jsx("strong",{children:"Important:"})," This app primarily ",t.jsx("strong",{children:"structures"})," your existing data rather than creating new content. AI-enhanced features are supplementary and require additional tokens (unless you're on Growth Extra or Enterprise plans)."]})]}),t.jsx(x,{}),t.jsxs(u,{gap:"200",children:[t.jsx(c,{variant:"headingMd",as:"h3",children:"Video Tutorial"}),t.jsx(l,{padding:"400",background:"bg-surface-secondary",borderRadius:"200",children:t.jsx("div",{style:{position:"relative",paddingBottom:"56.25%",height:0,overflow:"hidden",maxWidth:"100%",borderRadius:"8px"},children:t.jsx("iframe",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",border:"none"},src:"https://www.youtube-nocookie.com/embed/bNfDsyDQEkc?origin=https://admin.shopify.com",title:"Video Tutorial",referrerPolicy:"no-referrer-when-downgrade",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0})})})]}),t.jsx(x,{}),t.jsxs(u,{gap:"300",children:[t.jsx(c,{variant:"headingMd",as:"h3",children:"Quick Start Guide"}),t.jsxs(u,{gap:"200",children:[t.jsx(c,{variant:"bodyMd",fontWeight:"semibold",children:"1. Sync Your Store Data"}),t.jsx(c,{variant:"bodyMd",tone:"subdued",children:'Click "Sync Now" to fetch your products, collections, languages, and markets from Shopify. This is required before you can start optimizing. Enable "Auto-sync on load" to keep your data fresh.'}),t.jsx(c,{variant:"bodyMd",fontWeight:"semibold",children:"2. Plan Selection & Token Management"}),t.jsx(c,{variant:"bodyMd",tone:"subdued",children:'Plan selection happens during app installation. Visit "Plans & Billing" to upgrade your plan or purchase additional tokens for AI-enhanced features (Professional/Growth plans).'}),t.jsx(c,{variant:"bodyMd",fontWeight:"semibold",children:"3. Structure Your Product Data"}),t.jsxs(c,{variant:"bodyMd",tone:"subdued",children:['Go to "Search Optimization for AI" → Products tab. First, create ',t.jsx("strong",{children:"basic optimization"})," by structuring existing titles, descriptions, and metadata for better AI consumption. This is essential - without basic optimization, AI-enhanced features cannot be applied."]}),t.jsxs(c,{variant:"bodyMd",tone:"subdued",children:["Also optimize your ",t.jsx("strong",{children:"Collections"})," to help AI bots understand your product categories and relationships."]}),t.jsx(c,{variant:"bodyMd",fontWeight:"semibold",children:"4. Configure Store Metadata"}),t.jsx(c,{variant:"bodyMd",tone:"subdued",children:'Go to "Store Metadata" to configure store description, keywords, business information, and contact details (Professional+ plans). This helps AI bots understand your brand and business context.'}),t.jsx(c,{variant:"bodyMd",fontWeight:"semibold",children:"5. Generate Sitemaps"}),t.jsxs(c,{variant:"bodyMd",tone:"subdued",children:["Navigate to Sitemap tab to generate your ",t.jsx("strong",{children:"standard sitemap"})," for search engines. For advanced optimization, go to Settings → Sitemap to configure ",t.jsx("strong",{children:"AI-enhanced sitemap"}),"with structured data that helps AI search engines discover and index your products (Growth Extra+ plans)."]}),t.jsx(c,{variant:"bodyMd",fontWeight:"semibold",children:"6. AI-Enhanced Features (Optional)"}),t.jsxs(c,{variant:"bodyMd",tone:"subdued",children:["Use AI-enhanced add-ons to ",t.jsx("strong",{children:"supplement and strengthen"})," your data discovery by AI bots, increasing your store's chances of being well-represented. These include:"]}),t.jsxs(c,{variant:"bodyMd",tone:"subdued",children:["• ",t.jsx("strong",{children:"AI Testing:"})," Test how AI bots respond to your products (Professional+)"]}),t.jsxs(c,{variant:"bodyMd",tone:"subdued",children:["• ",t.jsx("strong",{children:"AI Discovery Endpoints:"})," Advanced AI simulation features (Growth Extra+)"]}),t.jsxs(c,{variant:"bodyMd",tone:"subdued",children:["• ",t.jsx("strong",{children:"Advanced Schema Data:"})," Rich structured data markup (Enterprise only)"]}),t.jsx(c,{variant:"bodyMd",tone:"subdued",children:"These features require additional tokens unless you're on Growth Extra or Enterprise plans."}),t.jsx(c,{variant:"bodyMd",fontWeight:"semibold",children:"7. Configure AI Discovery Settings"}),t.jsx(c,{variant:"bodyMd",tone:"subdued",children:'Visit "Settings" to configure AI Discovery features:'}),t.jsxs(c,{variant:"bodyMd",tone:"subdued",children:["• ",t.jsx("strong",{children:"AI Bot Access Control:"})," Select which AI bots (OpenAI, Claude, Google, etc.) can access your store's structured data"]}),t.jsxs(c,{variant:"bodyMd",tone:"subdued",children:["• ",t.jsx("strong",{children:"AI Discovery Features:"})," Enable Products JSON Feed, Collections JSON Feed, Store Metadata, AI Welcome Page, AI-Enhanced Sitemap, and Advanced Schema Data"]}),t.jsxs(c,{variant:"bodyMd",tone:"subdued",children:["• Click ",t.jsx("strong",{children:'"Save Settings"'})," to save your configuration"]}),t.jsx(c,{variant:"bodyMd",fontWeight:"semibold",children:"8. Install robots.txt (REQUIRED)"}),t.jsxs(c,{variant:"bodyMd",tone:"subdued",children:[t.jsx("strong",{children:"Critical:"})," After saving Settings, you must manually install robots.txt in your theme for AI bots to access your endpoints:"]}),t.jsxs(c,{variant:"bodyMd",tone:"subdued",children:['• In Settings, scroll to "robots.txt Configuration" section and click ',t.jsx("strong",{children:'"View & Copy robots.txt Code"'})]}),t.jsx(c,{variant:"bodyMd",tone:"subdued",children:"• Copy the generated robots.txt content"}),t.jsxs(c,{variant:"bodyMd",tone:"subdued",children:["• Go to ",t.jsx("strong",{children:"Online Store → Themes"})," → ",t.jsx("strong",{children:"Actions → Edit code"})," on your active theme"]}),t.jsxs(c,{variant:"bodyMd",tone:"subdued",children:["• Click ",t.jsx("strong",{children:'"Add a new file"'})," and type: ",t.jsx("code",{children:"templates/robots.txt.liquid"})]}),t.jsxs(c,{variant:"bodyMd",tone:"subdued",children:["• Paste the copied content and click ",t.jsx("strong",{children:"Save"})]}),t.jsx(c,{variant:"bodyMd",tone:"subdued",children:t.jsx("strong",{children:"Without this step, AI bots cannot discover your store's endpoints!"})}),t.jsx(c,{variant:"bodyMd",fontWeight:"semibold",children:"9. Optional: Advanced Features"}),t.jsx(c,{variant:"bodyMd",tone:"subdued",children:"Additional features available in Settings:"}),t.jsxs(c,{variant:"bodyMd",tone:"subdued",children:["• ",t.jsx("strong",{children:"Advanced Schema Data:"})," Generate rich structured data markup for your products (Professional Plus/Enterprise plans)"]}),t.jsxs(c,{variant:"bodyMd",tone:"subdued",children:["• ",t.jsx("strong",{children:"AI Testing:"})," Test how AI bots respond to your products (Professional+ plans)"]}),t.jsx(c,{variant:"bodyMd",tone:"subdued",children:"These features may require additional tokens depending on your plan."}),t.jsx(c,{variant:"bodyMd",fontWeight:"semibold",children:"10. Monitor & Improve"}),t.jsx(c,{variant:"bodyMd",tone:"subdued",children:"Return to Dashboard regularly to track optimization progress, monitor token usage, and review plan recommendations."})]})]}),t.jsx(l,{paddingBlockStart:"200",children:t.jsxs(h,{gap:"200",children:[t.jsx(p,{variant:"primary",onClick:()=>O("/ai-seo/products"),children:"Start Optimizing"}),t.jsx(p,{onClick:()=>O("/billing"),children:"View Plans"})]})})]})})})]})})}),we&&t.jsx(a.Section,{children:t.jsx(m,{title:"Sync your store",tone:"info",action:{content:Q?"Syncing...":"Sync Now",onAction:ge,loading:Q},children:t.jsxs(u,{gap:"200",children:[t.jsx(c,{children:"Sync products, collections, languages, and markets to get started with AI optimization."}),Q&&t.jsxs(l,{paddingBlockStart:"200",children:[t.jsx(b,{progress:50,size:"small",tone:"highlight"}),t.jsx(l,{paddingBlockStart:"100",children:t.jsx(c,{variant:"bodySm",tone:"subdued",children:"Fetching store data..."})})]})]})})}),!we&&H&&t.jsx(a.Section,{children:t.jsx(d,{children:ee?t.jsxs(u,{gap:"300",children:[t.jsxs(h,{align:"space-between",blockAlign:"center",children:[t.jsxs("div",{children:[t.jsx(c,{variant:"bodyMd",fontWeight:"semibold",children:"Store Sync"}),t.jsx(l,{paddingBlockStart:"050",children:t.jsxs(c,{variant:"bodySm",tone:"subdued",children:["Last synced: ",H.lastSyncDate?new Date(H.lastSyncDate).toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"Never"]})})]}),t.jsxs(h,{gap:"200",children:[t.jsx(p,{onClick:ge,loading:Q,children:"Sync Now"}),t.jsx(p,{onClick:()=>{te(!1);try{localStorage.setItem(`syncCardExpanded_${$}`,"false")}catch(e){}},variant:"plain",children:"Close"})]})]}),t.jsx(x,{}),t.jsx(j,{label:"Auto-sync on load",checked:X,onChange:async e=>{try{r("[Dashboard] Toggling auto-sync to:",e),Z(e);const t=await E(`/api/dashboard/auto-sync?shop=${$}`,{method:"POST",body:{enabled:e}});r("[Dashboard] Auto-sync toggle response:",t),(null==t?void 0:t.success)&&(Z(!!t.autoSyncEnabled),Y({...H||{},autoSyncEnabled:!!t.autoSyncEnabled}))}catch(t){Z(!e)}},helpText:"Automatically sync store data when you open the dashboard"})]}):t.jsxs(h,{align:"space-between",blockAlign:"center",gap:"400",children:[t.jsxs(h,{gap:"200",blockAlign:"center",children:[X&&t.jsx(y,{tone:"success",children:"Auto-sync enabled"}),t.jsxs(c,{variant:"bodySm",tone:"subdued",children:["Last synced: ",H.lastSyncDate?new Date(H.lastSyncDate).toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"Never"]})]}),t.jsxs(h,{gap:"200",children:[t.jsx(p,{onClick:ge,loading:Q,size:"slim",children:"Sync Now"}),t.jsx(p,{onClick:()=>{te(!0);try{localStorage.setItem(`syncCardExpanded_${$}`,"true")}catch(e){}},size:"slim",variant:"plain",children:"Expand"})]})]})})}),Se&&!ae&&t.jsx(a.Section,{children:t.jsx(m,{title:`Upgrade to ${Se.planName} Plan`,tone:"warning",action:{content:"View Plans",onAction:()=>O("/billing")},onDismiss:()=>{try{localStorage.setItem(`dismissedUpgradeBanner_${$}`,"true"),de(!0)}catch(e){}},children:t.jsxs(u,{gap:"200",children:[t.jsx(c,{children:Se.reason}),t.jsxs(c,{variant:"bodySm",tone:"subdued",children:["The ",Se.planName," plan supports up to ",Se.productLimit," products in ",Se.languageLimit," language",Se.languageLimit>1?"s":"","for $",Se.price,"/month."]})]})})}),fe&&!le&&t.jsx(a.Section,{children:t.jsx(m,{title:"Buy Tokens to Unlock AI Features",tone:"info",action:{content:"Buy Tokens",onAction:()=>O("/billing")},onDismiss:()=>{try{localStorage.setItem(`dismissedTokenBanner_${$}`,"true"),ce(!0)}catch(e){}},children:t.jsx(c,{children:"Purchase tokens to access AI-enhanced optimization features like AEO generation, AI Discovery and more."})})}),t.jsx(a.Section,{children:t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(320px, 1fr))",gap:"16px"},children:[t.jsx("div",{style:{display:"grid",gap:16},children:t.jsx(d,{children:t.jsxs(u,{gap:"400",children:[t.jsx(c,{variant:"headingMd",children:"Products & Collections"}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(220px, 1fr))",gap:12},children:[t.jsxs(u,{gap:"150",children:[t.jsx(c,{variant:"bodyMd",fontWeight:"semibold",children:"Products"}),t.jsxs(h,{align:"space-between",children:[t.jsx(c,{variant:"bodySm",tone:"subdued",children:"Total"}),t.jsx(c,{variant:"bodySm",fontWeight:"semibold",children:(null==(w=null==B?void 0:B.products)?void 0:w.total)||0})]}),t.jsxs(h,{align:"space-between",children:[t.jsx(c,{variant:"bodySm",tone:"subdued",children:"Optimized"}),t.jsx(c,{variant:"bodySm",fontWeight:"semibold",tone:"success",children:(null==(M=null==B?void 0:B.products)?void 0:M.optimized)||0})]}),t.jsxs(h,{align:"space-between",children:[t.jsx(c,{variant:"bodySm",tone:"subdued",children:"Unoptimized"}),t.jsx(c,{variant:"bodySm",fontWeight:"semibold",children:Math.max(((null==(k=null==B?void 0:B.products)?void 0:k.total)||0)-((null==(A=null==B?void 0:B.products)?void 0:A.optimized)||0),0)})]}),t.jsxs(l,{paddingBlockStart:"100",children:[t.jsx(b,{progress:xe,size:"small",tone:100===xe?"success":"primary"}),t.jsx(l,{paddingBlockStart:"050",children:t.jsxs(c,{variant:"bodySm",tone:"subdued",children:[xe,"% optimized"]})})]})]}),t.jsxs(u,{gap:"150",children:[t.jsx(c,{variant:"bodyMd",fontWeight:"semibold",children:"Collections"}),t.jsxs(h,{align:"space-between",children:[t.jsx(c,{variant:"bodySm",tone:"subdued",children:"Total"}),t.jsx(c,{variant:"bodySm",fontWeight:"semibold",children:(null==(I=null==B?void 0:B.collections)?void 0:I.total)||0})]}),t.jsxs(h,{align:"space-between",children:[t.jsx(c,{variant:"bodySm",tone:"subdued",children:"Optimized"}),t.jsx(c,{variant:"bodySm",fontWeight:"semibold",tone:"success",children:(null==(C=null==B?void 0:B.collections)?void 0:C.optimized)||0})]}),t.jsxs(h,{align:"space-between",children:[t.jsx(c,{variant:"bodySm",tone:"subdued",children:"Unoptimized"}),t.jsx(c,{variant:"bodySm",fontWeight:"semibold",children:Math.max(((null==(z=null==B?void 0:B.collections)?void 0:z.total)||0)-((null==(P=null==B?void 0:B.collections)?void 0:P.optimized)||0),0)})]}),t.jsxs(l,{paddingBlockStart:"100",children:[t.jsx(b,{progress:me,size:"small",tone:100===me?"success":"primary"}),t.jsx(l,{paddingBlockStart:"050",children:t.jsxs(c,{variant:"bodySm",tone:"subdued",children:[me,"% optimized"]})})]})]})]}),t.jsx(x,{}),t.jsx(h,{align:"space-between",children:t.jsxs(c,{variant:"bodySm",tone:"subdued",children:["Last synced: ",(null==H?void 0:H.lastSyncDate)?new Date(H.lastSyncDate).toLocaleString():"Never"]})})]})})}),t.jsxs("div",{style:{display:"grid",gap:16},children:[t.jsx(d,{children:t.jsxs(u,{gap:"400",children:[t.jsx(c,{variant:"headingMd",children:"Languages & Markets"}),t.jsx(u,{gap:"200",children:(null==B?void 0:B.languages)&&B.languages.length>0?t.jsxs(t.Fragment,{children:[B.languages.slice().sort((e,t)=>(t.primary?1:0)-(e.primary?1:0)||(t.totalCount||0)-(e.totalCount||0)).slice(0,3).map((e,n)=>{const s=e.totalCount>0?Math.round(e.optimizedCount/e.totalCount*100):0;return t.jsxs(u,{gap:"050",children:[t.jsxs(h,{align:"space-between",children:[t.jsxs(c,{variant:"bodyMd",tone:"subdued",children:[e.name||e.code," ",e.primary?"★":""]}),t.jsxs(c,{variant:"bodySm",fontWeight:"semibold",children:[e.optimizedCount||0,"/",e.totalCount||0]})]}),t.jsx(b,{progress:s,size:"small",tone:100===s?"success":"primary"})]},n)}),B.languages.length>3&&t.jsxs(c,{variant:"bodySm",tone:"subdued",children:["+",B.languages.length-3," more..."]})]}):t.jsx(c,{variant:"bodyMd",tone:"subdued",children:"No language data"})}),(null==B?void 0:B.storeMarkets)&&B.storeMarkets.length>0&&t.jsxs(l,{paddingBlockStart:"200",children:[t.jsx(x,{}),t.jsx(l,{paddingBlockStart:"200",children:t.jsxs(c,{variant:"bodySm",tone:"subdued",children:["Markets: ",B.storeMarkets.slice(0,2).map(e=>e.name).join(", "),B.storeMarkets.length>2?" +"+(B.storeMarkets.length-2):""]})})]})]})}),t.jsx(d,{children:t.jsxs(u,{gap:"300",children:[t.jsx(c,{variant:"headingMd",children:"Last Optimization"}),t.jsx(c,{variant:"bodyLg",fontWeight:"semibold",children:(null==B?void 0:B.lastOptimization)?new Date(B.lastOptimization).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"Never"}),t.jsx(p,{onClick:()=>O("/ai-seo/products"),children:"Optimize Now"})]})})]})]})}),t.jsx(a.Section,{children:t.jsx(i,{testResults:R,aiTestResults:J,stats:(()=>{var e,t,n,s;if(B)return{totalProducts:(null==(e=null==B?void 0:B.products)?void 0:e.total)||0,optimizedProducts:(null==(t=null==B?void 0:B.products)?void 0:t.optimized)||0,totalCollections:(null==(n=null==B?void 0:B.collections)?void 0:n.total)||0,optimizedCollections:(null==(s=null==B?void 0:B.collections)?void 0:s.optimized)||0};try{const e=localStorage.getItem(`dashboard-stats-${$}`);if(e){const t=JSON.parse(e);return{totalProducts:t.totalProducts||0,optimizedProducts:t.optimizedProducts||0,totalCollections:t.totalCollections||0,optimizedCollections:t.optimizedCollections||0}}}catch(o){}return{totalProducts:0,optimizedProducts:0,totalCollections:0,optimizedCollections:0}})()})}),t.jsx(a.Section,{children:t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(320px, 1fr))",gap:"16px"},children:[t.jsx(d,{style:{height:220,minHeight:220},children:t.jsxs(u,{gap:"300",children:[t.jsxs(h,{align:"space-between",blockAlign:"center",children:[t.jsxs("div",{children:[t.jsx(c,{variant:"headingMd",children:"Current Plan"}),t.jsx(l,{paddingBlockStart:"100",children:t.jsxs(c,{variant:"bodySm",tone:"subdued",children:[ye?`$${ye.toFixed(2)}`:"—","/month"]})})]}),t.jsx(y,{tone:"info",size:"large",children:(null==(T=null==L?void 0:L.plan)?void 0:T.replace("_"," ").toUpperCase())||"N/A"})]}),t.jsx(p,{onClick:()=>O("/billing"),children:"View Plans & Billing"})]})}),t.jsx(d,{style:{height:220,minHeight:220},children:t.jsxs(u,{gap:"300",children:[t.jsx(c,{variant:"headingMd",children:"Token Balance"}),t.jsxs(c,{variant:"bodyLg",fontWeight:"semibold",children:[(null==(D=null==U?void 0:U.balance)?void 0:D.toLocaleString())||0," tokens"]}),("growth_extra"===(null==L?void 0:L.plan)||"enterprise"===(null==L?void 0:L.plan))&&t.jsxs(c,{variant:"bodySm",tone:"subdued",children:["growth_extra"===(null==L?void 0:L.plan)?"100M":"300M"," included monthly"]}),t.jsx(p,{onClick:()=>O("/billing"),children:"Manage Tokens"})]})})]})})]})}export{v as default};
