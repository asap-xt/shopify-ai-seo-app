import{j as e}from"./app-bridge-Rb76oEby-1760703862760.js";import{r as d}from"./react-vendor-tAaa2TlE-1760703862760.js";import{m as _}from"./index-i-XcO7Kd-1760703862760.js";import{C as $,a as x,d as a,T as s,f as b,I as o,B as i,D as j,i as X,k as Z,M as m}from"./polaris-mHyUJkUi-1760703862760.js";const ee=(T,t="")=>{try{return new URLSearchParams(window.location.search).get(T)||t}catch{return t}};function re({shop:T}){var E,D,O;const t=T||ee("shop",""),[q,A]=d.useState(""),C=d.useMemo(()=>_(),[]),[v,N]=d.useState(null),[z,y]=d.useState(""),[B,G]=d.useState(!1),[h,F]=d.useState(null),[I,U]=d.useState(""),[L,P]=d.useState(!1),[V,M]=d.useState(!1),[l,W]=d.useState(null),[J,R]=d.useState(!1),[u,Y]=d.useState(null);d.useEffect(()=>{t&&H()},[t,C]);const H=async()=>{var r,c;try{const p=await C("/graphql",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:`
        query PlansMe($shop:String!) {
          plansMe(shop:$shop) {
            shop
            plan
            planKey
          }
        }
      `,variables:{shop:t}})});console.log("[AI-TESTING] Plan data:",p),N((c=(r=p==null?void 0:p.data)==null?void 0:r.plansMe)==null?void 0:c.plan)}catch(n){console.error("[AI-TESTING] Error loading plan:",n)}},S=r=>{if(!v)return!1;const n=["Starter","Professional","Growth","Growth Extra","Enterprise"].indexOf(v);switch(r){case"productsJson":return n>=0;case"storeMetadata":return n>=1;case"welcomePage":case"collectionsJson":return n>=2;case"aiSitemap":return n>=3;case"schemaData":return n>=4;case"meta":return n>=0;case"claude":return n>=0;case"gemini":return n>=1;case"chatgpt":return n>=2;case"perplexity":return n>=3;case"deepseek":return n>=4;default:return!1}},w=r=>{switch(r){case"storeMetadata":return"Professional";case"welcomePage":case"collectionsJson":return"Growth";case"aiSitemap":return"Growth Extra";case"schemaData":return"Enterprise";case"gemini":return"Professional";case"chatgpt":return"Growth";case"perplexity":return"Growth Extra";case"deepseek":return"Enterprise";default:return"Professional"}},g=(r,c,n=null)=>{if(n){const p=["Starter","Professional","Growth","Growth Extra","Enterprise"],Q=p.indexOf(v),K=p.indexOf(n);if(Q<K){Y({endpoint:c,currentPlan:v,requiredPlan:n}),R(!0);return}}window.open(r,"_blank")},k=(r,c)=>{F({name:r,url:c}),G(!0)},f=async(r,c=null)=>{try{y("Generating AI response...");let n=`/api/ai-discovery/simulate?shop=${t}&type=${r}`;c&&(n+=`&question=${encodeURIComponent(c)}`);const p=await C(n,{method:"GET"});y(p.response||"No response generated")}catch(n){if(console.error("[AI-TESTING] Simulation error:",n),console.log("[AI-TESTING] Error status:",n.status),console.log("[AI-TESTING] Error requiresUpgrade:",n.requiresUpgrade),console.log("[AI-TESTING] Error requiresPurchase:",n.requiresPurchase),n.status===402){if(n.requiresUpgrade){W(n),P(!0),y("");return}if(n.requiresPurchase){W(n),M(!0),y("");return}}y("Error generating response. Please try again."),A("Failed to simulate AI response")}};return e.jsxs(e.Fragment,{children:[e.jsx($,{children:e.jsx(x,{padding:"400",children:e.jsxs(a,{gap:"400",children:[e.jsx(s,{as:"h2",variant:"headingLg",children:"AI Testing"}),e.jsx(b,{tone:"info",children:e.jsx(s,{children:"Test how AI models discover and understand your store content. Check if your structured data and AI Discovery features are working correctly."})}),e.jsx($,{children:e.jsx(x,{padding:"300",children:e.jsxs(a,{gap:"400",children:[e.jsx(s,{as:"h3",variant:"headingMd",children:"AI Discovery Endpoints"}),e.jsx(s,{variant:"bodyMd",tone:"subdued",children:"These are the endpoints that AI bots use to discover and understand your store content."}),e.jsxs(a,{gap:"300",children:[e.jsxs(o,{align:"space-between",blockAlign:"center",children:[e.jsxs(a,{gap:"100",children:[e.jsx(s,{variant:"bodyMd",fontWeight:"semibold",children:"Products JSON Feed"}),e.jsx(s,{variant:"bodySm",tone:"subdued",children:"Bulk product data for AI consumption"})]}),e.jsx(i,{onClick:()=>g(`https://${t}/apps/new-ai-seo/ai/products.json?shop=${t}`,"Products JSON Feed"),size:"slim",children:"View"})]}),e.jsx(j,{}),e.jsxs(o,{align:"space-between",blockAlign:"center",children:[e.jsxs(a,{gap:"100",children:[e.jsx(s,{variant:"bodyMd",fontWeight:"semibold",children:"Store Metadata for AI Search"}),e.jsx(s,{variant:"bodySm",tone:"subdued",children:"Organization schema & AI metadata"})]}),e.jsx(i,{onClick:()=>g(`https://${t}/apps/new-ai-seo/ai/store-metadata.json?shop=${t}`,"Store Metadata for AI Search","Professional"),size:"slim",children:"View"})]}),e.jsx(j,{}),e.jsxs(o,{align:"space-between",blockAlign:"center",children:[e.jsxs(a,{gap:"100",children:[e.jsx(s,{variant:"bodyMd",fontWeight:"semibold",children:"AI Welcome Page"}),e.jsx(s,{variant:"bodySm",tone:"subdued",children:"Landing page for AI bots"})]}),e.jsx(i,{onClick:()=>g(`https://${t}/apps/new-ai-seo/ai/welcome?shop=${t}`,"AI Welcome Page","Growth"),size:"slim",children:"View"})]}),e.jsx(j,{}),e.jsxs(o,{align:"space-between",blockAlign:"center",children:[e.jsxs(a,{gap:"100",children:[e.jsx(s,{variant:"bodyMd",fontWeight:"semibold",children:"Collections JSON Feed"}),e.jsx(s,{variant:"bodySm",tone:"subdued",children:"Category data for better AI understanding"})]}),e.jsx(i,{onClick:()=>g(`https://${t}/apps/new-ai-seo/ai/collections-feed.json?shop=${t}`,"Collections JSON Feed","Growth"),size:"slim",children:"View"})]}),e.jsx(j,{}),e.jsxs(o,{align:"space-between",blockAlign:"center",children:[e.jsxs(a,{gap:"100",children:[e.jsx(s,{variant:"bodyMd",fontWeight:"semibold",children:"AI-Optimized Sitemap"}),e.jsx(s,{variant:"bodySm",tone:"subdued",children:"Optimized sitemap for AI bots"})]}),e.jsx(i,{onClick:()=>g(`https://${t}/apps/new-ai-seo/ai/sitemap-feed.xml?shop=${t}`,"AI-Optimized Sitemap","Growth Extra"),size:"slim",children:"View"})]}),e.jsx(j,{}),e.jsxs(o,{align:"space-between",blockAlign:"center",children:[e.jsxs(a,{gap:"100",children:[e.jsx(s,{variant:"bodyMd",fontWeight:"semibold",children:"robots.txt (Dynamic)"}),e.jsx(s,{variant:"bodySm",tone:"subdued",children:"Test how AI bots understand your store"})]}),e.jsx(i,{onClick:()=>g(`https://${t}/apps/new-ai-seo/ai/robots-dynamic?shop=${t}`,"robots.txt"),size:"slim",children:"View"})]}),e.jsx(j,{}),e.jsxs(o,{align:"space-between",blockAlign:"center",children:[e.jsxs(a,{gap:"100",children:[e.jsx(s,{variant:"bodyMd",fontWeight:"semibold",children:"Advanced Schema Data"}),e.jsx(s,{variant:"bodySm",tone:"subdued",children:"BreadcrumbList, FAQPage & more"})]}),e.jsx(i,{onClick:()=>g(`https://${t}/apps/new-ai-seo/ai/schema-data.json?shop=${t}`,"Advanced Schema Data","Enterprise"),size:"slim",children:"View"})]})]}),e.jsx(j,{}),e.jsxs(a,{gap:"200",children:[e.jsxs(o,{align:"space-between",children:[e.jsx(s,{children:"Meta AI Search"}),S("meta")?e.jsx(i,{onClick:()=>k("Meta AI","https://www.meta.ai/"),size:"slim",children:"Test"}):e.jsxs(i,{disabled:!0,size:"slim",children:[w("meta"),"+ Required"]})]}),e.jsxs(o,{align:"space-between",children:[e.jsx(s,{children:"Claude AI Search"}),S("claude")?e.jsx(i,{onClick:()=>k("Claude AI","https://claude.ai/"),size:"slim",children:"Test"}):e.jsxs(i,{disabled:!0,size:"slim",children:[w("claude"),"+ Required"]})]}),e.jsxs(o,{align:"space-between",children:[e.jsx(s,{children:"Gemini AI Search"}),S("gemini")?e.jsx(i,{onClick:()=>k("Gemini AI","https://gemini.google.com/"),size:"slim",children:"Test"}):e.jsxs(i,{disabled:!0,size:"slim",children:[w("gemini"),"+ Required"]})]}),e.jsxs(o,{align:"space-between",children:[e.jsx(s,{children:"ChatGPT Web Search"}),S("chatgpt")?e.jsx(i,{url:`https://chat.openai.com/?q=What+products+does+${t}+sell%3F+Tell+me+about+this+business+and+what+they+offer`,external:!0,size:"slim",children:"Test"}):e.jsxs(i,{disabled:!0,size:"slim",children:[w("chatgpt"),"+ Required"]})]}),e.jsxs(o,{align:"space-between",children:[e.jsx(s,{children:"Perplexity AI Search"}),S("perplexity")?e.jsx(i,{url:`https://www.perplexity.ai/search?q=What+products+does+${t}+sell%3F+Tell+me+about+this+business+and+what+they+offer`,external:!0,size:"slim",children:"Test"}):e.jsxs(i,{disabled:!0,size:"slim",children:[w("perplexity"),"+ Required"]})]}),e.jsxs(o,{align:"space-between",children:[e.jsx(s,{children:"DeepSeek AI Search"}),S("deepseek")?e.jsx(i,{onClick:()=>k("DeepSeek AI","https://chat.deepseek.com/"),size:"slim",children:"Test"}):e.jsxs(i,{disabled:!0,size:"slim",children:[w("deepseek"),"+ Required"]})]})]}),e.jsx(b,{tone:"info",children:e.jsxs(s,{children:[e.jsx("strong",{children:"How to test with AI bots:"}),e.jsx("br",{}),"• ",e.jsx("strong",{children:"Perplexity & ChatGPT:"}),' Click "Test" - they support URL parameters',e.jsx("br",{}),"• ",e.jsx("strong",{children:"Meta AI, Claude, Gemini, DeepSeek:"}),' Click "Test" to open a modal with the prompt to copy']})})]})})}),e.jsx($,{children:e.jsx(x,{padding:"300",children:e.jsxs(a,{gap:"300",children:[e.jsx(s,{as:"h4",variant:"headingSm",children:"AI Search Simulation"}),e.jsx(s,{variant:"bodyMd",tone:"subdued",children:"Test how AI bots would respond to questions about your store based on your structured data."}),e.jsx(b,{tone:"info",children:e.jsxs(a,{gap:"100",children:[e.jsx(s,{variant:"bodySm",fontWeight:"semibold",children:"Simulation Details:"}),e.jsxs(s,{variant:"bodySm",children:["• ",e.jsx("strong",{children:"Data Source:"})," Your store's products, collections, and metadata"]}),e.jsxs(s,{variant:"bodySm",children:["• ",e.jsx("strong",{children:"Response Style:"})," Concise (2-3 sentences), natural language"]}),e.jsxs(s,{variant:"bodySm",children:["• ",e.jsx("strong",{children:"Best For:"})," General store info, products, categories, contact details"]}),e.jsxs(s,{variant:"bodySm",children:["• ",e.jsx("strong",{children:"Limitations:"})," May not have real-time data (current stock, active promotions, exact shipping times)"]})]})}),e.jsxs(a,{gap:"200",children:[e.jsxs(o,{align:"space-between",children:[e.jsx(s,{children:"What products does this store sell?"}),e.jsx(i,{onClick:()=>f("products"),size:"slim",children:"Simulate Response"})]}),e.jsxs(o,{align:"space-between",children:[e.jsx(s,{children:"Tell me about this business"}),e.jsx(i,{onClick:()=>f("business"),size:"slim",children:"Simulate Response"})]}),e.jsxs(o,{align:"space-between",children:[e.jsx(s,{children:"What categories does this store have?"}),e.jsx(i,{onClick:()=>f("categories"),size:"slim",children:"Simulate Response"})]}),e.jsxs(o,{align:"space-between",children:[e.jsx(s,{children:"What is this store's contact information?"}),e.jsx(i,{onClick:()=>f("contact"),size:"slim",children:"Simulate Response"})]})]}),e.jsx(j,{}),e.jsxs(a,{gap:"200",children:[e.jsx(s,{variant:"headingSm",children:"Ask Your Own Question"}),e.jsx(X,{label:"",value:I,onChange:U,placeholder:"e.g., What are your return policies? Do you ship internationally?",autoComplete:"off",connectedRight:e.jsx(i,{onClick:()=>{I.trim()?f("custom",I):A("Please enter a question")},disabled:!I.trim(),children:"Ask AI"})})]}),z&&e.jsxs(x,{background:"bg-surface-secondary",padding:"300",borderRadius:"200",children:[e.jsx(s,{variant:"bodyMd",fontWeight:"semibold",children:"AI Bot Response:"}),e.jsx(x,{paddingBlockStart:"200",children:e.jsx(s,{variant:"bodyMd",children:z})})]})]})})})]})})}),q&&e.jsx(Z,{content:q,onDismiss:()=>A("")}),e.jsx(m,{open:B,onClose:()=>G(!1),title:`Test with ${h==null?void 0:h.name}`,primaryAction:{content:"Open AI Bot",url:h==null?void 0:h.url,external:!0},secondaryActions:[{content:"Copy Prompt",onAction:()=>{navigator.clipboard.writeText(`What products does ${t} sell? Tell me about this business and what they offer.`),A("Prompt copied to clipboard!")}}],children:e.jsx(m.Section,{children:e.jsxs(a,{gap:"300",children:[e.jsx(s,{variant:"bodyMd",children:'1. Click "Copy Prompt" (left button)'}),e.jsxs(s,{variant:"bodyMd",children:['2. Click "Open AI Bot" (right button) to visit ',h==null?void 0:h.name]}),e.jsx(s,{variant:"bodyMd",children:"3. Paste the prompt and send"}),e.jsxs(x,{background:"bg-surface-secondary",padding:"300",borderRadius:"200",children:[e.jsx(s,{variant:"bodyMd",fontWeight:"semibold",children:"Prompt to test:"}),e.jsx(x,{paddingBlockStart:"200",children:e.jsxs(s,{variant:"bodyMd",as:"p",children:["What products does ",t," sell? Tell me about this business and what they offer."]})})]}),e.jsx(b,{tone:"info",children:e.jsx(s,{children:"The AI bot will search the web and use your store's structured data to answer."})})]})})}),e.jsx(m,{open:J,onClose:()=>R(!1),title:"Upgrade Required",primaryAction:{content:"View Plans",onAction:()=>{const r=new URLSearchParams(window.location.search),c=r.toString()?`?${r.toString()}`:"";window.location.href=`/billing${c}`}},secondaryActions:[{content:"Cancel",onAction:()=>R(!1)}],children:e.jsx(m.Section,{children:e.jsxs(a,{gap:"300",children:[e.jsxs(s,{variant:"bodyMd",children:[e.jsx("strong",{children:u==null?void 0:u.endpoint})," requires ",e.jsx("strong",{children:u==null?void 0:u.requiredPlan})," plan or higher."]}),e.jsxs(s,{variant:"bodyMd",tone:"subdued",children:["Your current plan: ",e.jsx("strong",{children:u==null?void 0:u.currentPlan})]}),e.jsx(b,{tone:"info",children:e.jsx(s,{children:"Upgrade to access this advanced AI Discovery feature."})})]})})}),e.jsx(m,{open:L,onClose:()=>P(!1),title:"Upgrade Required",primaryAction:{content:"View Plans",onAction:()=>{const r=new URLSearchParams(window.location.search),c=r.toString()?`?${r.toString()}`:"";window.location.href=`/billing${c}`}},secondaryActions:[{content:"Cancel",onAction:()=>P(!1)}],children:e.jsx(m.Section,{children:e.jsxs(a,{gap:"300",children:[e.jsxs(s,{variant:"bodyMd",children:["AI Testing requires ",e.jsx("strong",{children:(l==null?void 0:l.minimumPlan)||"Professional"})," plan or higher."]}),e.jsxs(s,{variant:"bodyMd",tone:"subdued",children:["Your current plan: ",e.jsx("strong",{children:(l==null?void 0:l.currentPlan)||"Starter"})]}),e.jsx(b,{tone:"info",children:e.jsx(s,{children:"Upgrade to test AI responses with real store data."})})]})})}),e.jsx(m,{open:V,onClose:()=>M(!1),title:"Insufficient Tokens",primaryAction:{content:"Buy Tokens",onAction:()=>{const r=new URLSearchParams(window.location.search),c=r.toString()?`?${r.toString()}`:"";window.location.href=`/billing${c}`}},secondaryActions:[{content:"Cancel",onAction:()=>M(!1)}],children:e.jsx(m.Section,{children:e.jsxs(a,{gap:"300",children:[e.jsx(s,{variant:"bodyMd",children:"You need more tokens to use AI Testing."}),e.jsx(x,{background:"bg-surface-secondary",padding:"300",borderRadius:"200",children:e.jsxs(a,{gap:"200",children:[e.jsxs(o,{align:"space-between",children:[e.jsx(s,{variant:"bodySm",children:"Required:"}),e.jsxs(s,{variant:"bodySm",fontWeight:"semibold",children:[((E=l==null?void 0:l.tokensRequired)==null?void 0:E.toLocaleString())||0," tokens"]})]}),e.jsxs(o,{align:"space-between",children:[e.jsx(s,{variant:"bodySm",children:"Available:"}),e.jsxs(s,{variant:"bodySm",children:[((D=l==null?void 0:l.tokensAvailable)==null?void 0:D.toLocaleString())||0," tokens"]})]}),e.jsxs(o,{align:"space-between",children:[e.jsx(s,{variant:"bodySm",children:"Needed:"}),e.jsxs(s,{variant:"bodySm",fontWeight:"semibold",tone:"critical",children:[((O=l==null?void 0:l.tokensNeeded)==null?void 0:O.toLocaleString())||0," tokens"]})]})]})}),e.jsx(b,{tone:"info",children:e.jsx(s,{children:"Purchase tokens to continue using AI features. Tokens never expire."})})]})})})]})}export{re as default};
