import{r as e,j as t}from"./react-vendor-BLtYaay5.js";import{m as n}from"./sessionFetch-D9zn2iVF.js";import{g as i}from"./usePlanHierarchy-CpsbOjPs.js";import{d as s}from"./index-SIhijMOo.js";import{A as o}from"./AIEOScoreCard-Bx9NX2zA.js";import{T as r}from"./TokenPurchaseModal-ChVK648j.js";import{L as a,C as l,B as d,T as c,a as u,I as h,b as p,c as g,D as x,d as m,e as b,f as y,g as v}from"./polaris-BgbORwUH.js";import"./app-bridge-DUY42B6P.js";import"./vendor-L4_WdQez.js";function j({shop:j}){var S,f,A,w,I,k,M,C,P,z,T,D,$,O;const L=j||((e,t="")=>{try{return new URLSearchParams(window.location.search).get(e)||t}catch{return t}})("shop",""),W=e.useMemo(()=>n(),[]),B=e=>{const t=new URLSearchParams(window.location.search),n=t.toString()?`?${t.toString()}`:"";window.location.href=`${e}${n}`},[E,G]=e.useState(!0),[R,_]=e.useState(null),[N,F]=e.useState(null),[U,V]=e.useState(null),[Y,H]=e.useState([]),[q,J]=e.useState({}),[Q,X]=e.useState({}),[K,Z]=e.useState(null),[ee,te]=e.useState(!1),[ne,ie]=e.useState(!1),[se,oe]=e.useState(()=>{try{const e=localStorage.getItem(`syncCardExpanded_${L}`);return null===e||"true"===e}catch{return!0}}),re=e.useRef(null),ae=e.useRef(!1),le=e.useRef(null),[de,ce]=e.useState(()=>{try{return!("true"===localStorage.getItem(`gettingStartedSeenOnce_${L}`))}catch{return!1}}),[ue,he]=e.useState(()=>{try{return"true"===localStorage.getItem(`dismissedUpgradeBanner_${L}`)}catch{return!1}}),[pe,ge]=e.useState(()=>{try{return"true"===localStorage.getItem(`dismissedTokenBanner_${L}`)}catch{return!1}}),[xe,me]=e.useState(()=>{try{return"true"===localStorage.getItem(`dismissedReviewBanner_${L}`)}catch{return!1}}),[be,ye]=e.useState(()=>{try{return"true"===localStorage.getItem(`clickedReviewRate_${L}`)}catch{return!1}}),[ve,je]=e.useState(0),[Se,fe]=e.useState(null),[Ae,we]=e.useState("30d"),[Ie,ke]=e.useState(!1),Me={ChatGPT:{label:"ChatGPT by OpenAI",desc:"AI assistant reading your products"},"OpenAI Search":{label:"OpenAI Search",desc:"OpenAI indexing your store for AI search"},Claude:{label:"Claude by Anthropic",desc:"AI assistant reading your products"},Perplexity:{label:"Perplexity AI Search",desc:"AI search engine indexing your store"},"Google AI":{label:"Google AI (Gemini)",desc:"Google AI indexing your store"},Cohere:{label:"Cohere AI",desc:"AI platform reading your data"},"You.com":{label:"You.com AI Search",desc:"AI search engine indexing your store"},Google:{label:"Google Search",desc:"Google indexing your AI endpoints"},Bing:{label:"Microsoft Bing / Copilot",desc:"Powers Bing search and Microsoft Copilot AI"},Yahoo:{label:"Yahoo Search",desc:"Yahoo indexing your store"},Yandex:{label:"Yandex Search",desc:"Russian search engine indexing your store"},DuckDuckGo:{label:"DuckDuckGo",desc:"Privacy search engine indexing your store"},Ahrefs:{label:"Ahrefs SEO Crawler",desc:"Helps your store appear in search results"},Semrush:{label:"Semrush SEO Crawler",desc:"Helps your store appear in search results"},Majestic:{label:"Majestic SEO Crawler",desc:"Building backlink profile for your store"},DotBot:{label:"Moz SEO Crawler",desc:"Helps your store appear in search results"},Apple:{label:"Apple / Siri",desc:"Apple indexing for Siri and Spotlight"},"Meta AI":{label:"Meta AI",desc:"Meta AI reading your products"},Facebook:{label:"Facebook",desc:"Facebook previewing your store links"},"Twitter/X":{label:"X (Twitter)",desc:"X previewing your store links"},LinkedIn:{label:"LinkedIn",desc:"LinkedIn previewing your store links"},Amazon:{label:"Amazon",desc:"Amazon crawler indexing your store"},"Internet Archive":{label:"Internet Archive",desc:"Archiving your store for posterity"},"indexAIze Test":{label:"indexAIze (internal)",desc:"Our own AI testing bot"},"Human/Unknown":{label:"Direct browser visit",desc:"Someone opened this page in a browser"},"Other Bot":{label:"Other automated visitor",desc:"Unidentified bot or crawler"}},Ce={"/ai/products.json":"Product Catalog","/ai/collections-feed.json":"Collections","/ai/store-metadata.json":"Store Info","/ai/welcome":"AI Welcome Page","/ai/sitemap-feed.xml":"AI Sitemap","/ai/ask":"AI Ask","/llms.txt":"LLMs.txt","/llms-full.txt":"LLMs Full","/.well-known/ai-plugin.json":"AI Plugin","/mcp/tools/search_products":"MCP: Product Search","/mcp/tools/get_product_details":"MCP: Product Details","/mcp/tools/get_store_info":"MCP: Store Info","/mcp/tools/search_collections":"MCP: Collections","/mcp/tools/ask_question":"MCP: AI Q&A"},[Pe,ze]=e.useState(!0),[Te,De]=e.useState(!1),$e=e.useRef(null),Oe=async(e,t)=>{const n=e||Ae,i=void 0!==t?t:Ie;if(L)try{ze(!0);const e=await W(`/api/ai-analytics?shop=${encodeURIComponent(L)}&period=${n}&compare=${i}`);e&&!e.error&&fe(e)}catch(s){}finally{ze(!1)}};e.useEffect(()=>(Le(!0),We(),(()=>{try{const e=localStorage.getItem(`ai-test-results-${L}`);if(e){const t=JSON.parse(e);t.results&&J(t.results)}const t=localStorage.getItem(`ai-validation-results-${L}`);if(t){const e=JSON.parse(t);e.results&&X(e.results)}const n=localStorage.getItem(`dashboard-stats-${L}`);n&&JSON.parse(n)}catch(e){}})(),Oe(),()=>{re.current&&(clearInterval(re.current),re.current=null),$e.current&&clearTimeout($e.current),le.current&&(clearTimeout(le.current),le.current=null)}),[L]),e.useEffect(()=>{if(!E&&(null==N?void 0:N.plan)&&de)try{"true"===localStorage.getItem(`gettingStartedSeenOnce_${L}`)||le.current||(le.current=setTimeout(()=>{try{localStorage.setItem(`gettingStartedSeenOnce_${L}`,"true")}catch(e){}},1e4))}catch(e){}return()=>{le.current&&(clearTimeout(le.current),le.current=null)}},[E,null==N?void 0:N.plan,de,L]),e.useEffect(()=>{K&&K.autoSyncEnabled&&!ee&&!ae.current&&(s("[Dashboard] Auto-sync is enabled, triggering sync..."),ae.current=!0,Be())},[null==K?void 0:K.autoSyncEnabled]);const Le=async(e=!1)=>(!e&&$e.current&&clearTimeout($e.current),new Promise(t=>{$e.current=setTimeout(async()=>{var e,n,i,s;try{G(!0);const[r,a,l]=await Promise.all([W(`/api/dashboard/stats?shop=${L}`),W(`/api/billing/tokens/balance?shop=${L}`),W(`/api/billing/info?shop=${L}`)]);if(r){_(r),F(r.subscription);try{const t={totalProducts:(null==(e=null==r?void 0:r.products)?void 0:e.total)||0,optimizedProducts:(null==(n=null==r?void 0:r.products)?void 0:n.optimized)||0,totalCollections:(null==(i=null==r?void 0:r.collections)?void 0:i.total)||0,optimizedCollections:(null==(s=null==r?void 0:r.collections)?void 0:s.optimized)||0,timestamp:(new Date).toISOString()};localStorage.setItem(`dashboard-stats-${L}`,JSON.stringify(t))}catch(o){}}(null==l?void 0:l.plans)&&H(l.plans),a&&V(a),t()}catch(r){t()}finally{G(!1)}},e?0:500)})),We=async()=>{try{const e=await W(`/api/dashboard/sync-status?shop=${L}`);e&&(Z(e),ie(e.autoSyncEnabled||!1),te(!!e.inProgress))}catch(e){}},Be=async()=>{try{te(!0);const e=await W(`/api/dashboard/sync?shop=${L}`,{method:"POST"});s("[Dashboard] Sync start response:",e),(null==e?void 0:e.success)||(null==e?void 0:e.inProgress)?(re.current&&clearInterval(re.current),re.current=setInterval(async()=>{try{const e=await W(`/api/dashboard/sync-status?shop=${L}`);e&&(Z(e),e.inProgress||(re.current&&(clearInterval(re.current),re.current=null),te(!1),Le()))}catch(e){}},2e3)):te(!1)}catch(e){te(!1)}},Ee=(null==(S=null==R?void 0:R.products)?void 0:S.total)>0?Math.round(R.products.optimized/R.products.total*100):0,Ge=(null==(f=null==R?void 0:R.collections)?void 0:f.total)>0?Math.round(R.collections.optimized/R.collections.total*100):0;i(null==N?void 0:N.plan);const Re=e=>{const t=null==e?void 0:e.toLowerCase().replace(/_/g," "),n=Y.find(n=>n.key===t||n.key===e);return(null==n?void 0:n.price)||0},_e=(null==N?void 0:N.price)&&N.price>0?N.price:(null==N?void 0:N.plan)?Re(N.plan):void 0,Ne=e=>({starter:1,professional:2,professional_plus:2.5,"professional plus":2.5,growth:3,growth_plus:3.5,"growth plus":3.5,growth_extra:4,"growth extra":4,enterprise:5}[e]||0),Fe=()=>{var e,t;if(!R||0===Y.length)return null;const n=(null==(e=R.products)?void 0:e.total)||0,i=(null==(t=R.languages)?void 0:t.length)||1,s=(null==N?void 0:N.plan)||"starter",o=Ne(s),r=["growth"];let a=null,l=null;for(const u of Y)if(!r.includes(u.key)&&n<=u.productLimit&&i<=u.languageLimit){a=u.key,l=u;break}a||(l=Y.find(e=>"enterprise"===e.key),a="enterprise");if(Ne(a)<=o)return null;const d=(e=>{const t=null==e?void 0:e.toLowerCase().replace(/_/g," "),n=Y.find(n=>n.key===t||n.key===e);return n?{products:n.productLimit||0,languages:n.languageLimit||1}:{products:0,languages:0}})(s);let c="";return n>d.products?c=`Your store has ${n} products, exceeding the ${d.products}-product limit of your current plan.`:i>d.languages&&(c=`Your store has ${i} language(s), exceeding the ${d.languages}-language limit of your current plan.`),{plan:a,planName:(null==l?void 0:l.name)||a.replace("_"," ").toUpperCase(),price:(null==l?void 0:l.price)||Re(a),productLimit:(null==l?void 0:l.productLimit)||0,languageLimit:(null==l?void 0:l.languageLimit)||1,reason:c}},Ue=e.useMemo(()=>Fe(),[R,N,Y]),Ve=e.useMemo(()=>{if(!(null==N?void 0:N.plan))return!1;const e=N.plan;if(!["professional","professional_plus","professional plus","growth","growth_plus","growth plus"].includes(e))return!1;return!(((null==U?void 0:U.balance)||0)>=1e3)},[N,U]),Ye=e.useMemo(()=>!xe&&!be&&ve>50,[xe,be,ve]);if(E)return t.jsx(a,{children:t.jsx(a.Section,{children:t.jsx(l,{children:t.jsx(d,{padding:"400",children:t.jsx(c,{children:"Loading dashboard..."})})})})});const He=!(null==K?void 0:K.synced);return t.jsxs(a,{children:[t.jsx(a.Section,{children:t.jsx(l,{children:t.jsxs(u,{gap:"300",children:[t.jsxs(h,{align:"space-between",blockAlign:"center",children:[t.jsx(c,{variant:"headingMd",children:"Getting Started"}),t.jsxs(p,{onClick:()=>{const e=!de;if(ce(e),de&&!e)try{localStorage.setItem(`gettingStartedSeenOnce_${L}`,"true"),le.current&&(clearTimeout(le.current),le.current=null)}catch(t){}},disclosure:de?"up":"down",children:[de?"Hide":"Show"," Guide"]})]}),t.jsx(g,{open:de,id:"onboarding-collapsible",transition:{duration:"200ms",timingFunction:"ease-in-out"},children:t.jsx(d,{paddingBlockStart:"300",children:t.jsxs(u,{gap:"400",children:[t.jsx(x,{}),t.jsxs(u,{gap:"300",children:[t.jsx(c,{variant:"headingMd",as:"h3",children:"What This App Does"}),t.jsxs(c,{variant:"bodyMd",tone:"subdued",children:["This app optimizes your Shopify store for ",t.jsx("strong",{children:"AI search engines and AI agents"})," (ChatGPT, Claude, Gemini, Perplexity and others). It structures your product data, store metadata, and policies so AI can accurately discover, understand, and recommend your store."]}),t.jsxs(c,{variant:"bodyMd",tone:"subdued",children:["Key capabilities: structured product data, AI-optimized feeds, ",t.jsx("strong",{children:"MCP Server"})," for direct AI agent access,",t.jsx("strong",{children:"AI Shopping Assistant"})," to preview how AI helps your customers, and ",t.jsx("strong",{children:"AI Traffic analytics"})," to track AI bot visits."]})]}),t.jsx(x,{}),t.jsxs(u,{gap:"200",children:[t.jsx(c,{variant:"headingMd",as:"h3",children:"Video Tutorial"}),t.jsx(d,{padding:"400",background:"bg-surface-secondary",borderRadius:"200",children:t.jsx("div",{style:{position:"relative",paddingBottom:"56.25%",height:0,overflow:"hidden",maxWidth:"100%",borderRadius:"8px"},children:t.jsx("iframe",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",border:"none"},src:"https://www.youtube-nocookie.com/embed/v253h9ucKNk?origin=https://admin.shopify.com",title:"Video Tutorial",referrerPolicy:"no-referrer-when-downgrade",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0})})})]}),t.jsx(x,{}),t.jsxs(u,{gap:"300",children:[t.jsx(c,{variant:"headingMd",as:"h3",children:"Quick Start Guide"}),t.jsxs(u,{gap:"200",children:[t.jsx(c,{variant:"bodyMd",fontWeight:"semibold",children:"1. Sync Your Store Data"}),t.jsx(c,{variant:"bodyMd",tone:"subdued",children:'Click "Sync Now" to fetch your products, collections, languages, and markets from Shopify. This is required before you can start optimizing. Enable "Auto-sync on load" to keep your data fresh.'}),t.jsx(c,{variant:"bodyMd",fontWeight:"semibold",children:"2. Token Management"}),t.jsx(c,{variant:"bodyMd",tone:"subdued",children:'AI features (AI SEO, Advanced Schema, AI Sitemap, AI Shopping Assistant, MCP Q&A) require tokens. Purchase tokens from "Plans & Billing" or upgrade to Growth Extra/Enterprise for included monthly allowances.'}),t.jsx(c,{variant:"bodyMd",fontWeight:"semibold",children:"3. Structure Your Product Data"}),t.jsxs(c,{variant:"bodyMd",tone:"subdued",children:['Go to "Store Optimization for AI" → Products tab. First, create ',t.jsx("strong",{children:"basic optimization"})," by structuring existing titles, descriptions, and metadata for better AI consumption. Data is saved to Shopify metafields (seo_ai namespace). This is essential - without basic optimization, AI-enhanced features cannot be applied."]}),t.jsxs(c,{variant:"bodyMd",tone:"subdued",children:["Also optimize your ",t.jsx("strong",{children:"Collections"})," to help AI bots understand your product categories and relationships."]}),t.jsx(c,{variant:"bodyMd",fontWeight:"semibold",children:"4. Generate Sitemaps"}),t.jsxs(c,{variant:"bodyMd",tone:"subdued",children:['Navigate to "Store Optimization for AI" → Sitemap tab to generate your ',t.jsx("strong",{children:"standard sitemap"})," for search engines. AI-Optimized Sitemap with structured data for AI search engines is available in the same tab (Growth Extra+ plans or with tokens)."]}),t.jsx(c,{variant:"bodyMd",fontWeight:"semibold",children:"5. Configure Store Metadata"}),t.jsxs(c,{variant:"bodyMd",tone:"subdued",children:['Go to "Store Optimization for AI" → Store Metadata tab to configure store description, keywords, business information, contact details, ',t.jsx("strong",{children:"shipping regions, supported currencies, languages, and policies"}),". This data is used by AI bots and the AI Shopping Assistant to accurately answer customer questions about delivery, returns, and more."]}),t.jsx(c,{variant:"bodyMd",fontWeight:"semibold",children:"6. Schema Data & Advanced Features"}),t.jsx(c,{variant:"bodyMd",tone:"subdued",children:'Go to "Store Optimization for AI" → Schema Data tab:'}),t.jsx(c,{variant:"bodyMd",tone:"subdued",children:"• Copy basic schema Liquid code to your theme (reads from metafields)"}),t.jsxs(c,{variant:"bodyMd",tone:"subdued",children:["• ",t.jsx("strong",{children:"Advanced Schema Data:"})," Generate rich AI-enhanced structured data markup (Plus plans: Professional Plus, Growth Plus, Growth Extra, Enterprise)"]}),t.jsx(c,{variant:"bodyMd",fontWeight:"semibold",children:"7. Configure AI Discovery Settings"}),t.jsx(c,{variant:"bodyMd",tone:"subdued",children:'Visit "AI Discovery Features" to configure:'}),t.jsxs(c,{variant:"bodyMd",tone:"subdued",children:["• ",t.jsx("strong",{children:"AI Bot Access Control:"})," Select which AI bots (OpenAI, Claude, Google, etc.) can access your store's structured data"]}),t.jsxs(c,{variant:"bodyMd",tone:"subdued",children:["• ",t.jsx("strong",{children:"AI Discovery Features:"})," Enable Products JSON Feed, Collections JSON Feed, Store Metadata, AI Welcome Page, and ",t.jsx("strong",{children:"llms.txt"})]}),t.jsxs(c,{variant:"bodyMd",tone:"subdued",children:["• ",t.jsx("strong",{children:"MCP Server:"})," Automatically available — allows AI agents to search products, browse collections, get store info, and answer questions directly through the Model Context Protocol"]}),t.jsxs(c,{variant:"bodyMd",tone:"subdued",children:["• Click ",t.jsx("strong",{children:'"Save Settings"'})," to save your configuration"]}),t.jsx(c,{variant:"bodyMd",fontWeight:"semibold",children:"8. Install robots.txt (REQUIRED)"}),t.jsxs(c,{variant:"bodyMd",tone:"subdued",children:[t.jsx("strong",{children:"Critical:"})," After saving Settings, you must manually install robots.txt in your theme for AI bots to access your endpoints:"]}),t.jsxs(c,{variant:"bodyMd",tone:"subdued",children:['• In AI Discovery Features, scroll to "robots.txt Configuration" section and click ',t.jsx("strong",{children:'"View & Copy robots.txt Code"'})]}),t.jsx(c,{variant:"bodyMd",tone:"subdued",children:"• Copy the generated robots.txt content"}),t.jsxs(c,{variant:"bodyMd",tone:"subdued",children:["• Go to ",t.jsx("strong",{children:"Online Store → Themes"})," → ",t.jsx("strong",{children:"Actions → Edit code"})," on your active theme"]}),t.jsxs(c,{variant:"bodyMd",tone:"subdued",children:["• Click ",t.jsx("strong",{children:'"Add a new file"'})," and type: ",t.jsx("code",{children:"templates/robots.txt.liquid"})]}),t.jsxs(c,{variant:"bodyMd",tone:"subdued",children:["• Paste the copied content and click ",t.jsx("strong",{children:"Save"})]}),t.jsx(c,{variant:"bodyMd",tone:"subdued",children:t.jsx("strong",{children:"Without this step, AI bots cannot discover your store's endpoints!"})}),t.jsx(c,{variant:"bodyMd",fontWeight:"semibold",children:"9. AI Testing"}),t.jsx(c,{variant:"bodyMd",tone:"subdued",children:'Go to "AI Testing" to validate your optimization:'}),t.jsxs(c,{variant:"bodyMd",tone:"subdued",children:["• Run ",t.jsx("strong",{children:"Basic Tests"})," to check endpoint availability (including llms.txt and MCP Server)"]}),t.jsxs(c,{variant:"bodyMd",tone:"subdued",children:["• Check your ",t.jsx("strong",{children:"GEO Score"})," — measures overall AI-readiness across all endpoints"]}),t.jsxs(c,{variant:"bodyMd",tone:"subdued",children:["• Use the ",t.jsx("strong",{children:"AI Shopping Assistant"})," to test how AI models (GPT-5 Mini, Gemini 3 Flash, Claude Haiku 4.5, Llama 4, Perplexity Sonar) answer customer questions using your real store data, products, policies, and shipping info"]}),t.jsx(c,{variant:"bodyMd",fontWeight:"semibold",children:"10. Monitor & Improve"}),t.jsxs(c,{variant:"bodyMd",tone:"subdued",children:["Return to Dashboard regularly to track your GEO Score and ",t.jsx("strong",{children:"AI Traffic"})," — see which AI bots (ChatGPT, Claude, Gemini, Perplexity, etc.) visit your store, which endpoints they access, and how traffic trends over time. Re-optimize when adding new products or updating policies to keep your AI presence current."]})]})]}),t.jsx(d,{paddingBlockStart:"200",children:t.jsxs(h,{gap:"200",children:[t.jsx(p,{variant:"primary",onClick:()=>B("/ai-seo/products"),children:"Start Optimizing"}),t.jsx(p,{onClick:()=>B("/billing"),children:"View Plans"})]})})]})})})]})})}),He&&t.jsx(a.Section,{children:t.jsx(m,{title:"Sync your store",tone:"info",action:{content:ee?"Syncing...":"Sync Now",onAction:Be,loading:ee},children:t.jsxs(u,{gap:"200",children:[t.jsx(c,{children:"Sync products, collections, languages, and markets to get started with AI optimization."}),ee&&t.jsxs(d,{paddingBlockStart:"200",children:[t.jsx(b,{progress:50,size:"small",tone:"highlight"}),t.jsx(d,{paddingBlockStart:"100",children:t.jsx(c,{variant:"bodySm",tone:"subdued",children:"Fetching store data..."})})]})]})})}),!He&&K&&t.jsx(a.Section,{children:t.jsx(l,{children:se?t.jsxs(u,{gap:"300",children:[t.jsxs(h,{align:"space-between",blockAlign:"center",children:[t.jsxs("div",{children:[t.jsx(c,{variant:"bodyMd",fontWeight:"semibold",children:"Store Sync"}),t.jsx(d,{paddingBlockStart:"050",children:t.jsxs(c,{variant:"bodySm",tone:"subdued",children:["Last synced: ",K.lastSyncDate?new Date(K.lastSyncDate).toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"Never"]})})]}),t.jsxs(h,{gap:"200",children:[t.jsx(p,{onClick:Be,loading:ee,children:"Sync Now"}),t.jsx(p,{onClick:()=>{oe(!1);try{localStorage.setItem(`syncCardExpanded_${L}`,"false")}catch(e){}},variant:"plain",children:"Close"})]})]}),t.jsx(x,{}),t.jsx(v,{label:"Auto-sync on load",checked:ne,onChange:async e=>{try{s("[Dashboard] Toggling auto-sync to:",e),ie(e);const t=await W(`/api/dashboard/auto-sync?shop=${L}`,{method:"POST",body:{enabled:e}});s("[Dashboard] Auto-sync toggle response:",t),(null==t?void 0:t.success)&&(ie(!!t.autoSyncEnabled),Z({...K||{},autoSyncEnabled:!!t.autoSyncEnabled}))}catch(t){ie(!e)}},helpText:"Automatically sync store data when you open the dashboard"})]}):t.jsxs(h,{align:"space-between",blockAlign:"center",gap:"400",children:[t.jsxs(h,{gap:"200",blockAlign:"center",children:[ne&&t.jsx(y,{tone:"success",children:"Auto-sync enabled"}),t.jsxs(c,{variant:"bodySm",tone:"subdued",children:["Last synced: ",K.lastSyncDate?new Date(K.lastSyncDate).toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"Never"]})]}),t.jsxs(h,{gap:"200",children:[t.jsx(p,{onClick:Be,loading:ee,size:"slim",children:"Sync Now"}),t.jsx(p,{onClick:()=>{oe(!0);try{localStorage.setItem(`syncCardExpanded_${L}`,"true")}catch(e){}},size:"slim",variant:"plain",children:"Expand"})]})]})})}),Ue&&!ue&&t.jsx(a.Section,{children:t.jsx(m,{title:`Upgrade to ${Ue.planName} Plan`,tone:"warning",action:{content:"View Plans",onAction:()=>B("/billing")},onDismiss:()=>{try{localStorage.setItem(`dismissedUpgradeBanner_${L}`,"true"),he(!0)}catch(e){}},children:t.jsxs(u,{gap:"200",children:[t.jsx(c,{children:Ue.reason}),t.jsxs(c,{variant:"bodySm",tone:"subdued",children:["The ",Ue.planName," plan supports up to ",Ue.productLimit," products in ",Ue.languageLimit," language",Ue.languageLimit>1?"s":""," for $",Ue.price,"/month."]})]})})}),Ve&&!pe&&t.jsx(a.Section,{children:t.jsx(m,{title:"Buy Tokens to Unlock AI Features",tone:"info",action:{content:"Buy Tokens",onAction:()=>De(!0)},onDismiss:()=>{try{localStorage.setItem(`dismissedTokenBanner_${L}`,"true"),ge(!0)}catch(e){}},children:t.jsx(c,{children:"Purchase tokens to access AI-enhanced optimization features like AEO generation, AI Discovery and more."})})}),Ye&&t.jsx(a.Section,{children:t.jsx(m,{title:"Help shape the future of AI Search",tone:"success",action:{content:"Rate indexAIze",onAction:()=>{try{localStorage.setItem(`clickedReviewRate_${L}`,"true"),ye(!0),window.open("https://apps.shopify.com/indexaize-unlock-ai-search#modal-show=WriteReviewModal","_blank")}catch(e){}}},onDismiss:()=>{try{localStorage.setItem(`dismissedReviewBanner_${L}`,"true"),me(!0)}catch(e){}},children:t.jsx(c,{children:"You've successfully optimized your store for AI engines. Your feedback helps us build better tools for the Shopify community."})})}),t.jsx(a.Section,{children:t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(320px, 1fr))",gap:"16px"},children:[t.jsx("div",{style:{display:"grid",gap:16},children:t.jsx(l,{children:t.jsxs(u,{gap:"400",children:[t.jsx(c,{variant:"headingMd",children:"Products & Collections"}),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(220px, 1fr))",gap:12},children:[t.jsxs(u,{gap:"150",children:[t.jsx(c,{variant:"bodyMd",fontWeight:"semibold",children:"Products"}),t.jsxs(h,{align:"space-between",children:[t.jsx(c,{variant:"bodySm",tone:"subdued",children:"Total"}),t.jsx(c,{variant:"bodySm",fontWeight:"semibold",children:(null==(A=null==R?void 0:R.products)?void 0:A.total)||0})]}),t.jsxs(h,{align:"space-between",children:[t.jsx(c,{variant:"bodySm",tone:"subdued",children:"Optimized"}),t.jsx(c,{variant:"bodySm",fontWeight:"semibold",tone:"success",children:(null==(w=null==R?void 0:R.products)?void 0:w.optimized)||0})]}),t.jsxs(h,{align:"space-between",children:[t.jsx(c,{variant:"bodySm",tone:"subdued",children:"Unoptimized"}),t.jsx(c,{variant:"bodySm",fontWeight:"semibold",children:Math.max(((null==(I=null==R?void 0:R.products)?void 0:I.total)||0)-((null==(k=null==R?void 0:R.products)?void 0:k.optimized)||0),0)})]}),t.jsxs(d,{paddingBlockStart:"100",children:[t.jsx(b,{progress:Ee,size:"small",tone:100===Ee?"success":"primary"}),t.jsx(d,{paddingBlockStart:"050",children:t.jsxs(c,{variant:"bodySm",tone:"subdued",children:[Ee,"% optimized"]})})]})]}),t.jsxs(u,{gap:"150",children:[t.jsx(c,{variant:"bodyMd",fontWeight:"semibold",children:"Collections"}),t.jsxs(h,{align:"space-between",children:[t.jsx(c,{variant:"bodySm",tone:"subdued",children:"Total"}),t.jsx(c,{variant:"bodySm",fontWeight:"semibold",children:(null==(M=null==R?void 0:R.collections)?void 0:M.total)||0})]}),t.jsxs(h,{align:"space-between",children:[t.jsx(c,{variant:"bodySm",tone:"subdued",children:"Optimized"}),t.jsx(c,{variant:"bodySm",fontWeight:"semibold",tone:"success",children:(null==(C=null==R?void 0:R.collections)?void 0:C.optimized)||0})]}),t.jsxs(h,{align:"space-between",children:[t.jsx(c,{variant:"bodySm",tone:"subdued",children:"Unoptimized"}),t.jsx(c,{variant:"bodySm",fontWeight:"semibold",children:Math.max(((null==(P=null==R?void 0:R.collections)?void 0:P.total)||0)-((null==(z=null==R?void 0:R.collections)?void 0:z.optimized)||0),0)})]}),t.jsxs(d,{paddingBlockStart:"100",children:[t.jsx(b,{progress:Ge,size:"small",tone:100===Ge?"success":"primary"}),t.jsx(d,{paddingBlockStart:"050",children:t.jsxs(c,{variant:"bodySm",tone:"subdued",children:[Ge,"% optimized"]})})]})]})]}),t.jsx(x,{}),t.jsx(h,{align:"space-between",children:t.jsxs(c,{variant:"bodySm",tone:"subdued",children:["Last synced: ",(null==K?void 0:K.lastSyncDate)?new Date(K.lastSyncDate).toLocaleString():"Never"]})})]})})}),t.jsxs("div",{style:{display:"grid",gap:16},children:[t.jsx(l,{children:t.jsxs(u,{gap:"400",children:[t.jsx(c,{variant:"headingMd",children:"Languages & Markets"}),t.jsx(u,{gap:"200",children:(null==R?void 0:R.languages)&&R.languages.length>0?t.jsxs(t.Fragment,{children:[R.languages.slice().sort((e,t)=>(t.primary?1:0)-(e.primary?1:0)||(t.totalCount||0)-(e.totalCount||0)).slice(0,3).map((e,n)=>{const i=e.totalCount>0?Math.round(e.optimizedCount/e.totalCount*100):0;return t.jsxs(u,{gap:"050",children:[t.jsxs(h,{align:"space-between",children:[t.jsxs(c,{variant:"bodyMd",tone:"subdued",children:[e.name||e.code," ",e.primary?"★":""]}),t.jsxs(c,{variant:"bodySm",fontWeight:"semibold",children:[e.optimizedCount||0,"/",e.totalCount||0]})]}),t.jsx(b,{progress:i,size:"small",tone:100===i?"success":"primary"})]},n)}),R.languages.length>3&&t.jsxs(c,{variant:"bodySm",tone:"subdued",children:["+",R.languages.length-3," more..."]})]}):t.jsx(c,{variant:"bodyMd",tone:"subdued",children:"No language data"})}),(null==R?void 0:R.storeMarkets)&&R.storeMarkets.length>0&&t.jsxs(d,{paddingBlockStart:"200",children:[t.jsx(x,{}),t.jsx(d,{paddingBlockStart:"200",children:t.jsxs(c,{variant:"bodySm",tone:"subdued",children:["Markets: ",R.storeMarkets.slice(0,2).map(e=>e.name).join(", "),R.storeMarkets.length>2?" +"+(R.storeMarkets.length-2):""]})})]})]})}),t.jsx(l,{children:t.jsxs(u,{gap:"300",children:[t.jsx(c,{variant:"headingMd",children:"Last Optimization"}),t.jsx(c,{variant:"bodyLg",fontWeight:"semibold",children:(null==R?void 0:R.lastOptimization)?new Date(R.lastOptimization).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"Never"}),t.jsx(p,{onClick:()=>B("/ai-seo/products"),children:"Optimize Now"})]})})]})]})}),t.jsx(a.Section,{children:t.jsx(o,{testResults:q,aiTestResults:Q,stats:(()=>{var e,t,n,i;if(R)return{totalProducts:(null==(e=null==R?void 0:R.products)?void 0:e.total)||0,optimizedProducts:(null==(t=null==R?void 0:R.products)?void 0:t.optimized)||0,totalCollections:(null==(n=null==R?void 0:R.collections)?void 0:n.total)||0,optimizedCollections:(null==(i=null==R?void 0:R.collections)?void 0:i.optimized)||0};try{const e=localStorage.getItem(`dashboard-stats-${L}`);if(e){const t=JSON.parse(e);return{totalProducts:t.totalProducts||0,optimizedProducts:t.optimizedProducts||0,totalCollections:t.totalCollections||0,optimizedCollections:t.optimizedCollections||0}}}catch(s){}return{totalProducts:0,optimizedProducts:0,totalCollections:0,optimizedCollections:0}})(),shop:L,api:W,onTestsComplete:e=>{J(e),Le(!0)},onScoreCalculated:e=>je(e)})}),t.jsx(a.Section,{children:t.jsx(l,{children:t.jsxs(u,{gap:"400",children:[t.jsxs(h,{align:"space-between",blockAlign:"center",wrap:!1,children:[t.jsx(c,{variant:"headingMd",children:"AI Traffic"}),t.jsx(h,{gap:"200",blockAlign:"center",children:[{value:"today",label:"Today"},{value:"yesterday",label:"Yesterday"},{value:"7d",label:"7 days"},{value:"30d",label:"30 days"}].map(e=>t.jsx("button",{onClick:()=>{we(e.value),Oe(e.value,Ie)},style:{padding:"4px 10px",borderRadius:"6px",border:Ae===e.value?"1px solid #5c6ac4":"1px solid #d2d5d8",background:Ae===e.value?"#f4f5ff":"#fff",color:Ae===e.value?"#5c6ac4":"#616161",fontSize:"12px",fontWeight:Ae===e.value?600:400,cursor:"pointer",lineHeight:"20px"},children:e.label},e.value))})]}),t.jsx(v,{label:"Compare to previous period",checked:Ie,onChange:e=>{ke(e),Oe(Ae,e)}}),Pe?t.jsx(c,{variant:"bodySm",tone:"subdued",children:"Loading analytics..."}):Se&&0!==Se.totalVisits?t.jsxs(u,{gap:"400",children:[t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(140px, 1fr))",gap:"12px"},children:[t.jsxs("div",{style:{padding:"12px",background:"#f6f6f7",borderRadius:"8px",textAlign:"center"},children:[t.jsx(c,{variant:"headingLg",fontWeight:"bold",children:Se.totalVisits.toLocaleString()}),t.jsx(c,{variant:"bodySm",tone:"subdued",children:"AI & Search Visits"}),Ie&&Se.comparison&&t.jsxs(c,{variant:"bodySm",tone:"subdued",children:["vs ",Se.comparison.totalVisits.toLocaleString()]})]}),t.jsxs("div",{style:{padding:"12px",background:"#f6f6f7",borderRadius:"8px",textAlign:"center"},children:[t.jsx(c,{variant:"headingLg",fontWeight:"bold",children:Se.uniqueBots}),t.jsx(c,{variant:"bodySm",tone:"subdued",children:"Services Reading Your Data"}),Ie&&Se.comparison&&t.jsxs(c,{variant:"bodySm",tone:"subdued",children:["vs ",Se.comparison.uniqueBots]})]}),t.jsxs("div",{style:{padding:"12px",background:"#f6f6f7",borderRadius:"8px",textAlign:"center"},children:[t.jsxs(c,{variant:"headingLg",fontWeight:"bold",tone:Se.trend>0?"success":Se.trend<0?"critical":void 0,children:[Se.trend>0?"+":"",Se.trend,"%"]}),t.jsx(c,{variant:"bodySm",tone:"subdued",children:"Growth vs Last Period"})]})]}),(()=>{var e;const n="30d"===Ae?30:7,i={};(Se.dailyVisits||[]).forEach(e=>{i[e.date]=e.visits});const s={};Ie&&(null==(e=Se.comparison)?void 0:e.dailyVisits)&&Se.comparison.dailyVisits.forEach(e=>{s[e.date]=e.visits});const o=[],r=[];for(let t=n-1;t>=0;t--){const e=new Date;e.setDate(e.getDate()-t);const n=e.toISOString().split("T")[0];o.push({date:n,visits:i[n]||0})}if(Ie)for(let t=2*n-1;t>=n;t--){const e=new Date;e.setDate(e.getDate()-t);const n=e.toISOString().split("T")[0];r.push({date:n,visits:s[n]||0})}const a=[...o.map(e=>e.visits),...r.map(e=>e.visits)],l=Math.max(...a,1),d=e=>{if(!e)return"";const[,t,n]=e.split("-");return`${parseInt(n)}/${parseInt(t)}`},u=n<=7?n:5,p=[];for(let t=0;t<u;t++)p.push(Math.round(t*(o.length-1)/(u-1)));return t.jsxs("div",{children:[t.jsxs(h,{align:"space-between",blockAlign:"center",children:[t.jsx(c,{variant:"bodySm",fontWeight:"semibold",children:"Daily Visits"}),Ie&&t.jsxs(h,{gap:"300",blockAlign:"center",children:[t.jsxs(h,{gap:"100",blockAlign:"center",children:[t.jsx("div",{style:{width:10,height:10,borderRadius:2,background:"#5c6ac4"}}),t.jsx(c,{variant:"bodySm",tone:"subdued",children:"Current"})]}),t.jsxs(h,{gap:"100",blockAlign:"center",children:[t.jsx("div",{style:{width:10,height:10,borderRadius:2,background:"#c4c7e0"}}),t.jsx(c,{variant:"bodySm",tone:"subdued",children:"Previous"})]})]})]}),t.jsxs("div",{style:{position:"relative",marginTop:"8px"},children:[t.jsx("div",{style:{display:"flex",alignItems:"flex-end",gap:Ie?"2px":"1px",height:"120px"},children:o.map((e,n)=>{const i=e.visits>0?Math.max(8,e.visits/l*100):0,s=r[n],o=s&&s.visits>0?Math.max(8,s.visits/l*100):0;return t.jsxs("div",{style:{flex:1,display:"flex",flexDirection:"column",alignItems:"center",gap:0},children:[e.visits>0&&t.jsx("div",{style:{fontSize:"9px",color:"#616161",fontWeight:600,marginBottom:"2px",lineHeight:1},children:e.visits}),t.jsxs("div",{style:{display:"flex",alignItems:"flex-end",gap:"1px",width:"100%",height:"100px"},children:[Ie&&t.jsx("div",{title:s?`Prev ${d(s.date)}: ${s.visits}`:"",style:{flex:1,height:s&&s.visits>0?`${o}%`:"2px",background:s&&s.visits>0?"#c4c7e0":"#eeeff1",borderRadius:s&&s.visits>0?"2px 2px 0 0":"1px",transition:"height 0.2s ease"}}),t.jsx("div",{title:`${d(e.date)}: ${e.visits} visits`,style:{flex:1,height:e.visits>0?`${i}%`:"2px",background:e.visits>0?"#5c6ac4":"#e4e5e7",borderRadius:e.visits>0?"2px 2px 0 0":"1px",transition:"height 0.2s ease"}})]})]},e.date)})}),t.jsx("div",{style:{display:"flex",justifyContent:1===o.length?"center":"space-between",marginTop:"4px"},children:p.map(e=>{var n;return t.jsx(c,{variant:"bodySm",tone:"subdued",children:d((null==(n=o[e])?void 0:n.date)||"")},e)})})]})]})})(),t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px"},children:[t.jsxs("div",{children:[t.jsx(c,{variant:"bodySm",fontWeight:"semibold",children:"Who's Visiting Your Store"}),t.jsx("div",{style:{marginTop:"8px"},children:t.jsx(u,{gap:"300",children:null==(T=Se.topBots)?void 0:T.filter(e=>"Human/Unknown"!==e.name&&"indexAIze Test"!==e.name).slice(0,5).map(e=>{var n,i;const s=(o=e.name,Me[o]||{label:o,desc:""});var o;const r=Ie&&(null==(i=null==(n=Se.comparison)?void 0:n.topBots)?void 0:i.find(t=>t.name===e.name)),a=r?e.visits-r.visits:null;return t.jsxs(h,{align:"space-between",blockAlign:"start",children:[t.jsxs(u,{gap:"0",children:[t.jsx(c,{variant:"bodySm",fontWeight:"medium",children:s.label}),t.jsx(c,{variant:"bodySm",tone:"subdued",children:s.desc})]}),t.jsxs(h,{gap:"100",blockAlign:"center",children:[t.jsx(c,{variant:"bodySm",fontWeight:"semibold",children:e.visits}),null!==a&&0!==a&&t.jsxs(c,{variant:"bodySm",tone:a>0?"success":"critical",children:[a>0?"+":"",a]})]})]},e.name)})})})]}),t.jsxs("div",{children:[t.jsx(c,{variant:"bodySm",fontWeight:"semibold",children:"What They're Reading"}),t.jsx("div",{style:{marginTop:"8px"},children:t.jsx(u,{gap:"300",children:null==(D=Se.topEndpoints)?void 0:D.slice(0,5).map(e=>{var n,i;const s=Ie&&(null==(i=null==(n=Se.comparison)?void 0:n.topEndpoints)?void 0:i.find(t=>t.endpoint===e.endpoint)),o=s?e.visits-s.visits:null;return t.jsxs(h,{align:"space-between",blockAlign:"center",children:[t.jsx(c,{variant:"bodySm",children:(r=e.endpoint,Ce[r]||r)}),t.jsxs(h,{gap:"100",blockAlign:"center",children:[t.jsx(c,{variant:"bodySm",fontWeight:"semibold",children:e.visits}),null!==o&&0!==o&&t.jsxs(c,{variant:"bodySm",tone:o>0?"success":"critical",children:[o>0?"+":"",o]})]})]},e.endpoint);var r})})})]})]})]}):t.jsx(m,{tone:"info",children:t.jsxs("p",{children:["AI bots haven't discovered your store yet. Make sure ",t.jsx("strong",{children:"AI Discovery Features"})," are enabled in Settings to attract AI crawlers."]})})]})})}),t.jsx(a.Section,{children:t.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(320px, 1fr))",gap:"16px"},children:[t.jsx(l,{style:{height:220,minHeight:220},children:t.jsxs(u,{gap:"300",children:[t.jsxs(h,{align:"space-between",blockAlign:"center",children:[t.jsxs("div",{children:[t.jsx(c,{variant:"headingMd",children:"Current Plan"}),t.jsx(d,{paddingBlockStart:"100",children:t.jsxs(c,{variant:"bodySm",tone:"subdued",children:[_e?`$${_e.toFixed(2)}`:"—","/month"]})})]}),t.jsx(y,{tone:"info",size:"large",children:(null==($=null==N?void 0:N.plan)?void 0:$.replace("_"," ").toUpperCase())||"N/A"})]}),t.jsx(p,{onClick:()=>B("/billing"),children:"View Plans & Billing"})]})}),t.jsx(l,{style:{height:220,minHeight:220},children:t.jsxs(u,{gap:"300",children:[t.jsx(c,{variant:"headingMd",children:"Token Balance"}),t.jsxs(c,{variant:"bodyLg",fontWeight:"semibold",children:[(null==(O=null==U?void 0:U.balance)?void 0:O.toLocaleString())||0," tokens"]}),("growth_extra"===(null==N?void 0:N.plan)||"enterprise"===(null==N?void 0:N.plan))&&t.jsxs(c,{variant:"bodySm",tone:"subdued",children:["growth_extra"===(null==N?void 0:N.plan)?"100M":"300M"," included monthly"]}),t.jsx(p,{onClick:()=>B("/billing"),children:"Manage Tokens"})]})})]})}),t.jsx(r,{open:Te,onClose:()=>De(!1),shop:L,returnTo:"/dashboard",onPurchaseComplete:()=>{De(!1),Le(!0)}}),t.jsx(a.Section,{children:t.jsx("div",{style:{textAlign:"center",padding:"12px 0 4px"},children:t.jsx(c,{variant:"bodySm",tone:"subdued",children:"indexAIze v1.2.0"})})})]})}export{j as default};
