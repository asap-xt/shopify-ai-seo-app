import{_ as Z,t as X,c as ye,a as v,M as q,h as be,e as _e,P as me,C as Ae,W as Oe,g as Pe}from"./index-KS7CTtI6-1757513318316.js";function we(e,n){for(var u=0;u<n.length;u++){const c=n[u];if(typeof c!="string"&&!Array.isArray(c)){for(const i in c)if(i!=="default"&&!(i in e)){const a=Object.getOwnPropertyDescriptor(c,i);a&&Object.defineProperty(e,i,a.get?a:{enumerable:!0,get:()=>c[i]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}var x={exports:{}},ee={},U={},k={},D={};Object.defineProperty(D,"__esModule",{value:!0});D.mockAppBridge=D.serverAppBridge=void 0;var R=Z,B=function(){},Y=new Promise(function(){});D.serverAppBridge={dispatch:function(){return{}},error:function(){return B},featuresAvailable:function(){return Promise.reject(R.fromAction("Feature detection is only available on the client side.",R.AppActionType.WINDOW_UNDEFINED))},getState:function(){return Promise.reject(R.fromAction("State is only available on the client side.",R.AppActionType.WINDOW_UNDEFINED))},localOrigin:"",hostOrigin:"",subscribe:function(){return B}};D.mockAppBridge={dispatch:function(){return{}},error:function(){return B},featuresAvailable:function(){return Y},getState:function(){return Y},localOrigin:"",hostOrigin:"",subscribe:function(){return B}};var H={},y={};Object.defineProperty(y,"__esModule",{value:!0});y.getWindow=y.getLocation=y.redirect=y.shouldRedirect=void 0;function je(e){return e===window}y.shouldRedirect=je;function De(e){var n=re();n&&n.assign(e)}y.redirect=De;function re(){return te()?window.location:void 0}y.getLocation=re;function We(){return te()?window:void 0}y.getWindow=We;function te(){return typeof window<"u"}Object.defineProperty(H,"__esModule",{value:!0});H.handleAppPrint=void 0;var ne=y;function Ce(){return navigator.userAgent.indexOf("iOS")>=0}function Ee(){var e=ne.getWindow();if(!(!e||!e.document||!e.document.body)){var n=e.document.createElement("input");return n.style.display="none",e.document.body.appendChild(n),n}}function ie(){var e;(e=ne.getWindow())===null||e===void 0||e.print()}function Ie(){var e=Ee();e&&(e.select(),ie(),e.remove())}function Me(){Ce()?Ie():ie()}H.handleAppPrint=Me;var $={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.isV1Config=e.MessageType=e.LifecycleHook=e.PermissionType=void 0;var n=X;Object.defineProperty(e,"MessageType",{enumerable:!0,get:function(){return n.MessageType}});var u=X;Object.defineProperty(e,"PermissionType",{enumerable:!0,get:function(){return u.PermissionType}}),Object.defineProperty(e,"LifecycleHook",{enumerable:!0,get:function(){return u.LifecycleHook}});function c(i){return!i.host}e.isV1Config=c})($);var z={},oe={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.removeFromCollection=e.addAndRemoveFromCollection=void 0;var n=ye;Object.defineProperty(e,"addAndRemoveFromCollection",{enumerable:!0,get:function(){return n.addAndRemoveFromCollection}}),Object.defineProperty(e,"removeFromCollection",{enumerable:!0,get:function(){return n.removeFromCollection}})})(oe);Object.defineProperty(z,"__esModule",{value:!0});var Ne=oe,Se=function(){function e(){this.map={}}return e.prototype.set=function(n,u){Object.prototype.hasOwnProperty.call(this.map,n)||(this.map[n]=[]);var c={handler:u,remove:function(){}},i=Ne.addAndRemoveFromCollection(this.map[n],c);return c={handler:u,remove:i},i},e.prototype.get=function(n){var u=this.map[n];return u?u.map(function(c){return c.handler}):void 0},e.prototype.run=function(n,u,c){for(var i=[],a=3;a<arguments.length;a++)i[a-3]=arguments[a];var t=0,l=this.get(n)||[];function W(){for(var P=[],w=0;w<arguments.length;w++)P[w]=arguments[w];var N=l[t++];return N?N(W).apply(c,P):u.apply(c,P)}return W.apply(c,i)},e}();z.default=Se;(function(e){var n=v&&v.__assign||function(){return n=Object.assign||function(r){for(var o,f=1,p=arguments.length;f<p;f++){o=arguments[f];for(var d in o)Object.prototype.hasOwnProperty.call(o,d)&&(r[d]=o[d])}return r},n.apply(this,arguments)},u=v&&v.__spreadArray||function(r,o){for(var f=0,p=o.length,d=r.length;f<p;f++,d++)r[d]=o[f];return r},c=v&&v.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(e,"__esModule",{value:!0}),e.createApp=e.createAppWrapper=e.createClientApp=e.WINDOW_UNDEFINED_MESSAGE=void 0;var i=be,a=me,t=Z,l=q,W=D,P=_e,w=Ae,N=Oe,ue=H,C=y,E=$,ce=c(z);e.WINDOW_UNDEFINED_MESSAGE="window is not defined. Running an app outside a browser is not supported";function fe(r,o){var f=o.apiKey,p=o.host,d=o.forceRedirect,A=d===void 0?!P.isDevelopmentClient:d,h=C.getLocation();if(P.isUnframed||!h||!f||!p||!A||!C.shouldRedirect(r))return!1;var I="https://"+p+"/apps/"+f+h.pathname+(h.search||"");return C.redirect(I),!0}var le=function(r){return function(o){return r(n(n({},o),{version:i.getVersion(),clientInterface:{name:i.getPackageName(),version:i.getVersion()}}))}},pe=function(r){r.set(E.LifecycleHook.DispatchAction,le)};function se(r){r.subscribe(a.Action.APP,ue.handleAppPrint),r.dispatch(w.initialize());try{N.initializeWebVitals(r)}catch(o){console.error("App-Bridge failed to initialize web-vitals",o)}}var de=function(r,o){o===void 0&&(o=[]);var f=[],p=l.createTransportListener(),d=function(A){var h=A.data,I=h.type,b=h.payload;switch(I){case"getState":{var S=f.splice(0);S.forEach(function(T){return T(b)});break}case"dispatch":{p.handleMessage(b);var F=p.handleActionDispatch(b);if(F)return;var L=i.findMatchInEnum(t.Action,b.type);L&&t.throwError(L,b);break}}};return r.subscribe(d),function(A){var h=ve(A),I=fe(r.hostFrame,h);if(I)return W.mockAppBridge;var b=ge(r,h),S=p.createSubscribeHandler(b);b(E.MessageType.Unsubscribe);function F(s){return b(E.MessageType.Dispatch,s),s}for(var L=new URL("https://"+h.host).origin,T=new ce.default,O={hostOrigin:L,localOrigin:r.localOrigin,hooks:T,dispatch:function(s){return O.hooks?O.hooks.run(E.LifecycleHook.DispatchAction,F,O,s):F(s)},featuresAvailable:function(){for(var s=[],_=0;_<arguments.length;_++)s[_]=arguments[_];var g=s[0],m=Array.isArray(g)?u([],g):s;return O.getState("features").then(function(j){return m.length?m.reduce(function(M,G){return Object.keys(j).includes(G)&&(M[G]=j[G]),M},{}):j})},getState:function(s){return s&&typeof s!="string"?Promise.resolve(void 0):new Promise(function(_){f.push(_),b(E.MessageType.GetState)}).then(function(_){var g=_;if(s)for(var m=0,j=s.split(".");m<j.length;m++){var M=j[m];if(g==null||typeof g!="object"||Array.isArray(g)||!Object.keys(g).includes(M))return;g=g[M]}return g})},subscribe:S,error:function(s,_){var g=[];return i.forEachInEnum(t.Action,function(m){g.push(S(m,s,_))}),function(){g.forEach(function(m){return m()})}}},V=0,Q=o;V<Q.length;V++){var he=Q[V];he(T,O)}return se(O),O}};e.createClientApp=de;function ve(r){var o;if(!r.host)throw t.fromAction("host must be provided",t.AppActionType.INVALID_CONFIG);if(!r.apiKey)throw t.fromAction("apiKey must be provided",t.AppActionType.INVALID_CONFIG);try{var f=atob((o=r.host)===null||o===void 0?void 0:o.replace(/_/g,"/").replace(/-/g,"+"));return n(n({},r),{host:f})}catch{var p="not a valid host, please use the value provided by Shopify";throw t.fromAction(p,t.AppActionType.INVALID_CONFIG)}}function K(r,o,f){if(f===void 0&&(f=[]),!r)throw t.fromAction(e.WINDOW_UNDEFINED_MESSAGE,t.AppActionType.WINDOW_UNDEFINED);var p=C.getLocation(),d=o||p&&p.origin;if(!d)throw t.fromAction("local origin cannot be blank",t.AppActionType.MISSING_LOCAL_ORIGIN);var A=l.fromWindow(r,d),h=e.createClientApp(A,u([pe],f));return h}e.createAppWrapper=K;function J(r){var o=C.getWindow();return!o||!o.top?W.serverAppBridge:K(o.top)(r)}e.createApp=J;function ge(r,o){return function(f,p){r.dispatch({payload:p,source:o,type:f})}}e.default=J})(k);(function(e){var n=v&&v.__createBinding||(Object.create?function(i,a,t,l){l===void 0&&(l=t),Object.defineProperty(i,l,{enumerable:!0,get:function(){return a[t]}})}:function(i,a,t,l){l===void 0&&(l=t),i[l]=a[t]}),u=v&&v.__exportStar||function(i,a){for(var t in i)t!=="default"&&!Object.prototype.hasOwnProperty.call(a,t)&&n(a,i,t)};Object.defineProperty(e,"__esModule",{value:!0});var c=k;u($,e),u(k,e),e.default=c.createClientApp})(U);(function(e){var n=v&&v.__createBinding||(Object.create?function(i,a,t,l){l===void 0&&(l=t),Object.defineProperty(i,l,{enumerable:!0,get:function(){return a[t]}})}:function(i,a,t,l){l===void 0&&(l=t),i[l]=a[t]}),u=v&&v.__exportStar||function(i,a){for(var t in i)t!=="default"&&!Object.prototype.hasOwnProperty.call(a,t)&&n(a,i,t)};Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var c=U;Object.defineProperty(e,"default",{enumerable:!0,get:function(){return c.createApp}}),u(q,e),u(U,e)})(ee);x.exports=ee;var ae=x.exports;const Fe=Pe(ae),Te=we({__proto__:null,default:Fe},[ae]);export{Te as i};
