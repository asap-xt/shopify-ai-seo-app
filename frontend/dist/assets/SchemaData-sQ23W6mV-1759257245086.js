import{j as e}from"./app-bridge-moAdBGen-1759257245086.js";import{r as u}from"./react-vendor-tAaa2TlE-1759257245086.js";import{m as _}from"./index-Bv-o9Fvl-1759257245086.js";import{C as h,a as r,d as i,r as F,T as n,h as w,t as J,I as l,g as T,B as o,u as d,i as G,D as L,k as z}from"./polaris-CpNFSSKz-1759257245086.js";const I=(x,a="")=>{try{return new URLSearchParams(window.location.search).get(x)||a}catch{return a}};function V({shop:x}){const a=x||I("shop","");console.log("[SCHEMA-DATA] shopProp:",x),console.log('[SCHEMA-DATA] qs("shop"):',I("shop","")),console.log("[SCHEMA-DATA] final shop:",a),console.log("[SCHEMA-DATA] window.location.search:",window.location.search);const[m,P]=u.useState(0),[v,j]=u.useState(!0),[p,M]=u.useState({organization:null,website:null,products:[]}),[C,g]=u.useState(""),S=u.useMemo(()=>_(),[]),[D,H]=u.useState(""),[b,k]=u.useState(null);u.useEffect(()=>{a&&(E(),O())},[a,S]);const O=async()=>{var s,t;try{const A=await S("/graphql",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:`
        query PlansMe($shop:String!) {
          plansMe(shop:$shop) {
            shop
            plan
            planKey
          }
        }
      `,variables:{shop:a}})});console.log("[SCHEMA-DATA] Plan data:",A),k((t=(s=A==null?void 0:A.data)==null?void 0:s.plansMe)==null?void 0:t.plan)}catch(c){console.error("[SCHEMA-DATA] Error loading plan:",c)}},f=s=>{if(console.log("[SCHEMA-DATA] isFeatureAvailable - currentPlan:",b),console.log("[SCHEMA-DATA] isFeatureAvailable - feature:",s),!b)return console.log("[SCHEMA-DATA] No current plan, returning false"),!1;const t=["Starter","Professional","Growth","Growth Extra","Enterprise"],c=t.indexOf(b);switch(console.log("[SCHEMA-DATA] Plan hierarchy:",t),console.log("[SCHEMA-DATA] Current plan index:",c),s){case"productsJson":return c>=0;case"welcomePage":return c>=2;case"collectionsJson":return c>=2;case"aiSitemap":return c>=3;case"schemaData":return c>=4;default:return!1}},y=s=>{switch(s){case"productsJson":return"Starter";case"welcomePage":return"Growth";case"collectionsJson":return"Growth";case"aiSitemap":return"Growth Extra";case"schemaData":return"Enterprise";default:return"Starter"}},E=async()=>{j(!0);try{console.log("[SCHEMA-DATA] loadSchemas - shop:",a);const s=`/api/schema/preview?shop=${encodeURIComponent(a)}`;console.log("[SCHEMA-DATA] loadSchemas - url:",s);const t=await S(s,{headers:{"X-Shop":a}});console.log("[SCHEMA-DATA] loadSchemas - response:",t),t.ok?(M(t.schemas),R(t.schemas)):g(`Error: ${t.error}`)}catch(s){console.error("[SCHEMA-DATA] loadSchemas - error:",s),g(`Failed to load schemas: ${s.message}`)}finally{j(!1)}},R=s=>{const t=[];s.organization&&t.push(s.organization),s.website&&t.push(s.website);const c=`<script type="application/ld+json">
${JSON.stringify(t,null,2)}
<\/script>`;H(c)},q=async()=>{j(!0);try{console.log("[SCHEMA-DATA] handleRegenerate - shop:",a);const s=`/api/schema/generate?shop=${encodeURIComponent(a)}`;console.log("[SCHEMA-DATA] handleRegenerate - url:",s);const t=await S(s,{method:"POST",headers:{"X-Shop":a},body:{shop:a}});console.log("[SCHEMA-DATA] handleRegenerate - response:",t),t.ok?(g("Schemas regenerated successfully!"),E()):g(`Error: ${t.error}`)}catch(s){console.error("[SCHEMA-DATA] handleRegenerate - error:",s),g(`Failed to regenerate: ${s.message}`)}finally{j(!1)}},$=[{id:"overview",content:"Overview",accessibilityLabel:"Overview"},{id:"installation",content:"Installation",accessibilityLabel:"Installation"},{id:"ai-testing",content:"AI Testing",accessibilityLabel:"AI Testing"}];return v?e.jsx(h,{children:e.jsx(r,{padding:"400",children:e.jsxs(i,{gap:"400",align:"center",children:[e.jsx(F,{}),e.jsx(n,{children:"Loading schema data..."})]})})}):e.jsxs(e.Fragment,{children:[e.jsx(h,{children:e.jsx(r,{padding:"400",children:e.jsxs(i,{gap:"400",children:[e.jsx(n,{as:"h3",variant:"headingMd",children:"Schema.org Structured Data"}),e.jsx(w,{tone:"info",children:e.jsx(n,{children:"Schema.org structured data helps AI models understand your store content better, improving your visibility and search results."})}),e.jsxs(J,{tabs:$,selected:m,onSelect:P,children:[m===0&&e.jsx(r,{paddingBlockStart:"400",children:e.jsxs(i,{gap:"400",children:[e.jsx(h,{children:e.jsx(r,{padding:"300",children:e.jsxs(i,{gap:"300",children:[e.jsxs(l,{align:"space-between",children:[e.jsx(n,{as:"h4",variant:"headingSm",children:"Organization Schema"}),e.jsx(T,{tone:p.organization?"success":"warning",children:p.organization?"Active":"Not configured"})]}),!p.organization&&e.jsx(n,{as:"p",tone:"subdued",children:"Configure organization details in Store Metadata to enable this schema."})]})})}),e.jsx(h,{children:e.jsx(r,{padding:"300",children:e.jsxs(i,{gap:"300",children:[e.jsxs(l,{align:"space-between",children:[e.jsx(n,{as:"h4",variant:"headingSm",children:"WebSite Schema"}),e.jsx(T,{tone:p.website?"success":"warning",children:p.website?"Active":"Not configured"})]}),!p.website&&e.jsx(n,{as:"p",tone:"subdued",children:"Website schema is automatically generated from your store information."})]})})}),e.jsx(h,{children:e.jsx(r,{padding:"300",children:e.jsxs(i,{gap:"300",children:[e.jsxs(l,{align:"space-between",children:[e.jsx(n,{as:"h4",variant:"headingSm",children:"Product Schemas"}),e.jsx(T,{tone:"success",children:"Auto-generated"})]}),e.jsxs(n,{tone:"subdued",children:["Product schemas are automatically generated from your AI Optimisation data when pages load.",p.products.length>0&&` ${p.products.length} products have SEO data.`]})]})})}),e.jsxs(l,{gap:"300",children:[e.jsx(o,{onClick:q,loading:v,children:"Regenerate Schemas"}),e.jsx(o,{variant:"plain",url:"https://developers.google.com/search/docs/appearance/structured-data",children:"Learn about Schema.org"})]})]})}),m===1&&e.jsx(r,{paddingBlockStart:"400",children:e.jsxs(i,{gap:"400",children:[e.jsx(h,{children:e.jsx(r,{padding:"300",children:e.jsxs(i,{gap:"300",children:[e.jsx(n,{as:"h4",variant:"headingSm",children:"Theme Installation"}),e.jsxs(d,{type:"number",children:[e.jsx(d.Item,{children:"Go to your Shopify Admin → Online Store → Themes"}),e.jsx(d.Item,{children:'Click "Actions" → "Edit code" on your current theme'}),e.jsxs(d.Item,{children:["Open the file: ",e.jsx("code",{children:"layout/theme.liquid"})]}),e.jsxs(d.Item,{children:["Add this code before the closing ",e.jsx("code",{children:"</head>"})," tag:"]})]}),e.jsx(r,{background:"bg-surface-secondary",padding:"200",borderRadius:"200",children:e.jsx("pre",{style:{fontSize:"12px",overflow:"auto",whiteSpace:"pre-wrap"},children:`{% comment %} Organization & WebSite Schema - AI SEO App {% endcomment %}
${D}

{% comment %} Product Schema - Dynamic {% endcomment %}
{% if template contains 'product' %}
  {% assign seo_bullets = product.metafields.seo_ai.bullets %}
  {% assign seo_faq = product.metafields.seo_ai.faq %}
  {% assign seo_data = product.metafields.seo_ai['seo__' | append: request.locale.iso_code] | default: product.metafields.seo_ai.seo__en %}
  
  {% if seo_data %}
    <script type="application/ld+json">
    {{ seo_data.jsonLd | json }}
    <\/script>
  {% endif %}
{% endif %}`})}),e.jsx(w,{tone:"warning",children:e.jsx(n,{children:"Always backup your theme before making changes!"})})]})})}),e.jsx(h,{children:e.jsx(r,{padding:"300",children:e.jsxs(i,{gap:"300",children:[e.jsx(n,{as:"h4",variant:"headingSm",children:"Testing Your Installation"}),e.jsxs(d,{children:[e.jsx(d.Item,{children:"After installation, visit your store's homepage and product pages"}),e.jsx(d.Item,{children:"View the page source (right-click → View Source)"}),e.jsxs(d.Item,{children:["Search for ",e.jsx("code",{children:"application/ld+json"})," to find your schemas"]}),e.jsx(d.Item,{children:"Use the Validation tab to test with Google's tools"})]})]})})})]})}),m===2&&e.jsx(r,{paddingBlockStart:"400",children:e.jsxs(i,{gap:"400",children:[e.jsx(h,{children:e.jsx(r,{padding:"300",children:e.jsxs(i,{gap:"300",children:[e.jsx(n,{as:"h4",variant:"headingSm",children:"AI Search Testing Tools"}),e.jsx(G,{label:"Test URL",value:`https://${a}`,readOnly:!0,helpText:"Use this URL to test how AI bots understand your store"}),e.jsx(L,{}),e.jsxs(i,{gap:"200",children:[e.jsxs(l,{align:"space-between",children:[e.jsx(n,{children:"Perplexity AI Search"}),e.jsx(o,{url:`https://www.perplexity.ai/search?q=What+products+does+${a}+sell%3F+Tell+me+about+this+business+and+what+they+offer`,external:!0,variant:"plain",children:"Test with Prompt"})]}),e.jsxs(l,{align:"space-between",children:[e.jsx(n,{children:"ChatGPT Web Search"}),e.jsx(o,{url:"https://chat.openai.com/",external:!0,variant:"plain",children:"Test with Prompt"})]}),e.jsxs(l,{align:"space-between",children:[e.jsx(n,{children:"Claude AI Search"}),e.jsx(o,{url:"https://claude.ai/",external:!0,variant:"plain",children:"Test with Prompt"})]}),e.jsxs(l,{align:"space-between",children:[e.jsx(n,{children:"Gemini AI Search"}),e.jsx(o,{url:"https://gemini.google.com/",external:!0,variant:"plain",children:"Test with Prompt"})]})]}),e.jsx(w,{tone:"info",children:e.jsxs(n,{children:[e.jsx("strong",{children:"Pre-filled prompts:"}),' Click "Test with Prompt" to open AI tools with pre-filled questions about your store. For ChatGPT, Claude, and Gemini, copy this prompt: "What products does ',a,' sell? Tell me about this business and what they offer."']})})]})})}),e.jsx(h,{children:e.jsx(r,{padding:"300",children:e.jsxs(i,{gap:"300",children:[e.jsx(n,{as:"h4",variant:"headingSm",children:"AI Bot Access Check"}),e.jsxs(l,{align:"space-between",children:[e.jsx(n,{children:"Test Products JSON Feed"}),f("productsJson")?e.jsx(o,{url:`https://${a}/apps/new-ai-seo/ai/products.json`,external:!0,variant:"plain",children:"View"}):e.jsxs(o,{disabled:!0,variant:"plain",children:[y("productsJson"),"+ Required"]})]}),e.jsxs(l,{align:"space-between",children:[e.jsx(n,{children:"Test AI Welcome Page"}),f("welcomePage")?e.jsx(o,{url:`https://${a}/apps/new-ai-seo/ai/welcome`,external:!0,variant:"plain",children:"View"}):e.jsxs(o,{disabled:!0,variant:"plain",children:[y("welcomePage"),"+ Required"]})]}),e.jsxs(l,{align:"space-between",children:[e.jsx(n,{children:"Test Collections JSON Feed"}),f("collectionsJson")?e.jsx(o,{url:`https://${a}/apps/new-ai-seo/ai/collections.json`,external:!0,variant:"plain",children:"View"}):e.jsxs(o,{disabled:!0,variant:"plain",children:[y("collectionsJson"),"+ Required"]})]}),e.jsx(w,{tone:"success",children:e.jsxs(n,{children:[e.jsx("strong",{children:"AI bots can access these endpoints"})," to understand your store structure, products, and business information. This helps them provide better answers about your business."]})})]})})})]})})]})]})})}),C&&e.jsx(z,{content:C,onDismiss:()=>g("")})]})}export{V as default};
