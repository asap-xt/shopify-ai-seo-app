import{r as e,j as s,R as n}from"./react-vendor-BXVC7v0l.js";import{m as t}from"./sessionFetch-7UAEpzQi.js";import{I as i,T as a}from"./TrialActivationModal-Cte_nKcm.js";import{A as r}from"./AIEOScoreCard-Bq94vkm_.js";import{g as o}from"./usePlanHierarchy-fXt-6sDq.js";import{a as l,d as c,T as d,L as h,C as u,B as g,I as p,b as x,e as j,f as m,D as b,h as v,k as y,M as S}from"./polaris-DIPq0--Z.js";import"./app-bridge-DUY42B6P.js";import"./vendor-Cs_VgJ2r.js";import"./index-BiWVhI8k.js";function w({shop:w}){const f=w||((e,s="")=>{try{return new URLSearchParams(window.location.search).get(e)||s}catch{return s}})("shop",""),[k,A]=e.useState(""),P=e.useMemo(()=>t(),[]),[I,C]=e.useState(null),[T,M]=e.useState(""),[R,$]=e.useState(!1),[q,O]=e.useState(null),[z,D]=e.useState(""),[J,U]=e.useState(!1),[F,L]=e.useState(!1),[E,W]=e.useState(!1),[G,B]=e.useState(null),[N,H]=e.useState(!1),[V,Y]=e.useState(null),[Q,K]=e.useState({}),[X,Z]=e.useState(!1),[_,ee]=e.useState(0),[se,ne]=e.useState({}),[te,ie]=e.useState(!1),[ae,re]=e.useState(0),[oe,le]=e.useState(null),[ce,de]=e.useState(null),[he,ue]=e.useState(null),[ge,pe]=e.useState({totalProducts:0,optimizedProducts:0,totalCollections:0,optimizedCollections:0}),[xe,je]=e.useState(null);e.useEffect(()=>{f&&(be(),ve(),ye(),me())},[f,P]);const me=()=>{try{const e=localStorage.getItem(`ai-test-results-${f}`);if(e){const s=JSON.parse(e);s.results&&s.timestamp&&(K(s.results),je(new Date(s.timestamp)))}const s=localStorage.getItem(`ai-validation-results-${f}`);if(s){const e=JSON.parse(s);e.results&&ne(e.results)}}catch(e){}};e.useEffect(()=>{const e=()=>{!document.hidden&&f&&ve()};return document.addEventListener("visibilitychange",e),()=>{document.removeEventListener("visibilitychange",e)}},[f,P]);const be=async()=>{var e,s,n;try{const t=await P(`/api/billing/info?shop=${f}`),i=(null==(e=null==t?void 0:t.subscription)?void 0:e.plan)||"Starter";C(i),le((null==(s=null==t?void 0:t.tokens)?void 0:s.balance)||0),de((null==(n=null==t?void 0:t.subscription)?void 0:n.trialEndsAt)||null)}catch(t){C("Starter"),le(0)}},ve=async()=>{var e,s;try{const n=await P(`/api/billing/info?shop=${f}`);le((null==(e=null==n?void 0:n.tokens)?void 0:e.balance)||0),de((null==(s=null==n?void 0:n.subscription)?void 0:s.trialEndsAt)||null)}catch(n){}},ye=async()=>{var e,s,n,t;try{let a=null;try{const e=localStorage.getItem(`dashboard-stats-${f}`);if(e){const s=JSON.parse(e);(s.timestamp?Date.now()-new Date(s.timestamp).getTime():1/0)<3e5&&(a=s)}}catch(i){}if(!a){const r=await P(`/api/dashboard/stats?shop=${f}`);a={totalProducts:(null==(e=null==r?void 0:r.products)?void 0:e.total)||0,optimizedProducts:(null==(s=null==r?void 0:r.products)?void 0:s.optimized)||0,totalCollections:(null==(n=null==r?void 0:r.collections)?void 0:n.total)||0,optimizedCollections:(null==(t=null==r?void 0:r.collections)?void 0:t.optimized)||0,timestamp:(new Date).toISOString()};try{localStorage.setItem(`dashboard-stats-${f}`,JSON.stringify(a))}catch(i){}}pe({totalProducts:a.totalProducts||0,optimizedProducts:a.optimizedProducts||0,totalCollections:a.totalCollections||0,optimizedCollections:a.optimizedCollections||0})}catch(i){}},Se=e=>{if(!I)return!1;const s=o(I);switch(e){case"productsJson":case"meta":case"claude":return s>=0;case"storeMetadata":case"gemini":return s>=1;case"welcomePage":case"collectionsJson":case"chatgpt":return s>=2;case"aiSitemap":case"perplexity":return s>=3;case"schemaData":case"deepseek":return s>=4;default:return!1}},we=(e,s)=>{O({name:e,url:s}),$(!0)},fe=async(e,s=null)=>{try{M("Generating AI response...");let n=`/api/ai-discovery/simulate?shop=${f}&type=${e}`;s&&(n+=`&question=${encodeURIComponent(s)}`);const t=await P(n,{method:"GET"});M(t.response||"No response generated")}catch(n){if(402===n.status){if(n.trialRestriction&&n.requiresActivation)return B(n),W(!0),void M("");if(n.requiresUpgrade)return B(n),U(!0),void M("");if(n.requiresPurchase)return B(n),L(!0),void M("")}M("Error generating response. Please try again."),A("Failed to simulate AI response")}};return s.jsxs(s.Fragment,{children:[s.jsxs(l,{gap:"400",children:[s.jsx(c,{tone:"info",children:s.jsx(d,{children:"Test how AI models discover and understand your store content. Check if your structured data and AI Discovery features are working correctly."})}),s.jsx(r,{testResults:Q,aiTestResults:se,stats:ge}),s.jsxs(h,{children:[s.jsx(h.Section,{variant:"oneHalf",children:s.jsx(u,{children:s.jsx(g,{padding:"300",children:s.jsxs(l,{gap:"400",children:[s.jsxs(p,{align:"space-between",blockAlign:"center",children:[s.jsxs(l,{gap:"100",children:[s.jsx(d,{as:"h3",variant:"headingMd",children:"ðŸ”§ Basic AIEO Tests"}),s.jsx(d,{variant:"bodySm",tone:"subdued",children:"Quick check if endpoints are accessible and returning data"})]}),s.jsx(x,{onClick:async()=>{Z(!0),ee(0),K({});try{const e=await P("/api/ai-testing/run-tests",{method:"POST",body:{shop:f}});e.results?(K(e.results),ee(100),(e=>{try{const s={results:e,timestamp:(new Date).toISOString()};localStorage.setItem(`ai-test-results-${f}`,JSON.stringify(s)),je(new Date)}catch(s){}})(e.results),A("Basic tests completed!")):A("Testing failed. Please try again.")}catch(e){A("Failed to run tests. Please try again.")}finally{Z(!1)}},loading:X,disabled:X,children:X?"Testing...":"Run Basic Tests"})]}),xe&&Object.keys(Q).length>0&&!X&&s.jsx(c,{tone:"info",children:s.jsxs(d,{variant:"bodySm",children:["These results are from ",xe.toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),". Run Basic Tests again to refresh."]})}),X&&s.jsx(g,{children:s.jsxs(l,{gap:"200",children:[s.jsx(d,{variant:"bodySm",children:"Testing endpoints..."}),s.jsx(j,{progress:_,size:"small"})]})}),Object.keys(Q).length>0&&s.jsx(l,{gap:"300",children:Object.entries(Q).map(([e,t],i)=>{const a=i===Object.entries(Q).length-1;return s.jsxs(n.Fragment,{children:[s.jsx(p,{align:"space-between",blockAlign:"center",children:s.jsxs(l,{gap:"100",children:[s.jsxs(p,{gap:"200",blockAlign:"center",children:[s.jsx(d,{variant:"bodyMd",fontWeight:"semibold",children:t.name}),"success"===t.status&&s.jsx(m,{tone:"success",children:"âœ“ OK"}),"warning"===t.status&&s.jsx(m,{tone:"warning",children:"âš ï¸ Warning"}),"error"===t.status&&s.jsx(m,{tone:"critical",children:"âœ— Failed"}),"locked"===t.status&&s.jsx(m,{children:"ðŸ”’ Locked"})]}),s.jsx(d,{variant:"bodySm",tone:"subdued",children:t.message}),t.actionLink&&s.jsx(x,{size:"slim",onClick:()=>(e=>{const s=new URLSearchParams(window.location.search),n=s.toString()?`?${s.toString()}`:"";window.location.href=`${e}${n}`})(t.actionLink),children:"basicSitemap"===e?"Go to Sitemap":"aiSitemap"===e?"Go to Settings":"Go"})]})}),!a&&s.jsx(b,{})]},e)})}),0===Object.keys(Q).length&&!X&&s.jsx(c,{tone:"info",children:s.jsx(d,{children:'Click "Run Basic Tests" to check if your AI Discovery endpoints are configured correctly.'})})]})})})}),s.jsx(h.Section,{variant:"oneHalf",children:s.jsx(u,{children:s.jsx(g,{padding:"300",children:s.jsxs(l,{gap:"400",children:[s.jsxs(p,{align:"space-between",blockAlign:"center",children:[s.jsxs(l,{gap:"100",children:[s.jsxs(p,{gap:"200",blockAlign:"center",children:[s.jsx(d,{as:"h3",variant:"headingMd",children:"ðŸ¤– AI-Powered Validation"}),null!==oe&&s.jsxs(m,{tone:oe>50?"success":"warning",children:[oe," tokens"]}),s.jsx(x,{size:"micro",onClick:()=>ve(),accessibilityLabel:"Refresh token balance",children:"ðŸ”„"})]}),s.jsx(d,{variant:"bodySm",tone:"subdued",children:"Deep analysis with AI bot"}),I&&s.jsx(d,{variant:"bodySm",tone:"subdued",children:"Requires: Professional+ plan & pay-per-use tokens"})]}),s.jsx(x,{onClick:async()=>{if(o(I)<1)return B({message:"AI-powered validation requires Professional plan or higher",requiredPlan:"Professional",currentPlan:I||"Starter"}),void U(!0);ie(!0),re(0),ne({});try{const s=await P("/api/ai-testing/ai-validate",{method:"POST",body:{shop:f,endpointResults:Q}});if(s&&s.results){ne(s.results),re(100);try{const e={results:s.results,timestamp:(new Date).toISOString()};localStorage.setItem(`ai-validation-results-${f}`,JSON.stringify(e))}catch(e){}if(s.aiEOScore){const e=s.aiEOScore;ue(e),A(`AI validation completed! Score: ${e.score||"N/A"}/100 (${s.tokensUsed||0} tokens used)`)}else ue(null),A(`AI validation completed! (${s.tokensUsed||0} tokens used)`);ve()}else ue(null),A("AI validation failed. Please try again.")}catch(s){if(402===s.status){if(s.trialRestriction&&s.requiresActivation)return B(s),void W(!0);if(s.requiresUpgrade)return B(s),void U(!0);if(s.requiresPurchase)return B(s),void L(!0)}A("Failed to run AI validation. Please try again.")}finally{ie(!1)}},loading:te,disabled:te||0===Object.keys(Q).length,variant:"primary",children:te?"Validating...":"Test with AI Bot"})]}),te&&s.jsx(g,{children:s.jsxs(l,{gap:"200",children:[s.jsx(d,{variant:"bodySm",children:"AI is analyzing your endpoints..."}),s.jsx(j,{progress:ae,size:"small",tone:"primary"})]})}),Object.keys(se).length>0&&s.jsxs(l,{gap:"300",children:[se.productsJson&&s.jsxs(s.Fragment,{children:[s.jsx(p,{align:"space-between",blockAlign:"center",children:s.jsxs(l,{gap:"100",children:[s.jsxs(p,{gap:"200",blockAlign:"center",children:[s.jsx(d,{variant:"bodyMd",fontWeight:"semibold",children:"Products JSON Feed"}),"excellent"===se.productsJson.rating&&s.jsx(m,{tone:"success",children:"ðŸ¤– Excellent"}),"good"===se.productsJson.rating&&s.jsx(m,{tone:"success",children:"ðŸ¤– Good"}),"fair"===se.productsJson.rating&&s.jsx(m,{tone:"warning",children:"ðŸ¤– Fair"}),"poor"===se.productsJson.rating&&s.jsx(m,{tone:"critical",children:"ðŸ¤– Poor"}),"locked"===se.productsJson.rating&&s.jsx(m,{children:"ðŸ”’ Locked"}),"unavailable"===se.productsJson.rating&&s.jsx(m,{tone:"critical",children:"âŒ Unavailable"})]}),s.jsx(d,{variant:"bodySm",children:se.productsJson.feedback}),se.productsJson.suggestions&&s.jsxs(d,{variant:"bodySm",tone:"subdued",children:["ðŸ’¡ ",se.productsJson.suggestions]})]})}),s.jsx(b,{})]}),se.storeMetadata&&s.jsxs(s.Fragment,{children:[s.jsx(p,{align:"space-between",blockAlign:"center",children:s.jsxs(l,{gap:"100",children:[s.jsxs(p,{gap:"200",blockAlign:"center",children:[s.jsx(d,{variant:"bodyMd",fontWeight:"semibold",children:"Store Metadata"}),"excellent"===se.storeMetadata.rating&&s.jsx(m,{tone:"success",children:"ðŸ¤– Excellent"}),"good"===se.storeMetadata.rating&&s.jsx(m,{tone:"success",children:"ðŸ¤– Good"}),"fair"===se.storeMetadata.rating&&s.jsx(m,{tone:"warning",children:"ðŸ¤– Fair"}),"poor"===se.storeMetadata.rating&&s.jsx(m,{tone:"critical",children:"ðŸ¤– Poor"}),"locked"===se.storeMetadata.rating&&s.jsx(m,{children:"ðŸ”’ Locked"}),"unavailable"===se.storeMetadata.rating&&s.jsx(m,{tone:"critical",children:"âŒ Unavailable"})]}),s.jsx(d,{variant:"bodySm",children:se.storeMetadata.feedback}),se.storeMetadata.suggestions&&s.jsxs(d,{variant:"bodySm",tone:"subdued",children:["ðŸ’¡ ",se.storeMetadata.suggestions]})]})}),s.jsx(b,{})]}),se.welcomePage&&s.jsxs(s.Fragment,{children:[s.jsx(p,{align:"space-between",blockAlign:"center",children:s.jsxs(l,{gap:"100",children:[s.jsxs(p,{gap:"200",blockAlign:"center",children:[s.jsx(d,{variant:"bodyMd",fontWeight:"semibold",children:"AI Welcome Page"}),"excellent"===se.welcomePage.rating&&s.jsx(m,{tone:"success",children:"ðŸ¤– Excellent"}),"good"===se.welcomePage.rating&&s.jsx(m,{tone:"success",children:"ðŸ¤– Good"}),"fair"===se.welcomePage.rating&&s.jsx(m,{tone:"warning",children:"ðŸ¤– Fair"}),"poor"===se.welcomePage.rating&&s.jsx(m,{tone:"critical",children:"ðŸ¤– Poor"}),"locked"===se.welcomePage.rating&&s.jsx(m,{children:"ðŸ”’ Locked"}),"unavailable"===se.welcomePage.rating&&s.jsx(m,{tone:"critical",children:"âŒ Unavailable"})]}),s.jsx(d,{variant:"bodySm",children:se.welcomePage.feedback}),se.welcomePage.suggestions&&s.jsxs(d,{variant:"bodySm",tone:"subdued",children:["ðŸ’¡ ",se.welcomePage.suggestions]})]})}),s.jsx(b,{})]}),se.collectionsJson&&s.jsxs(s.Fragment,{children:[s.jsx(p,{align:"space-between",blockAlign:"center",children:s.jsxs(l,{gap:"100",children:[s.jsxs(p,{gap:"200",blockAlign:"center",children:[s.jsx(d,{variant:"bodyMd",fontWeight:"semibold",children:"Collections JSON Feed"}),"excellent"===se.collectionsJson.rating&&s.jsx(m,{tone:"success",children:"ðŸ¤– Excellent"}),"good"===se.collectionsJson.rating&&s.jsx(m,{tone:"success",children:"ðŸ¤– Good"}),"fair"===se.collectionsJson.rating&&s.jsx(m,{tone:"warning",children:"ðŸ¤– Fair"}),"poor"===se.collectionsJson.rating&&s.jsx(m,{tone:"critical",children:"ðŸ¤– Poor"}),"locked"===se.collectionsJson.rating&&s.jsx(m,{children:"ðŸ”’ Locked"}),"unavailable"===se.collectionsJson.rating&&s.jsx(m,{tone:"critical",children:"âŒ Unavailable"})]}),s.jsx(d,{variant:"bodySm",children:se.collectionsJson.feedback}),se.collectionsJson.suggestions&&s.jsxs(d,{variant:"bodySm",tone:"subdued",children:["ðŸ’¡ ",se.collectionsJson.suggestions]})]})}),s.jsx(b,{})]}),se.aiSitemap&&s.jsxs(s.Fragment,{children:[s.jsx(p,{align:"space-between",blockAlign:"center",children:s.jsxs(l,{gap:"100",children:[s.jsxs(p,{gap:"200",blockAlign:"center",children:[s.jsx(d,{variant:"bodyMd",fontWeight:"semibold",children:"AI-Enhanced Sitemap"}),"excellent"===se.aiSitemap.rating&&s.jsx(m,{tone:"success",children:"ðŸ¤– Excellent"}),"good"===se.aiSitemap.rating&&s.jsx(m,{tone:"success",children:"ðŸ¤– Good"}),"fair"===se.aiSitemap.rating&&s.jsx(m,{tone:"warning",children:"ðŸ¤– Fair"}),"poor"===se.aiSitemap.rating&&s.jsx(m,{tone:"critical",children:"ðŸ¤– Poor"}),"locked"===se.aiSitemap.rating&&s.jsx(m,{children:"ðŸ”’ Locked"}),"unavailable"===se.aiSitemap.rating&&s.jsx(m,{tone:"critical",children:"âŒ Unavailable"})]}),s.jsx(d,{variant:"bodySm",children:se.aiSitemap.feedback}),se.aiSitemap.suggestions&&s.jsxs(d,{variant:"bodySm",tone:"subdued",children:["ðŸ’¡ ",se.aiSitemap.suggestions]})]})}),s.jsx(b,{})]}),se.schemaData&&s.jsx(p,{align:"space-between",blockAlign:"center",children:s.jsxs(l,{gap:"100",children:[s.jsxs(p,{gap:"200",blockAlign:"center",children:[s.jsx(d,{variant:"bodyMd",fontWeight:"semibold",children:"Advanced Schema Data"}),"excellent"===se.schemaData.rating&&s.jsx(m,{tone:"success",children:"ðŸ¤– Excellent"}),"good"===se.schemaData.rating&&s.jsx(m,{tone:"success",children:"ðŸ¤– Good"}),"fair"===se.schemaData.rating&&s.jsx(m,{tone:"warning",children:"ðŸ¤– Fair"}),"poor"===se.schemaData.rating&&s.jsx(m,{tone:"critical",children:"ðŸ¤– Poor"}),"locked"===se.schemaData.rating&&s.jsx(m,{children:"ðŸ”’ Locked"}),"unavailable"===se.schemaData.rating&&s.jsx(m,{tone:"critical",children:"âŒ Unavailable"})]}),s.jsx(d,{variant:"bodySm",children:se.schemaData.feedback}),se.schemaData.suggestions&&s.jsxs(d,{variant:"bodySm",tone:"subdued",children:["ðŸ’¡ ",se.schemaData.suggestions]})]})})]}),0===Object.keys(se).length&&!te&&s.jsx(c,{tone:"info",children:s.jsx(d,{children:0===Object.keys(Q).length?"Run Basic Tests first, then use AI validation for deep analysis":'Click "Test with AI Bot" to get AI-powered feedback on your endpoint data quality'})}),!I&&s.jsx(c,{tone:"warning",children:s.jsx(d,{children:"Loading plan information..."})})]})})})})]}),s.jsx(u,{children:s.jsx(g,{padding:"300",children:s.jsxs(l,{gap:"400",children:[s.jsx(d,{as:"h3",variant:"headingMd",children:"Test with Real AI Bots"}),s.jsx(d,{variant:"bodyMd",tone:"subdued",children:"Manually test your store with real AI search engines"}),s.jsxs(l,{gap:"200",children:[s.jsxs(p,{align:"space-between",children:[s.jsx(d,{children:"Meta AI Search"}),Se("meta")?s.jsx(x,{onClick:()=>we("Meta AI","https://www.meta.ai/"),size:"slim",children:"Test"}):s.jsx(x,{disabled:!0,size:"slim",children:"Plan upgrade required"})]}),s.jsxs(p,{align:"space-between",children:[s.jsx(d,{children:"Claude AI Search"}),Se("claude")?s.jsx(x,{onClick:()=>we("Claude AI","https://claude.ai/"),size:"slim",children:"Test"}):s.jsx(x,{disabled:!0,size:"slim",children:"Plan upgrade required"})]}),s.jsxs(p,{align:"space-between",children:[s.jsx(d,{children:"Gemini AI Search"}),Se("gemini")?s.jsx(x,{onClick:()=>we("Gemini AI","https://gemini.google.com/"),size:"slim",children:"Test"}):s.jsx(x,{disabled:!0,size:"slim",children:"Plan upgrade required"})]}),s.jsxs(p,{align:"space-between",children:[s.jsx(d,{children:"ChatGPT Web Search"}),Se("chatgpt")?s.jsx(x,{url:`https://chat.openai.com/?q=What+products+does+${f}+sell%3F+Tell+me+about+this+business+and+what+they+offer`,external:!0,size:"slim",children:"Test"}):s.jsx(x,{disabled:!0,size:"slim",children:"Plan upgrade required"})]}),s.jsxs(p,{align:"space-between",children:[s.jsx(d,{children:"Perplexity AI Search"}),Se("perplexity")?s.jsx(x,{url:`https://www.perplexity.ai/search?q=What+products+does+${f}+sell%3F+Tell+me+about+this+business+and+what+they+offer`,external:!0,size:"slim",children:"Test"}):s.jsx(x,{disabled:!0,size:"slim",children:"Plan upgrade required"})]}),s.jsxs(p,{align:"space-between",children:[s.jsx(d,{children:"DeepSeek AI Search"}),Se("deepseek")?s.jsx(x,{onClick:()=>we("DeepSeek AI","https://chat.deepseek.com/"),size:"slim",children:"Test"}):s.jsx(x,{disabled:!0,size:"slim",children:"Plan upgrade required"})]})]}),s.jsx(c,{tone:"info",children:s.jsxs(d,{children:[s.jsx("strong",{children:"How to test with AI bots:"}),s.jsx("br",{}),"â€¢ ",s.jsx("strong",{children:"Perplexity & ChatGPT:"}),' Click "Test" - they support URL parameters',s.jsx("br",{}),"â€¢ ",s.jsx("strong",{children:"Meta AI, Claude, Gemini, DeepSeek:"}),' Click "Test" to open a modal with the prompt to copy']})})]})})}),s.jsx(u,{children:s.jsx(g,{padding:"300",children:s.jsxs(l,{gap:"300",children:[s.jsx(d,{as:"h4",variant:"headingSm",children:"AI Search Simulation"}),s.jsx(d,{variant:"bodyMd",tone:"subdued",children:"Test how AI bots would respond to questions about your store based on your structured data."}),s.jsx(c,{tone:"info",children:s.jsxs(l,{gap:"100",children:[s.jsx(d,{variant:"bodySm",fontWeight:"semibold",children:"Simulation Details:"}),s.jsxs(d,{variant:"bodySm",children:["â€¢ ",s.jsx("strong",{children:"Data Source:"})," Your store's products, collections, and metadata"]}),s.jsxs(d,{variant:"bodySm",children:["â€¢ ",s.jsx("strong",{children:"Response Style:"})," Concise (2-3 sentences), natural language"]}),s.jsxs(d,{variant:"bodySm",children:["â€¢ ",s.jsx("strong",{children:"Best For:"})," General store info, products, categories, contact details"]}),s.jsxs(d,{variant:"bodySm",children:["â€¢ ",s.jsx("strong",{children:"Limitations:"})," May not have real-time data (current stock, active promotions, exact shipping times)"]})]})}),s.jsxs(l,{gap:"200",children:[s.jsxs(p,{align:"space-between",children:[s.jsx(d,{children:"What products does this store sell?"}),s.jsx(x,{onClick:()=>fe("products"),size:"slim",children:"Simulate Response"})]}),s.jsxs(p,{align:"space-between",children:[s.jsx(d,{children:"Tell me about this business"}),s.jsx(x,{onClick:()=>fe("business"),size:"slim",children:"Simulate Response"})]}),s.jsxs(p,{align:"space-between",children:[s.jsx(d,{children:"What categories does this store have?"}),s.jsx(x,{onClick:()=>fe("categories"),size:"slim",children:"Simulate Response"})]}),s.jsxs(p,{align:"space-between",children:[s.jsx(d,{children:"What is this store's contact information?"}),s.jsx(x,{onClick:()=>fe("contact"),size:"slim",children:"Simulate Response"})]})]}),s.jsx(b,{}),s.jsxs(l,{gap:"200",children:[s.jsx(d,{variant:"headingSm",children:"Ask Your Own Question"}),s.jsx(v,{label:"",value:z,onChange:D,placeholder:"e.g., What are your return policies? Do you ship internationally?",autoComplete:"off",connectedRight:s.jsx(x,{onClick:()=>{z.trim()?fe("custom",z):A("Please enter a question")},disabled:!z.trim(),children:"Ask AI"})})]}),T&&s.jsxs(g,{background:"bg-surface-secondary",padding:"300",borderRadius:"200",children:[s.jsx(d,{variant:"bodyMd",fontWeight:"semibold",children:"AI Bot Response:"}),s.jsx(g,{paddingBlockStart:"200",children:s.jsx(d,{variant:"bodyMd",children:T})})]})]})})})]}),k&&s.jsx(y,{content:k,onDismiss:()=>A("")}),s.jsx(S,{open:R,onClose:()=>$(!1),title:`Test with ${null==q?void 0:q.name}`,primaryAction:{content:"Open AI Bot",url:null==q?void 0:q.url,external:!0},secondaryActions:[{content:"Copy Prompt",onAction:()=>{navigator.clipboard.writeText(`What products does ${f} sell? Tell me about this business and what they offer.`),A("Prompt copied to clipboard!")}}],children:s.jsx(S.Section,{children:s.jsxs(l,{gap:"300",children:[s.jsx(d,{variant:"bodyMd",children:'1. Click "Copy Prompt" (left button)'}),s.jsxs(d,{variant:"bodyMd",children:['2. Click "Open AI Bot" (right button) to visit ',null==q?void 0:q.name]}),s.jsx(d,{variant:"bodyMd",children:"3. Paste the prompt and send"}),s.jsxs(g,{background:"bg-surface-secondary",padding:"300",borderRadius:"200",children:[s.jsx(d,{variant:"bodyMd",fontWeight:"semibold",children:"Prompt to test:"}),s.jsx(g,{paddingBlockStart:"200",children:s.jsxs(d,{variant:"bodyMd",as:"p",children:["What products does ",f," sell? Tell me about this business and what they offer."]})})]}),s.jsx(c,{tone:"info",children:s.jsx(d,{children:"The AI bot will search the web and use your store's structured data to answer."})})]})})}),s.jsx(S,{open:N,onClose:()=>H(!1),title:"Upgrade Required",primaryAction:{content:"View Plans",onAction:()=>{const e=new URLSearchParams(window.location.search),s=e.toString()?`?${e.toString()}`:"";window.location.href=`/billing${s}`}},secondaryActions:[{content:"Cancel",onAction:()=>H(!1)}],children:s.jsx(S.Section,{children:s.jsxs(l,{gap:"300",children:[s.jsxs(d,{variant:"bodyMd",children:[s.jsx("strong",{children:null==V?void 0:V.endpoint})," requires ",s.jsx("strong",{children:null==V?void 0:V.requiredPlan})," plan or higher."]}),s.jsxs(d,{variant:"bodyMd",tone:"subdued",children:["Your current plan: ",s.jsx("strong",{children:null==V?void 0:V.currentPlan})]}),s.jsx(c,{tone:"info",children:s.jsx(d,{children:"Upgrade to access this advanced AI Discovery feature."})})]})})}),s.jsx(S,{open:J,onClose:()=>U(!1),title:"Upgrade Required",primaryAction:{content:"View Plans",onAction:()=>{const e=new URLSearchParams(window.location.search),s=e.toString()?`?${e.toString()}`:"";window.location.href=`/billing${s}`}},secondaryActions:[{content:"Cancel",onAction:()=>U(!1)}],children:s.jsx(S.Section,{children:s.jsxs(l,{gap:"300",children:[s.jsxs(d,{variant:"bodyMd",children:["AI Testing requires ",s.jsx("strong",{children:(null==G?void 0:G.minimumPlan)||"Professional"})," plan or higher."]}),s.jsxs(d,{variant:"bodyMd",tone:"subdued",children:["Your current plan: ",s.jsx("strong",{children:(null==G?void 0:G.currentPlan)||"Starter"})]}),s.jsx(c,{tone:"info",children:s.jsx(d,{children:"Upgrade to test AI responses with real store data."})})]})})}),s.jsx(i,{open:F,onClose:()=>{L(!1),B(null),ve()},tokensRequired:(null==G?void 0:G.tokensRequired)||0,tokensAvailable:(null==G?void 0:G.tokensAvailable)||0,tokensNeeded:(null==G?void 0:G.tokensNeeded)||0,feature:"ai-testing-simulation",shop:f,needsUpgrade:!1,returnTo:"/ai-testing"}),G&&s.jsx(a,{open:E,onClose:()=>{W(!1),B(null)},feature:G.feature||"ai-testing-simulation",trialEndsAt:G.trialEndsAt,currentPlan:G.currentPlan||I,tokensRequired:G.tokensRequired||0,onActivatePlan:async()=>{try{const e=await P("/api/billing/activate",{method:"POST",body:JSON.stringify({shop:f,endTrial:!0,returnTo:"/ai-testing"})});if(e.requiresApproval&&e.confirmationUrl)return void(window.top.location.href=e.confirmationUrl);window.location.reload()}catch(e){const s=new URLSearchParams(window.location.search),n=s.get("host"),t=s.get("embedded");window.location.href=`/billing?shop=${encodeURIComponent(f)}&embedded=${t}&host=${encodeURIComponent(n)}`}},onPurchaseTokens:()=>{const e=new URLSearchParams(window.location.search),s=e.get("host"),n=e.get("embedded");window.location.href=`/billing?shop=${encodeURIComponent(f)}&embedded=${n}&host=${encodeURIComponent(s)}&returnTo=${encodeURIComponent("/ai-testing")}`}})]})}export{w as default};
