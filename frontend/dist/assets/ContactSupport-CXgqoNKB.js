import{r as e,j as a}from"./react-vendor-BLtYaay5.js";import{u as s}from"./useShopApi-Dxe2kUKp.js";import{B as i,a as l,T as n,d as r,C as t,I as o,h as d,G as u,b as c}from"./polaris-DLzuUptG.js";import"./app-bridge-DUY42B6P.js";import"./vendor-L4_WdQez.js";const m=[{label:"Bug Report",value:"Bug Report"},{label:"Feature Request",value:"Feature Request"},{label:"Billing Issue",value:"Billing Issue"},{label:"General Question",value:"General Question"},{label:"Technical Support",value:"Technical Support"}];function h({shop:h}){const{api:p}=s(),[g,b]=e.useState({name:"",email:"",subject:"General Question",message:"",file:null}),[j,x]=e.useState(!1),[f,y]=e.useState(null),[v,S]=e.useState(""),[w,R]=e.useState(null),M=h||((e,a="")=>{try{return new URLSearchParams(window.location.search).get(e)||a}catch{return a}})("shop","");e.useEffect(()=>{B()},[M]);const B=async()=>{try{const e=await p(`/api/shop/info?shop=${encodeURIComponent(M)}`);R(e),b(a=>({...a,name:(null==e?void 0:e.name)||"",email:(null==e?void 0:e.email)||""}))}catch(e){}},z=(e,a)=>{b(s=>({...s,[e]:a}))};return a.jsx(i,{padding:"400",children:a.jsxs(l,{gap:"400",children:[a.jsx(n,{variant:"bodyMd",tone:"subdued",children:"Need help? Send us a message and we'll get back to you within 24 hours."}),f&&a.jsx(r,{tone:"success"===f?"success":"critical",children:v}),a.jsx(t,{children:a.jsx(i,{padding:"400",children:a.jsx("form",{onSubmit:async e=>{if(e.preventDefault(),g.name.trim()?g.email.trim()?g.message.trim()||(y("error"),S("Please enter your message"),0):(y("error"),S("Please enter your email"),0):(y("error"),S("Please enter your name"),0)){x(!0),y(null),S("");try{const e={name:g.name,email:g.email,subject:g.subject,message:g.message};if(g.file)try{const s=await(a=g.file,new Promise((e,s)=>{const i=new FileReader;i.readAsDataURL(a),i.onload=()=>{const a=i.result.split(",")[1];e(a)},i.onerror=e=>s(e)}));e.file={content:s,filename:g.file.name,type:g.file.type,size:`${(g.file.size/1024).toFixed(1)} KB`}}catch(s){}const i=await p(`/api/support/send?shop=${encodeURIComponent(M)}`,{method:"POST",body:e});if(!i.success)throw new Error(i.error||"Failed to send message");{y("success"),S("Message sent successfully! We'll get back to you within 24 hours."),b({name:(null==w?void 0:w.name)||"",email:(null==w?void 0:w.email)||"",subject:"General Question",message:"",file:null});const e=document.querySelector('input[type="file"]');e&&(e.value="")}}catch(s){y("error"),S(`Failed to send message: ${s.message||"Please try again or email us at indexaize@gmail.com"}`)}finally{x(!1)}var a}},children:a.jsxs(l,{gap:"400",children:[a.jsxs(o,{gap:"400",wrap:!0,children:[a.jsx(i,{flexGrow:1,children:a.jsx(d,{label:"Name",value:g.name,onChange:e=>z("name",e),placeholder:"Your name",required:!0,disabled:j})}),a.jsx(i,{flexGrow:1,children:a.jsx(d,{label:"Email",type:"email",value:g.email,onChange:e=>z("email",e),placeholder:"your@email.com",required:!0,disabled:j})})]}),a.jsx(u,{label:"Subject",options:m,value:g.subject,onChange:e=>z("subject",e),disabled:j}),a.jsx(d,{label:"Message",value:g.message,onChange:e=>z("message",e),multiline:4,placeholder:"Describe your issue or question...",required:!0,disabled:j}),a.jsxs(i,{children:[a.jsx(n,{as:"label",variant:"bodyMd",fontWeight:"medium",children:"Attach File (Optional)"}),a.jsx(i,{paddingBlockStart:"100",children:a.jsx("input",{type:"file",onChange:e=>(e=>{if(e.length>0){const a=e[0];if(a.size>512e3)return y("error"),void S("File size must be less than 500KB");b(e=>({...e,file:a}))}})(e.target.files),disabled:j,style:{padding:"8px",border:"1px solid #d1d5db",borderRadius:"4px",fontSize:"14px",width:"100%"}})}),a.jsx(n,{variant:"bodySm",tone:"subdued",children:"Any file type allowed • Maximum file size: 500KB"})]}),a.jsx(o,{gap:"200",align:"end",children:a.jsx(c,{variant:"primary",submit:!0,loading:j,disabled:j,children:j?"Sending...":"Send Message"})})]})})})}),a.jsx(t,{children:a.jsx(i,{padding:"400",children:a.jsxs(l,{gap:"200",children:[a.jsx(n,{as:"h3",variant:"headingMd",children:"Other Ways to Reach Us"}),a.jsx(n,{variant:"bodyMd",tone:"subdued",children:"• Email: indexaize@gmail.com"}),a.jsx(n,{variant:"bodyMd",tone:"subdued",children:"• Response time: Within 24 hours"}),a.jsxs(n,{variant:"bodyMd",tone:"subdued",children:["• Include your shop name: ",M]})]})})})]})})}export{h as default};
