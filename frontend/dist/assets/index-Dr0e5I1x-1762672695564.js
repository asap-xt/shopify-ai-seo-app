const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Dashboard-Ch2Owfsq-1762672695564.js","assets/app-bridge-B8D5nrjk-1762672695564.js","assets/react-vendor-tAaa2TlE-1762672695564.js","assets/sessionFetch-CJepNHo3-1762672695564.js","assets/polaris-8FhogFhN-1762672695564.js","assets/BulkEdit-DZUiV_CG-1762672695564.js","assets/useShopApi-Dcfuilta-1762672695564.js","assets/StoreMetadataBanner-_qd7C4UR-1762672695564.js","assets/InsufficientTokensModal-CdY1nb6K-1762672695564.js","assets/Collections-BxEUDGP_-1762672695564.js","assets/Sitemap-uQ85v8ej-1762672695564.js","assets/StoreMetadata-dwIyk4Ap-1762672695564.js","assets/SchemaData-BhiHu0hn-1762672695564.js","assets/Settings-CYEbUoI--1762672695564.js","assets/AiTesting-BlRXURNN-1762672695564.js","assets/Billing-NyZEpS3w-1762672695564.js","assets/CleanUninstall-BqPJNf0z-1762672695564.js","assets/ContactSupport-vSgtWB68-1762672695564.js"])))=>i.map(i=>d[i]);
import{j as t}from"./app-bridge-B8D5nrjk-1762672695564.js";import{a as Y,r as p,R as h}from"./react-vendor-tAaa2TlE-1762672695564.js";import{B as E,I as C,T as b,C as D,A as $,F as z,P as V}from"./polaris-8FhogFhN-1762672695564.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))a(r);new MutationObserver(r=>{for(const e of r)if(e.type==="childList")for(const n of e.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&a(n)}).observe(document,{childList:!0,subtree:!0});function i(r){const e={};return r.integrity&&(e.integrity=r.integrity),r.referrerPolicy&&(e.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?e.credentials="include":r.crossOrigin==="anonymous"?e.credentials="omit":e.credentials="same-origin",e}function a(r){if(r.ep)return;r.ep=!0;const e=i(r);fetch(r.href,e)}})();var M,T=Y;M=T.createRoot,T.hydrateRoot;const B="modulepreload",W=function(o){return"/"+o},L={},d=function(s,i,a){let r=Promise.resolve();if(i&&i.length>0){document.getElementsByTagName("link");const n=document.querySelector("meta[property=csp-nonce]"),l=(n==null?void 0:n.nonce)||(n==null?void 0:n.getAttribute("nonce"));r=Promise.allSettled(i.map(c=>{if(c=W(c),c in L)return;L[c]=!0;const u=c.endsWith(".css"),I=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${I}`))return;const f=document.createElement("link");if(f.rel=u?"stylesheet":B,u||(f.as="script"),f.crossOrigin="",f.href=c,l&&f.setAttribute("nonce",l),document.head.appendChild(f),u)return new Promise((_,g)=>{f.addEventListener("load",_),f.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${c}`)))})}))}function e(n){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=n,window.dispatchEvent(l),!l.defaultPrevented)throw n}return r.then(n=>{for(const l of n||[])l.status==="rejected"&&e(l.reason);return s().catch(e)})},F=()=>{if(typeof window>"u"||!window.gtag){console.warn("[ANALYTICS] GA4 not loaded");return}console.log("[ANALYTICS] GA4 initialized")},K=()=>{if(typeof window>"u"||!window.fbq){console.warn("[ANALYTICS] Meta Pixel not loaded");return}console.log("[ANALYTICS] Meta Pixel initialized")},R=(o,s="")=>{if(typeof window>"u"||!window.gtag){console.warn("[ANALYTICS] GA4 not available, skipping page view:",o);return}try{window.gtag("event","page_view",{page_path:o,page_title:s||document.title,page_location:window.location.href}),console.log("[ANALYTICS] Page view tracked:",o)}catch(i){console.error("[ANALYTICS] Error tracking page view:",i)}};function q({sectionTitle:o,lang:s,setLang:i,t:a}){return t.jsx(E,{padding:"400",borderBlockEndWidth:"025",borderColor:"border",background:"bg",children:t.jsx(C,{align:"space-between",blockAlign:"center",children:t.jsx(b,{as:"h1",variant:"headingLg",children:o})})})}const N="en",j={en:()=>d(()=>import("./en-DY--Skhq-1762672695564.js"),[]),de:()=>d(()=>import("./de-BYtsvH6H-1762672695564.js"),[]),es:()=>d(()=>import("./es-Cshzw9pa-1762672695564.js"),[]),fr:()=>d(()=>import("./fr-DGTXCiho-1762672695564.js"),[])},U=Object.keys(j);function H(){try{const o=localStorage.getItem("app_lang");return U.includes(o)?o:null}catch{return null}}function J(o){try{localStorage.setItem("app_lang",o)}catch{}}function Q(){const[o,s]=p.useState(()=>H()||N),[i,a]=p.useState({});p.useEffect(()=>{let e=!1;async function n(){const c=await(j[o]||j[N])();e||a(c.default||c)}return n(),J(o),()=>{e=!0}},[o]);const r=p.useMemo(()=>(e,n="")=>{const l=e==null?void 0:e.split(".").reduce((c,u)=>c&&c[u]!==void 0?c[u]:void 0,i);return l!=null?String(l):n||e},[i]);return{lang:o,setLang:s,t:r,dict:i,langs:U}}const X=h.lazy(()=>d(()=>import("./Dashboard-Ch2Owfsq-1762672695564.js"),__vite__mapDeps([0,1,2,3,4]))),Z=h.lazy(()=>d(()=>import("./BulkEdit-DZUiV_CG-1762672695564.js"),__vite__mapDeps([5,1,2,6,7,4,8]))),ee=h.lazy(()=>d(()=>import("./Collections-BxEUDGP_-1762672695564.js"),__vite__mapDeps([9,1,2,3,7,4,8]))),te=h.lazy(()=>d(()=>import("./Sitemap-uQ85v8ej-1762672695564.js"),__vite__mapDeps([10,1,2,3,4]))),oe=h.lazy(()=>d(()=>import("./StoreMetadata-dwIyk4Ap-1762672695564.js"),__vite__mapDeps([11,1,2,3,4]))),ne=h.lazy(()=>d(()=>import("./SchemaData-BhiHu0hn-1762672695564.js"),__vite__mapDeps([12,1,2,3,4]))),re=h.lazy(()=>(console.log("[APP] ===== LOADING SETTINGS COMPONENT ====="),d(()=>import("./Settings-CYEbUoI--1762672695564.js"),__vite__mapDeps([13,1,2,3,8,4])))),se=h.lazy(()=>d(()=>import("./AiTesting-BlRXURNN-1762672695564.js"),__vite__mapDeps([14,1,2,3,4]))),O=h.lazy(()=>d(()=>import("./Billing-NyZEpS3w-1762672695564.js"),__vite__mapDeps([15,1,2,4]))),ie=h.lazy(()=>d(()=>import("./CleanUninstall-BqPJNf0z-1762672695564.js"),__vite__mapDeps([16,1,2,3,4]))),ae=h.lazy(()=>d(()=>import("./ContactSupport-vSgtWB68-1762672695564.js"),__vite__mapDeps([17,1,2,6,4]))),ce={Polaris:{ResourceList:{sortingLabel:"Sort by"}}},G=(o,s="")=>{try{return new URLSearchParams(window.location.search).get(o)||s}catch{return s}};function le(){const o=a=>a.replace(/^\/apps\/[^/]+/,"")||"/",[s,i]=p.useState(()=>o(window.location.pathname));return p.useEffect(()=>{const a=()=>{const n=o(window.location.pathname);console.log("[useRoute] Location changed to:",n),i(n),R(n)};window.addEventListener("popstate",a);let r=window.location.pathname;const e=setInterval(()=>{window.location.pathname!==r&&(r=window.location.pathname,a())},50);return()=>{window.removeEventListener("popstate",a),clearInterval(e)}},[]),p.useEffect(()=>{F(),K(),R(s)},[]),{path:s}}function de({active:o,shop:s}){o==="/"||o.startsWith("/dashboard"),o.startsWith("/ai-seo"),o.startsWith("/billing"),o.startsWith("/settings");const a=new URLSearchParams(window.location.search).get("host"),r=new URLSearchParams;s&&r.set("shop",s),a&&r.set("host",a);const e=r.toString()?`?${r.toString()}`:"";return t.jsxs("ui-nav-menu",{children:[t.jsx("a",{href:`/${e}`,rel:"home",children:"Home"}),t.jsx("a",{href:`/dashboard${e}`,children:"Dashboard"}),t.jsx("a",{href:`/ai-seo${e}`,children:"Search Optimization for AI"}),t.jsx("a",{href:`/settings${e}`,children:"Settings"}),t.jsx("a",{href:`/ai-testing${e}`,children:"AI Testing"}),t.jsx("a",{href:`/billing${e}`,children:"Plans & Billing"}),t.jsx("a",{href:`/clean-uninstall${e}`,children:"Clean & Uninstall"}),t.jsx("a",{href:`/contact-support${e}`,children:"Contact Support"})]})}const pe=h.memo(({shop:o,plan:s})=>{const i=o||G("shop",""),a=window.location.pathname,e=a==="/ai-seo"||a==="/ai-seo/products"?"products":a==="/ai-seo/collections"?"collections":a==="/ai-seo/sitemap"?"sitemap":a==="/ai-seo/store-metadata"?"store-metadata":a==="/ai-seo/schema-data"?"schema-data":"products",n=l=>{const c=new URLSearchParams(window.location.search),u=c.toString()?`?${c.toString()}`:"";return l==="products"?`/ai-seo${u}`:`/ai-seo/${l}${u}`};return t.jsxs("div",{children:[t.jsx(E,{paddingBlockEnd:"400",children:t.jsx(D,{children:t.jsx(E,{padding:"200",children:t.jsxs(C,{gap:"100",children:[t.jsx("a",{href:n("products"),style:{padding:"8px 16px",borderRadius:"4px",backgroundColor:e==="products"?"#008060":"#f6f6f7",color:e==="products"?"white":"#202223",textDecoration:"none",display:"inline-block"},children:"Products"}),t.jsx("a",{href:n("collections"),style:{padding:"8px 16px",borderRadius:"4px",backgroundColor:e==="collections"?"#008060":"#f6f6f7",color:e==="collections"?"white":"#202223",textDecoration:"none",display:"inline-block"},children:"Collections"}),t.jsx("a",{href:n("sitemap"),style:{padding:"8px 16px",borderRadius:"4px",backgroundColor:e==="sitemap"?"#008060":"#f6f6f7",color:e==="sitemap"?"white":"#202223",textDecoration:"none",display:"inline-block"},children:"Sitemap"}),t.jsx("a",{href:n("store-metadata"),style:{padding:"8px 16px",borderRadius:"4px",backgroundColor:e==="store-metadata"?"#008060":"#f6f6f7",color:e==="store-metadata"?"white":"#202223",textDecoration:"none",display:"inline-block"},children:"Store metadata"}),t.jsx("a",{href:n("schema-data"),style:{padding:"8px 16px",borderRadius:"4px",backgroundColor:e==="schema-data"?"#008060":"#f6f6f7",color:e==="schema-data"?"white":"#202223",textDecoration:"none",display:"inline-block"},children:"Schema Data"})]})})})}),t.jsxs("div",{children:[e==="products"&&t.jsx(Z,{shop:i,globalPlan:s}),e==="collections"&&t.jsx(ee,{shop:i,globalPlan:s}),e==="sitemap"&&t.jsx(te,{shop:i}),e==="store-metadata"&&t.jsx(oe,{shop:i}),e==="schema-data"&&t.jsx(ne,{shop:i})]})]})});function ue(){const{path:o}=le(),{lang:s,setLang:i,t:a}=Q(),r=!!new URLSearchParams(window.location.search).get("host"),e=G("shop",""),[n,l]=p.useState(null);p.useEffect(()=>{const I=async()=>{const _=new URLSearchParams(window.location.search),g=_.get("shop"),x=_.get("id_token");if(g&&x)try{console.log("[APP] Performing initial token exchange for shop:",g);const m=await fetch("/token-exchange",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({shop:g,id_token:x})});if(!m.ok){const S=await m.json();console.error("[APP] Token exchange failed:",S);return}const P=await m.json();console.log("[APP] Token exchange successful:",P);const A=new URL(window.location);A.searchParams.delete("id_token"),window.history.replaceState({},"",A),await f(g)}catch(m){console.error("[APP] Token exchange error:",m)}else g&&await f(g)},f=async _=>{var g,x;try{const P=await fetch("/graphql",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:`
          query PlansMe($shop:String!) {
            plansMe(shop:$shop) {
              shop
              plan
              planKey
              priceUsd
              product_limit
              providersAllowed
              modelsSuggested
              subscriptionStatus
              trial {
                active
                ends_at
                days_left
              }
            }
          }
        `,variables:{shop:_}})});if(P.status===202&&(await P.json()).error==="token_exchange_required"){console.log("[APP] Token exchange required, but no id_token available"),window.location.href=`/auth?shop=${encodeURIComponent(_)}`;return}if(!P.ok){console.error("[APP] Failed to load plans:",await P.text());return}const A=await P.json(),S=(g=A==null?void 0:A.data)==null?void 0:g.plansMe;S&&(l(S),S.subscriptionStatus==="pending"&&((x=window.shopify)!=null&&x.navigate)&&(console.log("[APP] Subscription pending, redirecting to billing via App Bridge..."),window.shopify.navigate("/billing")))}catch(m){console.error("[APP] Error loading initial data:",m)}};I()},[]);const c=p.useMemo(()=>o.startsWith("/ai-seo")?"Search Optimization for AI":o.startsWith("/billing")?"Plans & Billing":o.startsWith("/settings")?"Settings":o.startsWith("/ai-testing")?"AI Testing":o.startsWith("/clean-uninstall")?"Clean & Uninstall":o.startsWith("/contact-support")?"Contact Support":"Dashboard",[o]),u=()=>(n==null?void 0:n.subscriptionStatus)==="pending"&&o!=="/billing"?(console.log("[APP] Subscription pending, showing Billing page for plan selection"),t.jsx(O,{shop:e})):o==="/"||o==="/dashboard"?t.jsx(X,{shop:e}):o.startsWith("/ai-seo")?t.jsx(pe,{shop:e,plan:n}):o==="/billing"?t.jsx(O,{shop:e}):o==="/settings"?(console.log("[APP] ===== RENDERING SETTINGS PAGE ====="),t.jsx(re,{shop:e})):o==="/contact-support"?(console.log("[APP] ===== RENDERING CONTACT SUPPORT PAGE ====="),t.jsx(ae,{shop:e})):o==="/ai-testing"?(console.log("[APP] ===== RENDERING AI TESTING PAGE ====="),console.log("[APP] Path:",o),console.log("[APP] Shop:",e),t.jsx(se,{shop:e})):o==="/clean-uninstall"?t.jsx(ie,{shop:e}):t.jsx(D,{children:t.jsxs(E,{padding:"400",children:[t.jsx(b,{variant:"headingMd",children:"Page not found"}),t.jsx(E,{paddingBlockStart:"200",children:t.jsxs(b,{children:['The page "',o,'" does not exist.']})})]})});return t.jsxs($,{i18n:ce,children:[r&&t.jsx(de,{active:o,shop:e}),t.jsx(z,{children:t.jsxs(V,{children:[t.jsx(q,{sectionTitle:c,lang:s,setLang:i,t:a,shop:e}),u()]})})]})}const v=new URLSearchParams(window.location.search),y=v.get("host"),w=v.get("shop"),k=v.get("embedded")==="1";console.log("[MAIN] Public App - Host:",y,"Shop:",w);console.log("[MAIN] Full URL:",window.location.href);function he(){const[o,s]=p.useState(!1),i=p.useMemo(()=>(console.log("[MAIN] Checking for API key..."),console.log("[MAIN] window.__SHOPIFY_API_KEY:",window.__SHOPIFY_API_KEY),console.log("[MAIN] import.meta.env.VITE_SHOPIFY_API_KEY:","2749a2f6d38ff5796ed256b5c9dc70a1"),window.__SHOPIFY_API_KEY?(console.log("[MAIN] Using injected API key:",window.__SHOPIFY_API_KEY),window.__SHOPIFY_API_KEY):(console.log("[MAIN] Using env API key:","2749a2f6d38ff5796ed256b5c9dc70a1"),"2749a2f6d38ff5796ed256b5c9dc70a1")),[]);return p.useEffect(()=>{setTimeout(()=>s(!0),100)},[]),!k||!y||!w?(console.log("[MAIN] Not embedded or missing params"),t.jsxs("div",{style:{padding:"20px",textAlign:"center"},children:[t.jsx("h1",{children:"Error: App must be loaded from Shopify Admin"}),t.jsxs("p",{children:["Shop: ",w||"Missing"]}),t.jsxs("p",{children:["Host: ",y||"Missing"]}),t.jsxs("p",{children:["Embedded: ",k?"Yes":"No"]}),t.jsx("a",{href:`https://admin.shopify.com/store/${w==null?void 0:w.replace(".myshopify.com","")}/apps`,children:"Go to Shopify Admin"})]})):i?(console.log("[MAIN] App config:",{apiKey:i?"SET":"MISSING",host:y?"SET":"MISSING",shop:w?"SET":"MISSING"}),o?t.jsx(ue,{}):t.jsx("div",{children:"Loading..."})):t.jsxs("div",{style:{padding:"20px",textAlign:"center"},children:[t.jsx("h1",{children:"Configuration Error"}),t.jsx("p",{children:"Shopify API key is not configured."}),t.jsx("p",{children:"Please contact support."})]})}M(document.getElementById("root")).render(t.jsx(he,{}));
