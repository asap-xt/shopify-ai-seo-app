import{j as a}from"./app-bridge-BavyHm11-1761331762024.js";import{r as w}from"./react-vendor-tAaa2TlE-1761331762024.js";import{u as K}from"./useShopApi-CjRv56oB-1761331762024.js";import{a as g,e as P,T as f,d as A,C as _,I as F,j as T,y as U,B as W}from"./polaris-rwJQ_KVp-1761331762024.js";class x{constructor(s=0,t="Network Error"){this.status=s,this.text=t}}const $=()=>{if(!(typeof localStorage>"u"))return{get:e=>Promise.resolve(localStorage.getItem(e)),set:(e,s)=>Promise.resolve(localStorage.setItem(e,s)),remove:e=>Promise.resolve(localStorage.removeItem(e))}},n={origin:"https://api.emailjs.com",blockHeadless:!1,storageProvider:$()},R=e=>e?typeof e=="string"?{publicKey:e}:e.toString()==="[object Object]"?e:{}:{},J=(e,s="https://api.emailjs.com")=>{if(!e)return;const t=R(e);n.publicKey=t.publicKey,n.blockHeadless=t.blockHeadless,n.storageProvider=t.storageProvider,n.blockList=t.blockList,n.limitRate=t.limitRate,n.origin=t.origin||s},B=async(e,s,t={})=>{const o=await fetch(n.origin+e,{method:"POST",headers:t,body:s}),i=await o.text(),h=new x(o.status,i);if(o.ok)return h;throw h},M=(e,s,t)=>{if(!e||typeof e!="string")throw"The public key is required. Visit https://dashboard.emailjs.com/admin/account";if(!s||typeof s!="string")throw"The service ID is required. Visit https://dashboard.emailjs.com/admin";if(!t||typeof t!="string")throw"The template ID is required. Visit https://dashboard.emailjs.com/admin/templates"},Q=e=>{if(e&&e.toString()!=="[object Object]")throw"The template params have to be the object. Visit https://www.emailjs.com/docs/sdk/send/"},C=e=>e.webdriver||!e.languages||e.languages.length===0,E=()=>new x(451,"Unavailable For Headless Browser"),Y=(e,s)=>{if(!Array.isArray(e))throw"The BlockList list has to be an array";if(typeof s!="string")throw"The BlockList watchVariable has to be a string"},X=e=>{var s;return!((s=e.list)!=null&&s.length)||!e.watchVariable},Z=(e,s)=>e instanceof FormData?e.get(s):e[s],q=(e,s)=>{if(X(e))return!1;Y(e.list,e.watchVariable);const t=Z(s,e.watchVariable);return typeof t!="string"?!1:e.list.includes(t)},H=()=>new x(403,"Forbidden"),ee=(e,s)=>{if(typeof e!="number"||e<0)throw"The LimitRate throttle has to be a positive number";if(s&&typeof s!="string")throw"The LimitRate ID has to be a non-empty string"},te=async(e,s,t)=>{const o=Number(await t.get(e)||0);return s-Date.now()+o},O=async(e,s,t)=>{if(!s.throttle||!t)return!1;ee(s.throttle,s.id);const o=s.id||e;return await te(o,s.throttle,t)>0?!0:(await t.set(o,Date.now().toString()),!1)},N=()=>new x(429,"Too Many Requests"),se=async(e,s,t,o)=>{const i=R(o),h=i.publicKey||n.publicKey,y=i.blockHeadless||n.blockHeadless,u=i.storageProvider||n.storageProvider,v={...n.blockList,...i.blockList},d={...n.limitRate,...i.limitRate};return y&&C(navigator)?Promise.reject(E()):(M(h,e,s),Q(t),t&&q(v,t)?Promise.reject(H()):await O(location.pathname,d,u)?Promise.reject(N()):B("/api/v1.0/email/send",JSON.stringify({lib_version:"4.4.1",user_id:h,service_id:e,template_id:s,template_params:t}),{"Content-type":"application/json"}))},re=e=>{if(!e||e.nodeName!=="FORM")throw"The 3rd parameter is expected to be the HTML form element or the style selector of the form"},ae=e=>typeof e=="string"?document.querySelector(e):e,ie=async(e,s,t,o)=>{const i=R(o),h=i.publicKey||n.publicKey,y=i.blockHeadless||n.blockHeadless,u=n.storageProvider||i.storageProvider,v={...n.blockList,...i.blockList},d={...n.limitRate,...i.limitRate};if(y&&C(navigator))return Promise.reject(E());const m=ae(t);M(h,e,s),re(m);const p=new FormData(m);return q(v,p)?Promise.reject(H()):await O(location.pathname,d,u)?Promise.reject(N()):(p.append("lib_version","4.4.1"),p.append("service_id",e),p.append("template_id",s),p.append("user_id",h),B("/api/v1.0/email/send-form",p))},oe={init:J,send:se,sendForm:ie,EmailJSResponseStatus:x},L=[{label:"Bug Report",value:"bug_report"},{label:"Feature Request",value:"feature_request"},{label:"Billing Issue",value:"billing_issue"},{label:"General Question",value:"general_question"},{label:"Technical Support",value:"technical_support"}];function me({shop:e}){const{api:s}=K(),[t,o]=w.useState({name:"",email:"",subject:"general_question",message:"",file:null}),[i,h]=w.useState(!1),[y,u]=w.useState(null),[v,d]=w.useState(""),[m,p]=w.useState(null),S=e||((r,l="")=>{try{return new URLSearchParams(window.location.search).get(r)||l}catch{return l}})("shop","");w.useEffect(()=>{z()},[S]);const z=async()=>{try{const r=await s(`/api/shop/info?shop=${encodeURIComponent(S)}`);p(r),o(l=>({...l,name:(r==null?void 0:r.name)||"",email:(r==null?void 0:r.email)||""}))}catch(r){console.error("[ContactSupport] Error loading shop info:",r)}},k=(r,l)=>{o(c=>({...c,[r]:l}))},D=r=>{if(r.length>0){const l=r[0];if(!l.type.startsWith("image/")){u("error"),d("Only image files are allowed (JPG, PNG, GIF, etc.)");return}if(l.size>5*1024*1024){u("error"),d("File size must be less than 5MB");return}o(c=>({...c,file:l}))}},G=r=>new Promise((l,c)=>{const j=new FileReader;j.readAsDataURL(r),j.onload=()=>l(j.result),j.onerror=b=>c(b)}),V=()=>t.name.trim()?t.email.trim()?t.message.trim()?!0:(u("error"),d("Please enter your message"),!1):(u("error"),d("Please enter your email"),!1):(u("error"),d("Please enter your name"),!1),I=async r=>{var l;if(r.preventDefault(),!!V()){h(!0),u(null),d("");try{let c={name:t.name,email:t.email,subject:((l=L.find(b=>b.value===t.subject))==null?void 0:l.label)||t.subject,message:t.message,shop_name:(m==null?void 0:m.name)||S,shop_url:`https://${S}`,time:new Date().toLocaleString()};if(t.file)try{const b=await G(t.file);c.file_name=t.file.name,c.file_size=`${(t.file.size/1024).toFixed(1)} KB`,c.file_type=t.file.type,c.file_data=b,c.message+=`

ðŸ“Ž ATTACHED IMAGE:
Name: ${t.file.name}
Size: ${c.file_size}
Type: ${t.file.type}`}catch(b){console.error("[ContactSupport] Error converting file to base64:",b),u("error"),d("Failed to process file attachment");return}const j=await oe.send("service_c8j657n","template_zrftkfg",c,"-0N7g1SCh9fSknb6q");console.log("[ContactSupport] Email sent successfully:",j),u("success"),d("Message sent successfully! We'll get back to you within 24 hours."),o({name:(m==null?void 0:m.name)||"",email:(m==null?void 0:m.email)||"",subject:"general_question",message:"",file:null})}catch(c){console.error("[ContactSupport] Error sending email:",c),u("error"),d("Failed to send message. Please try again or contact us directly.")}finally{h(!1)}}};return a.jsx(g,{padding:"400",children:a.jsxs(P,{gap:"400",children:[a.jsx(f,{variant:"bodyMd",tone:"subdued",children:"Need help? Send us a message and we'll get back to you within 24 hours."}),y&&a.jsx(A,{tone:y==="success"?"success":"critical",children:v}),a.jsx(_,{children:a.jsx(g,{padding:"400",children:a.jsx("form",{onSubmit:I,children:a.jsxs(P,{gap:"400",children:[a.jsxs(F,{gap:"400",wrap:!0,children:[a.jsx(g,{flexGrow:1,children:a.jsx(T,{label:"Name",value:t.name,onChange:r=>k("name",r),placeholder:"Your name",required:!0,disabled:i})}),a.jsx(g,{flexGrow:1,children:a.jsx(T,{label:"Email",type:"email",value:t.email,onChange:r=>k("email",r),placeholder:"your@email.com",required:!0,disabled:i})})]}),a.jsx(U,{label:"Subject",options:L,value:t.subject,onChange:r=>k("subject",r),disabled:i}),a.jsx(T,{label:"Message",value:t.message,onChange:r=>k("message",r),multiline:4,placeholder:"Describe your issue or question...",required:!0,disabled:i}),a.jsxs(g,{children:[a.jsx(f,{as:"label",variant:"bodyMd",fontWeight:"medium",children:"Attach Image (Optional)"}),a.jsx(g,{paddingBlockStart:"100",children:a.jsx("input",{type:"file",accept:"image/*",onChange:r=>D(r.target.files),disabled:i,style:{padding:"8px",border:"1px solid #d1d5db",borderRadius:"4px",fontSize:"14px",width:"100%"}})}),a.jsx(f,{variant:"bodySm",tone:"subdued",children:"Only image files allowed (JPG, PNG, GIF, etc.) â€¢ Maximum file size: 5MB"})]}),a.jsx(F,{gap:"200",align:"end",children:a.jsx(W,{variant:"primary",submit:!0,loading:i,disabled:i,children:i?"Sending...":"Send Message"})})]})})})}),a.jsx(_,{children:a.jsx(g,{padding:"400",children:a.jsxs(P,{gap:"200",children:[a.jsx(f,{as:"h3",variant:"headingMd",children:"Other Ways to Reach Us"}),a.jsx(f,{variant:"bodyMd",tone:"subdued",children:"â€¢ Email: indexaize@gmail.com"}),a.jsx(f,{variant:"bodyMd",tone:"subdued",children:"â€¢ Response time: Within 24 hours"}),a.jsxs(f,{variant:"bodyMd",tone:"subdued",children:["â€¢ Include your shop name: ",S]})]})})})]})})}export{me as default};
