import{r as e,j as a}from"./react-vendor-BXVC7v0l.js";import{e as s}from"./vendor-Cs_VgJ2r.js";import{u as l}from"./useShopApi-BPGAW5iN.js";import{B as i,a as n,T as t,d as r,C as o,I as d,h as u,G as c,b as m}from"./polaris-LiLfZG0r.js";import"./app-bridge-DUY42B6P.js";const h=[{label:"Bug Report",value:"bug_report"},{label:"Feature Request",value:"feature_request"},{label:"Billing Issue",value:"billing_issue"},{label:"General Question",value:"general_question"},{label:"Technical Support",value:"technical_support"}];function g({shop:g}){const{api:p}=l(),[b,f]=e.useState({name:"",email:"",subject:"general_question",message:"",file:null}),[j,x]=e.useState(!1),[y,v]=e.useState(null),[S,w]=e.useState(""),[_,q]=e.useState(null),z=g||((e,a="")=>{try{return new URLSearchParams(window.location.search).get(e)||a}catch{return a}})("shop","");e.useEffect(()=>{M()},[z]);const M=async()=>{try{const e=await p(`/api/shop/info?shop=${encodeURIComponent(z)}`);q(e),f(a=>({...a,name:(null==e?void 0:e.name)||"",email:(null==e?void 0:e.email)||""}))}catch(e){}},F=(e,a)=>{f(s=>({...s,[e]:a}))};return a.jsx(i,{padding:"400",children:a.jsxs(n,{gap:"400",children:[a.jsx(t,{variant:"bodyMd",tone:"subdued",children:"Need help? Send us a message and we'll get back to you within 24 hours."}),y&&a.jsx(r,{tone:"success"===y?"success":"critical",children:S}),a.jsx(o,{children:a.jsx(i,{padding:"400",children:a.jsx("form",{onSubmit:async e=>{var a,l,i;if(e.preventDefault(),b.name.trim()?b.email.trim()?b.message.trim()||(v("error"),w("Please enter your message"),0):(v("error"),w("Please enter your email"),0):(v("error"),w("Please enter your name"),0)){x(!0),v(null),w("");try{let e={name:b.name,email:b.email,subject:(null==(a=h.find(e=>e.value===b.subject))?void 0:a.label)||b.subject,message:b.message,shop_name:(null==_?void 0:_.name)||z,shop_url:`https://${z}`,time:(new Date).toLocaleString()};if(b.file)try{const a=await(n=b.file,new Promise((e,a)=>{const s=new FileReader;s.readAsDataURL(n),s.onload=()=>e(s.result),s.onerror=e=>a(e)}));e.file_name=b.file.name,e.file_size=`${(b.file.size/1024).toFixed(1)} KB`,e.file_type=b.file.type,e.file_data=a}catch(t){e.message+=`\n\nðŸ“Ž ATTACHED FILE (conversion failed):\nName: ${b.file.name}\nSize: ${(b.file.size/1024).toFixed(1)} KB\nType: ${b.file.type}`}await s.send("service_c8j657n","template_zrftkfg",e,"-0N7g1SCh9fSknb6q");v("success"),w("Message sent successfully! We'll get back to you within 24 hours."),f({name:(null==_?void 0:_.name)||"",email:(null==_?void 0:_.email)||"",subject:"general_question",message:"",file:null})}catch(t){v("error"),413===t.status||(null==(l=t.message)?void 0:l.includes("413"))||(null==(i=t.text)?void 0:i.includes("too large"))?w("Message too large. Please remove the attachment or reduce message length, then try again."):400===t.status?w("Invalid request. Please check your email address and try again."):429===t.status?w("Too many requests. Please wait a minute and try again."):w(`Failed to send message: ${t.text||t.message||"Please try again or email us at indexaize@gmail.com"}`)}finally{x(!1)}var n}},children:a.jsxs(n,{gap:"400",children:[a.jsxs(d,{gap:"400",wrap:!0,children:[a.jsx(i,{flexGrow:1,children:a.jsx(u,{label:"Name",value:b.name,onChange:e=>F("name",e),placeholder:"Your name",required:!0,disabled:j})}),a.jsx(i,{flexGrow:1,children:a.jsx(u,{label:"Email",type:"email",value:b.email,onChange:e=>F("email",e),placeholder:"your@email.com",required:!0,disabled:j})})]}),a.jsx(c,{label:"Subject",options:h,value:b.subject,onChange:e=>F("subject",e),disabled:j}),a.jsx(u,{label:"Message",value:b.message,onChange:e=>F("message",e),multiline:4,placeholder:"Describe your issue or question...",required:!0,disabled:j}),a.jsxs(i,{children:[a.jsx(t,{as:"label",variant:"bodyMd",fontWeight:"medium",children:"Attach File (Optional)"}),a.jsx(i,{paddingBlockStart:"100",children:a.jsx("input",{type:"file",onChange:e=>(e=>{if(e.length>0){const a=e[0];if(a.size>30720)return v("error"),void w("File size must be less than 30KB. For larger files, please email us directly at indexaize@gmail.com");f(e=>({...e,file:a}))}})(e.target.files),disabled:j,style:{padding:"8px",border:"1px solid #d1d5db",borderRadius:"4px",fontSize:"14px",width:"100%"}})}),a.jsx(t,{variant:"bodySm",tone:"subdued",children:"Any file type allowed â€¢ Maximum file size: 30KB â€¢ For larger files, email us directly"})]}),a.jsx(d,{gap:"200",align:"end",children:a.jsx(m,{variant:"primary",submit:!0,loading:j,disabled:j,children:j?"Sending...":"Send Message"})})]})})})}),a.jsx(o,{children:a.jsx(i,{padding:"400",children:a.jsxs(n,{gap:"200",children:[a.jsx(t,{as:"h3",variant:"headingMd",children:"Other Ways to Reach Us"}),a.jsx(t,{variant:"bodyMd",tone:"subdued",children:"â€¢ Email: indexaize@gmail.com"}),a.jsx(t,{variant:"bodyMd",tone:"subdued",children:"â€¢ Response time: Within 24 hours"}),a.jsxs(t,{variant:"bodyMd",tone:"subdued",children:["â€¢ Include your shop name: ",z]})]})})})]})})}export{g as default};
