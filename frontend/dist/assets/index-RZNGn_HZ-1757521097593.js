import{c as v,g as ye}from"./index--hfGF2VA-1757521097593.js";import{_ as Z,t as X,c as be,M as q,h as me,e as _e,P as Ae,C as Oe,W as Pe}from"./index-ptC5V1eK-1757521097593.js";function we(e,n){for(var c=0;c<n.length;c++){const u=n[c];if(typeof u!="string"&&!Array.isArray(u)){for(const i in u)if(i!=="default"&&!(i in e)){const a=Object.getOwnPropertyDescriptor(u,i);a&&Object.defineProperty(e,i,a.get?a:{enumerable:!0,get:()=>u[i]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}var x={exports:{}},ee={},U={},k={},D={};Object.defineProperty(D,"__esModule",{value:!0});D.mockAppBridge=D.serverAppBridge=void 0;var R=Z,B=function(){},Y=new Promise(function(){});D.serverAppBridge={dispatch:function(){return{}},error:function(){return B},featuresAvailable:function(){return Promise.reject(R.fromAction("Feature detection is only available on the client side.",R.AppActionType.WINDOW_UNDEFINED))},getState:function(){return Promise.reject(R.fromAction("State is only available on the client side.",R.AppActionType.WINDOW_UNDEFINED))},localOrigin:"",hostOrigin:"",subscribe:function(){return B}};D.mockAppBridge={dispatch:function(){return{}},error:function(){return B},featuresAvailable:function(){return Y},getState:function(){return Y},localOrigin:"",hostOrigin:"",subscribe:function(){return B}};var H={},y={};Object.defineProperty(y,"__esModule",{value:!0});y.getWindow=y.getLocation=y.redirect=y.shouldRedirect=void 0;function je(e){return e===window}y.shouldRedirect=je;function De(e){var n=re();n&&n.assign(e)}y.redirect=De;function re(){return te()?window.location:void 0}y.getLocation=re;function We(){return te()?window:void 0}y.getWindow=We;function te(){return typeof window<"u"}Object.defineProperty(H,"__esModule",{value:!0});H.handleAppPrint=void 0;var ne=y;function Ce(){return navigator.userAgent.indexOf("iOS")>=0}function Ee(){var e=ne.getWindow();if(!(!e||!e.document||!e.document.body)){var n=e.document.createElement("input");return n.style.display="none",e.document.body.appendChild(n),n}}function ie(){var e;(e=ne.getWindow())===null||e===void 0||e.print()}function Ie(){var e=Ee();e&&(e.select(),ie(),e.remove())}function Me(){Ce()?Ie():ie()}H.handleAppPrint=Me;var $={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.isV1Config=e.MessageType=e.LifecycleHook=e.PermissionType=void 0;var n=X;Object.defineProperty(e,"MessageType",{enumerable:!0,get:function(){return n.MessageType}});var c=X;Object.defineProperty(e,"PermissionType",{enumerable:!0,get:function(){return c.PermissionType}}),Object.defineProperty(e,"LifecycleHook",{enumerable:!0,get:function(){return c.LifecycleHook}});function u(i){return!i.host}e.isV1Config=u})($);var z={},oe={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.removeFromCollection=e.addAndRemoveFromCollection=void 0;var n=be;Object.defineProperty(e,"addAndRemoveFromCollection",{enumerable:!0,get:function(){return n.addAndRemoveFromCollection}}),Object.defineProperty(e,"removeFromCollection",{enumerable:!0,get:function(){return n.removeFromCollection}})})(oe);Object.defineProperty(z,"__esModule",{value:!0});var Ne=oe,Se=function(){function e(){this.map={}}return e.prototype.set=function(n,c){Object.prototype.hasOwnProperty.call(this.map,n)||(this.map[n]=[]);var u={handler:c,remove:function(){}},i=Ne.addAndRemoveFromCollection(this.map[n],u);return u={handler:c,remove:i},i},e.prototype.get=function(n){var c=this.map[n];return c?c.map(function(u){return u.handler}):void 0},e.prototype.run=function(n,c,u){for(var i=[],a=3;a<arguments.length;a++)i[a-3]=arguments[a];var t=0,p=this.get(n)||[];function W(){for(var P=[],w=0;w<arguments.length;w++)P[w]=arguments[w];var N=p[t++];return N?N(W).apply(u,P):c.apply(u,P)}return W.apply(u,i)},e}();z.default=Se;(function(e){var n=v&&v.__assign||function(){return n=Object.assign||function(r){for(var o,f=1,l=arguments.length;f<l;f++){o=arguments[f];for(var d in o)Object.prototype.hasOwnProperty.call(o,d)&&(r[d]=o[d])}return r},n.apply(this,arguments)},c=v&&v.__spreadArray||function(r,o){for(var f=0,l=o.length,d=r.length;f<l;f++,d++)r[d]=o[f];return r},u=v&&v.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(e,"__esModule",{value:!0}),e.createApp=e.createAppWrapper=e.createClientApp=e.WINDOW_UNDEFINED_MESSAGE=void 0;var i=me,a=Ae,t=Z,p=q,W=D,P=_e,w=Oe,N=Pe,ce=H,C=y,E=$,ue=u(z);e.WINDOW_UNDEFINED_MESSAGE="window is not defined. Running an app outside a browser is not supported";function fe(r,o){var f=o.apiKey,l=o.host,d=o.forceRedirect,A=d===void 0?!P.isDevelopmentClient:d,h=C.getLocation();if(P.isUnframed||!h||!f||!l||!A||!C.shouldRedirect(r))return!1;var I="https://"+l+"/apps/"+f+h.pathname+(h.search||"");return C.redirect(I),!0}var pe=function(r){return function(o){return r(n(n({},o),{version:i.getVersion(),clientInterface:{name:i.getPackageName(),version:i.getVersion()}}))}},le=function(r){r.set(E.LifecycleHook.DispatchAction,pe)};function se(r){r.subscribe(a.Action.APP,ce.handleAppPrint),r.dispatch(w.initialize());try{N.initializeWebVitals(r)}catch(o){console.error("App-Bridge failed to initialize web-vitals",o)}}var de=function(r,o){o===void 0&&(o=[]);var f=[],l=p.createTransportListener(),d=function(A){var h=A.data,I=h.type,b=h.payload;switch(I){case"getState":{var S=f.splice(0);S.forEach(function(T){return T(b)});break}case"dispatch":{l.handleMessage(b);var F=l.handleActionDispatch(b);if(F)return;var L=i.findMatchInEnum(t.Action,b.type);L&&t.throwError(L,b);break}}};return r.subscribe(d),function(A){var h=ve(A),I=fe(r.hostFrame,h);if(I)return W.mockAppBridge;var b=ge(r,h),S=l.createSubscribeHandler(b);b(E.MessageType.Unsubscribe);function F(s){return b(E.MessageType.Dispatch,s),s}for(var L=new URL("https://"+h.host).origin,T=new ue.default,O={hostOrigin:L,localOrigin:r.localOrigin,hooks:T,dispatch:function(s){return O.hooks?O.hooks.run(E.LifecycleHook.DispatchAction,F,O,s):F(s)},featuresAvailable:function(){for(var s=[],m=0;m<arguments.length;m++)s[m]=arguments[m];var g=s[0],_=Array.isArray(g)?c([],g):s;return O.getState("features").then(function(j){return _.length?_.reduce(function(M,G){return Object.keys(j).includes(G)&&(M[G]=j[G]),M},{}):j})},getState:function(s){return s&&typeof s!="string"?Promise.resolve(void 0):new Promise(function(m){f.push(m),b(E.MessageType.GetState)}).then(function(m){var g=m;if(s)for(var _=0,j=s.split(".");_<j.length;_++){var M=j[_];if(g==null||typeof g!="object"||Array.isArray(g)||!Object.keys(g).includes(M))return;g=g[M]}return g})},subscribe:S,error:function(s,m){var g=[];return i.forEachInEnum(t.Action,function(_){g.push(S(_,s,m))}),function(){g.forEach(function(_){return _()})}}},V=0,Q=o;V<Q.length;V++){var he=Q[V];he(T,O)}return se(O),O}};e.createClientApp=de;function ve(r){var o;if(!r.host)throw t.fromAction("host must be provided",t.AppActionType.INVALID_CONFIG);if(!r.apiKey)throw t.fromAction("apiKey must be provided",t.AppActionType.INVALID_CONFIG);try{var f=atob((o=r.host)===null||o===void 0?void 0:o.replace(/_/g,"/").replace(/-/g,"+"));return n(n({},r),{host:f})}catch{var l="not a valid host, please use the value provided by Shopify";throw t.fromAction(l,t.AppActionType.INVALID_CONFIG)}}function K(r,o,f){if(f===void 0&&(f=[]),!r)throw t.fromAction(e.WINDOW_UNDEFINED_MESSAGE,t.AppActionType.WINDOW_UNDEFINED);var l=C.getLocation(),d=o||l&&l.origin;if(!d)throw t.fromAction("local origin cannot be blank",t.AppActionType.MISSING_LOCAL_ORIGIN);var A=p.fromWindow(r,d),h=e.createClientApp(A,c([le],f));return h}e.createAppWrapper=K;function J(r){var o=C.getWindow();return!o||!o.top?W.serverAppBridge:K(o.top)(r)}e.createApp=J;function ge(r,o){return function(f,l){r.dispatch({payload:l,source:o,type:f})}}e.default=J})(k);(function(e){var n=v&&v.__createBinding||(Object.create?function(i,a,t,p){p===void 0&&(p=t),Object.defineProperty(i,p,{enumerable:!0,get:function(){return a[t]}})}:function(i,a,t,p){p===void 0&&(p=t),i[p]=a[t]}),c=v&&v.__exportStar||function(i,a){for(var t in i)t!=="default"&&!Object.prototype.hasOwnProperty.call(a,t)&&n(a,i,t)};Object.defineProperty(e,"__esModule",{value:!0});var u=k;c($,e),c(k,e),e.default=u.createClientApp})(U);(function(e){var n=v&&v.__createBinding||(Object.create?function(i,a,t,p){p===void 0&&(p=t),Object.defineProperty(i,p,{enumerable:!0,get:function(){return a[t]}})}:function(i,a,t,p){p===void 0&&(p=t),i[p]=a[t]}),c=v&&v.__exportStar||function(i,a){for(var t in i)t!=="default"&&!Object.prototype.hasOwnProperty.call(a,t)&&n(a,i,t)};Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var u=U;Object.defineProperty(e,"default",{enumerable:!0,get:function(){return u.createApp}}),c(q,e),c(U,e)})(ee);x.exports=ee;var ae=x.exports;const Fe=ye(ae),Re=we({__proto__:null,default:Fe},[ae]);export{Re as i};
