import{j as e}from"./app-bridge-CsdnMkb1-1761839646717.js";import{r as l}from"./react-vendor-tAaa2TlE-1761839646717.js";import{m as D}from"./sessionFetch-CJepNHo3-1761839646717.js";import{b as s,C as E,B as d,T as n,D as h,a,I as t,e as O,M as p,k as P}from"./polaris-BP4OLP-k-1761839646717.js";function F(){var f,y,b,v,S,A,M,w,C,k;const u=((i,I="")=>{try{return new URLSearchParams(window.location.search).get(i)||I}catch{return I}})("shop",""),T=l.useMemo(()=>D(),[]),[U,o]=l.useState(!1),[c,j]=l.useState(!1),[r,N]=l.useState(null),[L,x]=l.useState(!1),[g,m]=l.useState("");return e.jsxs(s,{gap:"400",children:[e.jsx(E,{children:e.jsx(d,{padding:"600",children:e.jsxs(s,{gap:"600",children:[e.jsx(s,{gap:"200",children:e.jsx(n,{variant:"bodyMd",tone:"subdued",children:"Prepare your store for app uninstallation"})}),e.jsx(h,{}),e.jsx(a,{status:"warning",title:"Before you uninstall",children:e.jsx("p",{children:"We recommend cleaning up all app data from your store before uninstalling. This ensures no unused metafields or configurations are left behind."})}),e.jsxs(s,{gap:"400",children:[e.jsx(n,{variant:"headingMd",children:"What will be removed:"}),e.jsx(d,{paddingInlineStart:"400",children:e.jsxs(s,{gap:"200",children:[e.jsxs(t,{gap:"200",blockAlign:"start",children:[e.jsx(n,{variant:"bodyMd",children:"•"}),e.jsx(n,{variant:"bodyMd",children:"All AI Search optimization content"})]}),e.jsxs(t,{gap:"200",blockAlign:"start",children:[e.jsx(n,{variant:"bodyMd",children:"•"}),e.jsx(n,{variant:"bodyMd",children:"AI-generated metadata and structured data"})]}),e.jsxs(t,{gap:"200",blockAlign:"start",children:[e.jsx(n,{variant:"bodyMd",children:"•"}),e.jsx(n,{variant:"bodyMd",children:"Store configuration (brand voice, policies, target audience)"})]}),e.jsxs(t,{gap:"200",blockAlign:"start",children:[e.jsx(n,{variant:"bodyMd",children:"•"}),e.jsx(n,{variant:"bodyMd",children:"Advanced schema markup"})]})]})}),e.jsx(a,{status:"info",children:e.jsxs("p",{children:["ℹ️ ",e.jsx("strong",{children:"Your product and collection data will NOT be affected."})," This will only remove AI-generated content created by our app. Your original product titles, descriptions, and Shopify SEO metafields will remain unchanged."]})})]}),e.jsx(h,{}),e.jsxs(s,{gap:"300",children:[e.jsx(n,{variant:"headingMd",children:"How it works:"}),e.jsx(d,{paddingInlineStart:"400",children:e.jsxs("ol",{style:{margin:0,paddingLeft:"20px"},children:[e.jsx("li",{children:'Click "Clean & Prepare for Uninstall" button below'}),e.jsx("li",{children:"Confirm that you want to remove all app data"}),e.jsx("li",{children:"Wait for the cleanup process to complete"}),e.jsx("li",{children:"Follow the instructions to complete uninstall in Shopify Admin"})]})})]}),e.jsx(h,{}),e.jsx(t,{gap:"200",children:e.jsx(O,{variant:"primary",tone:"critical",size:"large",onClick:()=>o(!0),children:"Clean & Prepare for Uninstall"})}),e.jsx(a,{status:"info",children:e.jsxs("p",{children:["💡 ",e.jsx("strong",{children:"Important:"})," This action will NOT uninstall the app automatically. After cleaning, you'll receive instructions on how to complete the uninstall process in Shopify Admin."]})})]})})}),U&&e.jsx(p,{open:!0,title:"⚠️ Confirm Data Cleanup",onClose:()=>!c&&o(!1),primaryAction:{content:c?"Cleaning...":"Yes, Clean Everything",onAction:async()=>{j(!0);try{console.log("[UNINSTALL] Starting cleanup...");const i=await T(`/api/store/prepare-uninstall?shop=${u}`,{method:"POST",shop:u});console.log("[UNINSTALL] Cleanup result:",i),N(i),o(!1),x(!0)}catch(i){console.error("[UNINSTALL] Cleanup error:",i),m("Error cleaning app data: "+i.message),o(!1)}finally{j(!1)}},loading:c,destructive:!0},secondaryActions:[{content:"Cancel",onAction:()=>o(!1),disabled:c}],children:e.jsx(p.Section,{children:e.jsxs(s,{gap:"400",children:[e.jsx(a,{status:"critical",title:"This action cannot be undone!",children:e.jsx("p",{children:"All AI Search optimization content and app configurations will be permanently removed from your store."})}),e.jsx(n,{variant:"bodyMd",children:e.jsx("strong",{children:"Are you sure you want to proceed?"})}),e.jsx(n,{variant:"bodyMd",tone:"subdued",children:"This will remove:"}),e.jsx(d,{paddingInlineStart:"400",children:e.jsxs("ul",{style:{margin:0,paddingLeft:"20px"},children:[e.jsx("li",{children:"All AI Search optimization content for products and collections"}),e.jsx("li",{children:"AI-generated metadata and structured data"}),e.jsx("li",{children:"Store configuration (brand voice, policies, target audience)"}),e.jsx("li",{children:"Advanced schema markup"})]})}),e.jsx(a,{status:"info",children:e.jsxs("p",{children:["✅ ",e.jsx("strong",{children:"Your original product and collection data will NOT be affected."})," Only AI-generated content will be removed."]})})]})})}),L&&r&&e.jsx(p,{open:!0,title:"✅ App Data Cleaned Successfully",onClose:()=>x(!1),primaryAction:{content:"Go to Apps & Sales Channels",onAction:()=>{window.open("https://admin.shopify.com/store/"+u.replace(".myshopify.com","")+"/settings/apps","_blank")}},secondaryActions:[{content:"Close",onAction:()=>x(!1)}],children:e.jsx(p.Section,{children:e.jsxs(s,{gap:"400",children:[e.jsx(a,{status:"success",title:"Cleanup completed!",children:e.jsx("p",{children:"All app data has been removed from your Shopify store."})}),e.jsx(n,{variant:"headingMd",children:"Cleanup Summary:"}),e.jsxs(s,{gap:"200",children:[e.jsxs(t,{gap:"200",blockAlign:"start",children:[e.jsx(n,{variant:"bodyMd",children:"✓"}),e.jsxs(n,{variant:"bodyMd",children:["AI Search optimization data cleared for ",e.jsx("strong",{children:(((y=(f=r.results)==null?void 0:f.productSeoData)==null?void 0:y.cleared)||0)+(((v=(b=r.results)==null?void 0:b.collectionSeoData)==null?void 0:v.cleared)||0)})," items"]})]}),e.jsxs(t,{gap:"200",blockAlign:"start",children:[e.jsx(n,{variant:"bodyMd",children:"✓"}),e.jsxs(n,{variant:"bodyMd",children:["Metadata definitions removed: ",e.jsx("strong",{children:((A=(S=r.results)==null?void 0:S.metafieldDefinitions)==null?void 0:A.deleted)||0})]})]}),e.jsxs(t,{gap:"200",blockAlign:"start",children:[e.jsx(n,{variant:"bodyMd",children:"✓"}),e.jsxs(n,{variant:"bodyMd",children:["Store configuration: ",e.jsx("strong",{children:(w=(M=r.results)==null?void 0:M.storeMetadata)!=null&&w.deleted?"Removed":"Not found"})]})]}),e.jsxs(t,{gap:"200",blockAlign:"start",children:[e.jsx(n,{variant:"bodyMd",children:"✓"}),e.jsxs(n,{variant:"bodyMd",children:["Advanced schema markup: ",e.jsx("strong",{children:(k=(C=r.results)==null?void 0:C.advancedSchemas)!=null&&k.deleted?"Removed":"Not found"})]})]})]}),e.jsx(a,{status:"success",children:e.jsxs("p",{children:["✅ ",e.jsx("strong",{children:"All AI-generated content has been removed."})," Your original product data, titles, descriptions, and Shopify SEO metafields remain unchanged."]})}),e.jsx(h,{}),e.jsx(n,{variant:"headingMd",children:"Next Steps:"}),e.jsx(d,{paddingInlineStart:"400",children:e.jsxs("ol",{style:{margin:0,paddingLeft:"20px"},children:[e.jsxs("li",{children:["Go to ",e.jsx("strong",{children:"Settings → Apps and sales channels"})]}),e.jsxs("li",{children:["Find ",e.jsx("strong",{children:'"NEW AI SEO"'})," in the list"]}),e.jsxs("li",{children:["Click the ",e.jsx("strong",{children:"three dots (•••)"})," menu"]}),e.jsxs("li",{children:["Select ",e.jsx("strong",{children:'"Uninstall"'})]}),e.jsx("li",{children:"Confirm the uninstallation"})]})}),e.jsx(a,{status:"info",children:e.jsx("p",{children:"💡 Your store data is now clean. You can safely uninstall the app without leaving behind any unused metafields or configurations."})})]})})}),g&&e.jsx(P,{content:g,onDismiss:()=>m("")})]})}export{F as default};
