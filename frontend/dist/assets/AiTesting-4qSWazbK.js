import{r as d,j as e,R as Ve}from"./react-vendor-6uwpMgJP.js";import{m as Ye}from"./sessionFetch-D2hEaNvd.js";import{I as He}from"./InsufficientTokensModal-CWgAibhb.js";import{T as Ke}from"./TrialActivationModal-D5G7vt1Y.js";import{g as Ce}from"./usePlanHierarchy-BjUEvxZF.js";import{a as c,d as f,T as t,C as B,B as j,I as l,D as C,e as O,L as ie,b as g,f as r,h as Xe,k as Ze,M as $}from"./polaris-B96_d87K.js";import"./app-bridge-ugs9K9zh.js";import"./vendor-BC2YhXnC.js";import"./index-snQI04k5.js";const _e=(H,u="")=>{try{return new URLSearchParams(window.location.search).get(H)||u}catch{return u}};function ut({shop:H}){const u=H||_e("shop",""),Me=i=>{const s=new URLSearchParams(window.location.search),a=s.toString()?`?${s.toString()}`:"";window.location.href=`${i}${a}`},[ae,b]=d.useState(""),S=d.useMemo(()=>Ye(),[]),[M,re]=d.useState(null),[oe,z]=d.useState(""),[Ie,ce]=d.useState(!1),[w,ze]=d.useState(null),[G,De]=d.useState(""),[Ee,U]=d.useState(!1),[qe,K]=d.useState(!1),[Oe,X]=d.useState(!1),[p,v]=d.useState(null),[$e,le]=d.useState(!1),[A,et]=d.useState(null),[k,de]=d.useState({}),[F,he]=d.useState(!1),[Ue,ue]=d.useState(0),[n,ge]=d.useState({}),[L,pe]=d.useState(!1),[Fe,xe]=d.useState(0),[Z,_]=d.useState(null),[tt,me]=d.useState(null),[st,ee]=d.useState(null),[je,Le]=d.useState({totalProducts:0,optimizedProducts:0,totalCollections:0,optimizedCollections:0});d.useEffect(()=>{u&&(Re(),R(),We())},[u,S]),d.useEffect(()=>{const i=()=>{!document.hidden&&u&&R()};return document.addEventListener("visibilitychange",i),()=>{document.removeEventListener("visibilitychange",i)}},[u,S]);const Re=async()=>{var i,s,a;try{const h=await S(`/api/billing/info?shop=${u}`),o=((i=h==null?void 0:h.subscription)==null?void 0:i.plan)||"Starter";re(o),_(((s=h==null?void 0:h.tokens)==null?void 0:s.balance)||0),me(((a=h==null?void 0:h.subscription)==null?void 0:a.trialEndsAt)||null)}catch(h){console.error("[AI-TESTING] Error loading billing info:",h),re("Starter"),_(0)}},R=async()=>{var i,s;try{const a=await S(`/api/billing/info?shop=${u}`);_(((i=a==null?void 0:a.tokens)==null?void 0:i.balance)||0),me(((s=a==null?void 0:a.subscription)==null?void 0:s.trialEndsAt)||null)}catch(a){console.error("[AI-TESTING] Error loading token balance:",a)}},We=async()=>{var i,s,a,h;try{const o=await S(`/api/dashboard/stats?shop=${u}`);Le({totalProducts:((i=o==null?void 0:o.products)==null?void 0:i.total)||0,optimizedProducts:((s=o==null?void 0:o.products)==null?void 0:s.optimized)||0,totalCollections:((a=o==null?void 0:o.collections)==null?void 0:a.total)||0,optimizedCollections:((h=o==null?void 0:o.collections)==null?void 0:h.optimized)||0})}catch(o){console.error("[AI-TESTING] Error loading stats:",o)}},x=d.useMemo(()=>((s,a,h)=>{var Se,we,ve,Ae,ke,Pe,Te;const o={endpointAvailability:0,aiValidationQuality:0,optimizationCoverage:0,structuredDataQuality:0,total:0},be={productsJson:5,basicSitemap:4,robotsTxt:2,schemaData:2,welcomePage:3,collectionsJson:4,storeMetadata:4,aiSitemap:3,advancedSchemaApi:3};let N=0,te=0;for(const[m,y]of Object.entries(s||{})){const T=be[m]||1;te+=T,y.status==="success"?N+=T:y.status==="warning"?N+=T*.7:y.status==="locked"&&(N+=T*.3)}o.endpointAvailability=te>0?Math.round(N/te*30):0;const Ge={excellent:1,good:.75,fair:.5,poor:.25,unavailable:0,locked:.1};let ye=0,se=0;for(const[m,y]of Object.entries(a||{})){if(m==="robotsTxt"||m==="schemaData")continue;const T=((Se=y.rating)==null?void 0:Se.toLowerCase())||"unavailable",Y=Ge[T]||0,J=be[m]||1;ye+=Y*J,se+=J}o.aiValidationQuality=se>0?Math.round(ye/se*40):0;const ne=h.totalProducts||0,Qe=h.optimizedProducts||0,fe=h.totalCollections||0,Ne=h.optimizedCollections||0;let V=0;if(ne>0){const m=Qe/ne;V+=m*12}if(fe>0){const m=Ne/fe;V+=m*8}else ne>0&&(V+=8);o.optimizationCoverage=Math.round(V);let I=0;if(((we=s==null?void 0:s.schemaData)==null?void 0:we.status)==="success"&&(I+=3),((ve=s==null?void 0:s.storeMetadata)==null?void 0:ve.status)==="success"){I+=3;const m=(ke=(Ae=a==null?void 0:a.storeMetadata)==null?void 0:Ae.rating)==null?void 0:ke.toLowerCase();m==="excellent"?I+=4:m==="good"&&(I+=2)}else((Pe=s==null?void 0:s.storeMetadata)==null?void 0:Pe.status)==="locked"&&(I+=1);((Te=s==null?void 0:s.advancedSchemaApi)==null?void 0:Te.status)==="success"&&(I+=2),o.structuredDataQuality=Math.min(10,Math.round(I)),o.total=Math.min(100,o.endpointAvailability+o.aiValidationQuality+o.optimizationCoverage+o.structuredDataQuality);let E="F",q="#ef4444";o.total>=90?(E="A+",q="#10b981"):o.total>=80?(E="A",q="#10b981"):o.total>=70?(E="B",q="#3b82f6"):o.total>=60?(E="C",q="#f59e0b"):o.total>=50&&(E="D",q="#f97316");const P=[];if(o.endpointAvailability<20&&P.push("Several AI discovery endpoints are missing or not working. Fix endpoint issues to improve your score."),o.aiValidationQuality<30){const m=Object.entries(a||{}).filter(([y,T])=>{var J;const Y=(J=T.rating)==null?void 0:J.toLowerCase();return(Y==="poor"||Y==="fair")&&y!=="robotsTxt"&&y!=="schemaData"}).map(([y])=>y);m.length>0&&(P.push(`${m.length} endpoint(s) have low data quality ratings. Improve content quality to boost your score.`),P.push(`Review and improve: ${m.join(", ")}`))}return o.optimizationCoverage<15&&(P.push("Low optimization coverage. Optimize more products and collections to improve your score."),P.push("Go to Search Optimization for AI and optimize your products/collections")),o.structuredDataQuality<7&&P.push("Structured data could be improved. Add organization schema and enhance product schema."),{score:o.total,grade:E,gradeColor:q,breakdown:o,recommendations:P.length>0?P:["Your store is well-optimized for AI search engines!"]}})(k,n,je),[k,n,je]),D=i=>{if(!M)return!1;const s=Ce(M);switch(i){case"productsJson":return s>=0;case"storeMetadata":return s>=1;case"welcomePage":case"collectionsJson":return s>=2;case"aiSitemap":return s>=3;case"schemaData":return s>=4;case"meta":return s>=0;case"claude":return s>=0;case"gemini":return s>=1;case"chatgpt":return s>=2;case"perplexity":return s>=3;case"deepseek":return s>=4;default:return!1}},Q=(i,s)=>{ze({name:i,url:s}),ce(!0)},Je=async()=>{he(!0),ue(0),de({});try{const i=await S("/api/ai-testing/run-tests",{method:"POST",body:{shop:u}});i.results?(de(i.results),ue(100),b("Basic tests completed!")):b("Testing failed. Please try again.")}catch(i){console.error("[AI-TESTING] Error running tests:",i),b("Failed to run tests. Please try again.")}finally{he(!1)}},Be=async()=>{if(Ce(M)<1){v({message:"AI-powered validation requires Professional plan or higher",requiredPlan:"Professional",currentPlan:M||"Starter"}),U(!0);return}pe(!0),xe(0),ge({});try{const s=await S("/api/ai-testing/ai-validate",{method:"POST",body:{shop:u,endpointResults:k}});if(s&&s.results){if(ge(s.results),xe(100),s.aiEOScore){const a=s.aiEOScore;ee(a),b(`AI validation completed! Score: ${a.score||"N/A"}/100 (${s.tokensUsed||0} tokens used)`)}else ee(null),b(`AI validation completed! (${s.tokensUsed||0} tokens used)`);R()}else ee(null),b("AI validation failed. Please try again.")}catch(s){if(s.status===402){if(s.trialRestriction&&s.requiresActivation){v(s),X(!0);return}if(s.requiresUpgrade){v(s),U(!0);return}if(s.requiresPurchase){v(s),K(!0);return}}b("Failed to run AI validation. Please try again.")}finally{pe(!1)}},W=async(i,s=null)=>{try{z("Generating AI response...");let a=`/api/ai-discovery/simulate?shop=${u}&type=${i}`;s&&(a+=`&question=${encodeURIComponent(s)}`);const h=await S(a,{method:"GET"});z(h.response||"No response generated")}catch(a){if(console.error("[AI-TESTING] Simulation error:",a),a.status===402){if(a.trialRestriction&&a.requiresActivation){v(a),X(!0),z("");return}if(a.requiresUpgrade){v(a),U(!0),z("");return}if(a.requiresPurchase){v(a),K(!0),z("");return}}z("Error generating response. Please try again."),b("Failed to simulate AI response")}};return e.jsxs(e.Fragment,{children:[e.jsxs(c,{gap:"400",children:[e.jsx(f,{tone:"info",children:e.jsx(t,{children:"Test how AI models discover and understand your store content. Check if your structured data and AI Discovery features are working correctly."})}),e.jsx(B,{children:e.jsx(j,{padding:"400",children:e.jsxs(c,{gap:"300",children:[e.jsxs(l,{align:"space-between",blockAlign:"center",children:[e.jsxs(c,{gap:"100",children:[e.jsx(t,{as:"h3",variant:"headingMd",children:"AIEO Score"}),e.jsx(t,{variant:"bodySm",tone:"subdued",children:"Overall AI Engine Optimization rating"})]}),e.jsx(c,{gap:"100",align:"end",children:e.jsx(j,{style:{width:"80px",height:"80px",borderRadius:"50%",background:`conic-gradient(${x.gradeColor} ${x.score*3.6}deg, #e5e7eb ${x.score*3.6}deg)`,display:"flex",alignItems:"center",justifyContent:"center",position:"relative"},children:e.jsxs(j,{style:{width:"60px",height:"60px",borderRadius:"50%",background:"white",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column"},children:[e.jsx(t,{variant:"headingLg",fontWeight:"bold",style:{color:x.gradeColor},children:x.score}),e.jsx(t,{variant:"bodyXs",style:{color:x.gradeColor,marginTop:"-4px"},children:x.grade})]})})})]}),e.jsx(C,{}),e.jsxs(c,{gap:"200",children:[e.jsx(t,{variant:"headingSm",children:"Score Breakdown"}),e.jsxs(c,{gap:"100",children:[e.jsxs(l,{align:"space-between",children:[e.jsx(t,{variant:"bodyMd",children:"Endpoint Availability"}),e.jsxs(t,{variant:"bodyMd",fontWeight:"semibold",children:[x.breakdown.endpointAvailability,"/30"]})]}),e.jsx(O,{progress:Math.round(x.breakdown.endpointAvailability/30*100),size:"small",tone:"primary"})]}),e.jsxs(c,{gap:"100",children:[e.jsxs(l,{align:"space-between",children:[e.jsx(t,{variant:"bodyMd",children:"AI Validation Quality"}),e.jsxs(t,{variant:"bodyMd",fontWeight:"semibold",children:[x.breakdown.aiValidationQuality,"/40"]})]}),e.jsx(O,{progress:Math.round(x.breakdown.aiValidationQuality/40*100),size:"small",tone:"primary"})]}),e.jsxs(c,{gap:"100",children:[e.jsxs(l,{align:"space-between",children:[e.jsx(t,{variant:"bodyMd",children:"Optimization Coverage"}),e.jsxs(t,{variant:"bodyMd",fontWeight:"semibold",children:[x.breakdown.optimizationCoverage,"/20"]})]}),e.jsx(O,{progress:Math.round(x.breakdown.optimizationCoverage/20*100),size:"small",tone:"primary"})]}),e.jsxs(c,{gap:"100",children:[e.jsxs(l,{align:"space-between",children:[e.jsx(t,{variant:"bodyMd",children:"Structured Data Quality"}),e.jsxs(t,{variant:"bodyMd",fontWeight:"semibold",children:[x.breakdown.structuredDataQuality,"/10"]})]}),e.jsx(O,{progress:Math.round(x.breakdown.structuredDataQuality/10*100),size:"small",tone:"primary"})]})]}),x.recommendations&&x.recommendations.length>0&&e.jsxs(c,{gap:"200",children:[e.jsx(t,{variant:"headingSm",children:"Recommendations"}),x.recommendations.map((i,s)=>e.jsx(f,{tone:i.includes("Fix")||i.includes("Improve")||i.includes("low")?"critical":i.includes("Review")?"warning":"info",children:e.jsx(t,{variant:"bodyMd",children:i})},s))]})]})})}),e.jsxs(ie,{children:[e.jsx(ie.Section,{variant:"oneHalf",children:e.jsx(B,{children:e.jsx(j,{padding:"300",children:e.jsxs(c,{gap:"400",children:[e.jsxs(l,{align:"space-between",blockAlign:"center",children:[e.jsxs(c,{gap:"100",children:[e.jsx(t,{as:"h3",variant:"headingMd",children:"ðŸ”§ Basic AIEO Tests"}),e.jsx(t,{variant:"bodySm",tone:"subdued",children:"Quick check if endpoints are accessible and returning data"})]}),e.jsx(g,{onClick:Je,loading:F,disabled:F,children:F?"Testing...":"Run Basic Tests"})]}),F&&e.jsx(j,{children:e.jsxs(c,{gap:"200",children:[e.jsx(t,{variant:"bodySm",children:"Testing endpoints..."}),e.jsx(O,{progress:Ue,size:"small"})]})}),Object.keys(k).length>0&&e.jsx(c,{gap:"300",children:Object.entries(k).map(([i,s],a)=>{const h=a===Object.entries(k).length-1;return e.jsxs(Ve.Fragment,{children:[e.jsx(l,{align:"space-between",blockAlign:"center",children:e.jsxs(c,{gap:"100",children:[e.jsxs(l,{gap:"200",blockAlign:"center",children:[e.jsx(t,{variant:"bodyMd",fontWeight:"semibold",children:s.name}),s.status==="success"&&e.jsx(r,{tone:"success",children:"âœ“ OK"}),s.status==="warning"&&e.jsx(r,{tone:"warning",children:"âš ï¸ Warning"}),s.status==="error"&&e.jsx(r,{tone:"critical",children:"âœ— Failed"}),s.status==="locked"&&e.jsx(r,{children:"ðŸ”’ Locked"})]}),e.jsx(t,{variant:"bodySm",tone:"subdued",children:s.message}),s.actionLink&&e.jsx(g,{size:"slim",onClick:()=>Me(s.actionLink),children:i==="basicSitemap"?"Go to Sitemap":i==="aiSitemap"?"Go to Settings":"Go"})]})}),!h&&e.jsx(C,{})]},i)})}),Object.keys(k).length===0&&!F&&e.jsx(f,{tone:"info",children:e.jsx(t,{children:'Click "Run Basic Tests" to check if your AI Discovery endpoints are configured correctly.'})})]})})})}),e.jsx(ie.Section,{variant:"oneHalf",children:e.jsx(B,{children:e.jsx(j,{padding:"300",children:e.jsxs(c,{gap:"400",children:[e.jsxs(l,{align:"space-between",blockAlign:"center",children:[e.jsxs(c,{gap:"100",children:[e.jsxs(l,{gap:"200",blockAlign:"center",children:[e.jsx(t,{as:"h3",variant:"headingMd",children:"ðŸ¤– AI-Powered Validation"}),Z!==null&&e.jsxs(r,{tone:Z>50?"success":"warning",children:[Z," tokens"]}),e.jsx(g,{size:"micro",onClick:()=>R(),accessibilityLabel:"Refresh token balance",children:"ðŸ”„"})]}),e.jsx(t,{variant:"bodySm",tone:"subdued",children:"Deep analysis with AI bot"}),M&&e.jsx(t,{variant:"bodySm",tone:"subdued",children:"Requires: Professional+ plan & pay-per-use tokens"})]}),e.jsx(g,{onClick:Be,loading:L,disabled:L||Object.keys(k).length===0,variant:"primary",children:L?"Validating...":"Test with AI Bot"})]}),L&&e.jsx(j,{children:e.jsxs(c,{gap:"200",children:[e.jsx(t,{variant:"bodySm",children:"AI is analyzing your endpoints..."}),e.jsx(O,{progress:Fe,size:"small",tone:"primary"})]})}),Object.keys(n).length>0&&e.jsxs(c,{gap:"300",children:[n.productsJson&&e.jsxs(e.Fragment,{children:[e.jsx(l,{align:"space-between",blockAlign:"center",children:e.jsxs(c,{gap:"100",children:[e.jsxs(l,{gap:"200",blockAlign:"center",children:[e.jsx(t,{variant:"bodyMd",fontWeight:"semibold",children:"Products JSON Feed"}),n.productsJson.rating==="excellent"&&e.jsx(r,{tone:"success",children:"ðŸ¤– Excellent"}),n.productsJson.rating==="good"&&e.jsx(r,{tone:"success",children:"ðŸ¤– Good"}),n.productsJson.rating==="fair"&&e.jsx(r,{tone:"warning",children:"ðŸ¤– Fair"}),n.productsJson.rating==="poor"&&e.jsx(r,{tone:"critical",children:"ðŸ¤– Poor"}),n.productsJson.rating==="locked"&&e.jsx(r,{children:"ðŸ”’ Locked"}),n.productsJson.rating==="unavailable"&&e.jsx(r,{tone:"critical",children:"âŒ Unavailable"})]}),e.jsx(t,{variant:"bodySm",children:n.productsJson.feedback}),n.productsJson.suggestions&&e.jsxs(t,{variant:"bodySm",tone:"subdued",children:["ðŸ’¡ ",n.productsJson.suggestions]})]})}),e.jsx(C,{})]}),n.storeMetadata&&e.jsxs(e.Fragment,{children:[e.jsx(l,{align:"space-between",blockAlign:"center",children:e.jsxs(c,{gap:"100",children:[e.jsxs(l,{gap:"200",blockAlign:"center",children:[e.jsx(t,{variant:"bodyMd",fontWeight:"semibold",children:"Store Metadata"}),n.storeMetadata.rating==="excellent"&&e.jsx(r,{tone:"success",children:"ðŸ¤– Excellent"}),n.storeMetadata.rating==="good"&&e.jsx(r,{tone:"success",children:"ðŸ¤– Good"}),n.storeMetadata.rating==="fair"&&e.jsx(r,{tone:"warning",children:"ðŸ¤– Fair"}),n.storeMetadata.rating==="poor"&&e.jsx(r,{tone:"critical",children:"ðŸ¤– Poor"}),n.storeMetadata.rating==="locked"&&e.jsx(r,{children:"ðŸ”’ Locked"}),n.storeMetadata.rating==="unavailable"&&e.jsx(r,{tone:"critical",children:"âŒ Unavailable"})]}),e.jsx(t,{variant:"bodySm",children:n.storeMetadata.feedback}),n.storeMetadata.suggestions&&e.jsxs(t,{variant:"bodySm",tone:"subdued",children:["ðŸ’¡ ",n.storeMetadata.suggestions]})]})}),e.jsx(C,{})]}),n.welcomePage&&e.jsxs(e.Fragment,{children:[e.jsx(l,{align:"space-between",blockAlign:"center",children:e.jsxs(c,{gap:"100",children:[e.jsxs(l,{gap:"200",blockAlign:"center",children:[e.jsx(t,{variant:"bodyMd",fontWeight:"semibold",children:"AI Welcome Page"}),n.welcomePage.rating==="excellent"&&e.jsx(r,{tone:"success",children:"ðŸ¤– Excellent"}),n.welcomePage.rating==="good"&&e.jsx(r,{tone:"success",children:"ðŸ¤– Good"}),n.welcomePage.rating==="fair"&&e.jsx(r,{tone:"warning",children:"ðŸ¤– Fair"}),n.welcomePage.rating==="poor"&&e.jsx(r,{tone:"critical",children:"ðŸ¤– Poor"}),n.welcomePage.rating==="locked"&&e.jsx(r,{children:"ðŸ”’ Locked"}),n.welcomePage.rating==="unavailable"&&e.jsx(r,{tone:"critical",children:"âŒ Unavailable"})]}),e.jsx(t,{variant:"bodySm",children:n.welcomePage.feedback}),n.welcomePage.suggestions&&e.jsxs(t,{variant:"bodySm",tone:"subdued",children:["ðŸ’¡ ",n.welcomePage.suggestions]})]})}),e.jsx(C,{})]}),n.collectionsJson&&e.jsxs(e.Fragment,{children:[e.jsx(l,{align:"space-between",blockAlign:"center",children:e.jsxs(c,{gap:"100",children:[e.jsxs(l,{gap:"200",blockAlign:"center",children:[e.jsx(t,{variant:"bodyMd",fontWeight:"semibold",children:"Collections JSON Feed"}),n.collectionsJson.rating==="excellent"&&e.jsx(r,{tone:"success",children:"ðŸ¤– Excellent"}),n.collectionsJson.rating==="good"&&e.jsx(r,{tone:"success",children:"ðŸ¤– Good"}),n.collectionsJson.rating==="fair"&&e.jsx(r,{tone:"warning",children:"ðŸ¤– Fair"}),n.collectionsJson.rating==="poor"&&e.jsx(r,{tone:"critical",children:"ðŸ¤– Poor"}),n.collectionsJson.rating==="locked"&&e.jsx(r,{children:"ðŸ”’ Locked"}),n.collectionsJson.rating==="unavailable"&&e.jsx(r,{tone:"critical",children:"âŒ Unavailable"})]}),e.jsx(t,{variant:"bodySm",children:n.collectionsJson.feedback}),n.collectionsJson.suggestions&&e.jsxs(t,{variant:"bodySm",tone:"subdued",children:["ðŸ’¡ ",n.collectionsJson.suggestions]})]})}),e.jsx(C,{})]}),n.aiSitemap&&e.jsxs(e.Fragment,{children:[e.jsx(l,{align:"space-between",blockAlign:"center",children:e.jsxs(c,{gap:"100",children:[e.jsxs(l,{gap:"200",blockAlign:"center",children:[e.jsx(t,{variant:"bodyMd",fontWeight:"semibold",children:"AI-Enhanced Sitemap"}),n.aiSitemap.rating==="excellent"&&e.jsx(r,{tone:"success",children:"ðŸ¤– Excellent"}),n.aiSitemap.rating==="good"&&e.jsx(r,{tone:"success",children:"ðŸ¤– Good"}),n.aiSitemap.rating==="fair"&&e.jsx(r,{tone:"warning",children:"ðŸ¤– Fair"}),n.aiSitemap.rating==="poor"&&e.jsx(r,{tone:"critical",children:"ðŸ¤– Poor"}),n.aiSitemap.rating==="locked"&&e.jsx(r,{children:"ðŸ”’ Locked"}),n.aiSitemap.rating==="unavailable"&&e.jsx(r,{tone:"critical",children:"âŒ Unavailable"})]}),e.jsx(t,{variant:"bodySm",children:n.aiSitemap.feedback}),n.aiSitemap.suggestions&&e.jsxs(t,{variant:"bodySm",tone:"subdued",children:["ðŸ’¡ ",n.aiSitemap.suggestions]})]})}),e.jsx(C,{})]}),n.schemaData&&e.jsx(l,{align:"space-between",blockAlign:"center",children:e.jsxs(c,{gap:"100",children:[e.jsxs(l,{gap:"200",blockAlign:"center",children:[e.jsx(t,{variant:"bodyMd",fontWeight:"semibold",children:"Advanced Schema Data"}),n.schemaData.rating==="excellent"&&e.jsx(r,{tone:"success",children:"ðŸ¤– Excellent"}),n.schemaData.rating==="good"&&e.jsx(r,{tone:"success",children:"ðŸ¤– Good"}),n.schemaData.rating==="fair"&&e.jsx(r,{tone:"warning",children:"ðŸ¤– Fair"}),n.schemaData.rating==="poor"&&e.jsx(r,{tone:"critical",children:"ðŸ¤– Poor"}),n.schemaData.rating==="locked"&&e.jsx(r,{children:"ðŸ”’ Locked"}),n.schemaData.rating==="unavailable"&&e.jsx(r,{tone:"critical",children:"âŒ Unavailable"})]}),e.jsx(t,{variant:"bodySm",children:n.schemaData.feedback}),n.schemaData.suggestions&&e.jsxs(t,{variant:"bodySm",tone:"subdued",children:["ðŸ’¡ ",n.schemaData.suggestions]})]})})]}),Object.keys(n).length===0&&!L&&e.jsx(f,{tone:"info",children:e.jsx(t,{children:Object.keys(k).length===0?"Run Basic Tests first, then use AI validation for deep analysis":'Click "Test with AI Bot" to get AI-powered feedback on your endpoint data quality'})}),!M&&e.jsx(f,{tone:"warning",children:e.jsx(t,{children:"Loading plan information..."})})]})})})})]}),e.jsx(B,{children:e.jsx(j,{padding:"300",children:e.jsxs(c,{gap:"400",children:[e.jsx(t,{as:"h3",variant:"headingMd",children:"Test with Real AI Bots"}),e.jsx(t,{variant:"bodyMd",tone:"subdued",children:"Manually test your store with real AI search engines"}),e.jsxs(c,{gap:"200",children:[e.jsxs(l,{align:"space-between",children:[e.jsx(t,{children:"Meta AI Search"}),D("meta")?e.jsx(g,{onClick:()=>Q("Meta AI","https://www.meta.ai/"),size:"slim",children:"Test"}):e.jsx(g,{disabled:!0,size:"slim",children:"Plan upgrade required"})]}),e.jsxs(l,{align:"space-between",children:[e.jsx(t,{children:"Claude AI Search"}),D("claude")?e.jsx(g,{onClick:()=>Q("Claude AI","https://claude.ai/"),size:"slim",children:"Test"}):e.jsx(g,{disabled:!0,size:"slim",children:"Plan upgrade required"})]}),e.jsxs(l,{align:"space-between",children:[e.jsx(t,{children:"Gemini AI Search"}),D("gemini")?e.jsx(g,{onClick:()=>Q("Gemini AI","https://gemini.google.com/"),size:"slim",children:"Test"}):e.jsx(g,{disabled:!0,size:"slim",children:"Plan upgrade required"})]}),e.jsxs(l,{align:"space-between",children:[e.jsx(t,{children:"ChatGPT Web Search"}),D("chatgpt")?e.jsx(g,{url:`https://chat.openai.com/?q=What+products+does+${u}+sell%3F+Tell+me+about+this+business+and+what+they+offer`,external:!0,size:"slim",children:"Test"}):e.jsx(g,{disabled:!0,size:"slim",children:"Plan upgrade required"})]}),e.jsxs(l,{align:"space-between",children:[e.jsx(t,{children:"Perplexity AI Search"}),D("perplexity")?e.jsx(g,{url:`https://www.perplexity.ai/search?q=What+products+does+${u}+sell%3F+Tell+me+about+this+business+and+what+they+offer`,external:!0,size:"slim",children:"Test"}):e.jsx(g,{disabled:!0,size:"slim",children:"Plan upgrade required"})]}),e.jsxs(l,{align:"space-between",children:[e.jsx(t,{children:"DeepSeek AI Search"}),D("deepseek")?e.jsx(g,{onClick:()=>Q("DeepSeek AI","https://chat.deepseek.com/"),size:"slim",children:"Test"}):e.jsx(g,{disabled:!0,size:"slim",children:"Plan upgrade required"})]})]}),e.jsx(f,{tone:"info",children:e.jsxs(t,{children:[e.jsx("strong",{children:"How to test with AI bots:"}),e.jsx("br",{}),"â€¢ ",e.jsx("strong",{children:"Perplexity & ChatGPT:"}),' Click "Test" - they support URL parameters',e.jsx("br",{}),"â€¢ ",e.jsx("strong",{children:"Meta AI, Claude, Gemini, DeepSeek:"}),' Click "Test" to open a modal with the prompt to copy']})})]})})}),e.jsx(B,{children:e.jsx(j,{padding:"300",children:e.jsxs(c,{gap:"300",children:[e.jsx(t,{as:"h4",variant:"headingSm",children:"AI Search Simulation"}),e.jsx(t,{variant:"bodyMd",tone:"subdued",children:"Test how AI bots would respond to questions about your store based on your structured data."}),e.jsx(f,{tone:"info",children:e.jsxs(c,{gap:"100",children:[e.jsx(t,{variant:"bodySm",fontWeight:"semibold",children:"Simulation Details:"}),e.jsxs(t,{variant:"bodySm",children:["â€¢ ",e.jsx("strong",{children:"Data Source:"})," Your store's products, collections, and metadata"]}),e.jsxs(t,{variant:"bodySm",children:["â€¢ ",e.jsx("strong",{children:"Response Style:"})," Concise (2-3 sentences), natural language"]}),e.jsxs(t,{variant:"bodySm",children:["â€¢ ",e.jsx("strong",{children:"Best For:"})," General store info, products, categories, contact details"]}),e.jsxs(t,{variant:"bodySm",children:["â€¢ ",e.jsx("strong",{children:"Limitations:"})," May not have real-time data (current stock, active promotions, exact shipping times)"]})]})}),e.jsxs(c,{gap:"200",children:[e.jsxs(l,{align:"space-between",children:[e.jsx(t,{children:"What products does this store sell?"}),e.jsx(g,{onClick:()=>W("products"),size:"slim",children:"Simulate Response"})]}),e.jsxs(l,{align:"space-between",children:[e.jsx(t,{children:"Tell me about this business"}),e.jsx(g,{onClick:()=>W("business"),size:"slim",children:"Simulate Response"})]}),e.jsxs(l,{align:"space-between",children:[e.jsx(t,{children:"What categories does this store have?"}),e.jsx(g,{onClick:()=>W("categories"),size:"slim",children:"Simulate Response"})]}),e.jsxs(l,{align:"space-between",children:[e.jsx(t,{children:"What is this store's contact information?"}),e.jsx(g,{onClick:()=>W("contact"),size:"slim",children:"Simulate Response"})]})]}),e.jsx(C,{}),e.jsxs(c,{gap:"200",children:[e.jsx(t,{variant:"headingSm",children:"Ask Your Own Question"}),e.jsx(Xe,{label:"",value:G,onChange:De,placeholder:"e.g., What are your return policies? Do you ship internationally?",autoComplete:"off",connectedRight:e.jsx(g,{onClick:()=>{G.trim()?W("custom",G):b("Please enter a question")},disabled:!G.trim(),children:"Ask AI"})})]}),oe&&e.jsxs(j,{background:"bg-surface-secondary",padding:"300",borderRadius:"200",children:[e.jsx(t,{variant:"bodyMd",fontWeight:"semibold",children:"AI Bot Response:"}),e.jsx(j,{paddingBlockStart:"200",children:e.jsx(t,{variant:"bodyMd",children:oe})})]})]})})})]}),ae&&e.jsx(Ze,{content:ae,onDismiss:()=>b("")}),e.jsx($,{open:Ie,onClose:()=>ce(!1),title:`Test with ${w==null?void 0:w.name}`,primaryAction:{content:"Open AI Bot",url:w==null?void 0:w.url,external:!0},secondaryActions:[{content:"Copy Prompt",onAction:()=>{navigator.clipboard.writeText(`What products does ${u} sell? Tell me about this business and what they offer.`),b("Prompt copied to clipboard!")}}],children:e.jsx($.Section,{children:e.jsxs(c,{gap:"300",children:[e.jsx(t,{variant:"bodyMd",children:'1. Click "Copy Prompt" (left button)'}),e.jsxs(t,{variant:"bodyMd",children:['2. Click "Open AI Bot" (right button) to visit ',w==null?void 0:w.name]}),e.jsx(t,{variant:"bodyMd",children:"3. Paste the prompt and send"}),e.jsxs(j,{background:"bg-surface-secondary",padding:"300",borderRadius:"200",children:[e.jsx(t,{variant:"bodyMd",fontWeight:"semibold",children:"Prompt to test:"}),e.jsx(j,{paddingBlockStart:"200",children:e.jsxs(t,{variant:"bodyMd",as:"p",children:["What products does ",u," sell? Tell me about this business and what they offer."]})})]}),e.jsx(f,{tone:"info",children:e.jsx(t,{children:"The AI bot will search the web and use your store's structured data to answer."})})]})})}),e.jsx($,{open:$e,onClose:()=>le(!1),title:"Upgrade Required",primaryAction:{content:"View Plans",onAction:()=>{const i=new URLSearchParams(window.location.search),s=i.toString()?`?${i.toString()}`:"";window.location.href=`/billing${s}`}},secondaryActions:[{content:"Cancel",onAction:()=>le(!1)}],children:e.jsx($.Section,{children:e.jsxs(c,{gap:"300",children:[e.jsxs(t,{variant:"bodyMd",children:[e.jsx("strong",{children:A==null?void 0:A.endpoint})," requires ",e.jsx("strong",{children:A==null?void 0:A.requiredPlan})," plan or higher."]}),e.jsxs(t,{variant:"bodyMd",tone:"subdued",children:["Your current plan: ",e.jsx("strong",{children:A==null?void 0:A.currentPlan})]}),e.jsx(f,{tone:"info",children:e.jsx(t,{children:"Upgrade to access this advanced AI Discovery feature."})})]})})}),e.jsx($,{open:Ee,onClose:()=>U(!1),title:"Upgrade Required",primaryAction:{content:"View Plans",onAction:()=>{const i=new URLSearchParams(window.location.search),s=i.toString()?`?${i.toString()}`:"";window.location.href=`/billing${s}`}},secondaryActions:[{content:"Cancel",onAction:()=>U(!1)}],children:e.jsx($.Section,{children:e.jsxs(c,{gap:"300",children:[e.jsxs(t,{variant:"bodyMd",children:["AI Testing requires ",e.jsx("strong",{children:(p==null?void 0:p.minimumPlan)||"Professional"})," plan or higher."]}),e.jsxs(t,{variant:"bodyMd",tone:"subdued",children:["Your current plan: ",e.jsx("strong",{children:(p==null?void 0:p.currentPlan)||"Starter"})]}),e.jsx(f,{tone:"info",children:e.jsx(t,{children:"Upgrade to test AI responses with real store data."})})]})})}),e.jsx(He,{open:qe,onClose:()=>{K(!1),v(null),R()},tokensRequired:(p==null?void 0:p.tokensRequired)||0,tokensAvailable:(p==null?void 0:p.tokensAvailable)||0,tokensNeeded:(p==null?void 0:p.tokensNeeded)||0,feature:"ai-testing-simulation",shop:u,needsUpgrade:!1,returnTo:"/ai-testing"}),p&&e.jsx(Ke,{open:Oe,onClose:()=>{X(!1),v(null)},feature:p.feature||"ai-testing-simulation",trialEndsAt:p.trialEndsAt,currentPlan:p.currentPlan||M,tokensRequired:p.tokensRequired||0,onActivatePlan:async()=>{try{const i=await S("/api/billing/activate",{method:"POST",body:JSON.stringify({shop:u,endTrial:!0,returnTo:"/ai-testing"})});if(i.requiresApproval&&i.confirmationUrl){window.top.location.href=i.confirmationUrl;return}window.location.reload()}catch(i){console.error("[AI-TESTING] âŒ Activation failed:",i);const s=new URLSearchParams(window.location.search),a=s.get("host"),h=s.get("embedded");window.location.href=`/billing?shop=${encodeURIComponent(u)}&embedded=${h}&host=${encodeURIComponent(a)}`}},onPurchaseTokens:()=>{const i=new URLSearchParams(window.location.search),s=i.get("host"),a=i.get("embedded");window.location.href=`/billing?shop=${encodeURIComponent(u)}&embedded=${a}&host=${encodeURIComponent(s)}&returnTo=${encodeURIComponent("/ai-testing")}`}})]})}export{ut as default};
