import{r as i,j as e}from"./react-vendor-6uwpMgJP.js";import{m as We}from"./sessionFetch-C95wjxRc.js";import{g as Ne,P as Re}from"./usePlanHierarchy-BjUEvxZF.js";import{d as B}from"./index-x4Nl581N.js";import{A as ye}from"./AIEOScoreCard-Du5U_y-o.js";import{L as b,C as v,B as x,T as t,a as h,I as p,b as j,c as Ue,D as z,d as F,e as $,f as je,g as Ge}from"./polaris-B96_d87K.js";import"./app-bridge-ugs9K9zh.js";import"./vendor-BC2YhXnC.js";const Fe=(L,a="")=>{try{return new URLSearchParams(window.location.search).get(L)||a}catch{return a}};function Ze({shop:L}){var ne,re,oe,se,ae,ie,de,le,ce,ue,he,ge;const a=L||Fe("shop",""),A=i.useMemo(()=>We(),[]),w=r=>{const o=new URLSearchParams(window.location.search),l=o.toString()?`?${o.toString()}`:"";window.location.href=`${r}${l}`},[_,J]=i.useState(!0),[n,Se]=i.useState(null),[s,fe]=i.useState(null),[k,ve]=i.useState(null),[q,we]=i.useState({}),[V,ke]=i.useState({}),[c,W]=i.useState(null),[C,T]=i.useState(!1),[H,E]=i.useState(!1),[Me,Y]=i.useState(()=>{try{const r=localStorage.getItem(`syncCardExpanded_${a}`);return r===null?!0:r==="true"}catch{return!0}}),S=i.useRef(null),Q=i.useRef(!1),y=i.useRef(null),[M,Pe]=i.useState(()=>{try{return!(localStorage.getItem(`gettingStartedSeenOnce_${a}`)==="true")}catch{return!1}}),[Ae,Ce]=i.useState(()=>{try{return localStorage.getItem(`dismissedUpgradeBanner_${a}`)==="true"}catch{return!1}}),[Ie,ze]=i.useState(()=>{try{return localStorage.getItem(`dismissedTokenBanner_${a}`)==="true"}catch{return!1}}),D=i.useRef(null),Te=()=>{try{const r=localStorage.getItem(`ai-test-results-${a}`);if(r){const g=JSON.parse(r);g.results&&we(g.results)}const o=localStorage.getItem(`ai-validation-results-${a}`);if(o){const g=JSON.parse(o);g.results&&ke(g.results)}const l=localStorage.getItem(`dashboard-stats-${a}`);if(l){const g=JSON.parse(l)}}catch(r){console.error("[Dashboard] Error loading saved test results:",r)}};i.useEffect(()=>(K(!0),De(),Te(),()=>{S.current&&(clearInterval(S.current),S.current=null),D.current&&clearTimeout(D.current),y.current&&(clearTimeout(y.current),y.current=null)}),[a]),i.useEffect(()=>{if(!_&&(s!=null&&s.plan)&&M)try{!(localStorage.getItem(`gettingStartedSeenOnce_${a}`)==="true")&&!y.current&&(y.current=setTimeout(()=>{try{localStorage.setItem(`gettingStartedSeenOnce_${a}`,"true")}catch(o){console.error("[Dashboard] Error marking Getting Started as seen:",o)}},1e4))}catch(r){console.error("[Dashboard] Error checking Getting Started status:",r)}return()=>{y.current&&(clearTimeout(y.current),y.current=null)}},[_,s==null?void 0:s.plan,M,a]),i.useEffect(()=>{c&&c.autoSyncEnabled&&!C&&!Q.current&&(B("[Dashboard] Auto-sync is enabled, triggering sync..."),Q.current=!0,O())},[c==null?void 0:c.autoSyncEnabled]);const K=async(r=!1)=>(!r&&D.current&&clearTimeout(D.current),new Promise(o=>{D.current=setTimeout(async()=>{var l,g,m,d;try{J(!0);const[u,P]=await Promise.all([A(`/api/dashboard/stats?shop=${a}`),A(`/api/billing/tokens/balance?shop=${a}`)]);if(u){Se(u),fe(u.subscription);try{const I={totalProducts:((l=u==null?void 0:u.products)==null?void 0:l.total)||0,optimizedProducts:((g=u==null?void 0:u.products)==null?void 0:g.optimized)||0,totalCollections:((m=u==null?void 0:u.collections)==null?void 0:m.total)||0,optimizedCollections:((d=u==null?void 0:u.collections)==null?void 0:d.optimized)||0,timestamp:new Date().toISOString()};localStorage.setItem(`dashboard-stats-${a}`,JSON.stringify(I))}catch(I){console.error("[Dashboard] Error saving stats to localStorage:",I)}}P&&ve(P),o()}catch(u){console.error("[Dashboard] Error loading data:",u),o()}finally{J(!1)}},r?0:500)})),De=async()=>{try{const r=await A(`/api/dashboard/sync-status?shop=${a}`);r&&(W(r),E(r.autoSyncEnabled||!1),T(!!r.inProgress))}catch(r){console.error("[Dashboard] Error loading sync status:",r)}},O=async()=>{try{T(!0);const r=await A(`/api/dashboard/sync?shop=${a}`,{method:"POST"});B("[Dashboard] Sync start response:",r),r!=null&&r.success||r!=null&&r.inProgress?(S.current&&clearInterval(S.current),S.current=setInterval(async()=>{try{const o=await A(`/api/dashboard/sync-status?shop=${a}`);o&&(W(o),o.inProgress||(S.current&&(clearInterval(S.current),S.current=null),T(!1),K()))}catch(o){console.error("[Dashboard] Poll error:",o)}},2e3)):T(!1)}catch(r){console.error("[Dashboard] Error syncing:",r),T(!1)}},Ee=async r=>{try{B("[Dashboard] Toggling auto-sync to:",r),E(r);const o=await A(`/api/dashboard/auto-sync?shop=${a}`,{method:"POST",body:{enabled:r}});B("[Dashboard] Auto-sync toggle response:",o),o!=null&&o.success&&(E(!!o.autoSyncEnabled),W({...c||{},autoSyncEnabled:!!o.autoSyncEnabled}))}catch(o){console.error("[Dashboard] Error toggling auto-sync:",o),E(!r)}},N=((ne=n==null?void 0:n.products)==null?void 0:ne.total)>0?Math.round(n.products.optimized/n.products.total*100):0,R=((re=n==null?void 0:n.collections)==null?void 0:re.total)>0?Math.round(n.collections.optimized/n.collections.total*100):0;Ne(s==null?void 0:s.plan);const X=i.useMemo(()=>({starter:9.99,professional:15.99,professional_plus:19.99,"professional plus":19.99,growth:29.99,growth_plus:35.99,"growth plus":35.99,growth_extra:79.99,"growth extra":79.99,enterprise:139.99}),[]),Z=s!=null&&s.price&&s.price>0?s.price:s!=null&&s.plan?X[s.plan]:void 0,U=r=>{switch(r){case"starter":return{products:70,languages:1};case"professional":return{products:70,languages:1};case"professional_plus":case"professional plus":return{products:200,languages:2};case"growth":return{products:450,languages:3};case"growth_plus":case"growth plus":return{products:450,languages:3};case"growth_extra":case"growth extra":return{products:750,languages:6};case"enterprise":return{products:1200,languages:10};default:return{products:0,languages:0}}},ee=r=>({starter:1,professional:2,professional_plus:2.5,"professional plus":2.5,growth:3,growth_plus:3.5,"growth plus":3.5,growth_extra:4,"growth extra":4,enterprise:5})[r]||0,Oe=()=>{var pe,me;if(!n)return null;const r=((pe=n.products)==null?void 0:pe.total)||0,o=((me=n.languages)==null?void 0:me.length)||1,l=(s==null?void 0:s.plan)||"starter",g=ee(l),m=Re;let d=null;for(const xe of m){const be=U(xe);if(r<=be.products&&o<=be.languages){d=xe;break}}if(d||(d="enterprise"),ee(d)<=g)return null;const P=U(l),I=U(d);let G="";return r>P.products?G=`Your store has ${r} products, exceeding the ${P.products}-product limit of your current plan.`:o>P.languages&&(G=`Your store has ${o} language(s), exceeding the ${P.languages}-language limit of your current plan.`),{plan:d,planName:d.replace("_"," ").toUpperCase(),price:X[d],productLimit:I.products,languageLimit:I.languages,reason:G}},f=i.useMemo(()=>Oe(),[n,s]),Be=i.useMemo(()=>{if(!(s!=null&&s.plan))return!1;const r=s.plan;return!(!["professional","professional_plus","professional plus","growth","growth_plus","growth plus"].includes(r)||((k==null?void 0:k.balance)||0)>=1e3)},[s,k]),$e=()=>{try{localStorage.setItem(`dismissedUpgradeBanner_${a}`,"true"),Ce(!0)}catch(r){console.error("[Dashboard] Error saving dismissed banner state:",r)}},Le=()=>{try{localStorage.setItem(`dismissedTokenBanner_${a}`,"true"),ze(!0)}catch(r){console.error("[Dashboard] Error saving dismissed token banner state:",r)}},_e=()=>{const r=!M;if(Pe(r),M&&!r)try{localStorage.setItem(`gettingStartedSeenOnce_${a}`,"true"),y.current&&(clearTimeout(y.current),y.current=null)}catch(o){console.error("[Dashboard] Error marking Getting Started as seen:",o)}};if(_)return e.jsx(b,{children:e.jsx(b.Section,{children:e.jsx(v,{children:e.jsx(x,{padding:"400",children:e.jsx(t,{children:"Loading dashboard..."})})})})});const te=!(c!=null&&c.synced);return e.jsxs(b,{children:[e.jsx(b.Section,{children:e.jsx(v,{children:e.jsxs(h,{gap:"300",children:[e.jsxs(p,{align:"space-between",blockAlign:"center",children:[e.jsx(t,{variant:"headingMd",children:"Getting Started"}),e.jsxs(j,{onClick:_e,disclosure:M?"up":"down",children:[M?"Hide":"Show"," Guide"]})]}),e.jsx(Ue,{open:M,id:"onboarding-collapsible",transition:{duration:"200ms",timingFunction:"ease-in-out"},children:e.jsx(x,{paddingBlockStart:"300",children:e.jsxs(h,{gap:"400",children:[e.jsx(z,{}),e.jsxs(h,{gap:"300",children:[e.jsx(t,{variant:"headingMd",as:"h3",children:"What This App Does"}),e.jsxs(t,{variant:"bodyMd",tone:"subdued",children:["This app helps optimize your Shopify store for ",e.jsx("strong",{children:"AI search engines"})," (like ChatGPT, Claude, Perplexity) by structuring your existing product data in a format that AI bots can easily understand and reference."]}),e.jsxs(t,{variant:"bodyMd",tone:"subdued",children:[e.jsx("strong",{children:"Important:"})," This app primarily ",e.jsx("strong",{children:"structures"})," your existing data rather than creating new content. AI-enhanced features are supplementary and require additional tokens (unless you're on Growth Extra or Enterprise plans)."]})]}),e.jsx(z,{}),e.jsxs(h,{gap:"200",children:[e.jsx(t,{variant:"headingMd",as:"h3",children:"Video Tutorial"}),e.jsx(x,{padding:"400",background:"bg-surface-secondary",borderRadius:"200",children:e.jsx("div",{style:{position:"relative",paddingBottom:"56.25%",height:0,overflow:"hidden",maxWidth:"100%",borderRadius:"8px"},children:e.jsx("iframe",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",border:"none"},src:"https://www.youtube-nocookie.com/embed/bNfDsyDQEkc?origin=https://admin.shopify.com",title:"Video Tutorial",referrerPolicy:"no-referrer-when-downgrade",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0})})})]}),e.jsx(z,{}),e.jsxs(h,{gap:"300",children:[e.jsx(t,{variant:"headingMd",as:"h3",children:"Quick Start Guide"}),e.jsxs(h,{gap:"200",children:[e.jsx(t,{variant:"bodyMd",fontWeight:"semibold",children:"1. Sync Your Store Data"}),e.jsx(t,{variant:"bodyMd",tone:"subdued",children:'Click "Sync Now" to fetch your products, collections, languages, and markets from Shopify. This is required before you can start optimizing. Enable "Auto-sync on load" to keep your data fresh.'}),e.jsx(t,{variant:"bodyMd",fontWeight:"semibold",children:"2. Plan Selection & Token Management"}),e.jsx(t,{variant:"bodyMd",tone:"subdued",children:'Plan selection happens during app installation. Visit "Plans & Billing" to upgrade your plan or purchase additional tokens for AI-enhanced features (Professional/Growth plans).'}),e.jsx(t,{variant:"bodyMd",fontWeight:"semibold",children:"3. Structure Your Product Data"}),e.jsxs(t,{variant:"bodyMd",tone:"subdued",children:['Go to "Search Optimization for AI" → Products tab. First, create ',e.jsx("strong",{children:"basic optimization"})," by structuring existing titles, descriptions, and metadata for better AI consumption. This is essential - without basic optimization, AI-enhanced features cannot be applied."]}),e.jsxs(t,{variant:"bodyMd",tone:"subdued",children:["Also optimize your ",e.jsx("strong",{children:"Collections"})," to help AI bots understand your product categories and relationships."]}),e.jsx(t,{variant:"bodyMd",fontWeight:"semibold",children:"4. Configure Store Metadata"}),e.jsx(t,{variant:"bodyMd",tone:"subdued",children:'Go to "Store Metadata" to configure store description, keywords, business information, and contact details (Professional+ plans). This helps AI bots understand your brand and business context.'}),e.jsx(t,{variant:"bodyMd",fontWeight:"semibold",children:"5. Generate Sitemaps"}),e.jsxs(t,{variant:"bodyMd",tone:"subdued",children:["Navigate to Sitemap tab to generate your ",e.jsx("strong",{children:"standard sitemap"})," for search engines. For advanced optimization, go to Settings → Sitemap to configure ",e.jsx("strong",{children:"AI-enhanced sitemap"}),"with structured data that helps AI search engines discover and index your products (Growth Extra+ plans)."]}),e.jsx(t,{variant:"bodyMd",fontWeight:"semibold",children:"6. AI-Enhanced Features (Optional)"}),e.jsxs(t,{variant:"bodyMd",tone:"subdued",children:["Use AI-enhanced add-ons to ",e.jsx("strong",{children:"supplement and strengthen"})," your data discovery by AI bots, increasing your store's chances of being well-represented. These include:"]}),e.jsxs(t,{variant:"bodyMd",tone:"subdued",children:["• ",e.jsx("strong",{children:"AI Testing:"})," Test how AI bots respond to your products (Professional+)"]}),e.jsxs(t,{variant:"bodyMd",tone:"subdued",children:["• ",e.jsx("strong",{children:"AI Discovery Endpoints:"})," Advanced AI simulation features (Growth Extra+)"]}),e.jsxs(t,{variant:"bodyMd",tone:"subdued",children:["• ",e.jsx("strong",{children:"Advanced Schema Data:"})," Rich structured data markup (Enterprise only)"]}),e.jsx(t,{variant:"bodyMd",tone:"subdued",children:"These features require additional tokens unless you're on Growth Extra or Enterprise plans."}),e.jsx(t,{variant:"bodyMd",fontWeight:"semibold",children:"7. Configure AI Discovery Settings"}),e.jsx(t,{variant:"bodyMd",tone:"subdued",children:'Visit "Settings" to configure AI Discovery features:'}),e.jsxs(t,{variant:"bodyMd",tone:"subdued",children:["• ",e.jsx("strong",{children:"AI Bot Access Control:"})," Select which AI bots (OpenAI, Claude, Google, etc.) can access your store's structured data"]}),e.jsxs(t,{variant:"bodyMd",tone:"subdued",children:["• ",e.jsx("strong",{children:"AI Discovery Features:"})," Enable Products JSON Feed, Collections JSON Feed, Store Metadata, AI Welcome Page, AI-Enhanced Sitemap, and Advanced Schema Data"]}),e.jsxs(t,{variant:"bodyMd",tone:"subdued",children:["• Click ",e.jsx("strong",{children:'"Save Settings"'})," to save your configuration"]}),e.jsx(t,{variant:"bodyMd",fontWeight:"semibold",children:"8. Install robots.txt (REQUIRED)"}),e.jsxs(t,{variant:"bodyMd",tone:"subdued",children:[e.jsx("strong",{children:"Critical:"})," After saving Settings, you must manually install robots.txt in your theme for AI bots to access your endpoints:"]}),e.jsxs(t,{variant:"bodyMd",tone:"subdued",children:['• In Settings, scroll to "robots.txt Configuration" section and click ',e.jsx("strong",{children:'"View & Copy robots.txt Code"'})]}),e.jsx(t,{variant:"bodyMd",tone:"subdued",children:"• Copy the generated robots.txt content"}),e.jsxs(t,{variant:"bodyMd",tone:"subdued",children:["• Go to ",e.jsx("strong",{children:"Online Store → Themes"})," → ",e.jsx("strong",{children:"Actions → Edit code"})," on your active theme"]}),e.jsxs(t,{variant:"bodyMd",tone:"subdued",children:["• Click ",e.jsx("strong",{children:'"Add a new file"'})," and type: ",e.jsx("code",{children:"templates/robots.txt.liquid"})]}),e.jsxs(t,{variant:"bodyMd",tone:"subdued",children:["• Paste the copied content and click ",e.jsx("strong",{children:"Save"})]}),e.jsx(t,{variant:"bodyMd",tone:"subdued",children:e.jsx("strong",{children:"Without this step, AI bots cannot discover your store's endpoints!"})}),e.jsx(t,{variant:"bodyMd",fontWeight:"semibold",children:"9. Optional: Advanced Features"}),e.jsx(t,{variant:"bodyMd",tone:"subdued",children:"Additional features available in Settings:"}),e.jsxs(t,{variant:"bodyMd",tone:"subdued",children:["• ",e.jsx("strong",{children:"Advanced Schema Data:"})," Generate rich structured data markup for your products (Professional Plus/Enterprise plans)"]}),e.jsxs(t,{variant:"bodyMd",tone:"subdued",children:["• ",e.jsx("strong",{children:"AI Testing:"})," Test how AI bots respond to your products (Professional+ plans)"]}),e.jsx(t,{variant:"bodyMd",tone:"subdued",children:"These features may require additional tokens depending on your plan."}),e.jsx(t,{variant:"bodyMd",fontWeight:"semibold",children:"10. Monitor & Improve"}),e.jsx(t,{variant:"bodyMd",tone:"subdued",children:"Return to Dashboard regularly to track optimization progress, monitor token usage, and review plan recommendations."})]})]}),e.jsx(x,{paddingBlockStart:"200",children:e.jsxs(p,{gap:"200",children:[e.jsx(j,{variant:"primary",onClick:()=>w("/ai-seo/products"),children:"Start Optimizing"}),e.jsx(j,{onClick:()=>w("/billing"),children:"View Plans"})]})})]})})})]})})}),te&&e.jsx(b.Section,{children:e.jsx(F,{title:"Sync your store",tone:"info",action:{content:C?"Syncing...":"Sync Now",onAction:O,loading:C},children:e.jsxs(h,{gap:"200",children:[e.jsx(t,{children:"Sync products, collections, languages, and markets to get started with AI optimization."}),C&&e.jsxs(x,{paddingBlockStart:"200",children:[e.jsx($,{progress:50,size:"small",tone:"highlight"}),e.jsx(x,{paddingBlockStart:"100",children:e.jsx(t,{variant:"bodySm",tone:"subdued",children:"Fetching store data..."})})]})]})})}),!te&&c&&e.jsx(b.Section,{children:e.jsx(v,{children:Me?e.jsxs(h,{gap:"300",children:[e.jsxs(p,{align:"space-between",blockAlign:"center",children:[e.jsxs("div",{children:[e.jsx(t,{variant:"bodyMd",fontWeight:"semibold",children:"Store Sync"}),e.jsx(x,{paddingBlockStart:"050",children:e.jsxs(t,{variant:"bodySm",tone:"subdued",children:["Last synced: ",c.lastSyncDate?new Date(c.lastSyncDate).toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"Never"]})})]}),e.jsxs(p,{gap:"200",children:[e.jsx(j,{onClick:O,loading:C,children:"Sync Now"}),e.jsx(j,{onClick:()=>{Y(!1);try{localStorage.setItem(`syncCardExpanded_${a}`,"false")}catch(r){console.error("[Dashboard] Error saving sync card state:",r)}},variant:"plain",children:"Close"})]})]}),e.jsx(z,{}),e.jsx(Ge,{label:"Auto-sync on load",checked:H,onChange:Ee,helpText:"Automatically sync store data when you open the dashboard"})]}):e.jsxs(p,{align:"space-between",blockAlign:"center",gap:"400",children:[e.jsxs(p,{gap:"200",blockAlign:"center",children:[H&&e.jsx(je,{tone:"success",children:"Auto-sync enabled"}),e.jsxs(t,{variant:"bodySm",tone:"subdued",children:["Last synced: ",c.lastSyncDate?new Date(c.lastSyncDate).toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"Never"]})]}),e.jsxs(p,{gap:"200",children:[e.jsx(j,{onClick:O,loading:C,size:"slim",children:"Sync Now"}),e.jsx(j,{onClick:()=>{Y(!0);try{localStorage.setItem(`syncCardExpanded_${a}`,"true")}catch(r){console.error("[Dashboard] Error saving sync card state:",r)}},size:"slim",variant:"plain",children:"Expand"})]})]})})}),f&&!Ae&&e.jsx(b.Section,{children:e.jsx(F,{title:`Upgrade to ${f.planName} Plan`,tone:"warning",action:{content:"View Plans",onAction:()=>w("/billing")},onDismiss:$e,children:e.jsxs(h,{gap:"200",children:[e.jsx(t,{children:f.reason}),e.jsxs(t,{variant:"bodySm",tone:"subdued",children:["The ",f.planName," plan supports up to ",f.productLimit," products in ",f.languageLimit," language",f.languageLimit>1?"s":"","for $",f.price,"/month."]})]})})}),Be&&!Ie&&e.jsx(b.Section,{children:e.jsx(F,{title:"Buy Tokens to Unlock AI Features",tone:"info",action:{content:"Buy Tokens",onAction:()=>w("/billing")},onDismiss:Le,children:e.jsx(t,{children:"Purchase tokens to access AI-enhanced optimization features like AEO generation, AI Discovery and more."})})}),e.jsx(b.Section,{children:e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(320px, 1fr))",gap:"16px"},children:[e.jsx("div",{style:{display:"grid",gap:16},children:e.jsx(v,{children:e.jsxs(h,{gap:"400",children:[e.jsx(t,{variant:"headingMd",children:"Products & Collections"}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(220px, 1fr))",gap:12},children:[e.jsxs(h,{gap:"150",children:[e.jsx(t,{variant:"bodyMd",fontWeight:"semibold",children:"Products"}),e.jsxs(p,{align:"space-between",children:[e.jsx(t,{variant:"bodySm",tone:"subdued",children:"Total"}),e.jsx(t,{variant:"bodySm",fontWeight:"semibold",children:((oe=n==null?void 0:n.products)==null?void 0:oe.total)||0})]}),e.jsxs(p,{align:"space-between",children:[e.jsx(t,{variant:"bodySm",tone:"subdued",children:"Optimized"}),e.jsx(t,{variant:"bodySm",fontWeight:"semibold",tone:"success",children:((se=n==null?void 0:n.products)==null?void 0:se.optimized)||0})]}),e.jsxs(p,{align:"space-between",children:[e.jsx(t,{variant:"bodySm",tone:"subdued",children:"Unoptimized"}),e.jsx(t,{variant:"bodySm",fontWeight:"semibold",children:Math.max((((ae=n==null?void 0:n.products)==null?void 0:ae.total)||0)-(((ie=n==null?void 0:n.products)==null?void 0:ie.optimized)||0),0)})]}),e.jsxs(x,{paddingBlockStart:"100",children:[e.jsx($,{progress:N,size:"small",tone:N===100?"success":"primary"}),e.jsx(x,{paddingBlockStart:"050",children:e.jsxs(t,{variant:"bodySm",tone:"subdued",children:[N,"% optimized"]})})]})]}),e.jsxs(h,{gap:"150",children:[e.jsx(t,{variant:"bodyMd",fontWeight:"semibold",children:"Collections"}),e.jsxs(p,{align:"space-between",children:[e.jsx(t,{variant:"bodySm",tone:"subdued",children:"Total"}),e.jsx(t,{variant:"bodySm",fontWeight:"semibold",children:((de=n==null?void 0:n.collections)==null?void 0:de.total)||0})]}),e.jsxs(p,{align:"space-between",children:[e.jsx(t,{variant:"bodySm",tone:"subdued",children:"Optimized"}),e.jsx(t,{variant:"bodySm",fontWeight:"semibold",tone:"success",children:((le=n==null?void 0:n.collections)==null?void 0:le.optimized)||0})]}),e.jsxs(p,{align:"space-between",children:[e.jsx(t,{variant:"bodySm",tone:"subdued",children:"Unoptimized"}),e.jsx(t,{variant:"bodySm",fontWeight:"semibold",children:Math.max((((ce=n==null?void 0:n.collections)==null?void 0:ce.total)||0)-(((ue=n==null?void 0:n.collections)==null?void 0:ue.optimized)||0),0)})]}),e.jsxs(x,{paddingBlockStart:"100",children:[e.jsx($,{progress:R,size:"small",tone:R===100?"success":"primary"}),e.jsx(x,{paddingBlockStart:"050",children:e.jsxs(t,{variant:"bodySm",tone:"subdued",children:[R,"% optimized"]})})]})]})]}),e.jsx(z,{}),e.jsx(p,{align:"space-between",children:e.jsxs(t,{variant:"bodySm",tone:"subdued",children:["Last synced: ",c!=null&&c.lastSyncDate?new Date(c.lastSyncDate).toLocaleString():"Never"]})})]})})}),e.jsxs("div",{style:{display:"grid",gap:16},children:[e.jsx(v,{children:e.jsxs(h,{gap:"400",children:[e.jsx(t,{variant:"headingMd",children:"Languages & Markets"}),e.jsx(h,{gap:"200",children:n!=null&&n.languages&&n.languages.length>0?e.jsxs(e.Fragment,{children:[n.languages.slice().sort((r,o)=>(o.primary?1:0)-(r.primary?1:0)||(o.totalCount||0)-(r.totalCount||0)).slice(0,3).map((r,o)=>{const l=r.totalCount>0?Math.round(r.optimizedCount/r.totalCount*100):0;return e.jsxs(h,{gap:"050",children:[e.jsxs(p,{align:"space-between",children:[e.jsxs(t,{variant:"bodyMd",tone:"subdued",children:[r.name||r.code," ",r.primary?"★":""]}),e.jsxs(t,{variant:"bodySm",fontWeight:"semibold",children:[r.optimizedCount||0,"/",r.totalCount||0]})]}),e.jsx($,{progress:l,size:"small",tone:l===100?"success":"primary"})]},o)}),n.languages.length>3&&e.jsxs(t,{variant:"bodySm",tone:"subdued",children:["+",n.languages.length-3," more..."]})]}):e.jsx(t,{variant:"bodyMd",tone:"subdued",children:"No language data"})}),(n==null?void 0:n.storeMarkets)&&n.storeMarkets.length>0&&e.jsxs(x,{paddingBlockStart:"200",children:[e.jsx(z,{}),e.jsx(x,{paddingBlockStart:"200",children:e.jsxs(t,{variant:"bodySm",tone:"subdued",children:["Markets: ",n.storeMarkets.slice(0,2).map(r=>r.name).join(", "),n.storeMarkets.length>2?` +${n.storeMarkets.length-2}`:""]})})]})]})}),e.jsx(v,{children:e.jsxs(h,{gap:"300",children:[e.jsx(t,{variant:"headingMd",children:"Last Optimization"}),e.jsx(t,{variant:"bodyLg",fontWeight:"semibold",children:n!=null&&n.lastOptimization?new Date(n.lastOptimization).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"Never"}),e.jsx(j,{onClick:()=>w("/ai-seo/products"),children:"Optimize Now"})]})})]})]})}),e.jsx(b.Section,{children:e.jsx(ye,{testResults:q,aiTestResults:V,stats:(()=>{var r,o,l,g;if(n)return{totalProducts:((r=n==null?void 0:n.products)==null?void 0:r.total)||0,optimizedProducts:((o=n==null?void 0:n.products)==null?void 0:o.optimized)||0,totalCollections:((l=n==null?void 0:n.collections)==null?void 0:l.total)||0,optimizedCollections:((g=n==null?void 0:n.collections)==null?void 0:g.optimized)||0};try{const m=localStorage.getItem(`dashboard-stats-${a}`);if(m){const d=JSON.parse(m);return{totalProducts:d.totalProducts||0,optimizedProducts:d.optimizedProducts||0,totalCollections:d.totalCollections||0,optimizedCollections:d.optimizedCollections||0}}}catch(m){console.error("[Dashboard] Error loading stats from localStorage:",m)}return{totalProducts:0,optimizedProducts:0,totalCollections:0,optimizedCollections:0}})()})}),e.jsx(b.Section,{children:e.jsx(ye,{testResults:q,aiTestResults:V,stats:(()=>{var r,o,l,g;if(n)return{totalProducts:((r=n==null?void 0:n.products)==null?void 0:r.total)||0,optimizedProducts:((o=n==null?void 0:n.products)==null?void 0:o.optimized)||0,totalCollections:((l=n==null?void 0:n.collections)==null?void 0:l.total)||0,optimizedCollections:((g=n==null?void 0:n.collections)==null?void 0:g.optimized)||0};try{const m=localStorage.getItem(`dashboard-stats-${a}`);if(m){const d=JSON.parse(m);return{totalProducts:d.totalProducts||0,optimizedProducts:d.optimizedProducts||0,totalCollections:d.totalCollections||0,optimizedCollections:d.optimizedCollections||0}}}catch(m){console.error("[Dashboard] Error loading stats from localStorage:",m)}return{totalProducts:0,optimizedProducts:0,totalCollections:0,optimizedCollections:0}})()})}),e.jsx(b.Section,{children:e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(320px, 1fr))",gap:"16px"},children:[e.jsx(v,{style:{height:220,minHeight:220},children:e.jsxs(h,{gap:"300",children:[e.jsxs(p,{align:"space-between",blockAlign:"center",children:[e.jsxs("div",{children:[e.jsx(t,{variant:"headingMd",children:"Current Plan"}),e.jsx(x,{paddingBlockStart:"100",children:e.jsxs(t,{variant:"bodySm",tone:"subdued",children:[Z?`$${Z.toFixed(2)}`:"—","/month"]})})]}),e.jsx(je,{tone:"info",size:"large",children:((he=s==null?void 0:s.plan)==null?void 0:he.replace("_"," ").toUpperCase())||"N/A"})]}),e.jsx(j,{onClick:()=>w("/billing"),children:"View Plans & Billing"})]})}),e.jsx(v,{style:{height:220,minHeight:220},children:e.jsxs(h,{gap:"300",children:[e.jsx(t,{variant:"headingMd",children:"Token Balance"}),e.jsxs(t,{variant:"bodyLg",fontWeight:"semibold",children:[((ge=k==null?void 0:k.balance)==null?void 0:ge.toLocaleString())||0," tokens"]}),((s==null?void 0:s.plan)==="growth_extra"||(s==null?void 0:s.plan)==="enterprise")&&e.jsxs(t,{variant:"bodySm",tone:"subdued",children:[(s==null?void 0:s.plan)==="growth_extra"?"100M":"300M"," included monthly"]}),e.jsx(j,{onClick:()=>w("/billing"),children:"Manage Tokens"})]})})]})})]})}export{Ze as default};
