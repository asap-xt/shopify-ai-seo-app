import{j as e}from"./app-bridge-CpdpcJ5W-1759256018914.js";import{r as p}from"./react-vendor-tAaa2TlE-1759256018914.js";import{m as O}from"./index-Tjhp7prp-1759256018914.js";import{C as l,a as i,d as r,r as R,T as s,h as m,t as _,I as o,g as A,B as d,u as c,i as $,D as H,k as L}from"./polaris-62A1xdNH-1759256018914.js";const y=(g,n="")=>{try{return new URLSearchParams(window.location.search).get(g)||n}catch{return n}};function U({shop:g}){const n=g||y("shop","");console.log("[SCHEMA-DATA] shopProp:",g),console.log('[SCHEMA-DATA] qs("shop"):',y("shop","")),console.log("[SCHEMA-DATA] final shop:",n),console.log("[SCHEMA-DATA] window.location.search:",window.location.search);const[x,T]=p.useState(0),[b,j]=p.useState(!0),[h,v]=p.useState({organization:null,website:null,products:[]}),[w,u]=p.useState(""),S=p.useMemo(()=>O(),[]),[I,C]=p.useState("");p.useEffect(()=>{n&&f()},[n,S]);const f=async()=>{j(!0);try{console.log("[SCHEMA-DATA] loadSchemas - shop:",n);const t=`/api/schema/preview?shop=${encodeURIComponent(n)}`;console.log("[SCHEMA-DATA] loadSchemas - url:",t);const a=await S(t,{headers:{"X-Shop":n}});console.log("[SCHEMA-DATA] loadSchemas - response:",a),a.ok?(v(a.schemas),E(a.schemas)):u(`Error: ${a.error}`)}catch(t){console.error("[SCHEMA-DATA] loadSchemas - error:",t),u(`Failed to load schemas: ${t.message}`)}finally{j(!1)}},E=t=>{const a=[];t.organization&&a.push(t.organization),t.website&&a.push(t.website);const M=`<script type="application/ld+json">
${JSON.stringify(a,null,2)}
<\/script>`;C(M)},k=async()=>{j(!0);try{console.log("[SCHEMA-DATA] handleRegenerate - shop:",n);const t=`/api/schema/generate?shop=${encodeURIComponent(n)}`;console.log("[SCHEMA-DATA] handleRegenerate - url:",t);const a=await S(t,{method:"POST",headers:{"X-Shop":n},body:{shop:n}});console.log("[SCHEMA-DATA] handleRegenerate - response:",a),a.ok?(u("Schemas regenerated successfully!"),f()):u(`Error: ${a.error}`)}catch(t){console.error("[SCHEMA-DATA] handleRegenerate - error:",t),u(`Failed to regenerate: ${t.message}`)}finally{j(!1)}},D=[{id:"overview",content:"Overview",accessibilityLabel:"Overview"},{id:"installation",content:"Installation",accessibilityLabel:"Installation"},{id:"ai-testing",content:"AI Testing",accessibilityLabel:"AI Testing"}];return b?e.jsx(l,{children:e.jsx(i,{padding:"400",children:e.jsxs(r,{gap:"400",align:"center",children:[e.jsx(R,{}),e.jsx(s,{children:"Loading schema data..."})]})})}):e.jsxs(e.Fragment,{children:[e.jsx(l,{children:e.jsx(i,{padding:"400",children:e.jsxs(r,{gap:"400",children:[e.jsx(s,{as:"h3",variant:"headingMd",children:"Schema.org Structured Data"}),e.jsx(m,{tone:"info",children:e.jsx(s,{children:"Schema.org structured data helps AI models understand your store content better, improving your visibility and search results."})}),e.jsxs(_,{tabs:D,selected:x,onSelect:T,children:[x===0&&e.jsx(i,{paddingBlockStart:"400",children:e.jsxs(r,{gap:"400",children:[e.jsx(l,{children:e.jsx(i,{padding:"300",children:e.jsxs(r,{gap:"300",children:[e.jsxs(o,{align:"space-between",children:[e.jsx(s,{as:"h4",variant:"headingSm",children:"Organization Schema"}),e.jsx(A,{tone:h.organization?"success":"warning",children:h.organization?"Active":"Not configured"})]}),!h.organization&&e.jsx(s,{as:"p",tone:"subdued",children:"Configure organization details in Store Metadata to enable this schema."})]})})}),e.jsx(l,{children:e.jsx(i,{padding:"300",children:e.jsxs(r,{gap:"300",children:[e.jsxs(o,{align:"space-between",children:[e.jsx(s,{as:"h4",variant:"headingSm",children:"WebSite Schema"}),e.jsx(A,{tone:h.website?"success":"warning",children:h.website?"Active":"Not configured"})]}),!h.website&&e.jsx(s,{as:"p",tone:"subdued",children:"Website schema is automatically generated from your store information."})]})})}),e.jsx(l,{children:e.jsx(i,{padding:"300",children:e.jsxs(r,{gap:"300",children:[e.jsxs(o,{align:"space-between",children:[e.jsx(s,{as:"h4",variant:"headingSm",children:"Product Schemas"}),e.jsx(A,{tone:"success",children:"Auto-generated"})]}),e.jsxs(s,{tone:"subdued",children:["Product schemas are automatically generated from your AI Optimisation data when pages load.",h.products.length>0&&` ${h.products.length} products have SEO data.`]})]})})}),e.jsxs(o,{gap:"300",children:[e.jsx(d,{onClick:k,loading:b,children:"Regenerate Schemas"}),e.jsx(d,{variant:"plain",url:"https://developers.google.com/search/docs/appearance/structured-data",children:"Learn about Schema.org"})]})]})}),x===1&&e.jsx(i,{paddingBlockStart:"400",children:e.jsxs(r,{gap:"400",children:[e.jsx(l,{children:e.jsx(i,{padding:"300",children:e.jsxs(r,{gap:"300",children:[e.jsx(s,{as:"h4",variant:"headingSm",children:"Theme Installation"}),e.jsxs(c,{type:"number",children:[e.jsx(c.Item,{children:"Go to your Shopify Admin → Online Store → Themes"}),e.jsx(c.Item,{children:'Click "Actions" → "Edit code" on your current theme'}),e.jsxs(c.Item,{children:["Open the file: ",e.jsx("code",{children:"layout/theme.liquid"})]}),e.jsxs(c.Item,{children:["Add this code before the closing ",e.jsx("code",{children:"</head>"})," tag:"]})]}),e.jsx(i,{background:"bg-surface-secondary",padding:"200",borderRadius:"200",children:e.jsx("pre",{style:{fontSize:"12px",overflow:"auto",whiteSpace:"pre-wrap"},children:`{% comment %} Organization & WebSite Schema - AI SEO App {% endcomment %}
${I}

{% comment %} Product Schema - Dynamic {% endcomment %}
{% if template contains 'product' %}
  {% assign seo_bullets = product.metafields.seo_ai.bullets %}
  {% assign seo_faq = product.metafields.seo_ai.faq %}
  {% assign seo_data = product.metafields.seo_ai['seo__' | append: request.locale.iso_code] | default: product.metafields.seo_ai.seo__en %}
  
  {% if seo_data %}
    <script type="application/ld+json">
    {{ seo_data.jsonLd | json }}
    <\/script>
  {% endif %}
{% endif %}`})}),e.jsx(m,{tone:"warning",children:e.jsx(s,{children:"Always backup your theme before making changes!"})})]})})}),e.jsx(l,{children:e.jsx(i,{padding:"300",children:e.jsxs(r,{gap:"300",children:[e.jsx(s,{as:"h4",variant:"headingSm",children:"Testing Your Installation"}),e.jsxs(c,{children:[e.jsx(c.Item,{children:"After installation, visit your store's homepage and product pages"}),e.jsx(c.Item,{children:"View the page source (right-click → View Source)"}),e.jsxs(c.Item,{children:["Search for ",e.jsx("code",{children:"application/ld+json"})," to find your schemas"]}),e.jsx(c.Item,{children:"Use the Validation tab to test with Google's tools"})]})]})})})]})}),x===2&&e.jsx(i,{paddingBlockStart:"400",children:e.jsxs(r,{gap:"400",children:[e.jsx(l,{children:e.jsx(i,{padding:"300",children:e.jsxs(r,{gap:"300",children:[e.jsx(s,{as:"h4",variant:"headingSm",children:"AI Search Testing Tools"}),e.jsx($,{label:"Test URL",value:`https://${n}`,readOnly:!0,helpText:"Use this URL to test how AI bots understand your store"}),e.jsx(H,{}),e.jsxs(r,{gap:"200",children:[e.jsxs(o,{align:"space-between",children:[e.jsx(s,{children:"Perplexity AI Search"}),e.jsx(d,{url:`https://www.perplexity.ai/search?q=site:${n}`,external:!0,variant:"plain",children:"Test"})]}),e.jsxs(o,{align:"space-between",children:[e.jsx(s,{children:"ChatGPT Web Search"}),e.jsx(d,{url:"https://chat.openai.com/",external:!0,variant:"plain",children:"Test"})]}),e.jsxs(o,{align:"space-between",children:[e.jsx(s,{children:"Claude AI Search"}),e.jsx(d,{url:"https://claude.ai/",external:!0,variant:"plain",children:"Test"})]}),e.jsxs(o,{align:"space-between",children:[e.jsx(s,{children:"Gemini AI Search"}),e.jsx(d,{url:"https://gemini.google.com/",external:!0,variant:"plain",children:"Test"})]})]}),e.jsx(m,{tone:"info",children:e.jsxs(s,{children:[e.jsx("strong",{children:"How to test:"}),' Ask AI bots questions like "What products does this store sell?" or "Tell me about this business" using your store URL. They should be able to understand your store structure from the structured data.']})})]})})}),e.jsx(l,{children:e.jsx(i,{padding:"300",children:e.jsxs(r,{gap:"300",children:[e.jsx(s,{as:"h4",variant:"headingSm",children:"AI Bot Access Check"}),e.jsxs(o,{align:"space-between",children:[e.jsx(s,{children:"Test AI Welcome Page"}),e.jsx(d,{url:`https://${n}/apps/new-ai-seo/ai/welcome`,external:!0,variant:"plain",children:"View"})]}),e.jsxs(o,{align:"space-between",children:[e.jsx(s,{children:"Test Products JSON Feed"}),e.jsx(d,{url:`https://${n}/apps/new-ai-seo/ai/products.json`,external:!0,variant:"plain",children:"View"})]}),e.jsxs(o,{align:"space-between",children:[e.jsx(s,{children:"Test Collections JSON Feed"}),e.jsx(d,{url:`https://${n}/apps/new-ai-seo/ai/collections.json`,external:!0,variant:"plain",children:"View"})]}),e.jsx(m,{tone:"success",children:e.jsxs(s,{children:[e.jsx("strong",{children:"AI bots can access these endpoints"})," to understand your store structure, products, and business information. This helps them provide better answers about your business."]})})]})})})]})})]})]})})}),w&&e.jsx(L,{content:w,onDismiss:()=>u("")})]})}export{U as default};
