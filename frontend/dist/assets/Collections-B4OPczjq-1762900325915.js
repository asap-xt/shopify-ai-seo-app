import{j as e}from"./app-bridge-LikrqOxi-1762900325915.js";import{r as n}from"./react-vendor-tAaa2TlE-1762900325915.js";import{m as Lt}from"./sessionFetch-CJepNHo3-1762900325915.js";import{S as Mt,U as kt}from"./StoreMetadataBanner-cJX4C6Iv-1762900325915.js";import{I as Pt}from"./InsufficientTokensModal-Cqdxx1gI-1762900325915.js";import{M as m,a as L,T as r,e as me,d as Ot,b as M,B as c,I as w,g as Ue,D as Et,f as V,C as _e,h as It,S as Dt,i as Fe,j as qe,R as Tt,k as zt,m as Bt,E as $t}from"./polaris-Cpa09mIy-1762900325915.js";const Wt=(oe,j="")=>{try{return new URLSearchParams(window.location.search).get(oe)||j}catch{return j}};function hs({shop:oe,globalPlan:j}){var We,Re,Ne;const h=oe||Wt("shop",""),b=n.useMemo(()=>Lt(),[]),[g,Se]=n.useState([]),[xe,je]=n.useState(!1),[F,Ke]=n.useState(0),[p,q]=n.useState([]),[C,X]=n.useState(!1),[Rt,Nt]=n.useState(""),[z,ae]=n.useState(""),[k,ee]=n.useState("all"),[Ut,_t]=n.useState(""),[Ft,qt]=n.useState([]),[Kt,Ht]=n.useState([]),[ye,re]=n.useState(!1),[Jt,Gt]=n.useState(!1),[Yt,Zt]=n.useState(!1),[we,ie]=n.useState(!1),[P,He]=n.useState("updatedAt"),[O,Je]=n.useState("desc"),[Ge,Ye]=n.useState(""),[Qt,Ze]=n.useState([]),[v,R]=n.useState([]),[A,be]=n.useState([]),[ce,K]=n.useState(!1),[E,B]=n.useState({current:0,total:0,percent:0}),[Ce,H]=n.useState(""),[J,ve]=n.useState([]),[Vt,Xt]=n.useState(!1),[es,ts]=n.useState(null),[ss,ns]=n.useState(!1),[ls,Qe]=n.useState(""),[Ve,te]=n.useState(!1),[N,U]=n.useState([]),[Ae,Le]=n.useState(!1),[Xe,G]=n.useState(!1),[Me,ke]=n.useState(!1),[et,se]=n.useState(!1),[Pe,ne]=n.useState([]),[$,de]=n.useState({}),[tt,ue]=n.useState(!1),[st,he]=n.useState(!1),[Oe,os]=n.useState({}),[nt,pe]=n.useState(!1),[Ee,ge]=n.useState(null),[lt,Ie]=n.useState(!1),[De,f]=n.useState(""),[Te,ze]=n.useState(!1),[ot,Y]=n.useState(!1),[at,Be]=n.useState(!1),[S,Z]=n.useState(null),[I,Q]=n.useState("starter"),[D,fe]=n.useState(1);n.useEffect(()=>{if(!(!j||typeof j!="object")){if(j.planKey&&j.planKey!==""){Q(j.planKey);const s={starter:1,professional:2,"professional plus":2,professional_plus:2,growth:3,"growth plus":3,growth_plus:3,"growth extra":6,growth_extra:6,enterprise:10}[j.planKey.toLowerCase()]||1;fe(s)}else if(j.plan&&j.plan!==""){const t=j.plan.toLowerCase().replace(/\s+/g,"-");Q(t);const l={starter:1,professional:2,"professional plus":2,professional_plus:2,growth:3,"growth plus":3,growth_plus:3,"growth extra":6,growth_extra:6,enterprise:10}[t]||1;fe(l)}}},[j]);const[y,W]=n.useState({processing:!1,current:0,total:0,currentItem:"",results:null});n.useEffect(()=>{if(!h)return;b("/graphql",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:`
      query PlansMe($shop:String!) {
        plansMe(shop:$shop) {
          plan
          planKey
          modelsSuggested
        }
      }
    `,variables:{shop:h}})}).then(s=>{var d,x,_;if((d=s==null?void 0:s.errors)!=null&&d.length)throw new Error(((x=s.errors[0])==null?void 0:x.message)||"GraphQL error");const l=(_=s==null?void 0:s.data)==null?void 0:_.plansMe,o=(l==null?void 0:l.modelsSuggested)||["google/gemini-1.5-flash"];Ze(o.map(u=>({label:u,value:u}))),Ye(o[0]),Q((l==null?void 0:l.planKey)||"starter");const i=((l==null?void 0:l.planKey)||"starter").toLowerCase();fe({starter:1,professional:2,"professional plus":2,professional_plus:2,growth:3,"growth plus":3,growth_plus:3,"growth extra":6,growth_extra:6,enterprise:10}[i]||1)}).catch(s=>f(`Error loading models: ${s.message}`))},[h,b]),n.useEffect(()=>{h&&b(`/api/languages/shop/${h}?shop=${h}`).then(t=>{const s=(t==null?void 0:t.shopLanguages)||["en"];be(s),R([])}).catch(t=>{console.error("[COLLECTIONS] Languages API error:",t),be(["en"]),R([])})},[h,b]);const rt=async()=>{try{ke(!0);const t=await b(`/api/collections/sync?shop=${h}`,{method:"POST"});t!=null&&t.success?(f("Collections synced successfully!"),await T()):(console.error("[COLLECTIONS] Sync failed:",t),f("Failed to sync collections"))}catch(t){console.error("[COLLECTIONS] Sync error:",t),f("Error syncing collections")}finally{ke(!1)}},T=n.useCallback(async()=>{je(!0);try{const s=`/collections/list-graphql?${new URLSearchParams({shop:h,...z&&{search:z},...k!=="all"&&{optimized:k},sortBy:P,sortOrder:O})}`;let o=(await b(s)).collections||[];if(z){const i=z.toLowerCase();o=o.filter(a=>a.title.toLowerCase().includes(i)||a.handle.toLowerCase().includes(i))}k!=="all"&&(o=o.filter(i=>k==="true"?i.hasSeoData:!i.hasSeoData)),Se(o),Ke(o.length)}catch(t){f(`Error loading collections: ${t.message}`)}finally{je(!1)}},[h,z,k,P,O,b]);n.useEffect(()=>{h&&(T(),G(!1))},[h,k,P,O,T]),n.useEffect(()=>{const t=setTimeout(()=>{h&&T()},500);return()=>clearTimeout(t)},[z]);const it=n.useCallback(t=>{q(t);const s=t.some(l=>{const o=g.find(i=>i.id===l);return o==null?void 0:o.hasSeoData});G(s),t.length===0&&X(!1)},[g]),ct=n.useCallback(t=>{if(X(t),t){q(g.map(l=>l.id));const s=g.some(l=>l.hasSeoData);G(s)}else q([]),G(!1)},[g]),dt=async t=>{Ie(!0);try{const s=`/collections/${t.split("/").pop()}/seo-data?shop=${encodeURIComponent(h)}`,l=await b(s);ge(l),pe(!0)}catch(s){f((s==null?void 0:s.status)===404?"No SEO data found for this collection":"Failed to load SEO data")}finally{Ie(!1)}},$e=n.useMemo(()=>{var s;if(C)return v.length>D;const t=g.filter(l=>p.includes(l.id));if(t.length===0)return v.length>D;for(const l of t){const o=((s=l.optimizationSummary)==null?void 0:s.optimizedLanguages)||[],i=v.filter(d=>!o.includes(d));if(o.length+i.length>D)return!0}return!1},[g,p,C,D,v]),ut=()=>{if(p.length===0&&!C){f("Please select collections first");return}he(!0)},ht=async()=>{const s=g.filter(o=>p.includes(o.id)).filter(o=>{var i;return((i=o.optimizedLanguages)==null?void 0:i.length)>0});if(s.length===0){f("Please select collections with Basic SEO optimization");return}ze(!0),W({processing:!0,current:0,total:s.length,currentItem:"",results:null});const l={successful:0,failed:0,skipped:0};for(let o=0;o<s.length;o++){const i=s[o];W(a=>({...a,current:o,currentItem:i.title}));try{const a=i.optimizedLanguages||[];if(a.length===0){l.skipped++;continue}const d=await b(`/ai-enhance/collection/${encodeURIComponent(i.id)}`,{method:"POST",shop:h,body:{shop:h,languages:a}});d&&d.ok?l.successful++:l.failed++}catch(a){if(a.status===403){W({processing:!1,current:0,total:0,currentItem:"",results:null}),Z(a),Q(a.currentPlan||I||"starter"),Y(!0);return}if(a.status===402||a.requiresPurchase||a.trialRestriction){W({processing:!1,current:0,total:0,currentItem:"",results:null}),Z(a),Q(a.currentPlan||I||"starter"),a.trialRestriction?Y(!0):Be(!0);return}l.failed++}W(a=>({...a,current:o+1}))}W(o=>({...o,processing:!1,results:l})),f(`AI enhancement complete! ${l.successful} collections enhanced.`)},pt=()=>{g.filter(l=>p.includes(l.id)).filter(l=>{var o;return((o=l.optimizedLanguages)==null?void 0:o.length)>0});const s=()=>{const l=y.results;ze(!1),W({processing:!1,current:0,total:0,currentItem:"",results:null}),l&&l.successful>0&&setTimeout(()=>{Se([]),T()},1500)};return y.processing?e.jsx(m,{open:Te,title:"Processing AI Enhancement",onClose:()=>{},noScroll:!0,children:e.jsx(m.Section,{children:e.jsxs(L,{gap:"400",children:[e.jsxs(r,{variant:"bodyMd",children:["Processing: ",y.currentItem]}),e.jsx(me,{progress:y.current/y.total*100}),e.jsxs(r,{variant:"bodySm",tone:"subdued",children:[y.current," of ",y.total," collections (",Math.round(y.current/y.total*100),"%)"]})]})})}):y.results!==null?e.jsx(m,{open:Te,title:"AI Enhancement Results",onClose:s,primaryAction:{content:"Done",onAction:s},children:e.jsx(m.Section,{children:e.jsx(L,{gap:"300",children:e.jsxs(w,{gap:"400",children:[e.jsxs(c,{children:[e.jsx(r,{variant:"bodyMd",fontWeight:"semibold",children:"Successful:"}),e.jsx(r,{variant:"headingLg",fontWeight:"bold",tone:"success",children:y.results.successful})]}),e.jsxs(c,{children:[e.jsx(r,{variant:"bodyMd",fontWeight:"semibold",children:"Failed:"}),e.jsx(r,{variant:"headingLg",fontWeight:"bold",tone:"critical",children:y.results.failed})]}),e.jsxs(c,{children:[e.jsx(r,{variant:"bodyMd",fontWeight:"semibold",children:"Skipped:"}),e.jsx(r,{variant:"headingLg",fontWeight:"bold",tone:"info",children:y.results.skipped})]})]})})})}):null},gt=async()=>{var t;if(!v.length){f("Please select at least one language");return}he(!1),K(!0),B({current:0,total:0,percent:0}),ve([]),de({});try{const s=C?g:g.filter(a=>p.includes(a.id)),l=s.length;B({current:0,total:l,percent:0});const o={};for(let a=0;a<s.length;a++){const d=s[a];H(d.title);try{const u=await b("/seo/generate-collection-multi",{method:"POST",shop:h,body:JSON.stringify({shop:h,collectionId:d.id,model:Ge,languages:v})});o[d.id]={success:!0,data:u}}catch(u){if(u.status===403||(t=u.message)!=null&&t.includes("requires Professional plan")){K(!1),H(""),Z({error:u.message||"Collections SEO requires Professional plan or higher",currentPlan:u.currentPlan||I||"starter",upgradeMessage:u.upgradeMessage||"Upgrade to Professional plan to optimize collections for AI search"}),Y(!0);return}o[d.id]={success:!1,error:u.message},ve(le=>[...le,{collection:d.title,error:u.message}])}const x=a+1,_=Math.round(x/l*100);B({current:x,total:l,percent:_})}de(o),ue(!0);const i=Object.values(o).filter(a=>a.success).length;f(`Generated optimization for ${i} collections`)}catch(s){f(`Error: ${s.message}`)}finally{K(!1),H("")}},ft=async()=>{var t;K(!0),B({current:0,total:0,percent:0});try{const s=Object.entries($).filter(([o,i])=>i.success),l=s.length;B({current:0,total:l,percent:0});for(let o=0;o<s.length;o++){const[i,a]=s[o],d=g.find(u=>u.id===i);if(!d)continue;H(d.title);try{if(!((t=a.data)!=null&&t.results)||!Array.isArray(a.data.results))throw new Error("Invalid results structure");const u=await b("/seo/apply-collection-multi",{method:"POST",shop:h,body:{shop:h,collectionId:i,results:a.data.results.map(le=>({language:le.language,seo:le.data})),options:{updateTitle:!0,updateDescription:!0,updateSeo:!0,updateMetafields:!0}}});if(!(u!=null&&u.ok))throw new Error((u==null?void 0:u.error)||"Apply failed")}catch(u){console.error("Apply error for collection:",i,u),J.push({id:d.id,title:d.title,message:u.message})}const x=o+1,_=Math.round(x/l*100);B({current:x,total:l,percent:_})}f("Optimization applied successfully!"),ue(!1),de({}),q([]),await T(),X(!1)}catch(s){f(`Error applying optimization: ${s.message}`)}finally{K(!1),H("")}},mt=async(t=[])=>{Le(!0),Qe("");try{const s=C?g:g.filter(a=>p.includes(a.id)),l=s.length*t.length;let o=0;const i=[];for(const a of s)for(const d of t)try{const x=await b("/collections/delete-seo",{method:"DELETE",shop:h,body:{shop:h,collectionId:a.id,language:d}})}catch(x){console.error(`[DELETE-SEO-BULK] Failed to delete ${d} for ${a.title}:`,x),i.push({id:a.id,title:a.title,message:x.message})}finally{o++,B({current:o,total:l,percent:Math.round(o/l*100)})}f(`Deleted optimization for ${t.join(", ").toUpperCase()}`),setTimeout(async()=>{await T(),q([]),X(!1),G(!1)},100)}catch(s){console.error("[DELETE-SEO-BULK] Error:",s),f(`Delete error: ${s.message}`)}finally{Le(!1),ne([]),U([])}},St=t=>{var a,d;const s=((a=$[t.id])==null?void 0:a.success)||Oe[t.id],l=((d=$[t.id])==null?void 0:d.data)||Oe[t.id],o=t.optimizedLanguages||[],i=e.jsx(c,{width:"40px",height:"40px",background:"surface-neutral",borderRadius:"200"});return e.jsx(Bt,{id:t.id,media:i,accessibilityLabel:`View details for ${t.title}`,children:e.jsxs(w,{gap:"400",align:"center",blockAlign:"center",wrap:!1,children:[e.jsxs(c,{style:{flex:"1 1 30%",minWidth:"200px"},children:[e.jsx(r,{variant:"bodyMd",fontWeight:"semibold",children:t.title}),e.jsxs(r,{variant:"bodySm",tone:"subdued",children:["Handle: ",t.handle]})]}),e.jsx(c,{style:{flex:"0 0 15%",minWidth:"100px",textAlign:"center"},children:e.jsxs(r,{variant:"bodyMd",children:[t.productsCount," products"]})}),e.jsx(c,{style:{flex:"0 0 25%",minWidth:"160px"},children:e.jsx(w,{gap:"100",wrap:!0,children:t.hasSeoData?e.jsxs(e.Fragment,{children:[A.map(x=>e.jsx(V,{tone:o.includes(x)?"success":"subdued",size:"small",children:x.toUpperCase()},x)),t.aiEnhanced&&e.jsx(V,{tone:"info",size:"small",children:"AI✨"})]}):e.jsx(V,{tone:"subdued",children:"No AI Search Optimisation"})})}),e.jsxs(c,{style:{flex:"0 0 15%",minWidth:"120px"},children:[s&&e.jsx(M,{size:"slim",onClick:()=>{ge(l),pe(!0)},children:"Preview JSON"}),!s&&t.hasSeoData&&e.jsx(M,{size:"slim",loading:lt,onClick:()=>dt(t.id),children:"Preview JSON"})]})]})})},xt=ce&&!y.processing&&e.jsx(m,{open:ce,title:"Processing Collections",onClose:()=>{},noScroll:!0,children:e.jsx(m.Section,{children:e.jsxs(L,{gap:"400",children:[e.jsx(r,{variant:"bodyMd",children:Ce?`Processing: ${Ce}`:"Preparing..."}),e.jsx(me,{progress:E.percent}),e.jsxs(r,{variant:"bodySm",tone:"subdued",children:[E.current," of ",E.total," collections (",E.percent,"%)"]})]})})}),jt=e.jsx(m,{open:st,title:"Select Languages",primaryAction:{content:"Generate Optimization for AI Search",onAction:gt,disabled:v.length===0||$e},secondaryActions:[{content:"Cancel",onAction:()=>he(!1)}],children:e.jsx(m.Section,{children:e.jsxs(L,{gap:"300",children:[e.jsxs(r,{variant:"bodyMd",children:["Select languages to generate AI Search Optimisation for ",C?"all":p.length," selected collections:"]}),$e&&e.jsx(Ot,{tone:"warning",title:"Language limit exceeded",children:e.jsxs(L,{gap:"200",children:[e.jsxs(r,{variant:"bodyMd",children:["Your ",I," plan supports up to ",D," language",D>1?"s":""," per collection.",p.length===1&&((Ne=(Re=(We=g.find(t=>t.id===p[0]))==null?void 0:We.optimizationSummary)==null?void 0:Re.optimizedLanguages)==null?void 0:Ne.length)>0&&e.jsxs(e.Fragment,{children:[" This collection already has ",g.find(t=>t.id===p[0]).optimizationSummary.optimizedLanguages.length," optimized language(s)."]})]}),e.jsx(r,{variant:"bodyMd",children:"Please deselect some languages or upgrade your plan to add more:"}),e.jsx(M,{variant:"primary",onClick:()=>{const t=new URLSearchParams(window.location.search),s=t.toString()?`?${t.toString()}`:"";window.location.href=`/billing${s}`},children:"Upgrade Plan"})]})}),e.jsx(c,{paddingBlockStart:"200",children:e.jsx(w,{gap:"200",wrap:!0,children:A.map(t=>e.jsx(Ue,{label:t.toUpperCase(),checked:v.includes(t),onChange:s=>{R(s?[...v,t]:v.filter(l=>l!==t))}},t))})}),e.jsx(c,{paddingBlockStart:"200",children:e.jsx(M,{plain:!0,onClick:()=>{v.length===A.length?R([]):A.length>D?(R([...A]),f(`You selected ${A.length} languages. Your ${I} plan supports ${D}. Please deselect or upgrade.`)):R([...A])},children:v.length===A.length?"Deselect all":"Select all"})})]})})}),yt=e.jsx(m,{open:tt&&!ce,title:"AI Search Optimisation Results",primaryAction:{content:"Apply Optimisation",onAction:ft,disabled:!Object.values($).some(t=>t.success)},secondaryActions:[{content:"Cancel",onAction:()=>ue(!1)}],children:e.jsx(m.Section,{children:e.jsxs(L,{gap:"300",children:[e.jsxs(w,{gap:"400",children:[e.jsxs(c,{children:[e.jsx(r,{variant:"bodyMd",fontWeight:"semibold",children:"Successful:"}),e.jsx(r,{variant:"headingLg",fontWeight:"bold",tone:"success",children:Object.values($).filter(t=>t.success&&!t.skipped).length})]}),e.jsxs(c,{children:[e.jsx(r,{variant:"bodyMd",fontWeight:"semibold",children:"Skipped:"}),e.jsx(r,{variant:"headingLg",fontWeight:"bold",tone:"info",children:Object.values($).filter(t=>t.skipped).length})]}),e.jsxs(c,{children:[e.jsx(r,{variant:"bodyMd",fontWeight:"semibold",children:"Failed:"}),e.jsx(r,{variant:"headingLg",fontWeight:"bold",tone:"critical",children:Object.values($).filter(t=>!t.success&&!t.skipped).length})]})]}),J.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(Et,{}),e.jsx(r,{variant:"bodyMd",fontWeight:"semibold",children:"Errors:"}),e.jsxs(c,{maxHeight:"200px",overflowY:"scroll",children:[J.slice(0,10).map((t,s)=>e.jsxs(r,{variant:"bodySm",tone:"critical",children:[t.collection,": ",t.error]},s)),J.length>10&&e.jsxs(r,{variant:"bodySm",tone:"subdued",children:["... and ",J.length-10," more errors"]})]})]})]})})}),wt=e.jsx(m,{open:nt,title:"SEO Data Preview",secondaryActions:[{content:"Close",onAction:()=>{pe(!1),ge(null)}}],children:e.jsx(m.Section,{children:e.jsx(c,{children:e.jsx("pre",{style:{whiteSpace:"pre-wrap",wordBreak:"break-word",fontSize:"12px",backgroundColor:"#f6f6f7",padding:"12px",borderRadius:"4px",maxHeight:"400px",overflow:"auto"},children:Ee?JSON.stringify(Ee,null,2):""})})})}),bt=e.jsx(m,{open:Ve,title:"Delete Optimization for AI Search",onClose:()=>{te(!1),U([])},primaryAction:{content:"Continue",onAction:()=>{ne(N),te(!1),se(!0)},disabled:N.length===0},secondaryActions:[{content:"Cancel",onAction:()=>{te(!1),U([])}}],children:e.jsx(m.Section,{children:e.jsxs(L,{gap:"400",children:[e.jsxs(r,{variant:"bodyMd",children:["Select languages to delete AI Search Optimisation from ",C?F:p.length," selected collections:"]}),e.jsx(c,{paddingBlockStart:"200",children:e.jsx(w,{gap:"400",wrap:!1,children:A.map(t=>e.jsxs("label",{style:{display:"flex",alignItems:"center",cursor:"pointer",userSelect:"none"},children:[e.jsx("input",{type:"checkbox",checked:N.includes(t),onChange:s=>{U(s.target.checked?[...N,t]:N.filter(l=>l!==t))},style:{marginRight:"8px",width:"18px",height:"18px",cursor:"pointer"}}),e.jsx(r,{variant:"bodyMd",children:t.toUpperCase()})]},t))})}),e.jsx(c,{children:e.jsx(M,{plain:!0,onClick:()=>{U(N.length===A.length?[]:[...A])},children:"Select all"})}),e.jsx(c,{paddingBlockStart:"300",children:e.jsx(r,{variant:"bodySm",children:"Warning: This will permanently delete AI Search Optimisation data for selected languages."})})]})})}),Ct=e.jsx(m,{open:et,title:"Confirm Deletion",onClose:()=>{se(!1),ne([])},primaryAction:{content:"Delete",destructive:!0,onAction:async()=>{se(!1),setTimeout(()=>{mt(Pe)},100)}},secondaryActions:[{content:"Cancel",onAction:()=>{se(!1),ne([]),U([])}}],children:e.jsx(m.Section,{children:e.jsxs(L,{gap:"400",children:[e.jsx(r,{variant:"bodyMd",children:"Are you sure you want to delete AI Search Optimisation for the following languages?"}),e.jsx(c,{paddingBlockStart:"200",children:e.jsx(w,{gap:"200",children:Pe.map(t=>e.jsx(V,{tone:"warning",children:t.toUpperCase()},t))})}),e.jsxs(r,{variant:"bodyMd",children:["This will delete optimisation from ",C?F:p.length," selected collections."]}),e.jsx(c,{paddingBlockStart:"200",children:e.jsx(r,{variant:"bodySm",tone:"critical",children:"This action cannot be undone."})})]})})}),vt=Ae&&e.jsx(m,{open:Ae,title:"Deleting SEO Data",onClose:()=>{},noScroll:!0,children:e.jsx(m.Section,{children:e.jsxs(L,{gap:"400",children:[e.jsx(r,{variant:"bodyMd",children:"Deleting selected languages..."}),e.jsx(me,{progress:E.percent}),e.jsxs(r,{variant:"bodySm",tone:"subdued",children:[E.current," of ",E.total," operations (",E.percent,"%)"]})]})})}),At=e.jsx($t,{heading:"No collections found",action:{content:"Clear filters",onAction:()=>{ae(""),ee("all"),T()}},image:"https://cdn.shopify.com/s/files/1/0262/4071/2726/files/emptystate-files.png",children:e.jsx("p",{children:"Try adjusting your filters or search terms"})});return e.jsxs(e.Fragment,{children:[e.jsx(Mt,{globalPlan:j}),e.jsx(_e,{children:e.jsx(c,{padding:"400",children:e.jsxs(L,{gap:"300",children:[e.jsxs(w,{gap:"400",align:"space-between",blockAlign:"center",wrap:!1,children:[e.jsx(c,{minWidth:"400px",children:e.jsx(It,{label:"",placeholder:"Search by collection name...",value:z,onChange:ae,prefix:e.jsx(Dt,{}),clearButton:!0,onClearButtonClick:()=>ae("")})}),e.jsx(c,{width:"320px",children:e.jsx(M,{primary:!0,onClick:ut,disabled:p.length===0&&!C,size:"medium",fullWidth:!0,children:"Generate Optimization for AI Search"})})]}),e.jsxs(w,{gap:"400",align:"space-between",blockAlign:"start",wrap:!1,children:[e.jsx(M,{onClick:rt,disabled:Me||xe,size:"medium",children:Me?"Syncing...":"Sync Collections"}),e.jsx(c,{width:"320px",children:e.jsxs(L,{gap:"200",align:"end",children:[(()=>{if(p.length===0&&!C||!g.filter(o=>p.includes(o.id)).some(o=>{var i;return((i=o.optimizedLanguages)==null?void 0:i.length)>0}))return null;const l=I.toLowerCase().replace(/_/g," ")==="starter";return e.jsx(M,{onClick:l?()=>{Z({error:"Collections require Professional plan or higher",message:"Upgrade to Professional plan to access Collections optimization",minimumPlanRequired:"Professional"}),Y(!0)}:ht,disabled:p.length===0&&!C,size:"medium",fullWidth:!0,children:"AI Enhanced add-ons"})})(),e.jsx(M,{outline:!0,destructive:!0,onClick:()=>te(!0),disabled:p.length===0||!Xe,size:"medium",fullWidth:!0,children:"Delete Optimization for AI Search"})]})})]})]})})}),e.jsx(c,{paddingBlockStart:"400",children:e.jsxs(_e,{children:[e.jsxs(c,{padding:"400",borderBlockEndWidth:"025",borderColor:"border",children:[e.jsxs(w,{gap:"200",wrap:!0,align:"space-between",children:[e.jsx(w,{gap:"200",wrap:!0,children:e.jsx(Fe,{active:ye,activator:e.jsx(M,{disclosure:"down",onClick:()=>re(!ye),removeUnderline:!0,children:e.jsxs(w,{gap:"100",blockAlign:"center",children:[e.jsx("span",{children:"AI Search Status"}),k!=="all"&&e.jsx(c,{onClick:t=>{t.stopPropagation(),ee("all")},children:e.jsx(r,{as:"span",tone:"subdued",children:"✕"})})]})}),onClose:()=>re(!1),children:e.jsx(c,{padding:"300",minWidth:"200px",children:e.jsx(qe,{title:"AI Search Status",titleHidden:!0,choices:[{label:"All collections",value:"all"},{label:"Has AI Search Optimisation",value:"true"},{label:"No AI Search Optimisation",value:"false"}],selected:[k],onChange:t=>{ee(t[0]),re(!1)}})})})}),e.jsx(Fe,{active:we,activator:e.jsx(M,{disclosure:"down",onClick:()=>ie(!we),removeUnderline:!0,children:e.jsx(w,{gap:"100",blockAlign:"center",children:e.jsxs("span",{children:[P==="updatedAt"&&O==="desc"&&"Newest first",P==="updatedAt"&&O==="asc"&&"Oldest first",P==="title"&&O==="asc"&&"Name A-Z",P==="title"&&O==="desc"&&"Name Z-A",P==="productsCount"&&O==="desc"&&"Most products",P==="productsCount"&&O==="asc"&&"Least products"]})})}),onClose:()=>ie(!1),children:e.jsx(c,{padding:"300",minWidth:"200px",children:e.jsx(qe,{title:"Sort Order",titleHidden:!0,choices:[{label:"Newest first",value:"updatedAt_desc"},{label:"Oldest first",value:"updatedAt_asc"},{label:"Name A-Z",value:"title_asc"},{label:"Name Z-A",value:"title_desc"},{label:"Most products",value:"productsCount_desc"},{label:"Least products",value:"productsCount_asc"}],selected:[`${P}_${O}`],onChange:t=>{const[s,l]=t[0].split("_");He(s),Je(l),ie(!1)}})})})]}),k!=="all"&&e.jsx(c,{paddingBlockStart:"200",children:e.jsx(w,{gap:"100",wrap:!0,children:e.jsx(V,{onRemove:()=>ee("all"),children:k==="true"?"Has AI Search Optimisation":"No AI Search Optimisation"})})})]}),F>0&&e.jsx(c,{padding:"400",borderBlockEndWidth:"025",borderColor:"border",children:e.jsx(Ue,{label:`Select all ${F} collections`,checked:C,onChange:ct})}),e.jsx(Tt,{resourceName:{singular:"collection",plural:"collections"},items:g,renderItem:St,selectedItems:p,onSelectionChange:it,selectable:!0,loading:xe,totalItemsCount:F,emptyState:At,showHeader:!1},`collections-${g.length}-${p.length}`)]})}),xt,jt,yt,wt,bt,Ct,vt,pt(),e.jsx(kt,{open:ot,onClose:()=>Y(!1),featureName:"Collections AI Enhancement",currentPlan:I,errorMessage:(S==null?void 0:S.error)||(S==null?void 0:S.message),minimumPlanRequired:S==null?void 0:S.minimumPlanRequired}),S&&e.jsx(Pt,{open:at,onClose:()=>{Be(!1),Z(null)},tokensRequired:S.tokensRequired||0,tokensAvailable:S.tokensAvailable||0,tokensNeeded:S.tokensNeeded||0,feature:"ai-seo-collection",shop:h,needsUpgrade:S.needsUpgrade||!1,minimumPlan:S.minimumPlanForFeature||null,currentPlan:S.currentPlan||I}),De&&e.jsx(zt,{content:De,onDismiss:()=>f("")})]})}export{hs as default};
