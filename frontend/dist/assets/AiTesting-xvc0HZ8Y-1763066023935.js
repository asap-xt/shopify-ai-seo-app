import{j as e}from"./app-bridge-WdIn4Kt--1763066023935.js";import{r as c,R as be}from"./react-vendor-tAaa2TlE-1763066023935.js";import{m as Se}from"./sessionFetch-CJepNHo3-1763066023935.js";import{I as fe}from"./InsufficientTokensModal-D7yyvn12-1763066023935.js";import{T as Ae}from"./TrialActivationModal-CLEk21TK-1763066023935.js";import{g as te,a as ye}from"./usePlanHierarchy-D5Zdzl7i-1763066023935.js";import{a as l,d as f,T as s,L as J,C as F,B as x,I as o,b as h,e as ie,f as r,D as T,h as we,k as Te,M as P}from"./polaris-BHlzHCK5-1763066023935.js";const Ie=(B,d="")=>{try{return new URLSearchParams(window.location.search).get(B)||d}catch{return d}};function Ne({shop:B}){const d=B||Ie("shop",""),ae=i=>{const n=new URLSearchParams(window.location.search),a=n.toString()?`?${n.toString()}`:"";window.location.href=`${i}${a}`},[W,p]=c.useState(""),A=c.useMemo(()=>Se(),[]),[j,L]=c.useState(null),[O,I]=c.useState(""),[re,V]=c.useState(!1),[m,oe]=c.useState(null),[q,le]=c.useState(""),[ce,E]=c.useState(!1),[de,U]=c.useState(!1),[he,$]=c.useState(!1),[u,b]=c.useState(null),[ue,H]=c.useState(!1),[S,ve]=c.useState(null),[w,Y]=c.useState({}),[R,Q]=c.useState(!1),[ge,K]=c.useState(0),[t,_]=c.useState({}),[C,X]=c.useState(!1),[pe,Z]=c.useState(0),[D,z]=c.useState(null),[ke,ee]=c.useState(null);c.useEffect(()=>{d&&(xe(),M())},[d,A]),c.useEffect(()=>{const i=()=>{!document.hidden&&d&&(console.log("[AI-TESTING] Page visible, refreshing token balance..."),M())};return document.addEventListener("visibilitychange",i),()=>{document.removeEventListener("visibilitychange",i)}},[d,A]);const xe=async()=>{var i,n,a,y,se;try{const g=await A(`/api/billing/info?shop=${d}`);console.log("[AI-TESTING] ðŸ“‹ Billing info received:",g),console.log("[AI-TESTING] ðŸ“‹ Raw plan from API:",(i=g==null?void 0:g.subscription)==null?void 0:i.plan),console.log("[AI-TESTING] ðŸ“‹ Plan type:",typeof((n=g==null?void 0:g.subscription)==null?void 0:n.plan));const ne=((a=g==null?void 0:g.subscription)==null?void 0:a.plan)||"Starter";console.log("[AI-TESTING] ðŸ“‹ Setting plan to:",ne),L(ne),z(((y=g==null?void 0:g.tokens)==null?void 0:y.balance)||0),ee(((se=g==null?void 0:g.subscription)==null?void 0:se.trialEndsAt)||null)}catch(g){console.error("[AI-TESTING] Error loading billing info:",g),L("Starter"),z(0)}},M=async()=>{var i,n;try{const a=await A(`/api/billing/info?shop=${d}`);console.log("[AI-TESTING] Token balance refresh:",a),z(((i=a==null?void 0:a.tokens)==null?void 0:i.balance)||0),ee(((n=a==null?void 0:a.subscription)==null?void 0:n.trialEndsAt)||null)}catch(a){console.error("[AI-TESTING] Error loading token balance:",a)}},v=i=>{if(!j)return!1;const n=te(j);switch(i){case"productsJson":return n>=0;case"storeMetadata":return n>=1;case"welcomePage":case"collectionsJson":return n>=2;case"aiSitemap":return n>=3;case"schemaData":return n>=4;case"meta":return n>=0;case"claude":return n>=0;case"gemini":return n>=1;case"chatgpt":return n>=2;case"perplexity":return n>=3;case"deepseek":return n>=4;default:return!1}},k=i=>{switch(i){case"storeMetadata":return"Professional";case"welcomePage":case"collectionsJson":return"Growth";case"aiSitemap":return"Growth Extra";case"schemaData":return"Enterprise";case"gemini":return"Professional";case"chatgpt":return"Growth";case"perplexity":return"Growth Extra";case"deepseek":return"Enterprise";default:return"Professional"}},N=(i,n)=>{oe({name:i,url:n}),V(!0)},je=async()=>{Q(!0),K(0),Y({});try{console.log("[AI-TESTING] Starting tests for shop:",d);const i=await A("/api/ai-testing/run-tests",{method:"POST",body:{shop:d}});console.log("[AI-TESTING] Test results:",i),i.results?(Y(i.results),K(100),p("Basic tests completed!")):p("Testing failed. Please try again.")}catch(i){console.error("[AI-TESTING] Error running tests:",i),p("Failed to run tests. Please try again.")}finally{Q(!1)}},me=async()=>{console.log("[AI-TESTING] ðŸŽ¯ runAiValidation called"),console.log("[AI-TESTING] ðŸŽ¯ Current plan from state:",j),console.log("[AI-TESTING] ðŸŽ¯ Plan type:",typeof j);const i=te(j);if(console.log("[AI-TESTING] ðŸŽ¯ Plan hierarchy:",ye),console.log("[AI-TESTING] ðŸŽ¯ Current index in hierarchy:",i),i<1){b({message:"AI-powered validation requires Professional plan or higher",requiredPlan:"Professional",currentPlan:j||"Starter"}),E(!0);return}X(!0),Z(0),_({});try{console.log("[AI-TESTING] Starting AI validation for shop:",d);const n=await A("/api/ai-testing/ai-validate",{method:"POST",body:{shop:d,endpointResults:w}});console.log("[AI-TESTING] AI validation results:",n),n.results?(_(n.results),Z(100),p(`AI validation completed! (${n.tokensUsed||0} tokens used)`),M()):p("AI validation failed. Please try again.")}catch(n){if(console.error("[AI-TESTING] Error running AI validation:",n),n.status===402){if(n.trialRestriction&&n.requiresActivation){b(n),$(!0);return}if(n.requiresUpgrade){b(n),E(!0);return}if(n.requiresPurchase){b(n),U(!0);return}}p("Failed to run AI validation. Please try again.")}finally{X(!1)}},G=async(i,n=null)=>{try{I("Generating AI response...");let a=`/api/ai-discovery/simulate?shop=${d}&type=${i}`;n&&(a+=`&question=${encodeURIComponent(n)}`);const y=await A(a,{method:"GET"});I(y.response||"No response generated")}catch(a){if(console.error("[AI-TESTING] Simulation error:",a),console.log("[AI-TESTING] Error status:",a.status),console.log("[AI-TESTING] Error requiresUpgrade:",a.requiresUpgrade),console.log("[AI-TESTING] Error requiresPurchase:",a.requiresPurchase),a.status===402){if(a.trialRestriction&&a.requiresActivation){b(a),$(!0),I("");return}if(a.requiresUpgrade){b(a),E(!0),I("");return}if(a.requiresPurchase){b(a),U(!0),I("");return}}I("Error generating response. Please try again."),p("Failed to simulate AI response")}};return e.jsxs(e.Fragment,{children:[e.jsxs(l,{gap:"400",children:[e.jsx(f,{tone:"info",children:e.jsx(s,{children:"Test how AI models discover and understand your store content. Check if your structured data and AI Discovery features are working correctly."})}),e.jsxs(J,{children:[e.jsx(J.Section,{variant:"oneHalf",children:e.jsx(F,{children:e.jsx(x,{padding:"300",children:e.jsxs(l,{gap:"400",children:[e.jsxs(o,{align:"space-between",blockAlign:"center",children:[e.jsxs(l,{gap:"100",children:[e.jsx(s,{as:"h3",variant:"headingMd",children:"ðŸ”§ Basic Endpoint Tests"}),e.jsx(s,{variant:"bodySm",tone:"subdued",children:"Quick check if endpoints are accessible and returning data"})]}),e.jsx(h,{onClick:je,loading:R,disabled:R,children:R?"Testing...":"Run Basic Tests"})]}),R&&e.jsx(x,{children:e.jsxs(l,{gap:"200",children:[e.jsx(s,{variant:"bodySm",children:"Testing endpoints..."}),e.jsx(ie,{progress:ge,size:"small"})]})}),Object.keys(w).length>0&&e.jsx(l,{gap:"300",children:Object.entries(w).map(([i,n],a)=>{const y=a===Object.entries(w).length-1;return e.jsxs(be.Fragment,{children:[e.jsx(o,{align:"space-between",blockAlign:"center",children:e.jsxs(l,{gap:"100",children:[e.jsxs(o,{gap:"200",blockAlign:"center",children:[e.jsx(s,{variant:"bodyMd",fontWeight:"semibold",children:n.name}),n.status==="success"&&e.jsx(r,{tone:"success",children:"âœ“ OK"}),n.status==="warning"&&e.jsx(r,{tone:"warning",children:"âš ï¸ Warning"}),n.status==="error"&&e.jsx(r,{tone:"critical",children:"âœ— Failed"}),n.status==="locked"&&e.jsx(r,{children:"ðŸ”’ Locked"})]}),e.jsxs(s,{variant:"bodySm",tone:"subdued",children:[n.message,n.dataSize&&` (${(n.dataSize/1024).toFixed(1)} KB)`]}),n.actionLink&&e.jsx(h,{size:"slim",onClick:()=>ae(n.actionLink),children:i==="basicSitemap"?"Go to Sitemap":i==="aiSitemap"?"Go to Settings":"Go"})]})}),!y&&e.jsx(T,{})]},i)})}),Object.keys(w).length===0&&!R&&e.jsx(f,{tone:"info",children:e.jsx(s,{children:'Click "Run Basic Tests" to check if your AI Discovery endpoints are configured correctly.'})})]})})})}),e.jsx(J.Section,{variant:"oneHalf",children:e.jsx(F,{children:e.jsx(x,{padding:"300",children:e.jsxs(l,{gap:"400",children:[e.jsxs(o,{align:"space-between",blockAlign:"center",children:[e.jsxs(l,{gap:"100",children:[e.jsxs(o,{gap:"200",blockAlign:"center",children:[e.jsx(s,{as:"h3",variant:"headingMd",children:"ðŸ¤– AI-Powered Validation"}),D!==null&&e.jsxs(r,{tone:D>50?"success":"warning",children:[D," tokens"]}),e.jsx(h,{size:"micro",onClick:()=>{console.log("[AI-TESTING] Manual token refresh..."),M()},accessibilityLabel:"Refresh token balance",children:"ðŸ”„"})]}),e.jsx(s,{variant:"bodySm",tone:"subdued",children:"Deep analysis with AI bot"}),j&&e.jsx(s,{variant:"bodySm",tone:"subdued",children:"Requires: Professional+ plan & pay-per-use tokens"})]}),e.jsx(h,{onClick:me,loading:C,disabled:C||Object.keys(w).length===0,variant:"primary",children:C?"Validating...":"Test with AI Bot"})]}),C&&e.jsx(x,{children:e.jsxs(l,{gap:"200",children:[e.jsx(s,{variant:"bodySm",children:"AI is analyzing your endpoints..."}),e.jsx(ie,{progress:pe,size:"small",tone:"primary"})]})}),Object.keys(t).length>0&&e.jsxs(l,{gap:"300",children:[t.productsJson&&e.jsxs(e.Fragment,{children:[e.jsx(o,{align:"space-between",blockAlign:"center",children:e.jsxs(l,{gap:"100",children:[e.jsxs(o,{gap:"200",blockAlign:"center",children:[e.jsx(s,{variant:"bodyMd",fontWeight:"semibold",children:"Products JSON Feed"}),t.productsJson.rating==="excellent"&&e.jsx(r,{tone:"success",children:"ðŸ¤– Excellent"}),t.productsJson.rating==="good"&&e.jsx(r,{tone:"success",children:"ðŸ¤– Good"}),t.productsJson.rating==="fair"&&e.jsx(r,{tone:"warning",children:"ðŸ¤– Fair"}),t.productsJson.rating==="poor"&&e.jsx(r,{tone:"critical",children:"ðŸ¤– Poor"})]}),e.jsx(s,{variant:"bodySm",children:t.productsJson.feedback}),t.productsJson.suggestions&&e.jsxs(s,{variant:"bodySm",tone:"subdued",children:["ðŸ’¡ ",t.productsJson.suggestions]})]})}),e.jsx(T,{})]}),t.storeMetadata&&e.jsxs(e.Fragment,{children:[e.jsx(o,{align:"space-between",blockAlign:"center",children:e.jsxs(l,{gap:"100",children:[e.jsxs(o,{gap:"200",blockAlign:"center",children:[e.jsx(s,{variant:"bodyMd",fontWeight:"semibold",children:"Store Metadata"}),t.storeMetadata.rating==="excellent"&&e.jsx(r,{tone:"success",children:"ðŸ¤– Excellent"}),t.storeMetadata.rating==="good"&&e.jsx(r,{tone:"success",children:"ðŸ¤– Good"}),t.storeMetadata.rating==="fair"&&e.jsx(r,{tone:"warning",children:"ðŸ¤– Fair"}),t.storeMetadata.rating==="poor"&&e.jsx(r,{tone:"critical",children:"ðŸ¤– Poor"})]}),e.jsx(s,{variant:"bodySm",children:t.storeMetadata.feedback}),t.storeMetadata.suggestions&&e.jsxs(s,{variant:"bodySm",tone:"subdued",children:["ðŸ’¡ ",t.storeMetadata.suggestions]})]})}),e.jsx(T,{})]}),t.welcomePage&&e.jsxs(e.Fragment,{children:[e.jsx(o,{align:"space-between",blockAlign:"center",children:e.jsxs(l,{gap:"100",children:[e.jsxs(o,{gap:"200",blockAlign:"center",children:[e.jsx(s,{variant:"bodyMd",fontWeight:"semibold",children:"AI Welcome Page"}),t.welcomePage.rating==="excellent"&&e.jsx(r,{tone:"success",children:"ðŸ¤– Excellent"}),t.welcomePage.rating==="good"&&e.jsx(r,{tone:"success",children:"ðŸ¤– Good"}),t.welcomePage.rating==="fair"&&e.jsx(r,{tone:"warning",children:"ðŸ¤– Fair"}),t.welcomePage.rating==="poor"&&e.jsx(r,{tone:"critical",children:"ðŸ¤– Poor"})]}),e.jsx(s,{variant:"bodySm",children:t.welcomePage.feedback}),t.welcomePage.suggestions&&e.jsxs(s,{variant:"bodySm",tone:"subdued",children:["ðŸ’¡ ",t.welcomePage.suggestions]})]})}),e.jsx(T,{})]}),t.collectionsJson&&e.jsxs(e.Fragment,{children:[e.jsx(o,{align:"space-between",blockAlign:"center",children:e.jsxs(l,{gap:"100",children:[e.jsxs(o,{gap:"200",blockAlign:"center",children:[e.jsx(s,{variant:"bodyMd",fontWeight:"semibold",children:"Collections JSON Feed"}),t.collectionsJson.rating==="excellent"&&e.jsx(r,{tone:"success",children:"ðŸ¤– Excellent"}),t.collectionsJson.rating==="good"&&e.jsx(r,{tone:"success",children:"ðŸ¤– Good"}),t.collectionsJson.rating==="fair"&&e.jsx(r,{tone:"warning",children:"ðŸ¤– Fair"}),t.collectionsJson.rating==="poor"&&e.jsx(r,{tone:"critical",children:"ðŸ¤– Poor"})]}),e.jsx(s,{variant:"bodySm",children:t.collectionsJson.feedback}),t.collectionsJson.suggestions&&e.jsxs(s,{variant:"bodySm",tone:"subdued",children:["ðŸ’¡ ",t.collectionsJson.suggestions]})]})}),e.jsx(T,{})]}),t.aiSitemap&&e.jsxs(e.Fragment,{children:[e.jsx(o,{align:"space-between",blockAlign:"center",children:e.jsxs(l,{gap:"100",children:[e.jsxs(o,{gap:"200",blockAlign:"center",children:[e.jsx(s,{variant:"bodyMd",fontWeight:"semibold",children:"AI-Enhanced Sitemap"}),t.aiSitemap.rating==="excellent"&&e.jsx(r,{tone:"success",children:"ðŸ¤– Excellent"}),t.aiSitemap.rating==="good"&&e.jsx(r,{tone:"success",children:"ðŸ¤– Good"}),t.aiSitemap.rating==="fair"&&e.jsx(r,{tone:"warning",children:"ðŸ¤– Fair"}),t.aiSitemap.rating==="poor"&&e.jsx(r,{tone:"critical",children:"ðŸ¤– Poor"})]}),e.jsx(s,{variant:"bodySm",children:t.aiSitemap.feedback}),t.aiSitemap.suggestions&&e.jsxs(s,{variant:"bodySm",tone:"subdued",children:["ðŸ’¡ ",t.aiSitemap.suggestions]})]})}),e.jsx(T,{})]}),t.schemaData&&e.jsx(o,{align:"space-between",blockAlign:"center",children:e.jsxs(l,{gap:"100",children:[e.jsxs(o,{gap:"200",blockAlign:"center",children:[e.jsx(s,{variant:"bodyMd",fontWeight:"semibold",children:"Advanced Schema Data"}),t.schemaData.rating==="excellent"&&e.jsx(r,{tone:"success",children:"ðŸ¤– Excellent"}),t.schemaData.rating==="good"&&e.jsx(r,{tone:"success",children:"ðŸ¤– Good"}),t.schemaData.rating==="fair"&&e.jsx(r,{tone:"warning",children:"ðŸ¤– Fair"}),t.schemaData.rating==="poor"&&e.jsx(r,{tone:"critical",children:"ðŸ¤– Poor"})]}),e.jsx(s,{variant:"bodySm",children:t.schemaData.feedback}),t.schemaData.suggestions&&e.jsxs(s,{variant:"bodySm",tone:"subdued",children:["ðŸ’¡ ",t.schemaData.suggestions]})]})})]}),Object.keys(t).length===0&&!C&&e.jsx(f,{tone:"info",children:e.jsx(s,{children:Object.keys(w).length===0?"Run Basic Tests first, then use AI validation for deep analysis":'Click "Test with AI Bot" to get AI-powered feedback on your endpoint data quality'})}),!j&&e.jsx(f,{tone:"warning",children:e.jsx(s,{children:"Loading plan information..."})})]})})})})]}),e.jsx(F,{children:e.jsx(x,{padding:"300",children:e.jsxs(l,{gap:"400",children:[e.jsx(s,{as:"h3",variant:"headingMd",children:"Test with Real AI Bots"}),e.jsx(s,{variant:"bodyMd",tone:"subdued",children:"Manually test your store with real AI search engines"}),e.jsxs(l,{gap:"200",children:[e.jsxs(o,{align:"space-between",children:[e.jsx(s,{children:"Meta AI Search"}),v("meta")?e.jsx(h,{onClick:()=>N("Meta AI","https://www.meta.ai/"),size:"slim",children:"Test"}):e.jsxs(h,{disabled:!0,size:"slim",children:[k("meta"),"+ Required"]})]}),e.jsxs(o,{align:"space-between",children:[e.jsx(s,{children:"Claude AI Search"}),v("claude")?e.jsx(h,{onClick:()=>N("Claude AI","https://claude.ai/"),size:"slim",children:"Test"}):e.jsxs(h,{disabled:!0,size:"slim",children:[k("claude"),"+ Required"]})]}),e.jsxs(o,{align:"space-between",children:[e.jsx(s,{children:"Gemini AI Search"}),v("gemini")?e.jsx(h,{onClick:()=>N("Gemini AI","https://gemini.google.com/"),size:"slim",children:"Test"}):e.jsxs(h,{disabled:!0,size:"slim",children:[k("gemini"),"+ Required"]})]}),e.jsxs(o,{align:"space-between",children:[e.jsx(s,{children:"ChatGPT Web Search"}),v("chatgpt")?e.jsx(h,{url:`https://chat.openai.com/?q=What+products+does+${d}+sell%3F+Tell+me+about+this+business+and+what+they+offer`,external:!0,size:"slim",children:"Test"}):e.jsxs(h,{disabled:!0,size:"slim",children:[k("chatgpt"),"+ Required"]})]}),e.jsxs(o,{align:"space-between",children:[e.jsx(s,{children:"Perplexity AI Search"}),v("perplexity")?e.jsx(h,{url:`https://www.perplexity.ai/search?q=What+products+does+${d}+sell%3F+Tell+me+about+this+business+and+what+they+offer`,external:!0,size:"slim",children:"Test"}):e.jsxs(h,{disabled:!0,size:"slim",children:[k("perplexity"),"+ Required"]})]}),e.jsxs(o,{align:"space-between",children:[e.jsx(s,{children:"DeepSeek AI Search"}),v("deepseek")?e.jsx(h,{onClick:()=>N("DeepSeek AI","https://chat.deepseek.com/"),size:"slim",children:"Test"}):e.jsxs(h,{disabled:!0,size:"slim",children:[k("deepseek"),"+ Required"]})]})]}),e.jsx(f,{tone:"info",children:e.jsxs(s,{children:[e.jsx("strong",{children:"How to test with AI bots:"}),e.jsx("br",{}),"â€¢ ",e.jsx("strong",{children:"Perplexity & ChatGPT:"}),' Click "Test" - they support URL parameters',e.jsx("br",{}),"â€¢ ",e.jsx("strong",{children:"Meta AI, Claude, Gemini, DeepSeek:"}),' Click "Test" to open a modal with the prompt to copy']})})]})})}),e.jsx(F,{children:e.jsx(x,{padding:"300",children:e.jsxs(l,{gap:"300",children:[e.jsx(s,{as:"h4",variant:"headingSm",children:"AI Search Simulation"}),e.jsx(s,{variant:"bodyMd",tone:"subdued",children:"Test how AI bots would respond to questions about your store based on your structured data."}),e.jsx(f,{tone:"info",children:e.jsxs(l,{gap:"100",children:[e.jsx(s,{variant:"bodySm",fontWeight:"semibold",children:"Simulation Details:"}),e.jsxs(s,{variant:"bodySm",children:["â€¢ ",e.jsx("strong",{children:"Data Source:"})," Your store's products, collections, and metadata"]}),e.jsxs(s,{variant:"bodySm",children:["â€¢ ",e.jsx("strong",{children:"Response Style:"})," Concise (2-3 sentences), natural language"]}),e.jsxs(s,{variant:"bodySm",children:["â€¢ ",e.jsx("strong",{children:"Best For:"})," General store info, products, categories, contact details"]}),e.jsxs(s,{variant:"bodySm",children:["â€¢ ",e.jsx("strong",{children:"Limitations:"})," May not have real-time data (current stock, active promotions, exact shipping times)"]})]})}),e.jsxs(l,{gap:"200",children:[e.jsxs(o,{align:"space-between",children:[e.jsx(s,{children:"What products does this store sell?"}),e.jsx(h,{onClick:()=>G("products"),size:"slim",children:"Simulate Response"})]}),e.jsxs(o,{align:"space-between",children:[e.jsx(s,{children:"Tell me about this business"}),e.jsx(h,{onClick:()=>G("business"),size:"slim",children:"Simulate Response"})]}),e.jsxs(o,{align:"space-between",children:[e.jsx(s,{children:"What categories does this store have?"}),e.jsx(h,{onClick:()=>G("categories"),size:"slim",children:"Simulate Response"})]}),e.jsxs(o,{align:"space-between",children:[e.jsx(s,{children:"What is this store's contact information?"}),e.jsx(h,{onClick:()=>G("contact"),size:"slim",children:"Simulate Response"})]})]}),e.jsx(T,{}),e.jsxs(l,{gap:"200",children:[e.jsx(s,{variant:"headingSm",children:"Ask Your Own Question"}),e.jsx(we,{label:"",value:q,onChange:le,placeholder:"e.g., What are your return policies? Do you ship internationally?",autoComplete:"off",connectedRight:e.jsx(h,{onClick:()=>{q.trim()?G("custom",q):p("Please enter a question")},disabled:!q.trim(),children:"Ask AI"})})]}),O&&e.jsxs(x,{background:"bg-surface-secondary",padding:"300",borderRadius:"200",children:[e.jsx(s,{variant:"bodyMd",fontWeight:"semibold",children:"AI Bot Response:"}),e.jsx(x,{paddingBlockStart:"200",children:e.jsx(s,{variant:"bodyMd",children:O})})]})]})})})]}),W&&e.jsx(Te,{content:W,onDismiss:()=>p("")}),e.jsx(P,{open:re,onClose:()=>V(!1),title:`Test with ${m==null?void 0:m.name}`,primaryAction:{content:"Open AI Bot",url:m==null?void 0:m.url,external:!0},secondaryActions:[{content:"Copy Prompt",onAction:()=>{navigator.clipboard.writeText(`What products does ${d} sell? Tell me about this business and what they offer.`),p("Prompt copied to clipboard!")}}],children:e.jsx(P.Section,{children:e.jsxs(l,{gap:"300",children:[e.jsx(s,{variant:"bodyMd",children:'1. Click "Copy Prompt" (left button)'}),e.jsxs(s,{variant:"bodyMd",children:['2. Click "Open AI Bot" (right button) to visit ',m==null?void 0:m.name]}),e.jsx(s,{variant:"bodyMd",children:"3. Paste the prompt and send"}),e.jsxs(x,{background:"bg-surface-secondary",padding:"300",borderRadius:"200",children:[e.jsx(s,{variant:"bodyMd",fontWeight:"semibold",children:"Prompt to test:"}),e.jsx(x,{paddingBlockStart:"200",children:e.jsxs(s,{variant:"bodyMd",as:"p",children:["What products does ",d," sell? Tell me about this business and what they offer."]})})]}),e.jsx(f,{tone:"info",children:e.jsx(s,{children:"The AI bot will search the web and use your store's structured data to answer."})})]})})}),e.jsx(P,{open:ue,onClose:()=>H(!1),title:"Upgrade Required",primaryAction:{content:"View Plans",onAction:()=>{const i=new URLSearchParams(window.location.search),n=i.toString()?`?${i.toString()}`:"";window.location.href=`/billing${n}`}},secondaryActions:[{content:"Cancel",onAction:()=>H(!1)}],children:e.jsx(P.Section,{children:e.jsxs(l,{gap:"300",children:[e.jsxs(s,{variant:"bodyMd",children:[e.jsx("strong",{children:S==null?void 0:S.endpoint})," requires ",e.jsx("strong",{children:S==null?void 0:S.requiredPlan})," plan or higher."]}),e.jsxs(s,{variant:"bodyMd",tone:"subdued",children:["Your current plan: ",e.jsx("strong",{children:S==null?void 0:S.currentPlan})]}),e.jsx(f,{tone:"info",children:e.jsx(s,{children:"Upgrade to access this advanced AI Discovery feature."})})]})})}),e.jsx(P,{open:ce,onClose:()=>E(!1),title:"Upgrade Required",primaryAction:{content:"View Plans",onAction:()=>{const i=new URLSearchParams(window.location.search),n=i.toString()?`?${i.toString()}`:"";window.location.href=`/billing${n}`}},secondaryActions:[{content:"Cancel",onAction:()=>E(!1)}],children:e.jsx(P.Section,{children:e.jsxs(l,{gap:"300",children:[e.jsxs(s,{variant:"bodyMd",children:["AI Testing requires ",e.jsx("strong",{children:(u==null?void 0:u.minimumPlan)||"Professional"})," plan or higher."]}),e.jsxs(s,{variant:"bodyMd",tone:"subdued",children:["Your current plan: ",e.jsx("strong",{children:(u==null?void 0:u.currentPlan)||"Starter"})]}),e.jsx(f,{tone:"info",children:e.jsx(s,{children:"Upgrade to test AI responses with real store data."})})]})})}),e.jsx(fe,{open:de,onClose:()=>{U(!1),b(null),M()},tokensRequired:(u==null?void 0:u.tokensRequired)||0,tokensAvailable:(u==null?void 0:u.tokensAvailable)||0,tokensNeeded:(u==null?void 0:u.tokensNeeded)||0,feature:"ai-testing-simulation",shop:d,needsUpgrade:!1,returnTo:"/ai-testing"}),u&&e.jsx(Ae,{open:he,onClose:()=>{$(!1),b(null)},feature:u.feature||"ai-testing-simulation",trialEndsAt:u.trialEndsAt,currentPlan:u.currentPlan||j,tokensRequired:u.tokensRequired||0,onActivatePlan:async()=>{try{console.log("[AI-TESTING] ðŸ”“ Activating plan directly...");const i=await A("/api/billing/activate",{method:"POST",body:JSON.stringify({shop:d,endTrial:!0,returnTo:"/ai-testing"})});if(console.log("[AI-TESTING] âœ… Activation response:",i),i.requiresApproval&&i.confirmationUrl){console.log("[AI-TESTING] ðŸ” Redirecting to Shopify approval..."),window.top.location.href=i.confirmationUrl;return}console.log("[AI-TESTING] âœ… Plan activated, reloading page..."),window.location.reload()}catch(i){console.error("[AI-TESTING] âŒ Activation failed:",i);const n=new URLSearchParams(window.location.search),a=n.get("host"),y=n.get("embedded");window.location.href=`/billing?shop=${encodeURIComponent(d)}&embedded=${y}&host=${encodeURIComponent(a)}`}},onPurchaseTokens:()=>{const i=new URLSearchParams(window.location.search),n=i.get("host"),a=i.get("embedded");window.location.href=`/billing?shop=${encodeURIComponent(d)}&embedded=${a}&host=${encodeURIComponent(n)}&returnTo=${encodeURIComponent("/ai-testing")}`}})]})}export{Ne as default};
