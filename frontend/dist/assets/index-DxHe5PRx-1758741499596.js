const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-D1hKiftA-1758741499596.js","assets/react-vendor-tAaa2TlE-1758741499596.js","assets/index-BbGuD21e-1758741499596.js","assets/index-CPJC4_lh-1758741499596.js","assets/BulkEdit-B0Y-ZuBV-1758741499596.js","assets/app-bridge-CVWcLQ5x-1758741499596.js","assets/UpgradeModal-C_5xAO9n-1758741499596.js","assets/polaris-3c3Pg7iW-1758741499596.js","assets/Collections-GbQjQFqw-1758741499596.js","assets/Sitemap-DbokXUNg-1758741499596.js","assets/StoreMetadata-B-6WNve0-1758741499596.js","assets/SchemaData-BfJO30qf-1758741499596.js","assets/Settings-hBDBn8Px-1758741499596.js"])))=>i.map(i=>d[i]);
import{j as e}from"./app-bridge-CVWcLQ5x-1758741499596.js";import{a as F,r as d,R as S}from"./react-vendor-tAaa2TlE-1758741499596.js";import{P as $,A as M,B as H,I as w,T as u,a as h,C as P,b as N,F as U,c as V}from"./polaris-3c3Pg7iW-1758741499596.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function a(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(r){if(r.ep)return;r.ep=!0;const o=a(r);fetch(r.href,o)}})();var O,R=F;O=R.createRoot,R.hydrateRoot;const z="modulepreload",W=function(t){return"/"+t},b={},f=function(n,a,s){let r=Promise.resolve();if(a&&a.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),l=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));r=Promise.allSettled(a.map(c=>{if(c=W(c),c in b)return;b[c]=!0;const p=c.endsWith(".css"),g=p?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${g}`))return;const m=document.createElement("link");if(m.rel=p?"stylesheet":z,p||(m.as="script"),m.crossOrigin="",m.href=c,l&&m.setAttribute("nonce",l),document.head.appendChild(m),p)return new Promise((j,x)=>{m.addEventListener("load",j),m.addEventListener("error",()=>x(new Error(`Unable to preload CSS for ${c}`)))})}))}function o(i){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=i,window.dispatchEvent(l),!l.defaultPrevented)throw i}return r.then(i=>{for(const l of i||[])l.status==="rejected"&&o(l.reason);return n().catch(o)})},D=d.createContext(null);function q(){const t=d.useContext(D);return t||console.warn("[useAppBridge] No App Bridge instance in context"),t}function G({children:t}){const[n,a]=d.useState(null),[s,r]=d.useState(!0),[o,i]=d.useState(null),l=new URLSearchParams(window.location.search),c=l.get("host"),p=l.get("shop"),g=void 0;return console.log("[APP-BRIDGE-PROVIDER] Public App - Initializing with:",{host:c?"Present":"Missing",shop:p?"Present":"Missing",apiKey:"Missing"}),d.useEffect(()=>{{console.error("[APP-BRIDGE-PROVIDER] Missing API key - cannot initialize App Bridge"),i("Missing API key"),r(!1);return}},[g,c,p]),s?e.jsx("div",{children:"Loading..."}):(o&&console.warn("[APP-BRIDGE-PROVIDER] App Bridge initialization failed:",o),e.jsx(D.Provider,{value:n,children:t}))}const K={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1};let E=null;async function J(t=!1){var n;if(E)return E;if(window.__SHOPIFY_APP_BRIDGE__)return E=window.__SHOPIFY_APP_BRIDGE__,t&&console.log("[SFETCH] Using global App Bridge instance"),E;try{const a=await f(()=>import("./index-D1hKiftA-1758741499596.js").then(c=>c.i),__vite__mapDeps([0,1,2])),s=a&&(a.default||a);if(!s)return t&&console.error("[SFETCH] App Bridge module not available"),null;const r=new URLSearchParams(window.location.search).get("host"),o=new URLSearchParams(window.location.search).get("shop"),i=window.__SHOPIFY_API_KEY||import.meta&&K&&void 0||((n=document.querySelector('meta[name="shopify-api-key"]'))==null?void 0:n.getAttribute("content"))||null;if(!i)return t&&console.error("[SFETCH] Missing API key for public app"),null;const l=r||o;return l?(E=s({apiKey:i,host:l,forceRedirect:!1}),t&&console.log("[SFETCH] Public App - AppBridge created"),E):(t&&console.warn("[SFETCH] No host or shop parameter - may not be embedded"),null)}catch(a){return t&&console.error("[SFETCH] AppBridge creation failed:",a),null}}async function Y(t,n=!1){try{n&&console.log("[SFETCH] Getting token from App Bridge...",{app:!!t});const a=await f(()=>import("./index-CPJC4_lh-1758741499596.js").then(o=>o.i),__vite__mapDeps([3,1,2])),s=a&&a.getSessionToken;if(!s||!t)return n&&console.log("[SFETCH] No getSessionToken or app:",{getSessionToken:!!s,app:!!t}),null;n&&console.log("[SFETCH] Calling getSessionToken...");const r=await s(t);return n&&console.log("[SFETCH] Got session token?",!!r,r?`(len=${r.length}, head=${r.slice(0,10)}...)`:""),r||null}catch(a){return n&&console.error("[SFETCH] Token fetch failed:",a),null}}function Q(){return async function(n,{method:a="GET",headers:s={},body:r,shop:o,responseType:i="json"}={}){const l=o?`${n}${n.includes("?")?"&":"?"}shop=${encodeURIComponent(o)}`:n,c=await J(),p=c?await Y(c):null,g={method:a,headers:{"Content-Type":"application/json",...s},credentials:"include",body:r?JSON.stringify(r):void 0},m=p?{...g,headers:{...g.headers,Authorization:`Bearer ${p}`}}:g,j=await fetch(l,m);if(j.status===304)return i==="text"?"":{};const x=await j.text();if(!j.ok){let _;try{_=JSON.parse(x)}catch{_={error:x||`HTTP ${j.status}`}}const k=(_==null?void 0:_.error)||(_==null?void 0:_.message)||`HTTP ${j.status}`;throw new Error(k)}if(i==="text")return x;let A;try{A=x?JSON.parse(x):null}catch{A={error:(x==null?void 0:x.slice(0,500))||"Non-JSON response"}}return A}}const X=(t,n="")=>{try{return new URLSearchParams(window.location.search).get(t)||n}catch{return n}};function Z(){const t=d.useMemo(()=>Q(),[]),n=X("shop","");return{api:t,shop:n}}const y=["en","de","es","fr"],I={en:"ðŸ‡¬ðŸ‡§",de:"ðŸ‡©ðŸ‡ª",es:"ðŸ‡ªðŸ‡¸",fr:"ðŸ‡«ðŸ‡·"},T={en:"English",de:"Deutsch",es:"EspaÃ±ol",fr:"FranÃ§ais"};function ee({lang:t="en",setLang:n,t:a}){const[s,r]=d.useState(!1);d.useEffect(()=>{if(!y.includes(t)){try{localStorage.setItem("app_lang","en")}catch{}typeof n=="function"&&n("en")}},[t,n]);const o=y.includes(t)?t:"en",i=e.jsx(H,{onClick:()=>r(c=>!c),disclosure:!0,children:e.jsxs(w,{gap:"200",blockAlign:"center",children:[e.jsx("span",{"aria-hidden":!0,children:I[o]}),e.jsx(u,{as:"span",variant:"bodyMd",children:T[o]})]})}),l=d.useMemo(()=>y.map(c=>({content:`${I[c]} ${T[c]}`,active:c===o,onAction:()=>{try{localStorage.setItem("app_lang",c)}catch{}typeof n=="function"&&n(c),r(!1)}})),[o,n]);return e.jsx($,{active:s,activator:i,onClose:()=>r(!1),autofocusTarget:"first-node",children:e.jsx(M,{items:l})})}function te({sectionTitle:t,lang:n,setLang:a,t:s}){return e.jsx(h,{padding:"400",borderBlockEndWidth:"025",borderColor:"border",background:"bg",children:e.jsxs(w,{align:"space-between",blockAlign:"center",children:[e.jsx(u,{as:"h1",variant:"headingLg",children:t}),e.jsx(ee,{lang:n,setLang:a,t:s})]})})}const B="en",v={en:()=>f(()=>import("./en-DY--Skhq-1758741499596.js"),[]),de:()=>f(()=>import("./de-BYtsvH6H-1758741499596.js"),[]),es:()=>f(()=>import("./es-Cshzw9pa-1758741499596.js"),[]),fr:()=>f(()=>import("./fr-DGTXCiho-1758741499596.js"),[])},C=Object.keys(v);function ne(){try{const t=localStorage.getItem("app_lang");return C.includes(t)?t:null}catch{return null}}function re(t){try{localStorage.setItem("app_lang",t)}catch{}}function oe(){const[t,n]=d.useState(()=>ne()||B),[a,s]=d.useState({});d.useEffect(()=>{let o=!1;async function i(){const c=await(v[t]||v[B])();o||s(c.default||c)}return i(),re(t),()=>{o=!0}},[t]);const r=d.useMemo(()=>(o,i="")=>{const l=o==null?void 0:o.split(".").reduce((c,p)=>c&&c[p]!==void 0?c[p]:void 0,a);return l!=null?String(l):i||o},[a]);return{lang:t,setLang:n,t:r,dict:a,langs:C}}const se=S.lazy(()=>f(()=>import("./BulkEdit-B0Y-ZuBV-1758741499596.js"),__vite__mapDeps([4,5,1,6,7]))),ie=S.lazy(()=>f(()=>import("./Collections-GbQjQFqw-1758741499596.js"),__vite__mapDeps([8,5,1,6,7]))),ae=S.lazy(()=>f(()=>import("./Sitemap-DbokXUNg-1758741499596.js"),__vite__mapDeps([9,5,1,7]))),ce=S.lazy(()=>f(()=>import("./StoreMetadata-B-6WNve0-1758741499596.js"),__vite__mapDeps([10,5,1,7]))),le=S.lazy(()=>f(()=>import("./SchemaData-BfJO30qf-1758741499596.js"),__vite__mapDeps([11,5,1,7]))),de=S.lazy(()=>f(()=>import("./Settings-hBDBn8Px-1758741499596.js"),__vite__mapDeps([12,5,1,7]))),ue={Polaris:{ResourceList:{sortingLabel:"Sort by"}}},L=(t,n="")=>{try{return new URLSearchParams(window.location.search).get(t)||n}catch{return n}};function pe(){const[t,n]=d.useState(window.location.pathname);return d.useEffect(()=>{const a=()=>n(window.location.pathname);return window.addEventListener("popstate",a),()=>window.removeEventListener("popstate",a)},[]),{path:t}}function he({active:t,shop:n}){t==="/"||t.startsWith("/dashboard"),t.startsWith("/ai-seo"),t.startsWith("/billing"),t.startsWith("/settings");const s=new URLSearchParams(window.location.search).get("host"),r=new URLSearchParams;n&&r.set("shop",n),s&&r.set("host",s);const o=r.toString()?`?${r.toString()}`:"";return e.jsxs("ui-nav-menu",{children:[e.jsx("a",{href:`/${o}`,rel:"home",children:"Home"}),e.jsx("a",{href:`/dashboard${o}`,children:"Dashboard"}),e.jsx("a",{href:`/ai-seo${o}`,children:"Search Optimization for AI"}),e.jsx("a",{href:`/billing${o}`,children:"Billing"}),e.jsx("a",{href:`/settings${o}`,children:"Settings"})]})}const fe=S.memo(({shop:t})=>{var o;const[n,a]=d.useState(null),{api:s}=Z(),r=t||L("shop","");return d.useEffect(()=>{r&&s("/plans/me",{shop:r}).then(i=>{i&&!i.error&&a(i)}).catch(i=>console.error("Failed to load plan:",i))},[r,s]),d.useEffect(()=>{r&&s("/collections/check-definitions",{shop:r}).then(i=>{const l=(i.definitions||[]).map(g=>g.key),p=["en","bg","fr"].filter(g=>!l.includes(`seo__${g}`));if(p.length>0)return s("/collections/create-definitions",{method:"POST",shop:r,body:{shop:r,languages:p}})}).catch(i=>console.error("Definitions error:",i))},[r,s]),n?e.jsx(P,{title:"Dashboard",children:e.jsxs(h,{padding:"400",children:[e.jsxs(w,{gap:"800",wrap:!1,children:[e.jsxs(h,{children:[e.jsx(u,{variant:"headingMd",as:"h3",children:"Current plan"}),e.jsx(u,{children:n.plan||"Free"})]}),e.jsxs(h,{children:[e.jsx(u,{variant:"headingMd",as:"h3",children:"Shop"}),e.jsx(u,{children:n.shop||"Ã¢â‚¬â€"})]}),e.jsxs(h,{children:[e.jsx(u,{variant:"headingMd",as:"h3",children:"AI queries"}),e.jsxs(u,{children:[n.ai_queries_used||0," / ",n.ai_queries_limit||0]})]}),e.jsxs(h,{children:[e.jsx(u,{variant:"headingMd",as:"h3",children:"Product limit"}),e.jsx(u,{children:n.product_limit||0})]})]}),e.jsxs(h,{paddingBlockStart:"400",children:[e.jsx(u,{variant:"headingMd",as:"h3",children:"Allowed AI providers"}),e.jsx(u,{children:((o=n.providersAllowed)==null?void 0:o.join(", "))||"None"})]}),n.trial_ends_at&&e.jsxs(h,{paddingBlockStart:"400",children:[e.jsx(u,{variant:"headingMd",as:"h3",children:"Trial ends at"}),e.jsx(u,{children:new Date(n.trial_ends_at).toLocaleDateString()})]})]})}):e.jsx(P,{children:e.jsx(h,{padding:"400",children:e.jsx(u,{children:"Loading plan info..."})})})}),ge=S.memo(()=>{const t=L("shop",""),n=window.location.pathname,s=n==="/ai-seo"||n==="/ai-seo/products"?"products":n==="/ai-seo/collections"?"collections":n==="/ai-seo/sitemap"?"sitemap":n==="/ai-seo/store-metadata"?"store-metadata":n==="/ai-seo/schema-data"?"schema-data":"products",r=o=>{const i=new URLSearchParams(window.location.search),l=i.toString()?`?${i.toString()}`:"";return o==="products"?`/ai-seo${l}`:`/ai-seo/${o}${l}`};return e.jsxs("div",{children:[e.jsx(h,{paddingBlockEnd:"400",children:e.jsx(P,{children:e.jsx(h,{padding:"200",children:e.jsxs(w,{gap:"100",children:[e.jsx("a",{href:r("products"),style:{padding:"8px 16px",borderRadius:"4px",backgroundColor:s==="products"?"#008060":"#f6f6f7",color:s==="products"?"white":"#202223",textDecoration:"none",display:"inline-block"},children:"Products"}),e.jsx("a",{href:r("collections"),style:{padding:"8px 16px",borderRadius:"4px",backgroundColor:s==="collections"?"#008060":"#f6f6f7",color:s==="collections"?"white":"#202223",textDecoration:"none",display:"inline-block"},children:"Collections"}),e.jsx("a",{href:r("sitemap"),style:{padding:"8px 16px",borderRadius:"4px",backgroundColor:s==="sitemap"?"#008060":"#f6f6f7",color:s==="sitemap"?"white":"#202223",textDecoration:"none",display:"inline-block"},children:"Sitemap"}),e.jsx("a",{href:r("store-metadata"),style:{padding:"8px 16px",borderRadius:"4px",backgroundColor:s==="store-metadata"?"#008060":"#f6f6f7",color:s==="store-metadata"?"white":"#202223",textDecoration:"none",display:"inline-block"},children:"Store metadata"}),e.jsx("a",{href:r("schema-data"),style:{padding:"8px 16px",borderRadius:"4px",backgroundColor:s==="schema-data"?"#008060":"#f6f6f7",color:s==="schema-data"?"white":"#202223",textDecoration:"none",display:"inline-block"},children:"Schema Data"})]})})})}),e.jsxs("div",{children:[s==="products"&&e.jsx(se,{shop:t}),s==="collections"&&e.jsx(ie,{shop:t}),s==="sitemap"&&e.jsx(ae,{shop:t}),s==="store-metadata"&&e.jsx(ce,{shop:t}),s==="schema-data"&&e.jsx(le,{shop:t})]})]})});function me(){q();const{path:t}=pe(),{lang:n,setLang:a,t:s}=oe(),r=!!new URLSearchParams(window.location.search).get("host"),o=L("shop",""),i=d.useMemo(()=>t.startsWith("/ai-seo")?"Search Optimization for AI":t.startsWith("/billing")?"Billing":t.startsWith("/settings")?"Settings":"Dashboard",[t]),l=()=>t==="/"||t==="/dashboard"?e.jsx(fe,{shop:o}):t.startsWith("/ai-seo")?e.jsx(ge,{shop:o}):t==="/billing"?e.jsx(P,{children:e.jsx(h,{padding:"400",children:e.jsx(u,{children:"Billing page"})})}):t==="/settings"?e.jsx(de,{shop:o}):e.jsx(P,{children:e.jsxs(h,{padding:"400",children:[e.jsx(u,{variant:"headingMd",children:"Page not found"}),e.jsx(h,{paddingBlockStart:"200",children:e.jsxs(u,{children:['The page "',t,'" does not exist.']})})]})});return e.jsxs(N,{i18n:ue,children:[r&&e.jsx(he,{active:t,shop:o}),e.jsx(U,{children:e.jsxs(V,{children:[e.jsx(te,{sectionTitle:i,lang:n,setLang:a,t:s,shop:o}),l()]})})]})}function xe(){const t=new URLSearchParams(window.location.search),n=t.get("host"),a=t.get("shop");return console.log("[MAIN] Public App - Host:",n,"Shop:",a),console.log("[MAIN] Full URL:",window.location.href),console.log("[MAIN] Rendering with AppBridgeProvider (Public App)"),e.jsx(G,{children:e.jsx(me,{})})}O(document.getElementById("root")).render(e.jsx(xe,{}));export{Q as m,Z as u};
