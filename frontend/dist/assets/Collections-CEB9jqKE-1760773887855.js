import{j as e}from"./app-bridge-BvoR4-e1-1760773887855.js";import{r as l}from"./react-vendor-tAaa2TlE-1760773887855.js";import{m as mt}from"./sessionFetch-CJepNHo3-1760773887855.js";import{S as St,U as xt,I as jt}from"./StoreMetadataBanner-Cvanrp3w-1760773887855.js";import{M as f,e as b,T as i,f as he,d as Ct,B as v,a as c,I as O,g as Pe,D as Et,h as ne,C as Ne,j as yt,S as Lt,P as wt,k as bt,R as Ot,l as It,n as At,E as vt}from"./polaris-CFjaXhex-1760773887855.js";import"./index-BLeOYlKn-1760773887855.js";const Mt=(K,j="")=>{try{return new URLSearchParams(window.location.search).get(K)||j}catch{return j}};function Jt({shop:K,globalPlan:j}){var Me,ke,De;const u=K||Mt("shop","");console.log("[COLLECTIONS] Component initialized with shop:",u,"shopProp:",K);const L=l.useMemo(()=>mt(),[]),[p,Re]=l.useState([]),[Be,pe]=l.useState(!1),[F,$e]=l.useState(0),[h,H]=l.useState([]),[C,J]=l.useState(!1),[kt,Dt]=l.useState(""),[T,oe]=l.useState(""),[I,Q]=l.useState("all"),[fe,le]=l.useState(!1),[ze,Ue]=l.useState(""),[Tt,We]=l.useState([]),[E,$]=l.useState([]),[y,me]=l.useState([]),[ae,Y]=l.useState(!1),[M,P]=l.useState({current:0,total:0,percent:0}),[Se,V]=l.useState(""),[q,xe]=l.useState([]),[Pt,Nt]=l.useState(!1),[Rt,Bt]=l.useState(null),[$t,zt]=l.useState(!1),[Ut,Ke]=l.useState(""),[Fe,X]=l.useState(!1),[z,U]=l.useState([]),[je,Ce]=l.useState(!1),[He,G]=l.useState(!1),[qe,Z]=l.useState(!1),[Ee,ee]=l.useState([]),[N,re]=l.useState({}),[Ge,ie]=l.useState(!1),[_e,ce]=l.useState(!1),[ye,Wt]=l.useState({}),[Je,de]=l.useState(!1),[Le,ue]=l.useState(null),[Qe,we]=l.useState(!1),[be,S]=l.useState(""),[Oe,Ie]=l.useState(!1),[Ye,te]=l.useState(!1),[Ve,Ae]=l.useState(!1),[m,se]=l.useState(null),[R,_]=l.useState("starter"),[k,ge]=l.useState(1);l.useEffect(()=>{if(!(!j||typeof j!="object")){if(j.planKey&&j.planKey!==""){_(j.planKey);const s={starter:1,professional:2,growth:3,"growth extra":6,growth_extra:6,enterprise:10}[j.planKey.toLowerCase()]||1;ge(s)}else if(j.plan&&j.plan!==""){const t=j.plan.toLowerCase().replace(/\s+/g,"-");_(t);const n={starter:1,professional:2,growth:3,"growth extra":6,growth_extra:6,enterprise:10}[t]||1;ge(n)}}},[j]);const[x,B]=l.useState({processing:!1,current:0,total:0,currentItem:"",results:null});l.useEffect(()=>{if(!u)return;L("/graphql",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:`
      query PlansMe($shop:String!) {
        plansMe(shop:$shop) {
          plan
          planKey
          modelsSuggested
        }
      }
    `,variables:{shop:u}})}).then(s=>{var d,g,A;if((d=s==null?void 0:s.errors)!=null&&d.length)throw new Error(((g=s.errors[0])==null?void 0:g.message)||"GraphQL error");const n=(A=s==null?void 0:s.data)==null?void 0:A.plansMe,a=(n==null?void 0:n.modelsSuggested)||["google/gemini-1.5-flash"];We(a.map(W=>({label:W,value:W}))),Ue(a[0]),_((n==null?void 0:n.planKey)||"starter");const r=((n==null?void 0:n.planKey)||"starter").toLowerCase();ge({starter:1,professional:2,growth:3,"growth extra":6,growth_extra:6,enterprise:10}[r]||1)}).catch(s=>S(`Error loading models: ${s.message}`))},[u,L]),l.useEffect(()=>{u&&(console.log("[COLLECTIONS] Loading languages for shop:",u),L(`/api/languages/shop/${u}?shop=${u}`).then(t=>{console.log("[COLLECTIONS] Languages API data:",t);const s=(t==null?void 0:t.shopLanguages)||["en"];console.log("[COLLECTIONS] Extracted languages:",s),me(s),$([])}).catch(t=>{console.error("[COLLECTIONS] Languages API error:",t),me(["en"]),$([])}))},[u,L]);const D=l.useCallback(async()=>{var t;pe(!0);try{console.log("[COLLECTIONS] Shop value:",u),console.log("[COLLECTIONS] Shop prop:",K),console.log("[COLLECTIONS] URL search params:",window.location.search);const n=`/collections/list-graphql?${new URLSearchParams({shop:u,...T&&{search:T},...I!=="all"&&{optimized:I}})}`;console.log("[COLLECTIONS] Using GraphQL endpoint:",n);const a=await L(n);console.log("[COLLECTIONS] API Response data:",a),((t=a==null?void 0:a.collections)==null?void 0:t.length)>0&&(console.log("[COLLECTIONS] First collection optimizedLanguages:",a.collections[0].optimizedLanguages),console.log("[COLLECTIONS] First collection full data:",a.collections[0]));let r=a.collections||[];if(T){const o=T.toLowerCase();r=r.filter(d=>d.title.toLowerCase().includes(o)||d.handle.toLowerCase().includes(o))}I!=="all"&&(r=r.filter(o=>I==="true"?o.hasSeoData:!o.hasSeoData)),Re(r),$e(r.length)}catch(s){S(`Error loading collections: ${s.message}`)}finally{pe(!1)}},[u,T,I,L]);l.useEffect(()=>{u&&(D(),G(!1))},[u,I,D]),l.useEffect(()=>{const t=setTimeout(()=>{u&&D()},500);return()=>clearTimeout(t)},[T]);const Xe=l.useCallback(t=>{H(t);const s=t.some(n=>{const a=p.find(r=>r.id===n);return a==null?void 0:a.hasSeoData});G(s),t.length===0&&J(!1)},[p]),Ze=l.useCallback(t=>{if(J(t),t){H(p.map(n=>n.id));const s=p.some(n=>n.hasSeoData);G(s)}else H([]),G(!1)},[p]),et=async t=>{we(!0);try{const s=`/collections/${t.split("/").pop()}/seo-data?shop=${encodeURIComponent(u)}`,n=await L(s);ue(n),de(!0)}catch(s){S((s==null?void 0:s.status)===404?"No SEO data found for this collection":"Failed to load SEO data")}finally{we(!1)}},ve=l.useMemo(()=>{var s;if(C)return E.length>k;const t=p.filter(n=>h.includes(n.id));if(t.length===0)return E.length>k;for(const n of t){const a=((s=n.optimizationSummary)==null?void 0:s.optimizedLanguages)||[],r=E.filter(d=>!a.includes(d));if(a.length+r.length>k)return!0}return!1},[p,h,C,k,E]),tt=()=>{if(h.length===0&&!C){S("Please select collections first");return}ce(!0)},st=async()=>{console.log("[AI-ENHANCE] Starting enhancement...");const s=p.filter(a=>h.includes(a.id)).filter(a=>{var r;return((r=a.optimizedLanguages)==null?void 0:r.length)>0});if(s.length===0){S("Please select collections with Basic SEO optimization");return}console.log("[AI-ENHANCE] Collections to enhance:",s.length),Ie(!0),B({processing:!0,current:0,total:s.length,currentItem:"",results:null});const n={successful:0,failed:0,skipped:0};for(let a=0;a<s.length;a++){const r=s[a];B(o=>({...o,current:a,currentItem:r.title}));try{const o=r.optimizedLanguages||[];if(o.length===0){console.log(`[AI-ENHANCE] No languages for ${r.title}, skipping`),n.skipped++;continue}console.log(`[AI-ENHANCE] Enhancing ${r.title} for languages:`,o);const d=await L(`/ai-enhance/collection/${encodeURIComponent(r.id)}`,{method:"POST",shop:u,body:{shop:u,languages:o}});d&&d.ok?(n.successful++,console.log(`[AI-ENHANCE] Success for ${r.title}`)):(n.failed++,console.log(`[AI-ENHANCE] Failed for ${r.title}`))}catch(o){if(console.error("[AI-ENHANCE] Error:",o),o.status===403){B({processing:!1,current:0,total:0,currentItem:"",results:null}),se(o),_(o.currentPlan||R||"starter"),te(!0);return}if(o.status===402||o.requiresPurchase||o.trialRestriction){B({processing:!1,current:0,total:0,currentItem:"",results:null}),se(o),_(o.currentPlan||R||"starter"),o.trialRestriction?te(!0):Ae(!0);return}n.failed++}B(o=>({...o,current:a+1}))}B(a=>({...a,processing:!1,results:n})),S(`AI enhancement complete! ${n.successful} collections enhanced.`),n.successful>0&&await D()},nt=()=>{p.filter(n=>h.includes(n.id)).filter(n=>{var a;return((a=n.optimizedLanguages)==null?void 0:a.length)>0});const s=()=>{Ie(!1),B({processing:!1,current:0,total:0,currentItem:"",results:null}),x.results&&x.results.successful>0&&D()};return x.processing?e.jsx(f,{open:Oe,title:"Processing AI Enhancement",onClose:()=>{},noScroll:!0,children:e.jsx(f.Section,{children:e.jsxs(b,{gap:"400",children:[e.jsxs(i,{variant:"bodyMd",children:["Processing: ",x.currentItem]}),e.jsx(he,{progress:x.current/x.total*100}),e.jsxs(i,{variant:"bodySm",tone:"subdued",children:[x.current," of ",x.total," collections (",Math.round(x.current/x.total*100),"%)"]})]})})}):x.results!==null?e.jsx(f,{open:Oe,title:"AI Enhancement Results",onClose:s,primaryAction:{content:"Done",onAction:s},children:e.jsx(f.Section,{children:e.jsx(b,{gap:"300",children:e.jsxs(O,{gap:"400",children:[e.jsxs(c,{children:[e.jsx(i,{variant:"bodyMd",fontWeight:"semibold",children:"Successful:"}),e.jsx(i,{variant:"headingLg",fontWeight:"bold",tone:"success",children:x.results.successful})]}),e.jsxs(c,{children:[e.jsx(i,{variant:"bodyMd",fontWeight:"semibold",children:"Failed:"}),e.jsx(i,{variant:"headingLg",fontWeight:"bold",tone:"critical",children:x.results.failed})]}),e.jsxs(c,{children:[e.jsx(i,{variant:"bodyMd",fontWeight:"semibold",children:"Skipped:"}),e.jsx(i,{variant:"headingLg",fontWeight:"bold",tone:"info",children:x.results.skipped})]})]})})})}):null},ot=async()=>{if(!E.length){S("Please select at least one language");return}ce(!1),Y(!0),P({current:0,total:0,percent:0}),xe([]),re({});try{const t=C?p:p.filter(r=>h.includes(r.id)),s=t.length;P({current:0,total:s,percent:0});const n={};for(let r=0;r<t.length;r++){const o=t[r];V(o.title);try{const A=await L("/seo/generate-collection-multi",{method:"POST",shop:u,body:JSON.stringify({shop:u,collectionId:o.id,model:ze,languages:E})});n[o.id]={success:!0,data:A}}catch(A){n[o.id]={success:!1,error:A.message},xe(W=>[...W,{collection:o.title,error:A.message}])}const d=r+1,g=Math.round(d/s*100);P({current:d,total:s,percent:g})}re(n),ie(!0);const a=Object.values(n).filter(r=>r.success).length;S(`Generated optimization for ${a} collections`)}catch(t){S(`Error: ${t.message}`)}finally{Y(!1),V("")}},lt=async()=>{var t,s;Y(!0),P({current:0,total:0,percent:0});try{const n=Object.entries(N).filter(([r,o])=>o.success),a=n.length;P({current:0,total:a,percent:0});for(let r=0;r<n.length;r++){const[o,d]=n[r],g=p.find(w=>w.id===o);if(!g)continue;V(g.title);try{if(console.log("Applying SEO for collection:",o),console.log("Result data:",d.data),console.log("Results array:",(t=d.data)==null?void 0:t.results),!((s=d.data)!=null&&s.results)||!Array.isArray(d.data.results))throw new Error("Invalid results structure");const w=await L("/seo/apply-collection-multi",{method:"POST",shop:u,body:{shop:u,collectionId:o,results:d.data.results.map(Te=>({language:Te.language,seo:Te.data})),options:{updateTitle:!0,updateDescription:!0,updateSeo:!0,updateMetafields:!0}}});if(!(w!=null&&w.ok))throw new Error((w==null?void 0:w.error)||"Apply failed")}catch(w){console.error("Apply error for collection:",o,w),q.push({id:g.id,title:g.title,message:w.message})}const A=r+1,W=Math.round(A/a*100);P({current:A,total:a,percent:W})}S("Optimization applied successfully!"),ie(!1),re({}),H([]),await D(),J(!1)}catch(n){S(`Error applying optimization: ${n.message}`)}finally{Y(!1),V("")}},at=async(t=[])=>{console.log("[DELETE-SEO-BULK] ===== BULK DELETE START ====="),console.log("[DELETE-SEO-BULK] Languages to delete:",t),console.log("[DELETE-SEO-BULK] Selected items:",h),console.log("[DELETE-SEO-BULK] Select all pages:",C),Ce(!0),Ke("");try{const s=C?p:p.filter(o=>h.includes(o.id)),n=s.length*t.length;let a=0;const r=[];for(const o of s)for(const d of t)try{console.log(`[DELETE-SEO-BULK] Deleting ${d} for ${o.title} (${o.id})`);const g=await L("/collections/delete-seo",{method:"DELETE",shop:u,body:{shop:u,collectionId:o.id,language:d}});console.log(`[DELETE-SEO-BULK] Success for ${o.title} - ${d}:`,g)}catch(g){console.error(`[DELETE-SEO-BULK] Failed to delete ${d} for ${o.title}:`,g),r.push({id:o.id,title:o.title,message:g.message})}finally{a++,P({current:a,total:n,percent:Math.round(a/n*100)})}S(`Deleted optimization for ${t.join(", ").toUpperCase()}`),setTimeout(async()=>{await D(),H([]),J(!1),G(!1)},100)}catch(s){console.error("[DELETE-SEO-BULK] Error:",s),S(`Delete error: ${s.message}`)}finally{console.log("[DELETE-SEO-BULK] ===== BULK DELETE END ====="),Ce(!1),ee([]),U([])}},rt=t=>{var o,d;const s=((o=N[t.id])==null?void 0:o.success)||ye[t.id],n=((d=N[t.id])==null?void 0:d.data)||ye[t.id],a=t.optimizedLanguages||[];console.log(`[COLLECTIONS] Rendering collection "${t.title}":`,{optimizedLanguages:a,availableLanguages:y,hasSeoData:t.hasSeoData});const r=e.jsx(c,{width:"40px",height:"40px",background:"surface-neutral",borderRadius:"200"});return e.jsx(At,{id:t.id,media:r,accessibilityLabel:`View details for ${t.title}`,onClick:g=>{console.log("[Collections-ResourceItem] ===== CLICK ON RESOURCE ITEM ====="),console.log("[Collections-ResourceItem] e.target:",g.target),console.log("[Collections-ResourceItem] e.target.tagName:",g.target.tagName),console.log('[Collections-ResourceItem] e.target.closest("input"):',g.target.closest("input")),console.log('[Collections-ResourceItem] e.target.closest("a"):',g.target.closest("a")),console.log("[Collections-ResourceItem] Event bubbling up...")},children:e.jsxs(O,{gap:"400",align:"center",blockAlign:"center",wrap:!1,children:[e.jsxs(c,{style:{flex:"1 1 30%",minWidth:"200px"},children:[e.jsx(i,{variant:"bodyMd",fontWeight:"semibold",children:t.title}),e.jsxs(i,{variant:"bodySm",tone:"subdued",children:["Handle: ",t.handle]})]}),e.jsx(c,{style:{flex:"0 0 15%",minWidth:"100px",textAlign:"center"},children:e.jsxs(i,{variant:"bodyMd",children:[t.productsCount," products"]})}),e.jsx(c,{style:{flex:"0 0 25%",minWidth:"160px"},children:t.hasSeoData?e.jsx(O,{gap:"100",children:y.map(g=>e.jsx(ne,{tone:a.includes(g)?"success":"subdued",size:"small",children:g.toUpperCase()},g))}):e.jsx(ne,{tone:"subdued",children:"No AI Search Optimisation"})}),e.jsxs(c,{style:{flex:"0 0 15%",minWidth:"120px"},children:[s&&e.jsx(v,{size:"slim",onClick:()=>{ue(n),de(!0)},children:"Preview JSON"}),!s&&t.hasSeoData&&e.jsx(v,{size:"slim",loading:Qe,onClick:()=>et(t.id),children:"Preview JSON"})]})]})})},it=ae&&!x.processing&&e.jsx(f,{open:ae,title:"Processing Collections",onClose:()=>{},noScroll:!0,children:e.jsx(f.Section,{children:e.jsxs(b,{gap:"400",children:[e.jsx(i,{variant:"bodyMd",children:Se?`Processing: ${Se}`:"Preparing..."}),e.jsx(he,{progress:M.percent}),e.jsxs(i,{variant:"bodySm",tone:"subdued",children:[M.current," of ",M.total," collections (",M.percent,"%)"]})]})})}),ct=e.jsx(f,{open:_e,title:"Select Languages",primaryAction:{content:"Generate Optimization for AI Search",onAction:ot,disabled:E.length===0||ve},secondaryActions:[{content:"Cancel",onAction:()=>ce(!1)}],children:e.jsx(f.Section,{children:e.jsxs(b,{gap:"300",children:[e.jsxs(i,{variant:"bodyMd",children:["Select languages to generate AI Search Optimisation for ",C?"all":h.length," selected collections:"]}),ve&&e.jsx(Ct,{tone:"warning",title:"Language limit exceeded",children:e.jsxs(b,{gap:"200",children:[e.jsxs(i,{variant:"bodyMd",children:["Your ",R," plan supports up to ",k," language",k>1?"s":""," per collection.",h.length===1&&((De=(ke=(Me=p.find(t=>t.id===h[0]))==null?void 0:Me.optimizationSummary)==null?void 0:ke.optimizedLanguages)==null?void 0:De.length)>0&&e.jsxs(e.Fragment,{children:[" This collection already has ",p.find(t=>t.id===h[0]).optimizationSummary.optimizedLanguages.length," optimized language(s)."]})]}),e.jsx(i,{variant:"bodyMd",children:"Please deselect some languages or upgrade your plan to add more:"}),e.jsx(v,{variant:"primary",onClick:()=>{const t=new URLSearchParams(window.location.search),s=t.toString()?`?${t.toString()}`:"";window.location.href=`/billing${s}`},children:"Upgrade Plan"})]})}),e.jsx(c,{paddingBlockStart:"200",children:e.jsx(O,{gap:"200",wrap:!0,children:y.map(t=>e.jsx(Pe,{label:t.toUpperCase(),checked:E.includes(t),onChange:s=>{$(s?[...E,t]:E.filter(n=>n!==t))}},t))})}),e.jsx(c,{paddingBlockStart:"200",children:e.jsx(v,{plain:!0,onClick:()=>{E.length===y.length?$([]):y.length>k?($([...y]),S(`You selected ${y.length} languages. Your ${R} plan supports ${k}. Please deselect or upgrade.`)):$([...y])},children:E.length===y.length?"Deselect all":"Select all"})})]})})}),dt=e.jsx(f,{open:Ge&&!ae,title:"AI Search Optimisation Results",primaryAction:{content:"Apply Optimisation",onAction:lt,disabled:!Object.values(N).some(t=>t.success)},secondaryActions:[{content:"Cancel",onAction:()=>ie(!1)}],children:e.jsx(f.Section,{children:e.jsxs(b,{gap:"300",children:[e.jsxs(O,{gap:"400",children:[e.jsxs(c,{children:[e.jsx(i,{variant:"bodyMd",fontWeight:"semibold",children:"Successful:"}),e.jsx(i,{variant:"headingLg",fontWeight:"bold",tone:"success",children:Object.values(N).filter(t=>t.success&&!t.skipped).length})]}),e.jsxs(c,{children:[e.jsx(i,{variant:"bodyMd",fontWeight:"semibold",children:"Skipped:"}),e.jsx(i,{variant:"headingLg",fontWeight:"bold",tone:"info",children:Object.values(N).filter(t=>t.skipped).length})]}),e.jsxs(c,{children:[e.jsx(i,{variant:"bodyMd",fontWeight:"semibold",children:"Failed:"}),e.jsx(i,{variant:"headingLg",fontWeight:"bold",tone:"critical",children:Object.values(N).filter(t=>!t.success&&!t.skipped).length})]})]}),q.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(Et,{}),e.jsx(i,{variant:"bodyMd",fontWeight:"semibold",children:"Errors:"}),e.jsxs(c,{maxHeight:"200px",overflowY:"scroll",children:[q.slice(0,10).map((t,s)=>e.jsxs(i,{variant:"bodySm",tone:"critical",children:[t.collection,": ",t.error]},s)),q.length>10&&e.jsxs(i,{variant:"bodySm",tone:"subdued",children:["... and ",q.length-10," more errors"]})]})]})]})})}),ut=e.jsx(f,{open:Je,title:"SEO Data Preview",secondaryActions:[{content:"Close",onAction:()=>{de(!1),ue(null)}}],children:e.jsx(f.Section,{children:e.jsx(c,{children:e.jsx("pre",{style:{whiteSpace:"pre-wrap",wordBreak:"break-word",fontSize:"12px",backgroundColor:"#f6f6f7",padding:"12px",borderRadius:"4px",maxHeight:"400px",overflow:"auto"},children:Le?JSON.stringify(Le,null,2):""})})})}),gt=e.jsx(f,{open:Fe,title:"Delete Optimization for AI Search",onClose:()=>{X(!1),U([])},primaryAction:{content:"Continue",onAction:()=>{ee(z),X(!1),Z(!0)},disabled:z.length===0},secondaryActions:[{content:"Cancel",onAction:()=>{X(!1),U([])}}],children:e.jsx(f.Section,{children:e.jsxs(b,{gap:"400",children:[e.jsxs(i,{variant:"bodyMd",children:["Select languages to delete AI Search Optimisation from ",C?F:h.length," selected collections:"]}),e.jsx(c,{paddingBlockStart:"200",children:e.jsx(O,{gap:"400",wrap:!1,children:y.map(t=>e.jsxs("label",{style:{display:"flex",alignItems:"center",cursor:"pointer",userSelect:"none"},children:[e.jsx("input",{type:"checkbox",checked:z.includes(t),onChange:s=>{U(s.target.checked?[...z,t]:z.filter(n=>n!==t))},style:{marginRight:"8px",width:"18px",height:"18px",cursor:"pointer"}}),e.jsx(i,{variant:"bodyMd",children:t.toUpperCase()})]},t))})}),e.jsx(c,{children:e.jsx(v,{plain:!0,onClick:()=>{U(z.length===y.length?[]:[...y])},children:"Select all"})}),e.jsx(c,{paddingBlockStart:"300",children:e.jsx(i,{variant:"bodySm",children:"Warning: This will permanently delete AI Search Optimisation data for selected languages."})})]})})}),ht=e.jsx(f,{open:qe,title:"Confirm Deletion",onClose:()=>{Z(!1),ee([])},primaryAction:{content:"Delete",destructive:!0,onAction:async()=>{Z(!1),setTimeout(()=>{at(Ee)},100)}},secondaryActions:[{content:"Cancel",onAction:()=>{Z(!1),ee([]),U([])}}],children:e.jsx(f.Section,{children:e.jsxs(b,{gap:"400",children:[e.jsx(i,{variant:"bodyMd",children:"Are you sure you want to delete AI Search Optimisation for the following languages?"}),e.jsx(c,{paddingBlockStart:"200",children:e.jsx(O,{gap:"200",children:Ee.map(t=>e.jsx(ne,{tone:"warning",children:t.toUpperCase()},t))})}),e.jsxs(i,{variant:"bodyMd",children:["This will delete optimisation from ",C?F:h.length," selected collections."]}),e.jsx(c,{paddingBlockStart:"200",children:e.jsx(i,{variant:"bodySm",tone:"critical",children:"This action cannot be undone."})})]})})}),pt=je&&e.jsx(f,{open:je,title:"Deleting SEO Data",onClose:()=>{},noScroll:!0,children:e.jsx(f.Section,{children:e.jsxs(b,{gap:"400",children:[e.jsx(i,{variant:"bodyMd",children:"Deleting selected languages..."}),e.jsx(he,{progress:M.percent}),e.jsxs(i,{variant:"bodySm",tone:"subdued",children:[M.current," of ",M.total," operations (",M.percent,"%)"]})]})})}),ft=e.jsx(vt,{heading:"No collections found",action:{content:"Clear filters",onAction:()=>{oe(""),Q("all"),D()}},image:"https://cdn.shopify.com/s/files/1/0262/4071/2726/files/emptystate-files.png",children:e.jsx("p",{children:"Try adjusting your filters or search terms"})});return e.jsxs(e.Fragment,{children:[e.jsx(St,{globalPlan:j}),e.jsx(Ne,{children:e.jsxs(c,{padding:"400",children:[e.jsxs(O,{gap:"400",align:"space-between",blockAlign:"start",wrap:!1,children:[e.jsx(c,{minWidth:"400px",maxWidth:"600px",children:e.jsx(b,{gap:"200",children:e.jsx(yt,{label:"",placeholder:"Search by collection name...",value:T,onChange:oe,prefix:e.jsx(Lt,{}),clearButton:!0,onClearButtonClick:()=>oe("")})})}),e.jsxs(b,{gap:"200",children:[e.jsx(v,{primary:!0,onClick:tt,disabled:h.length===0&&!C,children:"Generate Optimization for AI Search"}),(()=>{if(h.length===0&&!C||!p.filter(a=>h.includes(a.id)).some(a=>{var r;return((r=a.optimizedLanguages)==null?void 0:r.length)>0}))return null;const n=["growth","growth_extra","growth extra","enterprise"].includes(R.toLowerCase().replace(/_/g," "));return e.jsx(v,{onClick:n?st:()=>{se({error:"AI Enhancement requires a higher plan",message:"Upgrade to Growth plan to access AI-enhanced optimization for Collections",minimumPlanRequired:"Growth"}),te(!0)},disabled:h.length===0&&!C,children:"AI Enhanced add-ons"})})(),e.jsx(v,{outline:!0,destructive:!0,onClick:()=>X(!0),disabled:h.length===0||!He,children:"Delete Optimization for AI Search"})]})]}),F>0&&e.jsx(c,{paddingBlockStart:"300",children:e.jsx(Pe,{label:`Select all ${F} collections`,checked:C,onChange:Ze})})]})}),e.jsx(c,{paddingBlockStart:"400",children:e.jsxs(Ne,{children:[e.jsxs(c,{padding:"400",borderBlockEndWidth:"025",borderColor:"border",children:[e.jsx(O,{gap:"200",wrap:!0,children:e.jsx(wt,{active:fe,activator:e.jsx(v,{disclosure:"down",onClick:()=>le(!fe),removeUnderline:!0,children:e.jsxs(O,{gap:"100",blockAlign:"center",children:[e.jsx("span",{children:"AI Search Status"}),I!=="all"&&e.jsx(c,{onClick:t=>{t.stopPropagation(),Q("all")},children:e.jsx(i,{as:"span",tone:"subdued",children:"âœ•"})})]})}),onClose:()=>le(!1),children:e.jsx(c,{padding:"300",minWidth:"200px",children:e.jsx(bt,{title:"AI Search Status",titleHidden:!0,choices:[{label:"All collections",value:"all"},{label:"Has AI Search Optimisation",value:"true"},{label:"No AI Search Optimisation",value:"false"}],selected:[I],onChange:t=>{Q(t[0]),le(!1)}})})})}),I!=="all"&&e.jsx(c,{paddingBlockStart:"200",children:e.jsx(O,{gap:"100",wrap:!0,children:e.jsx(ne,{onRemove:()=>Q("all"),children:I==="true"?"Has AI Search Optimisation":"No AI Search Optimisation"})})})]}),e.jsx(Ot,{resourceName:{singular:"collection",plural:"collections"},items:p,renderItem:rt,selectedItems:h,onSelectionChange:Xe,selectable:!0,loading:Be,totalItemsCount:F,emptyState:ft,showHeader:!1},`collections-${p.length}-${h.length}`)]})}),it,ct,dt,ut,gt,ht,pt,nt(),e.jsx(xt,{open:Ye,onClose:()=>te(!1),featureName:"Collections AI Enhancement",currentPlan:R,errorMessage:(m==null?void 0:m.error)||(m==null?void 0:m.message),minimumPlanRequired:m==null?void 0:m.minimumPlanRequired}),m&&e.jsx(jt,{open:Ve,onClose:()=>{Ae(!1),se(null)},tokensRequired:m.tokensRequired||0,tokensAvailable:m.tokensAvailable||0,tokensNeeded:m.tokensNeeded||0,feature:"ai-seo-collection",shop:u,needsUpgrade:m.needsUpgrade||!1,minimumPlan:m.minimumPlanForFeature||null,currentPlan:m.currentPlan||R}),be&&e.jsx(It,{content:be,onDismiss:()=>S("")})]})}export{Jt as default};
