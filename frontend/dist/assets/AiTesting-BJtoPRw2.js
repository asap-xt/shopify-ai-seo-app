import{r as e,j as s,R as t}from"./react-vendor-BXVC7v0l.js";import{m as n}from"./sessionFetch-C-eYScRM.js";import{I as i,T as a}from"./TrialActivationModal-BqLgil_q.js";import{T as r}from"./TokenPurchaseModal-Ctj1HM8l.js";import{A as o}from"./AIEOScoreCard-D2hU0Uip.js";import{g as l}from"./usePlanHierarchy-CpsbOjPs.js";import{a as c,d,T as h,L as u,C as g,B as p,I as x,b as j,e as m,f as b,D as v,h as y,l as S,M as f}from"./polaris-LiLfZG0r.js";import"./app-bridge-DUY42B6P.js";import"./vendor-Cs_VgJ2r.js";import"./index-BOgK4rt0.js";function w({shop:w}){const k=w||((e,s="")=>{try{return new URLSearchParams(window.location.search).get(e)||s}catch{return s}})("shop",""),[A,P]=e.useState(""),I=e.useMemo(()=>n(),[]),[T,C]=e.useState(null),[M,R]=e.useState(""),[D,O]=e.useState(!1),[q,J]=e.useState(null),[z,$]=e.useState(""),[U,F]=e.useState(!1),[E,L]=e.useState(!1),[W,B]=e.useState(!1),[G,N]=e.useState(!1),[H,V]=e.useState(null),[Y,Q]=e.useState(!1),[K,X]=e.useState(null),[Z,_]=e.useState({}),[ee,se]=e.useState(!1),[te,ne]=e.useState(0),[ie,ae]=e.useState({}),[re,oe]=e.useState(!1),[le,ce]=e.useState(0),[de,he]=e.useState(null),[ue,ge]=e.useState(null),[pe,xe]=e.useState(null),[je,me]=e.useState({totalProducts:0,optimizedProducts:0,totalCollections:0,optimizedCollections:0}),[be,ve]=e.useState(null),[ye,Se]=e.useState(null);e.useEffect(()=>{k&&(we(),ke(),Ae(),fe())},[k,I]);const fe=()=>{try{const e=localStorage.getItem(`ai-test-results-${k}`);if(e){const s=JSON.parse(e);s.results&&s.timestamp&&(_(s.results),ve(new Date(s.timestamp)))}const s=localStorage.getItem(`ai-validation-results-${k}`);if(s){const e=JSON.parse(s);e.results&&ae(e.results),e.timestamp&&Se(new Date(e.timestamp))}}catch(e){}};e.useEffect(()=>{const e=()=>{!document.hidden&&k&&ke()};return document.addEventListener("visibilitychange",e),()=>{document.removeEventListener("visibilitychange",e)}},[k,I]);const we=async()=>{var e,s,t;try{const n=await I(`/api/billing/info?shop=${k}`),i=(null==(e=null==n?void 0:n.subscription)?void 0:e.plan)||"Starter";C(i),he((null==(s=null==n?void 0:n.tokens)?void 0:s.balance)||0),ge((null==(t=null==n?void 0:n.subscription)?void 0:t.trialEndsAt)||null)}catch(n){C("Starter"),he(0)}},ke=async()=>{var e,s;try{const t=await I(`/api/billing/info?shop=${k}`);he((null==(e=null==t?void 0:t.tokens)?void 0:e.balance)||0),ge((null==(s=null==t?void 0:t.subscription)?void 0:s.trialEndsAt)||null)}catch(t){}},Ae=async()=>{var e,s,t,n;try{let a=null;try{const e=localStorage.getItem(`dashboard-stats-${k}`);if(e){const s=JSON.parse(e);(s.timestamp?Date.now()-new Date(s.timestamp).getTime():1/0)<3e5&&(a=s)}}catch(i){}if(!a){const r=await I(`/api/dashboard/stats?shop=${k}`);a={totalProducts:(null==(e=null==r?void 0:r.products)?void 0:e.total)||0,optimizedProducts:(null==(s=null==r?void 0:r.products)?void 0:s.optimized)||0,totalCollections:(null==(t=null==r?void 0:r.collections)?void 0:t.total)||0,optimizedCollections:(null==(n=null==r?void 0:r.collections)?void 0:n.optimized)||0,timestamp:(new Date).toISOString()};try{localStorage.setItem(`dashboard-stats-${k}`,JSON.stringify(a))}catch(i){}}me({totalProducts:a.totalProducts||0,optimizedProducts:a.optimizedProducts||0,totalCollections:a.totalCollections||0,optimizedCollections:a.optimizedCollections||0})}catch(i){}},Pe=e=>{if(!T)return!1;const s=l(T);switch(e){case"productsJson":case"meta":case"claude":return s>=0;case"storeMetadata":case"gemini":return s>=1;case"welcomePage":case"collectionsJson":case"chatgpt":return s>=2;case"aiSitemap":case"perplexity":return s>=3;case"schemaData":case"deepseek":return s>=4;default:return!1}},Ie=(e,s)=>{J({name:e,url:s}),O(!0)},Te=async(e,s=null)=>{try{R("Generating AI response...");let t=`/api/ai-discovery/simulate?shop=${k}&type=${e}`;s&&(t+=`&question=${encodeURIComponent(s)}`);const n=await I(t,{method:"GET"});R(n.response||"No response generated")}catch(t){if(402===t.status){if(t.trialRestriction&&t.requiresActivation)return V(t),B(!0),void R("");if(t.requiresUpgrade)return V(t),F(!0),void R("");if(t.requiresPurchase)return V(t),L(!0),void R("")}R("Error generating response. Please try again."),P("Failed to simulate AI response")}};return s.jsxs(s.Fragment,{children:[s.jsxs(c,{gap:"400",children:[s.jsx(d,{tone:"info",children:s.jsx(h,{children:"Test how AI models discover and understand your store content. Check if your structured data and AI Discovery features are working correctly."})}),s.jsx(o,{testResults:Z,aiTestResults:ie,stats:je}),s.jsxs(u,{children:[s.jsx(u.Section,{variant:"oneHalf",children:s.jsx(g,{children:s.jsx(p,{padding:"300",children:s.jsxs(c,{gap:"400",children:[s.jsxs(x,{align:"space-between",blockAlign:"center",children:[s.jsxs(c,{gap:"100",children:[s.jsx(h,{as:"h3",variant:"headingMd",children:"Basic AIEO Tests"}),s.jsx(h,{variant:"bodySm",tone:"subdued",children:"Quick check if endpoints are accessible and returning data"})]}),s.jsx(j,{onClick:async()=>{se(!0),ne(0),_({});try{const e=await I("/api/ai-testing/run-tests",{method:"POST",body:{shop:k}});e.results?(_(e.results),ne(100),(e=>{try{const s={results:e,timestamp:(new Date).toISOString()};localStorage.setItem(`ai-test-results-${k}`,JSON.stringify(s)),ve(new Date)}catch(s){}})(e.results),P("Basic tests completed!")):P("Testing failed. Please try again.")}catch(e){P("Failed to run tests. Please try again.")}finally{se(!1)}},loading:ee,disabled:ee,children:ee?"Testing...":"Run Basic Tests"})]}),be&&Object.keys(Z).length>0&&!ee&&s.jsx(d,{tone:"info",children:s.jsxs(h,{variant:"bodySm",children:["These results are from ",be.toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),". Run Basic Tests again to refresh."]})}),ee&&s.jsx(p,{children:s.jsxs(c,{gap:"200",children:[s.jsx(h,{variant:"bodySm",children:"Testing endpoints..."}),s.jsx(m,{progress:te,size:"small"})]})}),Object.keys(Z).length>0&&s.jsx(c,{gap:"300",children:Object.entries(Z).map(([e,n],i)=>{const a=i===Object.entries(Z).length-1;return s.jsxs(t.Fragment,{children:[s.jsx(x,{align:"space-between",blockAlign:"center",children:s.jsxs(c,{gap:"100",children:[s.jsxs(x,{gap:"200",blockAlign:"center",children:[s.jsx(h,{variant:"bodyMd",fontWeight:"semibold",children:n.name}),"success"===n.status&&s.jsx(b,{tone:"success",children:"OK"}),"fair"===n.status&&s.jsx(b,{tone:"info",children:"Fair"}),"poor"===n.status&&s.jsx(b,{tone:"warning",children:"Poor"}),"warning"===n.status&&s.jsx(b,{tone:"critical",children:"Warning"}),"error"===n.status&&s.jsx(b,{tone:"critical",children:"Failed"}),"locked"===n.status&&s.jsx(b,{children:"Locked"})]}),s.jsx(h,{variant:"bodySm",tone:"subdued",children:n.message}),n.actionLink&&s.jsx(j,{size:"slim",onClick:()=>(e=>{const s=new URLSearchParams(window.location.search),t=s.toString()?`?${s.toString()}`:"";window.location.href=`${e}${t}`})(n.actionLink),children:"basicSitemap"===e?"Go to Sitemap":"aiSitemap"===e?"Go to Settings":"Go"})]})}),!a&&s.jsx(v,{})]},e)})}),0===Object.keys(Z).length&&!ee&&s.jsx(d,{tone:"info",children:s.jsx(h,{children:'Click "Run Basic Tests" to check if your AI Discovery endpoints are configured correctly.'})})]})})})}),s.jsx(u.Section,{variant:"oneHalf",children:s.jsx(g,{children:s.jsx(p,{padding:"300",children:s.jsxs(c,{gap:"400",children:[s.jsxs(x,{align:"space-between",blockAlign:"center",children:[s.jsxs(c,{gap:"100",children:[s.jsx(x,{gap:"200",blockAlign:"center",children:s.jsx(h,{as:"h3",variant:"headingMd",children:"AI-Powered Validation"})}),s.jsx(h,{variant:"bodySm",tone:"subdued",children:"Deep analysis with AI bot"}),T&&s.jsx(h,{variant:"bodySm",tone:"subdued",children:"Requires: Professional+ plan & pay-per-use tokens"})]}),s.jsx(j,{onClick:async()=>{if(l(T)<1)return V({message:"AI-powered validation requires Professional plan or higher",requiredPlan:"Professional",currentPlan:T||"Starter"}),void F(!0);oe(!0),ce(0),ae({});try{const s=await I("/api/ai-testing/ai-validate",{method:"POST",body:{shop:k,endpointResults:Z}});if(s&&s.results){ae(s.results),ce(100);try{const e={results:s.results,timestamp:(new Date).toISOString()};localStorage.setItem(`ai-validation-results-${k}`,JSON.stringify(e)),Se(new Date)}catch(e){}if(s.aiEOScore){const e=s.aiEOScore;xe(e),P(`AI validation completed! Score: ${e.score||"N/A"}/100 (${s.tokensUsed||0} tokens used)`)}else xe(null),P(`AI validation completed! (${s.tokensUsed||0} tokens used)`);ke()}else xe(null),P("AI validation failed. Please try again.")}catch(s){if(402===s.status){if(s.trialRestriction&&s.requiresActivation)return V(s),void B(!0);if(s.requiresUpgrade)return V(s),void F(!0);if(s.requiresPurchase)return V(s),void L(!0)}P("Failed to run AI validation. Please try again.")}finally{oe(!1)}},loading:re,disabled:re||0===Object.keys(Z).length,variant:"primary",children:re?"Validating...":"Test with AI Bot"})]}),ye&&Object.keys(ie).length>0&&!re&&s.jsx(d,{tone:"info",children:s.jsxs(h,{variant:"bodySm",children:["These results are from ",ye.toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),". Test with AI Bot again to refresh."]})}),re&&s.jsx(p,{children:s.jsxs(c,{gap:"200",children:[s.jsx(h,{variant:"bodySm",children:"AI is analyzing your endpoints..."}),s.jsx(m,{progress:le,size:"small",tone:"primary"})]})}),Object.keys(ie).length>0&&s.jsxs(c,{gap:"300",children:[ie.productsJson&&s.jsxs(s.Fragment,{children:[s.jsx(x,{align:"space-between",blockAlign:"center",children:s.jsxs(c,{gap:"100",children:[s.jsxs(x,{gap:"200",blockAlign:"center",children:[s.jsx(h,{variant:"bodyMd",fontWeight:"semibold",children:"Products JSON Feed"}),"excellent"===ie.productsJson.rating&&s.jsx(b,{tone:"success",children:"Excellent"}),"good"===ie.productsJson.rating&&s.jsx(b,{tone:"success",children:"Good"}),"fair"===ie.productsJson.rating&&s.jsx(b,{tone:"warning",children:"Fair"}),"poor"===ie.productsJson.rating&&s.jsx(b,{tone:"critical",children:"Poor"}),"locked"===ie.productsJson.rating&&s.jsx(b,{children:"ðŸ”’ Locked"}),"unavailable"===ie.productsJson.rating&&s.jsx(b,{tone:"critical",children:"âŒ Unavailable"})]}),s.jsx(h,{variant:"bodySm",children:ie.productsJson.feedback}),ie.productsJson.suggestions&&s.jsxs(h,{variant:"bodySm",tone:"subdued",children:["ðŸ’¡ ",ie.productsJson.suggestions]})]})}),s.jsx(v,{})]}),ie.storeMetadata&&s.jsxs(s.Fragment,{children:[s.jsx(x,{align:"space-between",blockAlign:"center",children:s.jsxs(c,{gap:"100",children:[s.jsxs(x,{gap:"200",blockAlign:"center",children:[s.jsx(h,{variant:"bodyMd",fontWeight:"semibold",children:"Store Metadata"}),"excellent"===ie.storeMetadata.rating&&s.jsx(b,{tone:"success",children:"Excellent"}),"good"===ie.storeMetadata.rating&&s.jsx(b,{tone:"success",children:"Good"}),"fair"===ie.storeMetadata.rating&&s.jsx(b,{tone:"warning",children:"Fair"}),"poor"===ie.storeMetadata.rating&&s.jsx(b,{tone:"critical",children:"Poor"}),"locked"===ie.storeMetadata.rating&&s.jsx(b,{children:"ðŸ”’ Locked"}),"unavailable"===ie.storeMetadata.rating&&s.jsx(b,{tone:"critical",children:"âŒ Unavailable"})]}),s.jsx(h,{variant:"bodySm",children:ie.storeMetadata.feedback}),ie.storeMetadata.suggestions&&s.jsxs(h,{variant:"bodySm",tone:"subdued",children:["ðŸ’¡ ",ie.storeMetadata.suggestions]})]})}),s.jsx(v,{})]}),ie.welcomePage&&s.jsxs(s.Fragment,{children:[s.jsx(x,{align:"space-between",blockAlign:"center",children:s.jsxs(c,{gap:"100",children:[s.jsxs(x,{gap:"200",blockAlign:"center",children:[s.jsx(h,{variant:"bodyMd",fontWeight:"semibold",children:"AI Welcome Page"}),"excellent"===ie.welcomePage.rating&&s.jsx(b,{tone:"success",children:"Excellent"}),"good"===ie.welcomePage.rating&&s.jsx(b,{tone:"success",children:"Good"}),"fair"===ie.welcomePage.rating&&s.jsx(b,{tone:"warning",children:"Fair"}),"poor"===ie.welcomePage.rating&&s.jsx(b,{tone:"critical",children:"Poor"}),"locked"===ie.welcomePage.rating&&s.jsx(b,{children:"ðŸ”’ Locked"}),"unavailable"===ie.welcomePage.rating&&s.jsx(b,{tone:"critical",children:"âŒ Unavailable"})]}),s.jsx(h,{variant:"bodySm",children:ie.welcomePage.feedback}),ie.welcomePage.suggestions&&s.jsxs(h,{variant:"bodySm",tone:"subdued",children:["ðŸ’¡ ",ie.welcomePage.suggestions]})]})}),s.jsx(v,{})]}),ie.collectionsJson&&s.jsxs(s.Fragment,{children:[s.jsx(x,{align:"space-between",blockAlign:"center",children:s.jsxs(c,{gap:"100",children:[s.jsxs(x,{gap:"200",blockAlign:"center",children:[s.jsx(h,{variant:"bodyMd",fontWeight:"semibold",children:"Collections JSON Feed"}),"excellent"===ie.collectionsJson.rating&&s.jsx(b,{tone:"success",children:"Excellent"}),"good"===ie.collectionsJson.rating&&s.jsx(b,{tone:"success",children:"Good"}),"fair"===ie.collectionsJson.rating&&s.jsx(b,{tone:"warning",children:"Fair"}),"poor"===ie.collectionsJson.rating&&s.jsx(b,{tone:"critical",children:"Poor"}),"locked"===ie.collectionsJson.rating&&s.jsx(b,{children:"ðŸ”’ Locked"}),"unavailable"===ie.collectionsJson.rating&&s.jsx(b,{tone:"critical",children:"âŒ Unavailable"})]}),s.jsx(h,{variant:"bodySm",children:ie.collectionsJson.feedback}),ie.collectionsJson.suggestions&&s.jsxs(h,{variant:"bodySm",tone:"subdued",children:["ðŸ’¡ ",ie.collectionsJson.suggestions]})]})}),s.jsx(v,{})]}),ie.aiSitemap&&s.jsxs(s.Fragment,{children:[s.jsx(x,{align:"space-between",blockAlign:"center",children:s.jsxs(c,{gap:"100",children:[s.jsxs(x,{gap:"200",blockAlign:"center",children:[s.jsx(h,{variant:"bodyMd",fontWeight:"semibold",children:"AI-Enhanced Sitemap"}),"excellent"===ie.aiSitemap.rating&&s.jsx(b,{tone:"success",children:"Excellent"}),"good"===ie.aiSitemap.rating&&s.jsx(b,{tone:"success",children:"Good"}),"fair"===ie.aiSitemap.rating&&s.jsx(b,{tone:"warning",children:"Fair"}),"poor"===ie.aiSitemap.rating&&s.jsx(b,{tone:"critical",children:"Poor"}),"locked"===ie.aiSitemap.rating&&s.jsx(b,{children:"ðŸ”’ Locked"}),"unavailable"===ie.aiSitemap.rating&&s.jsx(b,{tone:"critical",children:"âŒ Unavailable"})]}),s.jsx(h,{variant:"bodySm",children:ie.aiSitemap.feedback}),ie.aiSitemap.suggestions&&s.jsxs(h,{variant:"bodySm",tone:"subdued",children:["ðŸ’¡ ",ie.aiSitemap.suggestions]})]})}),s.jsx(v,{})]}),ie.schemaData&&s.jsx(x,{align:"space-between",blockAlign:"center",children:s.jsxs(c,{gap:"100",children:[s.jsxs(x,{gap:"200",blockAlign:"center",children:[s.jsx(h,{variant:"bodyMd",fontWeight:"semibold",children:"Advanced Schema Data"}),"excellent"===ie.schemaData.rating&&s.jsx(b,{tone:"success",children:"Excellent"}),"good"===ie.schemaData.rating&&s.jsx(b,{tone:"success",children:"Good"}),"fair"===ie.schemaData.rating&&s.jsx(b,{tone:"warning",children:"Fair"}),"poor"===ie.schemaData.rating&&s.jsx(b,{tone:"critical",children:"Poor"}),"locked"===ie.schemaData.rating&&s.jsx(b,{children:"ðŸ”’ Locked"}),"unavailable"===ie.schemaData.rating&&s.jsx(b,{tone:"critical",children:"âŒ Unavailable"})]}),s.jsx(h,{variant:"bodySm",children:ie.schemaData.feedback}),ie.schemaData.suggestions&&s.jsxs(h,{variant:"bodySm",tone:"subdued",children:["ðŸ’¡ ",ie.schemaData.suggestions]})]})})]}),0===Object.keys(ie).length&&!re&&s.jsx(d,{tone:"info",children:s.jsx(h,{children:0===Object.keys(Z).length?"Run Basic Tests first, then use AI validation for deep analysis":'Click "Test with AI Bot" to get AI-powered feedback on your endpoint data quality'})}),!T&&s.jsx(d,{tone:"warning",children:s.jsx(h,{children:"Loading plan information..."})})]})})})})]}),s.jsx(g,{children:s.jsx(p,{padding:"300",children:s.jsxs(c,{gap:"400",children:[s.jsx(h,{as:"h3",variant:"headingMd",children:"Test with Real AI Bots"}),s.jsx(h,{variant:"bodyMd",tone:"subdued",children:"Manually test your store with real AI search engines"}),s.jsxs(c,{gap:"200",children:[s.jsxs(x,{align:"space-between",children:[s.jsx(h,{children:"Meta AI Search"}),Pe("meta")?s.jsx(j,{onClick:()=>Ie("Meta AI","https://www.meta.ai/"),size:"slim",children:"Test"}):s.jsx(j,{disabled:!0,size:"slim",children:"Plan upgrade required"})]}),s.jsxs(x,{align:"space-between",children:[s.jsx(h,{children:"Claude AI Search"}),Pe("claude")?s.jsx(j,{onClick:()=>Ie("Claude AI","https://claude.ai/"),size:"slim",children:"Test"}):s.jsx(j,{disabled:!0,size:"slim",children:"Plan upgrade required"})]}),s.jsxs(x,{align:"space-between",children:[s.jsx(h,{children:"Gemini AI Search"}),Pe("gemini")?s.jsx(j,{onClick:()=>Ie("Gemini AI","https://gemini.google.com/"),size:"slim",children:"Test"}):s.jsx(j,{disabled:!0,size:"slim",children:"Plan upgrade required"})]}),s.jsxs(x,{align:"space-between",children:[s.jsx(h,{children:"ChatGPT Web Search"}),Pe("chatgpt")?s.jsx(j,{url:`https://chat.openai.com/?q=What+products+does+${k}+sell%3F+Tell+me+about+this+business+and+what+they+offer`,external:!0,size:"slim",children:"Test"}):s.jsx(j,{disabled:!0,size:"slim",children:"Plan upgrade required"})]}),s.jsxs(x,{align:"space-between",children:[s.jsx(h,{children:"Perplexity AI Search"}),Pe("perplexity")?s.jsx(j,{url:`https://www.perplexity.ai/search?q=What+products+does+${k}+sell%3F+Tell+me+about+this+business+and+what+they+offer`,external:!0,size:"slim",children:"Test"}):s.jsx(j,{disabled:!0,size:"slim",children:"Plan upgrade required"})]}),s.jsxs(x,{align:"space-between",children:[s.jsx(h,{children:"DeepSeek AI Search"}),Pe("deepseek")?s.jsx(j,{onClick:()=>Ie("DeepSeek AI","https://chat.deepseek.com/"),size:"slim",children:"Test"}):s.jsx(j,{disabled:!0,size:"slim",children:"Plan upgrade required"})]})]}),s.jsx(d,{tone:"info",children:s.jsxs(h,{children:[s.jsx("strong",{children:"How to test with AI bots:"}),s.jsx("br",{}),"â€¢ ",s.jsx("strong",{children:"Perplexity & ChatGPT:"}),' Click "Test" - they support URL parameters',s.jsx("br",{}),"â€¢ ",s.jsx("strong",{children:"Meta AI, Claude, Gemini, DeepSeek:"}),' Click "Test" to open a modal with the prompt to copy']})})]})})}),s.jsx(g,{children:s.jsx(p,{padding:"300",children:s.jsxs(c,{gap:"300",children:[s.jsx(h,{as:"h4",variant:"headingSm",children:"AI Search Simulation"}),s.jsx(h,{variant:"bodyMd",tone:"subdued",children:"Test how AI bots would respond to questions about your store based on your structured data."}),s.jsx(d,{tone:"info",children:s.jsxs(c,{gap:"100",children:[s.jsx(h,{variant:"bodySm",fontWeight:"semibold",children:"Simulation Details:"}),s.jsxs(h,{variant:"bodySm",children:["â€¢ ",s.jsx("strong",{children:"Data Source:"})," Your store's products, collections, and metadata"]}),s.jsxs(h,{variant:"bodySm",children:["â€¢ ",s.jsx("strong",{children:"Response Style:"})," Concise (2-3 sentences), natural language"]}),s.jsxs(h,{variant:"bodySm",children:["â€¢ ",s.jsx("strong",{children:"Best For:"})," General store info, products, categories, contact details"]}),s.jsxs(h,{variant:"bodySm",children:["â€¢ ",s.jsx("strong",{children:"Limitations:"})," May not have real-time data (current stock, active promotions, exact shipping times)"]})]})}),s.jsxs(c,{gap:"200",children:[s.jsxs(x,{align:"space-between",children:[s.jsx(h,{children:"What products does this store sell?"}),s.jsx(j,{onClick:()=>Te("products"),size:"slim",children:"Simulate Response"})]}),s.jsxs(x,{align:"space-between",children:[s.jsx(h,{children:"Tell me about this business"}),s.jsx(j,{onClick:()=>Te("business"),size:"slim",children:"Simulate Response"})]}),s.jsxs(x,{align:"space-between",children:[s.jsx(h,{children:"What categories does this store have?"}),s.jsx(j,{onClick:()=>Te("categories"),size:"slim",children:"Simulate Response"})]}),s.jsxs(x,{align:"space-between",children:[s.jsx(h,{children:"What is this store's contact information?"}),s.jsx(j,{onClick:()=>Te("contact"),size:"slim",children:"Simulate Response"})]})]}),s.jsx(v,{}),s.jsxs(c,{gap:"200",children:[s.jsx(h,{variant:"headingSm",children:"Ask Your Own Question"}),s.jsx(y,{label:"",value:z,onChange:$,placeholder:"e.g., What are your return policies? Do you ship internationally?",autoComplete:"off",connectedRight:s.jsx(j,{onClick:()=>{z.trim()?Te("custom",z):P("Please enter a question")},disabled:!z.trim(),children:"Ask AI"})})]}),M&&s.jsxs(p,{background:"bg-surface-secondary",padding:"300",borderRadius:"200",children:[s.jsx(h,{variant:"bodyMd",fontWeight:"semibold",children:"AI Bot Response:"}),s.jsx(p,{paddingBlockStart:"200",children:s.jsx(h,{variant:"bodyMd",children:M})})]})]})})})]}),A&&s.jsx(S,{content:A,onDismiss:()=>P("")}),s.jsx(f,{open:D,onClose:()=>O(!1),title:`Test with ${null==q?void 0:q.name}`,primaryAction:{content:"Open AI Bot",url:null==q?void 0:q.url,external:!0},secondaryActions:[{content:"Copy Prompt",onAction:()=>{navigator.clipboard.writeText(`What products does ${k} sell? Tell me about this business and what they offer.`),P("Prompt copied to clipboard!")}}],children:s.jsx(f.Section,{children:s.jsxs(c,{gap:"300",children:[s.jsx(h,{variant:"bodyMd",children:'1. Click "Copy Prompt" (left button)'}),s.jsxs(h,{variant:"bodyMd",children:['2. Click "Open AI Bot" (right button) to visit ',null==q?void 0:q.name]}),s.jsx(h,{variant:"bodyMd",children:"3. Paste the prompt and send"}),s.jsxs(p,{background:"bg-surface-secondary",padding:"300",borderRadius:"200",children:[s.jsx(h,{variant:"bodyMd",fontWeight:"semibold",children:"Prompt to test:"}),s.jsx(p,{paddingBlockStart:"200",children:s.jsxs(h,{variant:"bodyMd",as:"p",children:["What products does ",k," sell? Tell me about this business and what they offer."]})})]}),s.jsx(d,{tone:"info",children:s.jsx(h,{children:"The AI bot will search the web and use your store's structured data to answer."})})]})})}),s.jsx(f,{open:Y,onClose:()=>Q(!1),title:"Upgrade Required",primaryAction:{content:"View Plans",onAction:()=>{const e=new URLSearchParams(window.location.search),s=e.toString()?`?${e.toString()}`:"";window.location.href=`/billing${s}`}},secondaryActions:[{content:"Cancel",onAction:()=>Q(!1)}],children:s.jsx(f.Section,{children:s.jsxs(c,{gap:"300",children:[s.jsxs(h,{variant:"bodyMd",children:[s.jsx("strong",{children:null==K?void 0:K.endpoint})," requires ",s.jsx("strong",{children:null==K?void 0:K.requiredPlan})," plan or higher."]}),s.jsxs(h,{variant:"bodyMd",tone:"subdued",children:["Your current plan: ",s.jsx("strong",{children:null==K?void 0:K.currentPlan})]}),s.jsx(d,{tone:"info",children:s.jsx(h,{children:"Upgrade to access this advanced AI Discovery feature."})})]})})}),s.jsx(f,{open:U,onClose:()=>F(!1),title:"Upgrade Required",primaryAction:{content:"View Plans",onAction:()=>{const e=new URLSearchParams(window.location.search),s=e.toString()?`?${e.toString()}`:"";window.location.href=`/billing${s}`}},secondaryActions:[{content:"Cancel",onAction:()=>F(!1)}],children:s.jsx(f.Section,{children:s.jsxs(c,{gap:"300",children:[s.jsxs(h,{variant:"bodyMd",children:["AI Testing requires ",s.jsx("strong",{children:(null==H?void 0:H.minimumPlan)||"Professional"})," plan or higher."]}),s.jsxs(h,{variant:"bodyMd",tone:"subdued",children:["Your current plan: ",s.jsx("strong",{children:(null==H?void 0:H.currentPlan)||"Starter"})]}),s.jsx(d,{tone:"info",children:s.jsx(h,{children:"Upgrade to test AI responses with real store data."})})]})})}),s.jsx(i,{open:E,onClose:()=>{L(!1),V(null),ke()},tokensRequired:(null==H?void 0:H.tokensRequired)||0,tokensAvailable:(null==H?void 0:H.tokensAvailable)||0,tokensNeeded:(null==H?void 0:H.tokensNeeded)||0,feature:"ai-testing-simulation",shop:k,needsUpgrade:!1,returnTo:"/ai-testing",onBuyTokens:()=>{L(!1),N(!0)}}),H&&s.jsx(a,{open:W,onClose:()=>{B(!1),V(null)},feature:H.feature||"ai-testing-simulation",trialEndsAt:H.trialEndsAt,currentPlan:H.currentPlan||T,tokensRequired:H.tokensRequired||0,onActivatePlan:async()=>{try{const e=await I("/api/billing/activate",{method:"POST",body:JSON.stringify({shop:k,endTrial:!0,returnTo:"/ai-testing"})});if(e.requiresApproval&&e.confirmationUrl)return void(window.top.location.href=e.confirmationUrl);window.location.reload()}catch(e){const s=new URLSearchParams(window.location.search),t=s.get("host"),n=s.get("embedded");window.location.href=`/billing?shop=${encodeURIComponent(k)}&embedded=${n}&host=${encodeURIComponent(t)}`}},onPurchaseTokens:()=>{B(!1),N(!0)}}),s.jsx(r,{open:G,onClose:()=>{N(!1),V(null),ke()},shop:k,returnTo:"/ai-testing",inTrial:!!(null==H?void 0:H.trialEndsAt)})]})}export{w as default};
