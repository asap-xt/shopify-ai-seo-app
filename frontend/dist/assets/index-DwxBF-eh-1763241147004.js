const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Dashboard-BlKrsUkm-1763241147004.js","assets/app-bridge-Bknpd1oi-1763241147004.js","assets/react-vendor-tAaa2TlE-1763241147004.js","assets/sessionFetch-CJepNHo3-1763241147004.js","assets/usePlanHierarchy-BjUEvxZF-1763241147004.js","assets/polaris-0FNxzh0C-1763241147004.js","assets/BulkEdit-B-aIwMGj-1763241147004.js","assets/useShopApi-Ct6WbE-x-1763241147004.js","assets/StoreMetadataBanner-Dnh6ZX-T-1763241147004.js","assets/InsufficientTokensModal-B1Ah9SKK-1763241147004.js","assets/TrialActivationModal-C4x3Sr9g-1763241147004.js","assets/Collections-CnXeMn6u-1763241147004.js","assets/Sitemap-YFh84shT-1763241147004.js","assets/StoreMetadata-B3jifOsP-1763241147004.js","assets/SchemaData-Jjm7mrWK-1763241147004.js","assets/Settings-DJccisfC-1763241147004.js","assets/AiTesting-BbZHleP2-1763241147004.js","assets/Billing-D3V6TUsU-1763241147004.js","assets/CleanUninstall-DX9r-T0Z-1763241147004.js","assets/ContactSupport-Db9IQ2HR-1763241147004.js"])))=>i.map(i=>d[i]);
import{j as e}from"./app-bridge-Bknpd1oi-1763241147004.js";import{a as q,r as u,R as g}from"./react-vendor-tAaa2TlE-1763241147004.js";import{B as A,I as U,T as y,C as z,A as T,F as R,P as N}from"./polaris-0FNxzh0C-1763241147004.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))l(o);new MutationObserver(o=>{for(const t of o)if(t.type==="childList")for(const r of t.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&l(r)}).observe(document,{childList:!0,subtree:!0});function a(o){const t={};return o.integrity&&(t.integrity=o.integrity),o.referrerPolicy&&(t.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?t.credentials="include":o.crossOrigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function l(o){if(o.ep)return;o.ep=!0;const t=a(o);fetch(o.href,t)}})();var G,O=q;G=O.createRoot,O.hydrateRoot;const H="modulepreload",J=function(n){return"/"+n},C={},p=function(s,a,l){let o=Promise.resolve();if(a&&a.length>0){document.getElementsByTagName("link");const r=document.querySelector("meta[property=csp-nonce]"),i=(r==null?void 0:r.nonce)||(r==null?void 0:r.getAttribute("nonce"));o=Promise.allSettled(a.map(c=>{if(c=J(c),c in C)return;C[c]=!0;const h=c.endsWith(".css"),_=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${_}`))return;const d=document.createElement("link");if(d.rel=h?"stylesheet":H,h||(d.as="script"),d.crossOrigin="",d.href=c,i&&d.setAttribute("nonce",i),document.head.appendChild(d),h)return new Promise((P,f)=>{d.addEventListener("load",P),d.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${c}`)))})}))}function t(r){const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=r,window.dispatchEvent(i),!i.defaultPrevented)throw r}return o.then(r=>{for(const i of r||[])i.status==="rejected"&&t(i.reason);return s().catch(t)})},Q=()=>{if(typeof window>"u"||!window.gtag){console.warn("[ANALYTICS] GA4 not loaded");return}console.log("[ANALYTICS] GA4 initialized")},X=()=>{if(typeof window>"u"||!window.fbq){console.warn("[ANALYTICS] Meta Pixel not loaded");return}console.log("[ANALYTICS] Meta Pixel initialized")},k=(n,s="")=>{if(typeof window>"u"||!window.gtag){console.warn("[ANALYTICS] GA4 not available, skipping page view:",n);return}try{window.gtag("event","page_view",{page_path:n,page_title:s||document.title,page_location:window.location.href}),console.log("[ANALYTICS] Page view tracked:",n)}catch(a){console.error("[ANALYTICS] Error tracking page view:",a)}};function Z({sectionTitle:n,lang:s,setLang:a,t:l}){return e.jsx(A,{padding:"400",borderBlockEndWidth:"025",borderColor:"border",background:"bg",children:e.jsx(U,{align:"space-between",blockAlign:"center",children:e.jsx(y,{as:"h1",variant:"headingLg",children:n})})})}const D="en",v={en:()=>p(()=>import("./en-DY--Skhq-1763241147004.js"),[]),de:()=>p(()=>import("./de-BYtsvH6H-1763241147004.js"),[]),es:()=>p(()=>import("./es-Cshzw9pa-1763241147004.js"),[]),fr:()=>p(()=>import("./fr-DGTXCiho-1763241147004.js"),[])},Y=Object.keys(v);function ee(){try{const n=localStorage.getItem("app_lang");return Y.includes(n)?n:null}catch{return null}}function te(n){try{localStorage.setItem("app_lang",n)}catch{}}function ne(){const[n,s]=u.useState(()=>ee()||D),[a,l]=u.useState({});u.useEffect(()=>{let t=!1;async function r(){const c=await(v[n]||v[D])();t||l(c.default||c)}return r(),te(n),()=>{t=!0}},[n]);const o=u.useMemo(()=>(t,r="")=>{const i=t==null?void 0:t.split(".").reduce((c,h)=>c&&c[h]!==void 0?c[h]:void 0,a);return i!=null?String(i):r||t},[a]);return{lang:n,setLang:s,t:o,dict:a,langs:Y}}const oe=g.lazy(()=>p(()=>import("./Dashboard-BlKrsUkm-1763241147004.js"),__vite__mapDeps([0,1,2,3,4,5]))),re=g.lazy(()=>p(()=>import("./BulkEdit-B-aIwMGj-1763241147004.js"),__vite__mapDeps([6,1,2,7,8,5,9,10]))),se=g.lazy(()=>p(()=>import("./Collections-CnXeMn6u-1763241147004.js"),__vite__mapDeps([11,1,2,3,8,5,9,10]))),ae=g.lazy(()=>p(()=>import("./Sitemap-YFh84shT-1763241147004.js"),__vite__mapDeps([12,1,2,3,5]))),ie=g.lazy(()=>p(()=>import("./StoreMetadata-B3jifOsP-1763241147004.js"),__vite__mapDeps([13,1,2,3,5]))),ce=g.lazy(()=>p(()=>import("./SchemaData-Jjm7mrWK-1763241147004.js"),__vite__mapDeps([14,1,2,3,4,5]))),le=g.lazy(()=>(console.log("[APP] ===== LOADING SETTINGS COMPONENT ====="),p(()=>import("./Settings-DJccisfC-1763241147004.js"),__vite__mapDeps([15,1,2,3,9,5,4])))),de=g.lazy(()=>p(()=>import("./AiTesting-BbZHleP2-1763241147004.js"),__vite__mapDeps([16,1,2,3,9,5,10,4]))),pe=g.lazy(()=>p(()=>import("./Billing-D3V6TUsU-1763241147004.js"),__vite__mapDeps([17,1,2,5]))),ue=g.lazy(()=>p(()=>import("./CleanUninstall-DX9r-T0Z-1763241147004.js"),__vite__mapDeps([18,1,2,3,5]))),he=g.lazy(()=>p(()=>import("./ContactSupport-Db9IQ2HR-1763241147004.js"),__vite__mapDeps([19,1,2,7,5]))),$={Polaris:{ResourceList:{sortingLabel:"Sort by"}}},V=(n,s="")=>{try{return new URLSearchParams(window.location.search).get(n)||s}catch{return s}};function ge(){const n=l=>l.replace(/^\/apps\/[^/]+/,"").replace(/^\/indexaize-unlock-ai-search/,"")||"/",[s,a]=u.useState(()=>n(window.location.pathname));return u.useEffect(()=>{const l=()=>{const r=n(window.location.pathname);console.log("[useRoute] Location changed to:",r),a(r),k(r)};window.addEventListener("popstate",l);let o=window.location.pathname;const t=setInterval(()=>{window.location.pathname!==o&&(o=window.location.pathname,l())},50);return()=>{window.removeEventListener("popstate",l),clearInterval(t)}},[]),u.useEffect(()=>{Q(),X(),k(s)},[]),{path:s}}function fe({active:n,shop:s}){n==="/"||n.startsWith("/dashboard"),n.startsWith("/ai-seo"),n.startsWith("/billing"),n.startsWith("/settings");const l=new URLSearchParams(window.location.search).get("host"),o=new URLSearchParams;s&&o.set("shop",s),l&&o.set("host",l);const t=o.toString()?`?${o.toString()}`:"";return e.jsxs("ui-nav-menu",{children:[e.jsx("a",{href:`/${t}`,rel:"home",children:"Home"}),e.jsx("a",{href:`/dashboard${t}`,children:"Dashboard"}),e.jsx("a",{href:`/ai-seo${t}`,children:"Search Optimization for AI"}),e.jsx("a",{href:`/settings${t}`,children:"Settings"}),e.jsx("a",{href:`/ai-testing${t}`,children:"AI Testing"}),e.jsx("a",{href:`/billing${t}`,children:"Plans & Billing"}),e.jsx("a",{href:`/clean-uninstall${t}`,children:"Clean & Uninstall"}),e.jsx("a",{href:`/contact-support${t}`,children:"Contact Support"})]})}const me=g.memo(({shop:n,plan:s})=>{const a=n||V("shop",""),l=window.location.pathname,t=(()=>{const i=l.replace(/^\/apps\/new-ai-seo/,"");return i==="/ai-seo"||i==="/ai-seo/products"?"products":i==="/ai-seo/collections"?"collections":i==="/ai-seo/sitemap"?"sitemap":i==="/ai-seo/store-metadata"?"store-metadata":i==="/ai-seo/schema-data"?"schema-data":"products"})(),r=i=>{const c=new URLSearchParams(window.location.search),h=c.toString()?`?${c.toString()}`:"";return i==="products"?`/ai-seo${h}`:`/ai-seo/${i}${h}`};return e.jsxs("div",{children:[e.jsx(A,{paddingBlockEnd:"400",children:e.jsx(z,{children:e.jsx(A,{padding:"200",children:e.jsxs(U,{gap:"100",children:[e.jsx("a",{href:r("products"),style:{padding:"8px 16px",borderRadius:"4px",backgroundColor:t==="products"?"#008060":"#f6f6f7",color:t==="products"?"white":"#202223",textDecoration:"none",display:"inline-block"},children:"Products"}),e.jsx("a",{href:r("collections"),style:{padding:"8px 16px",borderRadius:"4px",backgroundColor:t==="collections"?"#008060":"#f6f6f7",color:t==="collections"?"white":"#202223",textDecoration:"none",display:"inline-block"},children:"Collections"}),e.jsx("a",{href:r("sitemap"),style:{padding:"8px 16px",borderRadius:"4px",backgroundColor:t==="sitemap"?"#008060":"#f6f6f7",color:t==="sitemap"?"white":"#202223",textDecoration:"none",display:"inline-block"},children:"Sitemap"}),e.jsx("a",{href:r("store-metadata"),style:{padding:"8px 16px",borderRadius:"4px",backgroundColor:t==="store-metadata"?"#008060":"#f6f6f7",color:t==="store-metadata"?"white":"#202223",textDecoration:"none",display:"inline-block"},children:"Store metadata"}),e.jsx("a",{href:r("schema-data"),style:{padding:"8px 16px",borderRadius:"4px",backgroundColor:t==="schema-data"?"#008060":"#f6f6f7",color:t==="schema-data"?"white":"#202223",textDecoration:"none",display:"inline-block"},children:"Schema Data"})]})})})}),e.jsxs("div",{children:[t==="products"&&e.jsx(re,{shop:a,globalPlan:s}),t==="collections"&&e.jsx(se,{shop:a,globalPlan:s}),t==="sitemap"&&e.jsx(ae,{shop:a}),t==="store-metadata"&&e.jsx(ie,{shop:a}),t==="schema-data"&&e.jsx(ce,{shop:a})]})]})});function _e(){const{path:n}=ge(),{lang:s,setLang:a,t:l}=ne(),o=!!new URLSearchParams(window.location.search).get("host"),t=V("shop",""),[r,i]=u.useState(()=>{try{const _=sessionStorage.getItem(`plan_${t}`);if(_){const d=JSON.parse(_);return!d||typeof d.language_limit>"u"?(sessionStorage.removeItem(`plan_${t}`),null):d}return null}catch{return null}});u.useEffect(()=>{const _=async()=>{const P=new URLSearchParams(window.location.search),f=P.get("shop"),S=P.get("id_token");if(f&&S)try{console.log("[APP] Performing initial token exchange for shop:",f);const m=await fetch("/token-exchange",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({shop:f,id_token:S})});if(!m.ok){const j=await m.json();console.error("[APP] Token exchange failed:",j);return}const I=await m.json();console.log("[APP] Token exchange successful:",I);const w=new URL(window.location);w.searchParams.delete("id_token"),window.history.replaceState({},"",w),await d(f)}catch(m){console.error("[APP] Token exchange error:",m)}else f&&await d(f)},d=async P=>{var f;try{const m=await fetch("/graphql",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:`
          query PlansMe($shop:String!) {
            plansMe(shop:$shop) {
              shop
              plan
              planKey
              priceUsd
              product_limit
              language_limit
              collection_limit
              providersAllowed
              modelsSuggested
              subscriptionStatus
              trial {
                active
                ends_at
                days_left
              }
            }
          }
        `,variables:{shop:P}})});if(m.status===202&&(await m.json()).error==="token_exchange_required"){console.log("[APP] Token exchange required, but no id_token available"),window.location.href=`/auth?shop=${encodeURIComponent(P)}`;return}if(!m.ok){console.error("[APP] Failed to load plans:",await m.text());return}const I=await m.json(),w=(f=I==null?void 0:I.data)==null?void 0:f.plansMe;if(w){i(w);try{sessionStorage.setItem(`plan_${P}`,JSON.stringify(w))}catch(E){console.error("[APP] Failed to cache plan:",E)}const B=window.location.pathname.includes("/billing");if((w.subscriptionStatus==="pending"||!w.plan)&&!B){console.log("[APP] No active subscription, redirecting to billing...");try{localStorage.removeItem(`onboardingOpen_${P}`)}catch(K){console.error("[APP] Failed to clear onboarding state:",K)}const E=new URLSearchParams(window.location.search),F=E.get("host"),W=E.get("embedded");window.location.href=`/billing?shop=${encodeURIComponent(P)}&embedded=${W}&host=${encodeURIComponent(F)}`;return}}}catch(S){console.error("[APP] Error loading initial data:",S)}};_()},[]);const c=u.useMemo(()=>n.startsWith("/ai-seo")?"Search Optimization for AI":n.startsWith("/billing")?"Plans & Billing":n.startsWith("/settings")?"Settings":n.startsWith("/ai-testing")?"AI Testing":n.startsWith("/clean-uninstall")?"Clean & Uninstall":n.startsWith("/contact-support")?"Contact Support":"Dashboard",[n]),h=()=>{const _=n.replace(/^\/apps\/new-ai-seo/,"");return _==="/"||_==="/dashboard"?e.jsx(oe,{shop:t}):_.startsWith("/ai-seo")?e.jsx(me,{shop:t,plan:r}):n==="/billing"?e.jsx(pe,{shop:t}):n==="/settings"?(console.log("[APP] ===== RENDERING SETTINGS PAGE ====="),e.jsx(le,{shop:t})):n==="/contact-support"?(console.log("[APP] ===== RENDERING CONTACT SUPPORT PAGE ====="),e.jsx(he,{shop:t})):n==="/ai-testing"?(console.log("[APP] ===== RENDERING AI TESTING PAGE ====="),console.log("[APP] Path:",n),console.log("[APP] Shop:",t),e.jsx(de,{shop:t})):n==="/clean-uninstall"?e.jsx(ue,{shop:t}):e.jsx(z,{children:e.jsxs(A,{padding:"400",children:[e.jsx(y,{variant:"headingMd",children:"Page not found"}),e.jsx(A,{paddingBlockStart:"200",children:e.jsxs(y,{children:['The page "',n,'" does not exist.']})})]})})};return r?e.jsxs(T,{i18n:$,children:[o&&e.jsx(fe,{active:n,shop:t}),e.jsx(R,{children:e.jsxs(N,{children:[e.jsx(Z,{sectionTitle:c,lang:s,setLang:a,t:l,shop:t}),h()]})})]}):e.jsx(T,{i18n:$,children:e.jsx(R,{children:e.jsx(N,{children:e.jsx(A,{padding:"400",children:e.jsx(y,{children:"Loading..."})})})})})}const L=new URLSearchParams(window.location.search),b=L.get("host"),x=L.get("shop"),M=L.get("embedded")==="1";console.log("[MAIN] Public App - Host:",b,"Shop:",x);console.log("[MAIN] Full URL:",window.location.href);function Pe(){const[n,s]=u.useState(!1),a=u.useMemo(()=>(console.log("[MAIN] Checking for API key..."),console.log("[MAIN] window.__SHOPIFY_API_KEY:",window.__SHOPIFY_API_KEY),console.log("[MAIN] import.meta.env.VITE_SHOPIFY_API_KEY:","2749a2f6d38ff5796ed256b5c9dc70a1"),window.__SHOPIFY_API_KEY?(console.log("[MAIN] Using injected API key:",window.__SHOPIFY_API_KEY),window.__SHOPIFY_API_KEY):(console.log("[MAIN] Using env API key:","2749a2f6d38ff5796ed256b5c9dc70a1"),"2749a2f6d38ff5796ed256b5c9dc70a1")),[]);return u.useEffect(()=>{setTimeout(()=>s(!0),100)},[]),!M||!b||!x?(console.log("[MAIN] Not embedded or missing params"),e.jsxs("div",{style:{padding:"20px",textAlign:"center"},children:[e.jsx("h1",{children:"Error: App must be loaded from Shopify Admin"}),e.jsxs("p",{children:["Shop: ",x||"Missing"]}),e.jsxs("p",{children:["Host: ",b||"Missing"]}),e.jsxs("p",{children:["Embedded: ",M?"Yes":"No"]}),e.jsx("a",{href:`https://admin.shopify.com/store/${x==null?void 0:x.replace(".myshopify.com","")}/apps`,children:"Go to Shopify Admin"})]})):a?(console.log("[MAIN] App config:",{apiKey:a?"SET":"MISSING",host:b?"SET":"MISSING",shop:x?"SET":"MISSING"}),n?e.jsx(_e,{}):e.jsx("div",{children:"Loading..."})):e.jsxs("div",{style:{padding:"20px",textAlign:"center"},children:[e.jsx("h1",{children:"Configuration Error"}),e.jsx("p",{children:"Shopify API key is not configured."}),e.jsx("p",{children:"Please contact support."})]})}G(document.getElementById("root")).render(e.jsx(Pe,{}));
