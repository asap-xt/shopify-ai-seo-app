import{j as e}from"./app-bridge-PqETjswS-1758880112043.js";import{r as o}from"./react-vendor-tAaa2TlE-1758880112043.js";import{m as C}from"./sessionFetch-DO-7bLHn-1758880112043.js";import{C as E,a as r,d as c,h as M,I as i,T as t,B as y,n as l,o as u,p as W,q as P,k as G}from"./polaris-8g_dX1fR-1758880112043.js";const R=(j,n="")=>{try{return new URLSearchParams(window.location.search).get(j)||n}catch{return n}};function _({shop:j}){const n=j||R("shop",""),[a,v]=o.useState(null),[m,b]=o.useState(!1),[f,h]=o.useState(""),[s,A]=o.useState(null),x=o.useMemo(()=>C(),[]),p=o.useCallback(async()=>{if(n)try{const d=await x("/api/sitemap/info",{shop:n});v(d)}catch(d){h(d.message||"Failed to load sitemap info")}},[n,x]),k=o.useCallback(async()=>{if(n)try{const d=await x("/plans/me",{shop:n});A(d||null)}catch{}},[n,x]),I=o.useCallback(async()=>{var d,S,w;if(n){b(!0);try{const g=await fetch(`/api/sitemap/generate?shop=${encodeURIComponent(n)}`,{method:"POST",credentials:"include",headers:{Authorization:`Bearer ${((w=(S=(d=window.__SHOPIFY_APP_BRIDGE__)==null?void 0:d.getState())==null?void 0:S.session)==null?void 0:w.token)||""}`}});if(g.ok)h("Sitemap generated successfully!"),await p();else{const B=await g.text();h(`Sitemap generation failed: ${B}`)}}catch(g){h(g.message||"Sitemap generation failed")}finally{b(!1)}}},[n,p]);return o.useEffect(()=>{p(),k()},[p,k]),e.jsxs(E,{children:[e.jsx(r,{padding:"400",children:e.jsxs(c,{gap:"400",children:[e.jsx(M,{tone:"info",children:e.jsxs("p",{children:["Your ",(s==null?void 0:s.plan)||"Starter"," plan includes up to"," ",e.jsx("strong",{children:(s==null?void 0:s.plan)==="Starter"?100:(s==null?void 0:s.plan)==="Professional"?350:(s==null?void 0:s.plan)==="Growth"?1e3:(s==null?void 0:s.plan)==="Growth Extra"?2500:(s==null?void 0:s.plan)==="Enterprise"?6e3:100})," ","URLs in the sitemap.",(a==null?void 0:a.productCount)&&a.productCount>((s==null?void 0:s.plan)==="Starter"?100:(s==null?void 0:s.plan)==="Professional"?350:(s==null?void 0:s.plan)==="Growth"?1e3:(s==null?void 0:s.plan)==="Growth Extra"?2500:(s==null?void 0:s.plan)==="Enterprise"?6e3:100)&&e.jsxs(e.Fragment,{children:[" You have ",a.productCount," products, so only the first"," ",(s==null?void 0:s.plan)==="Starter"?100:(s==null?void 0:s.plan)==="Professional"?350:(s==null?void 0:s.plan)==="Growth"?1e3:(s==null?void 0:s.plan)==="Growth Extra"?2500:(s==null?void 0:s.plan)==="Enterprise"?6e3:100," will be included."]})]})}),e.jsxs(i,{align:"space-between",blockAlign:"center",children:[e.jsxs(r,{children:[e.jsx(t,{variant:"headingMd",as:"h3",children:"Sitemap Generator"}),e.jsx(t,{variant:"bodySm",tone:"subdued",children:"Generate structured sitemap for AI models to discover and index your products"})]}),e.jsx(y,{primary:!0,onClick:I,loading:m,disabled:m,children:m?"Generating...":"Generate Sitemap"})]}),a&&e.jsx(r,{background:"bg-surface-secondary",padding:"400",borderRadius:"200",children:e.jsxs(c,{gap:"300",children:[e.jsx(i,{gap:"200",blockAlign:"center",children:a.generated?e.jsxs(e.Fragment,{children:[e.jsx(l,{source:u,tone:"success"}),e.jsx(t,{variant:"bodyMd",fontWeight:"semibold",tone:"success",children:"Sitemap Active"})]}):e.jsxs(e.Fragment,{children:[e.jsx(l,{source:W}),e.jsx(t,{variant:"bodyMd",fontWeight:"semibold",children:"No Sitemap Found"})]})}),a.generated&&e.jsxs(c,{gap:"400",children:[e.jsx(r,{children:e.jsxs(c,{gap:"200",children:[e.jsx(r,{paddingBlockEnd:"200",borderBlockEndWidth:"025",borderColor:"border-subdued",children:e.jsxs(i,{align:"space-between",children:[e.jsx(t,{variant:"bodyMd",color:"subdued",children:"Products included"}),e.jsxs(t,{variant:"bodyMd",fontWeight:"semibold",children:[a.lastProductCount||0," URLs"]})]})}),e.jsx(r,{paddingBlockEnd:"200",borderBlockEndWidth:"025",borderColor:"border-subdued",children:e.jsxs(i,{align:"space-between",children:[e.jsx(t,{variant:"bodyMd",color:"subdued",children:"File size"}),e.jsx(t,{variant:"bodyMd",fontWeight:"semibold",children:a.size?`${(a.size/1024).toFixed(2)} KB`:"Unknown"})]})}),e.jsx(r,{paddingBlockEnd:"200",borderBlockEndWidth:"025",borderColor:"border-subdued",children:e.jsxs(i,{align:"space-between",children:[e.jsx(t,{variant:"bodyMd",color:"subdued",children:"Last updated"}),e.jsx(t,{variant:"bodyMd",fontWeight:"semibold",children:a.generatedAt?new Date(a.generatedAt).toLocaleString():"Unknown"})]})}),e.jsx(r,{paddingBlockEnd:"200",children:e.jsxs(i,{align:"space-between",children:[e.jsx(t,{variant:"bodyMd",color:"subdued",children:"Sitemap URL"}),e.jsxs(t,{variant:"bodyMd",fontWeight:"semibold",breakWord:!0,children:["/api/sitemap/generate?shop=",n]})]})})]})}),e.jsx(r,{children:e.jsx(y,{fullWidth:!0,external:!0,url:`/api/sitemap/generate?shop=${encodeURIComponent(n)}`,icon:P,children:"View Sitemap"})})]})]})}),e.jsxs(r,{paddingBlockStart:"400",children:[e.jsx(t,{variant:"headingMd",as:"h4",children:"What's included:"}),e.jsx(r,{paddingBlockStart:"200",children:e.jsxs(c,{gap:"200",children:[e.jsxs(i,{gap:"200",blockAlign:"start",children:[e.jsx(r,{minWidth:"24px",children:e.jsx(l,{source:u,tone:"positive"})}),e.jsx(t,{children:"All active products with structured URLs for AI parsing"})]}),e.jsxs(i,{gap:"200",blockAlign:"start",children:[e.jsx(r,{minWidth:"24px",children:e.jsx(l,{source:u,tone:"positive"})}),e.jsx(t,{children:"Priority rankings to help AI models understand product importance"})]}),e.jsxs(i,{gap:"200",blockAlign:"start",children:[e.jsx(r,{minWidth:"24px",children:e.jsx(l,{source:u,tone:"positive"})}),e.jsx(t,{children:"Multi-language URLs for international AI search coverage"})]}),e.jsxs(i,{gap:"200",blockAlign:"start",children:[e.jsx(r,{minWidth:"24px",children:e.jsx(l,{source:u,tone:"positive"})}),e.jsx(t,{children:"Standard XML format that AI crawlers understand"})]})]})})]}),e.jsxs(r,{paddingBlockStart:"200",children:[e.jsx(t,{variant:"headingMd",as:"h4",children:"How it helps AI models:"}),e.jsx(r,{paddingBlockStart:"200",children:e.jsxs(c,{gap:"200",children:[e.jsx(t,{children:'1. Click "Generate Sitemap" to create a structured map of your products'}),e.jsx(t,{children:"2. The sitemap is automatically saved and available to AI crawlers"}),e.jsx(t,{children:"3. AI models can discover and understand your product catalog structure"}),e.jsx(t,{children:"4. Regenerate when you add new products to keep AI models updated"})]})})]})]})}),f&&e.jsx(G,{content:f,onDismiss:()=>h("")})]})}export{_ as default};
