import{r as e,j as t}from"./react-vendor-BXVC7v0l.js";import{m as s}from"./sessionFetch-CeBL7Ait.js";import{I as a,T as n,a as r}from"./TokenPurchaseModal-DozAvzCY.js";import{g as i}from"./usePlanHierarchy-fXt-6sDq.js";import{C as o,B as l,T as c,I as d,i as u,a as h,f as p,d as m,D as g,g as x,b as f,u as v,M as b,l as y}from"./polaris-CyaoFo5Q.js";import"./app-bridge-DUY42B6P.js";import"./vendor-Cs_VgJ2r.js";import"./index-ByiDf9QT.js";function j(){const j=e=>(e||"starter").toLowerCase().replace(" ","_"),S=((e,t="")=>{try{return new URLSearchParams(window.location.search).get(e)||t}catch{return t}})("shop",""),[w,A]=e.useState(!0),[k,P]=e.useState(!1),[I,C]=e.useState(null),[T,E]=e.useState(""),[O,D]=e.useState(!1),[$,M]=e.useState(""),[R,_]=e.useState(null),[z,G]=e.useState(null),[q,N]=e.useState(!1),[B,U]=e.useState(!1),[F,L]=e.useState(!1),[J,W]=e.useState(!1),[Y,Q]=e.useState(!1),[H,V]=e.useState(!1),[Z,K]=e.useState(!1),[X,ee]=e.useState(!1),[te,se]=e.useState(!1),[ae,ne]=e.useState(!1),[re,ie]=e.useState(""),[oe,le]=e.useState(null),[ce,de]=e.useState(null),[ue,he]=e.useState(!1),[pe,me]=e.useState(null),[ge,xe]=e.useState(!1),[fe,ve]=e.useState(!1),[be,ye]=e.useState(!1),[je,Se]=e.useState(!1),[we,Ae]=e.useState({feature:"",tokensRequired:0,tokensAvailable:0,tokensNeeded:0}),[ke,Pe]=e.useState(null),[Ie,Ce]=e.useState(!1),[Te,Ee]=e.useState(""),[Oe,De]=e.useState({enabled:!1,generating:!1,generated:!1,progress:""}),[$e,Me]=e.useState(!1),[Re,_e]=e.useState(null),[ze,Ge]=e.useState({inProgress:!1,status:"idle",message:null,position:null,estimatedTime:null,generatedAt:null,productCount:0}),[qe,Ne]=e.useState(null),[Be,Ue]=e.useState({inProgress:!1,status:"idle",message:null,position:null,estimatedTime:null,generatedAt:null,schemaCount:0}),[Fe,Le]=e.useState(null),[Je,We]=e.useState(!1),[Ye,Qe]=e.useState(!1),[He,Ve]=e.useState({current:0,total:0,percent:0,currentProduct:"",stats:{siteFAQ:!1,products:0,totalSchemas:0}}),Ze=e.useMemo(()=>s(),[]);e.useEffect(()=>{if($){R&&clearTimeout(R);const e=setTimeout(()=>{M("")},5e3);_(e)}},[$]);const Ke=e.useCallback(async()=>{var e,t,s,a,n;try{const r=await Ze(`/api/sitemap/status?shop=${S}`);return Ge({inProgress:r.inProgress||!1,status:r.status||"idle",message:r.message||null,position:(null==(e=r.queue)?void 0:e.position)||null,estimatedTime:(null==(t=r.queue)?void 0:t.estimatedTime)||null,generatedAt:(null==(s=r.sitemap)?void 0:s.generatedAt)||null,productCount:(null==(a=r.sitemap)?void 0:a.productCount)||0}),"completed"!==r.status||r.inProgress||(Q(!0),qe&&(clearInterval(qe),Ne(null)),ze.inProgress&&(M(`AI-Optimized Sitemap generated successfully! (${(null==(n=r.sitemap)?void 0:n.productCount)||0} products)`),C(e=>({...e,features:{...e.features,aiSitemap:!1}})))),"failed"===r.status&&(qe&&(clearInterval(qe),Ne(null)),M("AI-Optimized Sitemap generation failed. Please try again.")),r}catch(r){}},[S,Ze,qe,ze.inProgress]),Xe=e.useCallback(()=>{qe&&clearInterval(qe),Ke();const e=setInterval(()=>{Ke()},1e4);Ne(e)},[Ke,qe]);e.useEffect(()=>()=>{qe&&clearInterval(qe)},[qe]);const et=e.useCallback(async()=>{var e,t,s,a,n,r,i,o,l;try{const c=await Ze(`/api/schema/status?shop=${S}`);if(Ue({inProgress:c.inProgress||!1,status:c.status||"idle",message:c.message||null,position:(null==(e=c.queue)?void 0:e.position)||null,estimatedTime:(null==(t=c.queue)?void 0:t.estimatedTime)||null,generatedAt:(null==(s=c.schema)?void 0:s.generatedAt)||null,schemaCount:(null==(a=c.schema)?void 0:a.schemaCount)||0}),"completed"!==c.status||c.inProgress||(Fe&&(clearInterval(Fe),Le(null)),C(e=>({...e,features:{...e.features,schemaData:!1}})),Be.inProgress&&M(`Advanced Schema Data generated successfully! (${(null==(n=c.schema)?void 0:n.schemaCount)||0} schemas)`)),"failed"===c.status){const e=(null==(r=c.shopStatus)?void 0:r.failedAt)?new Date(c.shopStatus.failedAt):null,t=(null==(i=c.schema)?void 0:i.generatedAt)?new Date(c.schema.generatedAt):null;if((null==(o=c.schema)?void 0:o.exists)&&t&&e&&t>e)return Fe&&(clearInterval(Fe),Le(null)),C(e=>({...e,features:{...e.features,schemaData:!1}})),Be.inProgress&&M(`Advanced Schema Data generated successfully! (${(null==(l=c.schema)?void 0:l.schemaCount)||0} schemas)`),c;Fe&&(clearInterval(Fe),Le(null)),"NO_OPTIMIZED_PRODUCTS"===c.message?(_e("NO_OPTIMIZED_PRODUCTS"),Me(!0)):"ONLY_BASIC_SEO"===c.message?(_e("ONLY_BASIC_SEO"),Me(!0)):M(`Advanced Schema Data generation failed: ${c.message||"Unknown error"}`)}return c}catch(c){}},[S,Ze,Fe,Be.inProgress]),tt=e.useCallback(()=>{Fe&&clearInterval(Fe),et();const e=setInterval(()=>{et()},1e4);Le(e)},[et,Fe]);e.useEffect(()=>()=>{Fe&&clearInterval(Fe)},[Fe]),e.useEffect(()=>{S&&!qe&&Ke().then(e=>{(null==e?void 0:e.inProgress)&&Xe()})},[S]),e.useEffect(()=>{S&&!Fe&&et().then(e=>{(null==e?void 0:e.inProgress)&&tt()})},[S]);const st=e.useCallback(async()=>{var e;try{const t=await Ze(`/api/products/list?shop=${S}&limit=10&optimized=true`);return null==(e=null==t?void 0:t.products)?void 0:e.some(e=>{var t,s;return(null==(s=null==(t=null==e?void 0:e.optimizationSummary)?void 0:t.optimizedLanguages)?void 0:s.length)>0})}catch(t){return!1}},[S,Ze]),at=e.useCallback(async()=>{var e;try{const t=await Ze(`/collections/list-graphql?shop=${S}`);return null==(e=null==t?void 0:t.collections)?void 0:e.some(e=>{var t;return(null==(t=null==e?void 0:e.optimizedLanguages)?void 0:t.length)>0})}catch(t){return!1}},[S,Ze]),nt=e.useCallback(async()=>{var e,t;try{const s="\n        query CheckStoreMetadata($shop: String!) {\n          storeMetadata(shop: $shop) {\n            shopName\n            description\n          }\n        }\n      ",a=await Ze("/graphql",{method:"POST",body:JSON.stringify({query:s,variables:{shop:S}}),shop:S});return!!(null==(t=null==(e=null==a?void 0:a.data)?void 0:e.storeMetadata)?void 0:t.shopName)}catch(s){return!1}},[S,Ze]),rt=e.useCallback(async()=>{var e,t,s;try{const a=await fetch(`/ai/welcome?shop=${S}`,{method:"GET",credentials:"include",headers:{Authorization:`Bearer ${(null==(s=null==(t=null==(e=window.__SHOPIFY_APP_BRIDGE__)?void 0:e.getState())?void 0:t.session)?void 0:s.token)||""}`}});if(a.ok){const e=await a.text();return e.includes("<!DOCTYPE html>")||e.includes("<!doctype html>")}return!1}catch(a){return!1}},[S]),it=e.useCallback(async()=>{var e,t,s,a;try{if(null==(e=null==I?void 0:I.features)?void 0:e.productsJson){const e=await st();U(e)}if(null==(t=null==I?void 0:I.features)?void 0:t.collectionsJson){const e=await at();L(e)}if(null==(s=null==I?void 0:I.features)?void 0:s.storeMetadata){const e=await nt();W(e)}if(null==(a=null==I?void 0:I.features)?void 0:a.welcomePage){const e=await rt();V(e)}else V(!1)}catch(n){}},[null==I?void 0:I.features,st,at,nt,rt]);e.useEffect(()=>{},[null==I?void 0:I.features,st,at,nt,rt]),e.useEffect(()=>{S?ut():A(!1)},[S,Ze]),e.useEffect(()=>{ge&&ot()},[ge]),e.useEffect(()=>{},[null==I?void 0:I.features]);const ot=async()=>{try{const e=await Ze(`/api/schema/status?shop=${S}`);De({enabled:e.enabled,generating:e.generating,generated:e.hasSiteFAQ||e.productsWithSchema>0,progress:e.progress||""})}catch(e){}},lt=e.useRef(!1),ct=e.useRef(0),dt=e.useCallback(async()=>{if(lt.current,ct.current,lt.current){if(ct.current++,ct.current>30)return lt.current=!1,ct.current=0,We(!1),void M("Schema generation timed out. Please check if data was generated.");try{const t=await Ze(`/api/schema/status?shop=${S}`);if("NO_OPTIMIZED_PRODUCTS"===t.error||"ONLY_BASIC_SEO"===t.error)return t.error,lt.current=!1,ct.current=0,We(!1),M(null),_e(t.error),void Me(!0);if("TRIAL_RESTRICTION"===t.error)return lt.current=!1,ct.current=0,We(!1),M(t.errorMessage||"Advanced Schema Data is locked during trial. Please activate your plan to use included tokens."),void setTimeout(()=>{const e=new URLSearchParams(window.location.search),t=e.get("host"),s=e.get("embedded");window.location.href=`/billing?shop=${encodeURIComponent(S)}&embedded=${s}&host=${encodeURIComponent(t)}`},2e3);if("INSUFFICIENT_TOKENS"===t.error)return lt.current=!1,ct.current=0,We(!1),void M(t.errorMessage||"Insufficient token balance for Advanced Schema generation. Please purchase tokens.");if(t.dataReady)return lt.current=!1,ct.current=0,We(!1),Qe(!0),void Ve(e=>({...e,percent:100,currentProduct:"Complete!",stats:{siteFAQ:t.hasSiteFAQ||!1,products:t.productsWithSchema||0,totalSchemas:t.productsWithSchema||0}}));if(t.generating){let e=0;if(t.progress){const s=t.progress.match(/(\d+)%/);s&&(e=parseInt(s[1]))}Ve(s=>({...s,percent:Math.max(s.percent,e),currentProduct:t.currentProduct||`Processing... (${ct.current}/30)`})),setTimeout(()=>{lt.current&&dt()},3e3)}else try{const e=await Ze(`/ai/schema-data.json?shop=${S}`);if(e&&e.schemas&&e.schemas.length>0){lt.current=!1,ct.current=0,We(!1),Qe(!0);const t=[...new Set(e.schemas.map(e=>{var t,s;return null==(s=null==(t=e.url)?void 0:t.split("/products/")[1])?void 0:s.split("#")[0]}))].filter(Boolean);Ve(s=>({...s,percent:100,currentProduct:"Complete!",stats:{siteFAQ:!!e.siteFAQ,products:t.length,totalSchemas:e.schemas.length}}))}else lt.current=!1,ct.current=0,We(!1),M("Schema generation may have failed. Please try again.")}catch(e){lt.current=!1,ct.current=0,We(!1),M("Unable to verify schema generation status.")}}catch(e){ct.current<5?setTimeout(()=>{lt.current&&dt()},5e3):(lt.current=!1,ct.current=0,We(!1),M("Error checking generation status. Please refresh and try again."))}}},[Ze,S]),ut=async()=>{var e,t;try{const s=await Ze(`/api/ai-discovery/settings?shop=${S}`);Object.entries((null==s?void 0:s.features)||{}).filter(([e,t])=>!0===t);s.hasAiSitemap&&(null==(e=s.features)?void 0:e.aiSitemap)&&(s.features.aiSitemap=!1),s.hasAdvancedSchema&&(null==(t=s.features)?void 0:t.schemaData)&&(s.features.schemaData=!1),C(s),me(s),xe(s.advancedSchemaEnabled||!1),s.hasAiSitemap&&Q(!0),ht(s)}catch(s){M("Failed to load settings")}finally{A(!1)}},ht=async(e=I)=>{try{const e=await Ze(`/api/ai-discovery/robots-txt?shop=${S}`,{responseType:"text"});if(e)E(e);else{E("User-agent: *\nDisallow: /")}}catch(t){E("# Error generating robots.txt\n# "+t.message)}},pt=e=>{var t;(null==(t=null==I?void 0:I.availableBots)?void 0:t.includes(e))?(C(t=>({...t,bots:{...t.bots,[e]:{...t.bots[e],enabled:!t.bots[e].enabled}}})),ee(!0)):M(`Upgrade to ${requiredPlan} plan to enable ${I.bots[e].name}`)},mt=async e=>{if(!xt(e)){return void M(`Upgrade your plan to enable ${{productsJson:"Products JSON Feed",aiSitemap:"AI-Optimized Sitemap",welcomePage:"AI Welcome Page",collectionsJson:"Collections JSON Feed",storeMetadata:"Store Metadata",schemaData:"Schema Data"}[e]||e}`)}if(!I.features[e]&&vt(e))try{const t=await Ze(`/api/billing/tokens/balance?shop=${S}`);if(t.balance<=0){return Ae({feature:{aiSitemap:"ai-sitemap-optimized",schemaData:"ai-schema-advanced",welcomePage:"ai-welcome-page",collectionsJson:"ai-collections-json",storeMetadata:"ai-store-metadata"}[e]||e,tokensRequired:1e3,tokensAvailable:t.balance||0,tokensNeeded:1e3}),void ve(!0)}}catch(t){return void M("Error checking token balance")}C(t=>({...t,features:{...t.features,[e]:!t.features[e]}}))},gt=async()=>{var e,t,s,a,n;P(!0);try{await Ze(`/api/ai-discovery/settings?shop=${S}`,{method:"POST",body:{shop:S,bots:I.bots,features:I.features,richAttributes:I.richAttributes}}),ee(!1),me(I),ht();const i=j(null==I?void 0:I.plan),o=["growth_extra","growth extra","enterprise"],l=["professional_plus","professional plus","growth_plus","growth plus"].includes(i),c=o.includes(i);if(null==(e=I.features)?void 0:e.aiSitemap){if(!c&&!l)return void M("AI-Optimized Sitemap requires Growth Extra+ or Plus plan");if(l)try{const e=(await Ze(`/api/billing/tokens/balance?shop=${S}`)).balance||0;if(!(e>0))return Ae({feature:"ai-sitemap-optimized",tokensRequired:3e3,tokensAvailable:e,tokensNeeded:3e3}),void ve(!0)}catch(r){return void M("Failed to check token balance")}Q(!1);try{const e="\n            mutation RegenerateSitemap($shop: String!) {\n              regenerateSitemap(shop: $shop) {\n                success\n                message\n                shop\n              }\n            }\n          ",r=await Ze("/graphql",{method:"POST",body:JSON.stringify({query:e,variables:{shop:S}}),shop:S});if(null==(s=null==(t=null==r?void 0:r.data)?void 0:t.regenerateSitemap)?void 0:s.success)M(""),setTimeout(()=>{M("Settings saved! AI-Optimized Sitemap generation started in background. You can navigate away - it will continue processing."),Xe()},100);else{if(((null==(n=null==(a=null==r?void 0:r.data)?void 0:a.regenerateSitemap)?void 0:n.message)||"").startsWith("TRIAL_RESTRICTION:"))return P(!1),Pe({trialRestriction:!0,requiresActivation:!0,feature:"ai-sitemap-optimized",currentPlan:(null==I?void 0:I.plan)||"enterprise"}),void ye(!0);M(""),setTimeout(()=>{M("Settings saved, but sitemap regeneration failed")},100)}}catch(r){if(P(!1),402===r.status&&r.trialRestriction&&r.requiresActivation)return Pe({trialRestriction:!0,requiresActivation:!0,feature:"ai-sitemap-optimized",currentPlan:(null==I?void 0:I.plan)||"enterprise"}),void ye(!0);M("Settings saved, but sitemap regeneration failed")}}else M(""),setTimeout(()=>{const e=Object.values((null==I?void 0:I.bots)||{}).some(e=>e.enabled);M(e?"Settings saved! Scroll down to configure robots.txt (REQUIRED for AI Discovery).":"Settings saved successfully")},100)}catch(r){if(402===r.status)return P(!1),Pe(r),void(r.trialRestriction&&r.requiresActivation?ye(!0):r.requiresPurchase?ve(!0):M("AI-Optimized Sitemap requires tokens. Please upgrade or purchase tokens."));M("Failed to save settings")}finally{P(!1)}},xt=e=>{const t=i(null==I?void 0:I.plan),s={productsJson:0,storeMetadata:1,welcomePage:2,collectionsJson:2,aiSitemap:2,schemaData:2}[e];return void 0!==s&&t>=s},ft=e=>{var t;const s=j(null==I?void 0:I.plan);return(null==(t={storeMetadata:{starter:"Available in Professional or higher"},welcomePage:{starter:"Available in Professional Plus (pay-per-use tokens) or Growth+",professional:"Available in Professional Plus (pay-per-use tokens) or Growth+"},collectionsJson:{starter:"Available in Professional Plus (pay-per-use tokens) or Growth+",professional:"Available in Professional Plus (pay-per-use tokens) or Growth+"},aiSitemap:{starter:"Available in Professional Plus (pay-per-use tokens) or Growth Extra+",professional:"Available in Professional Plus (pay-per-use tokens) or Growth Extra+",growth:"Available in Growth Plus (pay-per-use tokens) or Growth Extra+"},schemaData:{starter:"Available in Professional Plus (pay-per-use tokens), Growth Plus (pay-per-use tokens) or Enterprise",professional:"Available in Professional Plus (pay-per-use tokens), Growth Plus (pay-per-use tokens) or Enterprise",growth:"Available in Growth Plus (pay-per-use tokens) or Enterprise",growth_extra:"Available in Enterprise"}}[e])?void 0:t[s])||"Upgrade to enable this feature"},vt=e=>{var t;return(null==(t={professional_plus:["welcomePage","collectionsJson","aiSitemap","schemaData"],growth_plus:["aiSitemap","schemaData"]}[j(null==I?void 0:I.plan)])?void 0:t.includes(e))||!1},bt=async e=>{if(!vt(e))return!0;try{const t=await Ze(`/api/billing/tokens/balance?shop=${S}`);if(t.balance<=0){return Ae({feature:{aiSitemap:"ai-sitemap-optimized",schemaData:"ai-schema-advanced",welcomePage:"ai-welcome-page",collectionsJson:"ai-collections-json",storeMetadata:"ai-store-metadata"}[e]||e,tokensRequired:1e3,tokensAvailable:t.balance||0,tokensNeeded:1e3}),ve(!0),!1}return!0}catch(t){return M("Error checking token balance"),!1}},yt=async(e,t)=>{var s,a,n,r,i,o;if(await bt(e)){ie(t),de(e),ne(!0),he(!0),le(null);try{const t={productsJson:`/ai/products.json?shop=${S}`,collectionsJson:`/ai/collections-feed.json?shop=${S}`,storeMetadata:`/ai/store-metadata.json?shop=${S}`,schemaData:`/ai/schema-data.json?shop=${S}`,aiSitemap:`/api/sitemap/generate?shop=${S}&force=true`,welcomePage:`/ai/welcome?shop=${S}`};if("aiSitemap"===e){const r=await fetch(t[e],{method:"GET",credentials:"include",headers:{Authorization:`Bearer ${(null==(n=null==(a=null==(s=window.__SHOPIFY_APP_BRIDGE__)?void 0:s.getState())?void 0:a.session)?void 0:n.token)||""}`}});if(!r.ok)throw new Error(`HTTP ${r.status}: ${r.statusText}`);{const e=await r.text();le(e)}}else if("welcomePage"===e){const s=await fetch(t[e],{method:"GET",credentials:"include",headers:{Authorization:`Bearer ${(null==(o=null==(i=null==(r=window.__SHOPIFY_APP_BRIDGE__)?void 0:r.getState())?void 0:i.session)?void 0:o.token)||""}`}});if(!s.ok)throw new Error(`HTTP ${s.status}: ${s.statusText}`);{const e=await s.text();le(e)}}else{const s=await Ze(t[e]);le(JSON.stringify(s,null,2))}}catch(l){le(`Error loading data: ${l.message}`)}finally{he(!1)}}};e.useEffect(()=>{},[q]),e.useEffect(()=>{N(!1),We(!1),Qe(!1),lt.current=!1,ct.current=0},[]),e.useEffect(()=>{(null==I?void 0:I.features)&&S&&it()},[null==I?void 0:I.features,S,it]),e.useEffect(()=>{lt.current&&!Je&&(lt.current=!1,ct.current=0),S&&(null==I?void 0:I.features)&&it()},[]);try{return S?w?t.jsx(o,{children:t.jsx(l,{padding:"400",children:t.jsxs(d,{align:"center",children:[t.jsx(u,{size:"small"}),t.jsx(c,{children:"Loading settings..."})]})})}):t.jsxs(h,{gap:"600",children:[t.jsx(o,{children:t.jsx(l,{padding:"400",children:t.jsxs(h,{gap:"400",children:[t.jsxs(d,{align:"space-between",children:[t.jsx(c,{as:"h2",variant:"headingMd",children:"AI Bot Access Control"}),(null==I?void 0:I.plan)&&t.jsxs(p,{tone:"info",children:[I.plan.charAt(0).toUpperCase()+I.plan.slice(1)," Plan"]})]}),t.jsx(c,{variant:"bodyMd",tone:"subdued",children:"Choose which AI bots can access your store's structured data"}),t.jsx(m,{status:"info",children:t.jsxs(h,{gap:"200",children:[t.jsx(c,{variant:"bodyMd",fontWeight:"semibold",children:"How it works:"}),t.jsxs("ol",{style:{marginLeft:"20px",marginBottom:0},children:[t.jsx("li",{children:"Select AI bots below"}),t.jsx("li",{children:"Configure AI Discovery Features below"}),t.jsx("li",{children:'Click "Save Settings" at the bottom'}),t.jsx("li",{children:"Configure robots.txt (instructions will appear)"})]})]})}),t.jsx(g,{}),t.jsxs(h,{gap:"300",children:[t.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"1rem"},children:["meta","anthropic"].map(e=>{var s,a,n;const r=null==(s=null==I?void 0:I.bots)?void 0:s[e];if(!r)return null;const i={starter:["meta","anthropic"],professional:["meta","anthropic","google"],growth:["meta","anthropic","google","openai"],growth_extra:["meta","anthropic","google","openai","perplexity"],enterprise:["meta","anthropic","google","openai","perplexity","others"]},o=(i[j(null==I?void 0:I.plan)]||i.starter).includes(e),u="google"===e?"Professional":"openai"===e?"Growth":"perplexity"===e?"Growth Extra":"others"===e?"Enterprise":null;return t.jsx(l,{padding:"200",background:o?"bg-surface":"bg-surface-secondary",borderRadius:"200",borderWidth:"025",borderColor:"border",children:t.jsx(h,{gap:"100",children:t.jsx(x,{label:t.jsxs(d,{gap:"200",align:"center",children:[t.jsx(c,{variant:o?"bodyMd":"bodySm",tone:o?"base":"subdued",children:r.name||e}),!o&&u&&t.jsx(p,{tone:"info",size:"small",children:"Upgrade"})]}),checked:!!(null==(n=null==(a=null==I?void 0:I.bots)?void 0:a[e])?void 0:n.enabled),onChange:()=>pt(e),disabled:!o,helpText:o?"meta"===e?"Meta AI platforms":"anthropic"===e?"Claude AI assistant":"google"===e?"Google Gemini":"openai"===e?"ChatGPT":"perplexity"===e?"AI-powered search":"others"===e?"Deepseek, Bytespider & others":"":`Upgrade to ${u} plan to enable this AI bot`})})},e)})}),t.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"1rem"},children:["google","openai"].map(e=>{var s,a,n,r;const i=null==(s=null==I?void 0:I.bots)?void 0:s[e];if(!i)return null;const o=null==(a=null==I?void 0:I.availableBots)?void 0:a.includes(e),u="google"===e?"Professional":"openai"===e?"Growth":"perplexity"===e?"Growth Extra":"others"===e?"Enterprise":null;return t.jsx(l,{padding:"200",background:o?"bg-surface":"bg-surface-secondary",borderRadius:"200",borderWidth:"025",borderColor:"border",children:t.jsx(h,{gap:"100",children:t.jsx(x,{label:t.jsxs(d,{gap:"200",align:"center",children:[t.jsx(c,{variant:o?"bodyMd":"bodySm",tone:o?"base":"subdued",children:i.name||e}),!o&&u&&t.jsx(p,{tone:"info",size:"small",children:"Upgrade"})]}),checked:!!(null==(r=null==(n=null==I?void 0:I.bots)?void 0:n[e])?void 0:r.enabled),onChange:()=>pt(e),disabled:!o,helpText:o?"meta"===e?"Meta AI platforms":"anthropic"===e?"Claude AI assistant":"google"===e?"Google Gemini":"openai"===e?"ChatGPT":"perplexity"===e?"AI-powered search":"others"===e?"Deepseek, Bytespider & others":"":`Upgrade to ${u} plan to enable this AI bot`})})},e)})}),t.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:"1rem"},children:["perplexity","others"].map(e=>{var s,a,n,r;const i=null==(s=null==I?void 0:I.bots)?void 0:s[e];if(!i)return null;const o=null==(a=null==I?void 0:I.availableBots)?void 0:a.includes(e),u="google"===e?"Professional":"openai"===e?"Growth":"perplexity"===e?"Growth Extra":"others"===e?"Enterprise":null;return t.jsx(l,{padding:"200",background:o?"bg-surface":"bg-surface-secondary",borderRadius:"200",borderWidth:"025",borderColor:"border",children:t.jsx(h,{gap:"100",children:t.jsx(x,{label:t.jsxs(d,{gap:"200",align:"center",children:[t.jsx(c,{variant:o?"bodyMd":"bodySm",tone:o?"base":"subdued",children:i.name||e}),!o&&u&&t.jsx(p,{tone:"info",size:"small",children:"Upgrade"})]}),checked:!!(null==(r=null==(n=null==I?void 0:I.bots)?void 0:n[e])?void 0:r.enabled),onChange:()=>pt(e),disabled:!o,helpText:o?"meta"===e?"Meta AI platforms":"anthropic"===e?"Claude AI assistant":"google"===e?"Google Gemini":"openai"===e?"ChatGPT":"perplexity"===e?"AI-powered search":"others"===e?"Deepseek, Bytespider & others":"":`Upgrade to ${u} plan to enable this AI bot`})})},e)})})]})]})})}),t.jsx(o,{children:t.jsx(l,{padding:"400",children:t.jsxs(h,{gap:"400",children:[t.jsx(c,{as:"h2",variant:"headingMd",children:"AI Discovery Features"}),t.jsx(c,{variant:"bodyMd",tone:"subdued",children:"Select the features you want to enable for AI bots to consume your store data."}),t.jsx(m,{status:"info",children:'Don\'t forget to click "Save Settings" after making changes.'}),t.jsx(g,{}),t.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(300px, 1fr))",gap:"1rem"},children:[{key:"productsJson",name:"Products JSON Feed",description:"Bulk product data for AI consumption",requiredPlan:"Starter"},{key:"storeMetadata",name:"Store Metadata for AI Search",description:"Organization schema & AI metadata",requiredPlan:"Professional"},{key:"welcomePage",name:"AI Welcome Page",description:"Landing page for AI bots",requiredPlan:"Growth"},{key:"collectionsJson",name:"Collections JSON Feed",description:"Category data for better AI understanding",requiredPlan:"Growth"},{key:"aiSitemap",name:"AI-Optimized Sitemap",description:"Enhanced sitemap with AI hints",requiredPlan:"Growth Extra"},{key:"schemaData",name:"Advanced Schema Data",description:"BreadcrumbList, FAQPage & more",requiredPlan:"Enterprise"}].map(e=>{var s;const a=xt(e.key),n=!!(null==(s=null==I?void 0:I.features)?void 0:s[e.key]);return t.jsx(l,{padding:"200",background:a?"bg-surface":"bg-surface-secondary",borderRadius:"200",borderWidth:"025",borderColor:"border",children:a?t.jsxs(h,{gap:"200",children:[t.jsxs(d,{align:"space-between",blockAlign:"center",children:[t.jsx(l,{flexGrow:1,children:t.jsx(x,{label:e.name,checked:n,onChange:()=>mt(e.key),helpText:e.description})}),"aiSitemap"===e.key&&Y&&!ze.inProgress&&t.jsx(f,{size:"slim",onClick:()=>yt(e.key,e.name),children:"View"}),"productsJson"===e.key&&B&&t.jsx(f,{size:"slim",onClick:()=>yt(e.key,e.name),children:"View"}),"collectionsJson"===e.key&&F&&t.jsx(f,{size:"slim",onClick:()=>yt(e.key,e.name),children:"View"}),"storeMetadata"===e.key&&n&&(J?t.jsx(f,{size:"slim",onClick:()=>yt(e.key,e.name),children:"View"}):t.jsx(f,{size:"slim",variant:"primary",onClick:async()=>{if(!(await bt("storeMetadata")))return;const e=`/ai-seo/store-metadata?shop=${S}`;window.open(e,"_blank")},children:"Configure"})),"welcomePage"===e.key&&H&&t.jsx(f,{size:"slim",onClick:()=>yt(e.key,e.name),children:"View"})]}),"aiSitemap"===e.key&&n&&ze.inProgress&&t.jsx(l,{paddingInlineStart:"800",paddingBlockStart:"200",children:t.jsxs(d,{gap:"200",blockAlign:"center",children:[t.jsx(u,{size:"small"}),t.jsxs(h,{gap:"100",children:[t.jsx(c,{variant:"bodyMd",tone:"subdued",children:ze.message||"Generating sitemap..."}),ze.position>0&&t.jsxs(c,{variant:"bodySm",tone:"subdued",children:["Queue position: ",ze.position," Â· Est. ",Math.ceil(ze.estimatedTime/60)," min"]}),"processing"===ze.status&&ze.productCount>0&&t.jsxs(c,{variant:"bodySm",tone:"subdued",children:["Processing ",ze.productCount," products..."]})]})]})}),"aiSitemap"===e.key&&!ze.inProgress&&"completed"===ze.status&&ze.generatedAt&&t.jsx(l,{paddingInlineStart:"800",paddingBlockStart:"200",children:t.jsxs(d,{gap:"200",blockAlign:"center",children:[t.jsx(p,{tone:"success",children:"Generated"}),t.jsxs(c,{variant:"bodySm",tone:"subdued",children:[ze.productCount," products Â· ",(()=>{const e=new Date,t=new Date(ze.generatedAt),s=Math.floor((e-t)/1e3/60);if(s<1)return"Just now";if(s<60)return`${s} min ago`;const a=Math.floor(s/60);if(a<24)return`${a}h ago`;return`${Math.floor(a/24)}d ago`})()]})]})}),"schemaData"===e.key&&n&&Be.inProgress&&t.jsx(l,{paddingInlineStart:"800",paddingBlockStart:"200",children:t.jsxs(d,{gap:"200",blockAlign:"center",children:[t.jsx(u,{size:"small"}),t.jsxs(h,{gap:"100",children:[t.jsx(c,{variant:"bodyMd",tone:"subdued",children:Be.message||"Generating schema data..."}),Be.position>0&&t.jsxs(c,{variant:"bodySm",tone:"subdued",children:["Queue position: ",Be.position," Â· Est. ",Math.ceil(Be.estimatedTime/60)," min"]}),"processing"===Be.status&&Be.schemaCount>0&&t.jsxs(c,{variant:"bodySm",tone:"subdued",children:["Processing ",Be.schemaCount," schemas..."]})]})]})}),"schemaData"===e.key&&!Be.inProgress&&"completed"===Be.status&&Be.generatedAt&&t.jsx(l,{paddingInlineStart:"800",paddingBlockStart:"200",children:t.jsxs(d,{gap:"200",blockAlign:"center",children:[t.jsx(p,{tone:"success",children:"Generated"}),t.jsxs(c,{variant:"bodySm",tone:"subdued",children:[Be.schemaCount," schemas Â· ",(()=>{const e=new Date,t=new Date(Be.generatedAt),s=Math.floor((e-t)/1e3/60);if(s<1)return"Just now";if(s<60)return`${s} min ago`;const a=Math.floor(s/60);if(a<24)return`${a}h ago`;return`${Math.floor(a/24)}d ago`})()]})]})})]}):t.jsx(x,{label:t.jsxs(d,{gap:"200",align:"center",children:[t.jsx(c,{variant:"bodySm",tone:"subdued",children:e.name}),e.requiredPlan&&t.jsx(p,{tone:"info",size:"small",children:"Upgrade"})]}),checked:!1,onChange:()=>mt(e.key),disabled:!0,helpText:ft(e.key)})},e.key)})})]})})}),(()=>{var e,t;const s=j(null==I?void 0:I.plan),a=i(s)>=2,n=null==(e=null==I?void 0:I.features)?void 0:e.schemaData,r=null==(t=null==pe?void 0:pe.features)?void 0:t.schemaData;return a&&n&&r})()&&t.jsx(o,{children:t.jsx(l,{padding:"400",children:t.jsxs(h,{gap:"400",children:[t.jsx(c,{as:"h2",variant:"headingMd",children:"Advanced Schema Data Management"}),t.jsx(c,{variant:"bodyMd",tone:"subdued",children:"Generate and manage structured data for your products"}),t.jsxs(d,{gap:"300",children:[t.jsx(f,{primary:!0,onClick:async()=>{var e,t,s,a;try{const e=await Ze(`/ai/schema-data.json?shop=${S}`);if(e.schemas&&e.schemas.length>0&&!confirm("This will replace existing schema data. Continue?"))return;await Ze(`/api/schema/generate-all?shop=${S}`,{method:"POST",shop:S,body:{shop:S}});M("Advanced Schema Data generation started in background. You can navigate away - it will continue processing."),tt()}catch(n){if(402===n.status)return Pe(n),void(n.trialRestriction&&n.requiresActivation?ye(!0):n.requiresPurchase?ve(!0):M("Advanced Schema Data requires activation or token purchase."));if((null==(e=n.message)?void 0:e.includes("NO_OPTIMIZED_PRODUCTS"))||(null==(t=n.error)?void 0:t.includes("NO_OPTIMIZED_PRODUCTS")))return _e("NO_OPTIMIZED_PRODUCTS"),void Me(!0);if((null==(s=n.message)?void 0:s.includes("ONLY_BASIC_SEO"))||(null==(a=n.error)?void 0:a.includes("ONLY_BASIC_SEO")))return _e("ONLY_BASIC_SEO"),void Me(!0);M("Failed to generate schema: "+(n.message||"Unknown error"))}},children:"Generate/Update Schema Data"}),t.jsx(f,{onClick:()=>{window.open(`/ai/schema-data.json?shop=${S}`,"_blank")},children:"View Generated Schema"}),t.jsx(f,{destructive:!0,onClick:async()=>{if(confirm("This will delete all advanced schema data. Are you sure?"))try{await Ze(`/api/schema/delete?shop=${S}`,{method:"DELETE",shop:S,body:{shop:S}}),M("Schema data deleted successfully")}catch(e){M("Failed to delete schema data")}},children:"Delete Schema Data"})]}),t.jsx(o,{children:t.jsx(l,{padding:"300",children:t.jsxs(h,{gap:"300",children:[t.jsx(c,{as:"h3",variant:"headingSm",children:"Rich Product Attributes"}),t.jsx(c,{variant:"bodyMd",tone:"subdued",children:"Select which AI-generated attributes to include in product schemas"}),t.jsx(v,{columns:2,gap:"400",children:[{key:"material",label:"Material",description:"Product material (cotton, leather, metal, etc.)"},{key:"color",label:"Color",description:"Product color information"},{key:"size",label:"Size",description:"Product size or dimensions"},{key:"weight",label:"Weight",description:"Product weight information"},{key:"dimensions",label:"Dimensions",description:"Product measurements"},{key:"category",label:"Category",description:"Product category classification"},{key:"audience",label:"Target Audience",description:"Intended user group (men, women, kids, etc.)"},{key:"reviews",label:"Review Schemas",description:"AI-generated product reviews for schema.org"},{key:"ratings",label:"Rating Schemas",description:"AI-generated ratings and aggregate ratings"},{key:"enhancedDescription",label:"Enhanced Descriptions",description:"AI-enhanced product descriptions"},{key:"organization",label:"Organization Schema",description:"Brand organization information"}].map(e=>{var s;return t.jsx(x,{label:e.label,helpText:e.description,checked:(null==(s=null==I?void 0:I.richAttributes)?void 0:s[e.key])||!1,onChange:t=>{C(s=>({...s,richAttributes:{...s.richAttributes,[e.key]:t}}))}},e.key)})})]})})}),t.jsx(m,{status:"info",tone:"subdued",children:t.jsx("p",{children:"Generation creates BreadcrumbList, FAQPage, WebPage and more schemas for each product. These structured schemas help AI bots understand your product hierarchy, answer customer questions automatically, and improve your store's visibility in AI-powered search results."})})]})})}),t.jsxs(d,{gap:"200",align:"end",children:[t.jsx(f,{tone:"critical",onClick:async()=>{if(window.confirm("Are you sure you want to reset all AI Discovery settings to defaults?"))try{await Ze(`/api/ai-discovery/settings?shop=${S}`,{method:"DELETE",shop:S}),M("Settings reset successfully"),me(null),setTimeout(()=>{window.location.reload()},1e3)}catch(e){M("Failed to reset settings")}},children:"Reset to Defaults"}),t.jsx(f,{primary:!0,size:"large",loading:k,onClick:gt,children:"Save Settings"})]}),!X&&Object.values((null==I?void 0:I.bots)||{}).some(e=>e.enabled)&&t.jsx(o,{children:t.jsx(l,{padding:"400",children:t.jsxs(h,{gap:"400",children:[t.jsxs(d,{align:"space-between",children:[t.jsx(c,{as:"h2",variant:"headingMd",children:"ðŸ“‹ robots.txt Configuration"}),t.jsx(p,{tone:"critical",children:"REQUIRED"})]}),t.jsx(m,{status:"critical",title:"âš ï¸ IMPORTANT: AI Discovery will NOT work without this step!",children:t.jsxs(h,{gap:"300",children:[t.jsx("p",{children:t.jsx("strong",{children:"Your AI bot settings are saved, but they can't access your store yet."})}),t.jsx("p",{children:"You must manually add robots.txt to your theme for AI bots to discover your products."}),t.jsx("p",{children:"Click the button below to see your custom robots.txt code and installation instructions."})]})}),t.jsx(f,{primary:!0,size:"large",onClick:async()=>{try{Object.values((null==I?void 0:I.bots)||{}).some(e=>e.enabled)?(await ht(),D(!0)):se(!0)}catch(e){M("Error generating robots.txt: "+e.message)}},children:"ðŸ“‹ View & Copy robots.txt Code"}),t.jsx(g,{}),t.jsxs(h,{gap:"300",children:[t.jsx(c,{variant:"headingMd",children:"Installation Instructions:"}),t.jsxs("ol",{style:{marginLeft:"20px",marginTop:"10px",lineHeight:"1.8"},children:[t.jsxs("li",{children:[t.jsx("strong",{children:"Generate & Copy:"})," Click the button above to see your custom robots.txt code, then copy it"]}),t.jsxs("li",{children:[t.jsx("strong",{children:"Open Theme Editor:"})," Go to ",t.jsx("strong",{children:"Online Store â†’ Themes"})," in Shopify admin"]}),t.jsxs("li",{children:[t.jsx("strong",{children:"Edit Code:"})," Click ",t.jsx("strong",{children:"Actions â†’ Edit code"})," on your active theme"]}),t.jsxs("li",{children:[t.jsx("strong",{children:"Check Existing File:"})," In the file browser, look for ",t.jsx("code",{children:"templates/robots.txt.liquid"})]}),t.jsxs("li",{children:[t.jsx("strong",{children:"If File Exists:"})," Click on it to edit. ",t.jsx("strong",{children:"Add"})," the copied code to the end of the existing content (don't replace it)"]}),t.jsxs("li",{children:[t.jsx("strong",{children:"If File Doesn't Exist:"})," Click ",t.jsx("strong",{children:"Add a new file"}),", type ",t.jsx("code",{children:"templates/robots.txt.liquid"}),", and paste the copied code"]}),t.jsxs("li",{children:[t.jsx("strong",{children:"Save:"})," Click the green ",t.jsx("strong",{children:"Save"})," button (top right)"]})]}),t.jsx(m,{status:"warning",children:t.jsxs("p",{children:[t.jsx("strong",{children:"âš ï¸ Important:"})," If you already have a ",t.jsx("code",{children:"robots.txt.liquid"})," file with custom rules, ",t.jsx("strong",{children:"add"})," our code to the end instead of replacing it. This ensures both your existing rules and AI bot access work correctly."]})}),t.jsx(m,{tone:"info",children:t.jsxs("p",{children:[t.jsx("strong",{children:"ðŸ’¡ Note:"})," Our generated robots.txt does NOT block standard search engines (Google, Bing, etc.). It only configures access for AI bots. The default Shopify robots.txt rules will still apply for standard crawlers."]})})]}),t.jsx(m,{status:"info",children:t.jsxs("p",{children:["ðŸ’¡ ",t.jsx("strong",{children:"Why this matters:"})," The robots.txt file tells AI bots (OpenAI, Anthropic, Google, etc.) which pages and endpoints they can access to properly understand and index your products for AI search results and recommendations."]})})]})})}),O&&t.jsx(b,{open:O,onClose:()=>D(!1),title:"robots.txt Configuration",primaryAction:{content:"Copy to clipboard",onAction:()=>{navigator.clipboard.writeText(T),M("Copied to clipboard!")}},secondaryActions:[{content:"Close",onAction:()=>D(!1)}],children:t.jsx(b.Section,{children:t.jsxs(h,{gap:"400",children:[!["growth","growth_extra","enterprise"].includes(j(null==I?void 0:I.plan))&&t.jsx(m,{status:"info",title:"Manual Configuration Steps",children:t.jsxs("ol",{style:{marginLeft:"20px",marginTop:"10px"},children:[t.jsx("li",{children:"Copy the robots.txt content below"}),t.jsxs("li",{children:["Go to ",t.jsx("strong",{children:"Online Store â†’ Themes"})]}),t.jsxs("li",{children:["Click ",t.jsx("strong",{children:"Actions â†’ Edit code"})," on your active theme"]}),t.jsxs("li",{children:["In the file browser, look for ",t.jsx("strong",{children:"templates/robots.txt.liquid"})]}),t.jsxs("li",{children:[t.jsx("strong",{children:"If file exists:"})," Add the copied code to the end (don't replace existing content)"]}),t.jsxs("li",{children:[t.jsx("strong",{children:"If file doesn't exist:"})," Click ",t.jsx("strong",{children:"Add a new file"}),", type ",t.jsx("code",{children:"templates/robots.txt.liquid"}),", and paste the code"]}),t.jsxs("li",{children:["Click ",t.jsx("strong",{children:"Save"})]})]})}),t.jsx(l,{padding:"200",background:"bg-surface-secondary",borderRadius:"100",children:t.jsx("pre",{style:{whiteSpace:"pre-wrap",fontFamily:"monospace",fontSize:"12px",margin:0,overflow:"auto",maxHeight:"400px"},children:T})})]})})}),te&&t.jsx(b,{open:te,onClose:()=>se(!1),title:"No AI Bots Selected",primaryAction:{content:"Got it",onAction:()=>se(!1)},children:t.jsx(b.Section,{children:t.jsxs(h,{gap:"400",children:[t.jsx(m,{status:"warning",children:t.jsx("p",{children:"You haven't selected any AI bots yet."})}),t.jsx(c,{children:"To configure robots.txt:"}),t.jsxs("ol",{style:{marginLeft:"20px",marginTop:"10px"},children:[t.jsx("li",{children:'Select AI bots from the "AI Bot Access Control" section above'}),t.jsx("li",{children:'Click "Save Settings" to save your selections'}),t.jsx("li",{children:'Then click "Generate robots.txt" to configure'})]})]})})}),ae&&t.jsx(b,{open:ae,onClose:()=>{ne(!1),le(null),de(null)},title:re,primaryAction:{content:"Copy",onAction:()=>{navigator.clipboard.writeText(oe),M("Copied to clipboard!")},disabled:ue},secondaryActions:[{content:"Close",onAction:()=>{ne(!1),le(null),de(null)}}],children:t.jsx(b.Section,{children:t.jsx(l,{padding:"200",background:"bg-surface-secondary",borderRadius:"100",children:ue?t.jsxs(d,{align:"center",gap:"200",children:[t.jsx(u,{size:"small"}),t.jsx(c,{variant:"bodyMd",children:"AI-Optimized Sitemap"===re?"Loading sitemap XML... This may take a moment for large stores.":"Loading..."})]}):"welcomePage"===ce?t.jsx("div",{style:{border:"1px solid #e1e3e5",borderRadius:"8px",overflow:"hidden",maxHeight:"600px",backgroundColor:"#fff"},children:t.jsx("iframe",{srcDoc:oe,style:{width:"100%",height:"600px",border:"none",display:"block"},title:"AI Welcome Page Preview",sandbox:"allow-same-origin"})}):t.jsx("pre",{style:{whiteSpace:"pre-wrap",fontFamily:"monospace",fontSize:"12px",margin:0,overflow:"auto",maxHeight:"400px"},children:oe})})})}),$e&&"NO_OPTIMIZED_PRODUCTS"===Re&&t.jsx(b,{open:!0,title:"No Optimized Products Found",onClose:async()=>{Me(!1),_e(null);try{await Ze(`/api/schema/dismiss-error?shop=${S}`,{method:"POST"})}catch(e){}},primaryAction:{content:"Go to Search Optimization",onAction:async()=>{Me(!1),_e(null);try{await Ze(`/api/schema/dismiss-error?shop=${S}`,{method:"POST"})}catch(s){}const e=new URLSearchParams(window.location.search),t=e.toString()?`?${e.toString()}`:"";window.location.href=`/ai-seo${t}`}},secondaryActions:[{content:"Cancel",onAction:async()=>{Me(!1),_e(null);try{await Ze(`/api/schema/dismiss-error?shop=${S}`,{method:"POST"})}catch(e){}}}],children:t.jsx(b.Section,{children:t.jsxs(h,{gap:"400",children:[t.jsx(m,{status:"warning",children:t.jsx("p",{children:"No optimized products were found in your store."})}),t.jsx(c,{children:"Advanced Schema Data requires at least basic AISEO optimization on your products. Please run AISEO optimization first, then try generating schemas again."}),t.jsx(c,{variant:"bodyMd",fontWeight:"semibold",children:"You can choose:"}),t.jsxs(h,{gap:"200",children:[t.jsxs(c,{children:["â€¢ ",t.jsx("strong",{children:"Basic AISEO"})," - Free AISEO optimization"]}),t.jsxs(c,{children:["â€¢ ",t.jsx("strong",{children:"AI-Enhanced AISEO"})," - Advanced optimization (requires tokens)"]})]})]})})}),$e&&"ONLY_BASIC_SEO"===Re&&t.jsx(b,{open:!0,title:"AI-Enhanced Optimization Recommended",onClose:async()=>{Me(!1),_e(null);try{await Ze(`/api/schema/dismiss-error?shop=${S}`,{method:"POST"})}catch(e){}},primaryAction:{content:"Generate AI-Enhanced Add-ons",onAction:async()=>{Me(!1),_e(null);try{await Ze(`/api/schema/dismiss-error?shop=${S}`,{method:"POST"})}catch(s){}const e=new URLSearchParams(window.location.search),t=e.toString()?`?${e.toString()}`:"";window.location.href=`/ai-seo${t}`}},secondaryActions:[{content:"Proceed with Basic AISEO",onAction:async()=>{Me(!1),_e(null);try{M("Starting schema generation with basic AISEO..."),await Ze(`/api/schema/generate-all?shop=${S}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({forceBasicSeo:!0})}),tt()}catch(e){M("Failed to generate schema: "+(e.message||"Unknown error"))}}}],children:t.jsx(b.Section,{children:t.jsxs(h,{gap:"400",children:[t.jsx(m,{status:"info",children:t.jsx("p",{children:"Only basic AISEO optimization was found on your products."})}),t.jsx(c,{children:"For best results with Advanced Schema Data, we recommend running AI-Enhanced AISEO optimization first. This will provide richer product data for schema generation."}),t.jsx(c,{variant:"bodyMd",fontWeight:"semibold",children:"What would you like to do?"}),t.jsxs(h,{gap:"200",children:[t.jsxs(c,{children:["â€¢ ",t.jsx("strong",{children:"Generate AI-Enhanced Add-ons"})," - Get the best results (requires tokens)"]}),t.jsxs(c,{children:["â€¢ ",t.jsx("strong",{children:"Proceed with Basic AISEO"})," - Continue with current basic AISEO"]})]})]})})}),$&&t.jsx(y,{content:$,onDismiss:()=>M("")}),ke&&t.jsxs(t.Fragment,{children:[t.jsx(a,{open:fe,onClose:()=>{ve(!1),Pe(null)},feature:ke.feature||"ai-sitemap-optimized",tokensRequired:ke.tokensRequired||0,tokensAvailable:ke.tokensAvailable||0,tokensNeeded:ke.tokensNeeded||0,shop:S,needsUpgrade:ke.needsUpgrade||!1,minimumPlan:ke.minimumPlanForFeature||null,currentPlan:ke.currentPlan||(null==I?void 0:I.plan)||"starter",returnTo:"/settings",onBuyTokens:()=>{ve(!1),Se(!0)}}),t.jsx(n,{open:be,onClose:()=>{ye(!1),Pe(null)},feature:ke.feature||"ai-sitemap-optimized",trialEndsAt:ke.trialEndsAt,currentPlan:ke.currentPlan||(null==I?void 0:I.plan)||"enterprise",tokensRequired:ke.tokensRequired||0,onActivatePlan:async()=>{try{const e=await Ze("/api/billing/activate",{method:"POST",body:JSON.stringify({shop:S,endTrial:!0,returnTo:"/settings"})});if(e.requiresApproval&&e.confirmationUrl)return void(window.top.location.href=e.confirmationUrl);window.location.reload()}catch(e){const t=new URLSearchParams(window.location.search),s=t.get("host"),a=t.get("embedded");window.location.href=`/billing?shop=${encodeURIComponent(S)}&embedded=${a}&host=${encodeURIComponent(s)}`}},onPurchaseTokens:()=>{ye(!1),Se(!0)},shop:S})]}),!ke&&fe&&t.jsx(a,{open:fe,onClose:()=>ve(!1),feature:we.feature,tokensRequired:we.tokensRequired,tokensAvailable:we.tokensAvailable,tokensNeeded:we.tokensNeeded,shop:S,needsUpgrade:!1,minimumPlan:null,currentPlan:(null==I?void 0:I.plan)||"starter",returnTo:"/settings",onBuyTokens:()=>{ve(!1),Se(!0)}}),t.jsx(r,{open:je,onClose:()=>{Se(!1),Pe(null)},shop:S,returnTo:"/settings",inTrial:!0})]}):t.jsx(o,{children:t.jsx(l,{padding:"400",children:t.jsx(c,{tone:"critical",children:"Missing shop parameter"})})})}catch(jt){return t.jsx(h,{gap:"400",children:t.jsx(o,{children:t.jsxs(l,{padding:"400",children:[t.jsx(c,{variant:"headingMd",children:"Settings Error"}),t.jsx(l,{paddingBlockStart:"200",children:t.jsxs(c,{children:["Failed to load settings: ",jt.message]})})]})})})}}export{j as default};
