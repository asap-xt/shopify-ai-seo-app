import{j as e}from"./app-bridge-zWUnD2De-1759257805235.js";import{r as p}from"./react-vendor-tAaa2TlE-1759257805235.js";import{m as _}from"./index-NIh3sAjQ-1759257805235.js";import{C as u,a as o,d as r,r as q,T as s,h as y,t as L,I as c,g as A,B as d,u as h,i as B,D as W,k as F}from"./polaris-BxKkr4rH-1759257805235.js";const $=(m,a="")=>{try{return new URLSearchParams(window.location.search).get(m)||a}catch{return a}};function X({shop:m}){const a=m||$("shop","");console.log("[SCHEMA-DATA] shopProp:",m),console.log('[SCHEMA-DATA] qs("shop"):',$("shop","")),console.log("[SCHEMA-DATA] final shop:",a),console.log("[SCHEMA-DATA] window.location.search:",window.location.search);const[x,k]=p.useState(0),[w,j]=p.useState(!0),[n,z]=p.useState({organization:null,website:null,products:[]}),[v,g]=p.useState(""),b=p.useMemo(()=>_(),[]),[E,M]=p.useState(""),[U,P]=p.useState(null),[T,I]=p.useState("");p.useEffect(()=>{a&&(C(),R())},[a,b]);const R=async()=>{var i,t;try{const f=await b("/graphql",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:`
        query PlansMe($shop:String!) {
          plansMe(shop:$shop) {
            shop
            plan
            planKey
          }
        }
      `,variables:{shop:a}})});console.log("[SCHEMA-DATA] Plan data:",f),P((t=(i=f==null?void 0:f.data)==null?void 0:i.plansMe)==null?void 0:t.plan)}catch(l){console.error("[SCHEMA-DATA] Error loading plan:",l)}},S=i=>{I("Loading simulation..."),setTimeout(()=>{let t="";switch(i){case"products":n.products&&n.products.length>0?t=`Based on the structured data, ${a} sells ${n.products.length} products including: ${n.products.slice(0,3).map(l=>l.title).join(", ")}${n.products.length>3?" and more.":"."}`:t=`I can see that ${a} is a store, but I don't have detailed product information available in the structured data. The store may need to generate AI optimization data for their products.`;break;case"business":n.organization?(t=`${n.organization.name||a} is a business that ${n.organization.description?`offers ${n.organization.description.toLowerCase()}`:"operates an online store"}.`,n.organization.url&&(t+=` You can visit them at ${n.organization.url}.`)):t=`${a} appears to be an online store, but I don't have detailed business information available in the structured data. The store may need to configure their organization schema.`;break;case"categories":n.website&&n.website.potentialAction?t=`${a} has a search functionality, indicating they likely have multiple product categories. However, I don't have specific category information available in the structured data. The store may need to generate collections data.`:t=`I can see that ${a} is a store, but I don't have detailed category information available in the structured data. The store may need to generate collections data.`;break;case"contact":if(n.organization&&n.organization.contactPoint){const l=n.organization.contactPoint;t=`For ${n.organization.name||a}, you can contact them`,l.telephone&&(t+=` by phone at ${l.telephone}`),l.email&&(t+=` or by email at ${l.email}`),t+="."}else t=`I can see that ${a} is a store, but I don't have contact information available in the structured data. The store may need to configure their organization schema with contact details.`;break;default:t="I don't have enough information to provide a detailed response about this store."}I(t)},1e3)},C=async()=>{j(!0);try{console.log("[SCHEMA-DATA] loadSchemas - shop:",a);const i=`/api/schema/preview?shop=${encodeURIComponent(a)}`;console.log("[SCHEMA-DATA] loadSchemas - url:",i);const t=await b(i,{headers:{"X-Shop":a}});console.log("[SCHEMA-DATA] loadSchemas - response:",t),t.ok?(z(t.schemas),D(t.schemas)):g(`Error: ${t.error}`)}catch(i){console.error("[SCHEMA-DATA] loadSchemas - error:",i),g(`Failed to load schemas: ${i.message}`)}finally{j(!1)}},D=i=>{const t=[];i.organization&&t.push(i.organization),i.website&&t.push(i.website);const l=`<script type="application/ld+json">
${JSON.stringify(t,null,2)}
<\/script>`;M(l)},H=async()=>{j(!0);try{console.log("[SCHEMA-DATA] handleRegenerate - shop:",a);const i=`/api/schema/generate?shop=${encodeURIComponent(a)}`;console.log("[SCHEMA-DATA] handleRegenerate - url:",i);const t=await b(i,{method:"POST",headers:{"X-Shop":a},body:{shop:a}});console.log("[SCHEMA-DATA] handleRegenerate - response:",t),t.ok?(g("Schemas regenerated successfully!"),C()):g(`Error: ${t.error}`)}catch(i){console.error("[SCHEMA-DATA] handleRegenerate - error:",i),g(`Failed to regenerate: ${i.message}`)}finally{j(!1)}},O=[{id:"overview",content:"Overview",accessibilityLabel:"Overview"},{id:"installation",content:"Installation",accessibilityLabel:"Installation"},{id:"ai-testing",content:"AI Testing",accessibilityLabel:"AI Testing"}];return w?e.jsx(u,{children:e.jsx(o,{padding:"400",children:e.jsxs(r,{gap:"400",align:"center",children:[e.jsx(q,{}),e.jsx(s,{children:"Loading schema data..."})]})})}):e.jsxs(e.Fragment,{children:[e.jsx(u,{children:e.jsx(o,{padding:"400",children:e.jsxs(r,{gap:"400",children:[e.jsx(s,{as:"h3",variant:"headingMd",children:"Schema.org Structured Data"}),e.jsx(y,{tone:"info",children:e.jsx(s,{children:"Schema.org structured data helps AI models understand your store content better, improving your visibility and search results."})}),e.jsxs(L,{tabs:O,selected:x,onSelect:k,children:[x===0&&e.jsx(o,{paddingBlockStart:"400",children:e.jsxs(r,{gap:"400",children:[e.jsx(u,{children:e.jsx(o,{padding:"300",children:e.jsxs(r,{gap:"300",children:[e.jsxs(c,{align:"space-between",children:[e.jsx(s,{as:"h4",variant:"headingSm",children:"Organization Schema"}),e.jsx(A,{tone:n.organization?"success":"warning",children:n.organization?"Active":"Not configured"})]}),!n.organization&&e.jsx(s,{as:"p",tone:"subdued",children:"Configure organization details in Store Metadata to enable this schema."})]})})}),e.jsx(u,{children:e.jsx(o,{padding:"300",children:e.jsxs(r,{gap:"300",children:[e.jsxs(c,{align:"space-between",children:[e.jsx(s,{as:"h4",variant:"headingSm",children:"WebSite Schema"}),e.jsx(A,{tone:n.website?"success":"warning",children:n.website?"Active":"Not configured"})]}),!n.website&&e.jsx(s,{as:"p",tone:"subdued",children:"Website schema is automatically generated from your store information."})]})})}),e.jsx(u,{children:e.jsx(o,{padding:"300",children:e.jsxs(r,{gap:"300",children:[e.jsxs(c,{align:"space-between",children:[e.jsx(s,{as:"h4",variant:"headingSm",children:"Product Schemas"}),e.jsx(A,{tone:"success",children:"Auto-generated"})]}),e.jsxs(s,{tone:"subdued",children:["Product schemas are automatically generated from your AI Optimisation data when pages load.",n.products.length>0&&` ${n.products.length} products have SEO data.`]})]})})}),e.jsxs(c,{gap:"300",children:[e.jsx(d,{onClick:H,loading:w,children:"Regenerate Schemas"}),e.jsx(d,{variant:"plain",url:"https://developers.google.com/search/docs/appearance/structured-data",children:"Learn about Schema.org"})]})]})}),x===1&&e.jsx(o,{paddingBlockStart:"400",children:e.jsxs(r,{gap:"400",children:[e.jsx(u,{children:e.jsx(o,{padding:"300",children:e.jsxs(r,{gap:"300",children:[e.jsx(s,{as:"h4",variant:"headingSm",children:"Theme Installation"}),e.jsxs(h,{type:"number",children:[e.jsx(h.Item,{children:"Go to your Shopify Admin → Online Store → Themes"}),e.jsx(h.Item,{children:'Click "Actions" → "Edit code" on your current theme'}),e.jsxs(h.Item,{children:["Open the file: ",e.jsx("code",{children:"layout/theme.liquid"})]}),e.jsxs(h.Item,{children:["Add this code before the closing ",e.jsx("code",{children:"</head>"})," tag:"]})]}),e.jsx(o,{background:"bg-surface-secondary",padding:"200",borderRadius:"200",children:e.jsx("pre",{style:{fontSize:"12px",overflow:"auto",whiteSpace:"pre-wrap"},children:`{% comment %} Organization & WebSite Schema - AI SEO App {% endcomment %}
${E}

{% comment %} Product Schema - Dynamic {% endcomment %}
{% if template contains 'product' %}
  {% assign seo_bullets = product.metafields.seo_ai.bullets %}
  {% assign seo_faq = product.metafields.seo_ai.faq %}
  {% assign seo_data = product.metafields.seo_ai['seo__' | append: request.locale.iso_code] | default: product.metafields.seo_ai.seo__en %}
  
  {% if seo_data %}
    <script type="application/ld+json">
    {{ seo_data.jsonLd | json }}
    <\/script>
  {% endif %}
{% endif %}`})}),e.jsx(y,{tone:"warning",children:e.jsx(s,{children:"Always backup your theme before making changes!"})})]})})}),e.jsx(u,{children:e.jsx(o,{padding:"300",children:e.jsxs(r,{gap:"300",children:[e.jsx(s,{as:"h4",variant:"headingSm",children:"Testing Your Installation"}),e.jsxs(h,{children:[e.jsx(h.Item,{children:"After installation, visit your store's homepage and product pages"}),e.jsx(h.Item,{children:"View the page source (right-click → View Source)"}),e.jsxs(h.Item,{children:["Search for ",e.jsx("code",{children:"application/ld+json"})," to find your schemas"]}),e.jsx(h.Item,{children:"Use the Validation tab to test with Google's tools"})]})]})})})]})}),x===2&&e.jsx(o,{paddingBlockStart:"400",children:e.jsxs(r,{gap:"400",children:[e.jsx(u,{children:e.jsx(o,{padding:"300",children:e.jsxs(r,{gap:"300",children:[e.jsx(s,{as:"h4",variant:"headingSm",children:"AI Search Testing Tools"}),e.jsx(B,{label:"Test URL",value:`https://${a}`,readOnly:!0,helpText:"Use this URL to test how AI bots understand your store"}),e.jsx(W,{}),e.jsxs(r,{gap:"200",children:[e.jsxs(c,{align:"space-between",children:[e.jsx(s,{children:"Perplexity AI Search"}),e.jsx(d,{url:`https://www.perplexity.ai/search?q=What+products+does+${a}+sell%3F+Tell+me+about+this+business+and+what+they+offer`,external:!0,variant:"plain",children:"Test with Prompt"})]}),e.jsxs(c,{align:"space-between",children:[e.jsx(s,{children:"ChatGPT Web Search"}),e.jsx(d,{url:"https://chat.openai.com/",external:!0,variant:"plain",children:"Test with Prompt"})]}),e.jsxs(c,{align:"space-between",children:[e.jsx(s,{children:"Claude AI Search"}),e.jsx(d,{url:"https://claude.ai/",external:!0,variant:"plain",children:"Test with Prompt"})]}),e.jsxs(c,{align:"space-between",children:[e.jsx(s,{children:"Gemini AI Search"}),e.jsx(d,{url:"https://gemini.google.com/",external:!0,variant:"plain",children:"Test with Prompt"})]})]}),e.jsx(y,{tone:"info",children:e.jsxs(s,{children:[e.jsx("strong",{children:"Pre-filled prompts:"}),' Click "Test with Prompt" to open AI tools with pre-filled questions about your store. For ChatGPT, Claude, and Gemini, copy this prompt: "What products does ',a,' sell? Tell me about this business and what they offer."']})})]})})}),e.jsx(u,{children:e.jsx(o,{padding:"300",children:e.jsxs(r,{gap:"300",children:[e.jsx(s,{as:"h4",variant:"headingSm",children:"AI Search Simulation"}),e.jsx(s,{variant:"bodyMd",tone:"subdued",children:"Test how AI bots would respond to questions about your store based on your structured data."}),e.jsxs(r,{gap:"200",children:[e.jsxs(c,{align:"space-between",children:[e.jsx(s,{children:"What products does this store sell?"}),e.jsx(d,{onClick:()=>S("products"),variant:"plain",children:"Simulate Response"})]}),e.jsxs(c,{align:"space-between",children:[e.jsx(s,{children:"Tell me about this business"}),e.jsx(d,{onClick:()=>S("business"),variant:"plain",children:"Simulate Response"})]}),e.jsxs(c,{align:"space-between",children:[e.jsx(s,{children:"What categories does this store have?"}),e.jsx(d,{onClick:()=>S("categories"),variant:"plain",children:"Simulate Response"})]}),e.jsxs(c,{align:"space-between",children:[e.jsx(s,{children:"What is this store's contact information?"}),e.jsx(d,{onClick:()=>S("contact"),variant:"plain",children:"Simulate Response"})]})]}),T&&e.jsxs(o,{background:"bg-surface-secondary",padding:"300",borderRadius:"200",children:[e.jsx(s,{variant:"bodyMd",fontWeight:"semibold",children:"AI Bot Response:"}),e.jsx(o,{paddingBlockStart:"200",children:e.jsx(s,{variant:"bodyMd",children:T})})]})]})})})]})})]})]})})}),v&&e.jsx(F,{content:v,onDismiss:()=>g("")})]})}export{X as default};
