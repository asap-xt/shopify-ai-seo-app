import{_ as Z,t as X,c as he,a as v,M as q,h as ye,e as be,P as _e,C as Ae,W as me}from"./index-CxfVzI2Z-1757507544602.js";function Oe(e,n){for(var c=0;c<n.length;c++){const u=n[c];if(typeof u!="string"&&!Array.isArray(u)){for(const i in u)if(i!=="default"&&!(i in e)){const a=Object.getOwnPropertyDescriptor(u,i);a&&Object.defineProperty(e,i,a.get?a:{enumerable:!0,get:()=>u[i]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}var x={exports:{}},ee={},U={},k={},W={};Object.defineProperty(W,"__esModule",{value:!0});W.mockAppBridge=W.serverAppBridge=void 0;var R=Z,B=function(){},Y=new Promise(function(){});W.serverAppBridge={dispatch:function(){return{}},error:function(){return B},featuresAvailable:function(){return Promise.reject(R.fromAction("Feature detection is only available on the client side.",R.AppActionType.WINDOW_UNDEFINED))},getState:function(){return Promise.reject(R.fromAction("State is only available on the client side.",R.AppActionType.WINDOW_UNDEFINED))},localOrigin:"",hostOrigin:"",subscribe:function(){return B}};W.mockAppBridge={dispatch:function(){return{}},error:function(){return B},featuresAvailable:function(){return Y},getState:function(){return Y},localOrigin:"",hostOrigin:"",subscribe:function(){return B}};var H={},y={};Object.defineProperty(y,"__esModule",{value:!0});y.getWindow=y.getLocation=y.redirect=y.shouldRedirect=void 0;function Pe(e){return e===window}y.shouldRedirect=Pe;function we(e){var n=re();n&&n.assign(e)}y.redirect=we;function re(){return te()?window.location:void 0}y.getLocation=re;function je(){return te()?window:void 0}y.getWindow=je;function te(){return typeof window<"u"}Object.defineProperty(H,"__esModule",{value:!0});H.handleAppPrint=void 0;var ne=y;function We(){return navigator.userAgent.indexOf("iOS")>=0}function De(){var e=ne.getWindow();if(!(!e||!e.document||!e.document.body)){var n=e.document.createElement("input");return n.style.display="none",e.document.body.appendChild(n),n}}function ie(){var e;(e=ne.getWindow())===null||e===void 0||e.print()}function Ce(){var e=De();e&&(e.select(),ie(),e.remove())}function Ee(){We()?Ce():ie()}H.handleAppPrint=Ee;var $={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.isV1Config=e.MessageType=e.LifecycleHook=e.PermissionType=void 0;var n=X;Object.defineProperty(e,"MessageType",{enumerable:!0,get:function(){return n.MessageType}});var c=X;Object.defineProperty(e,"PermissionType",{enumerable:!0,get:function(){return c.PermissionType}}),Object.defineProperty(e,"LifecycleHook",{enumerable:!0,get:function(){return c.LifecycleHook}});function u(i){return!i.host}e.isV1Config=u})($);var z={},oe={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.removeFromCollection=e.addAndRemoveFromCollection=void 0;var n=he;Object.defineProperty(e,"addAndRemoveFromCollection",{enumerable:!0,get:function(){return n.addAndRemoveFromCollection}}),Object.defineProperty(e,"removeFromCollection",{enumerable:!0,get:function(){return n.removeFromCollection}})})(oe);Object.defineProperty(z,"__esModule",{value:!0});var Ie=oe,Me=function(){function e(){this.map={}}return e.prototype.set=function(n,c){Object.prototype.hasOwnProperty.call(this.map,n)||(this.map[n]=[]);var u={handler:c,remove:function(){}},i=Ie.addAndRemoveFromCollection(this.map[n],u);return u={handler:c,remove:i},i},e.prototype.get=function(n){var c=this.map[n];return c?c.map(function(u){return u.handler}):void 0},e.prototype.run=function(n,c,u){for(var i=[],a=3;a<arguments.length;a++)i[a-3]=arguments[a];var t=0,p=this.get(n)||[];function D(){for(var P=[],w=0;w<arguments.length;w++)P[w]=arguments[w];var N=p[t++];return N?N(D).apply(u,P):c.apply(u,P)}return D.apply(u,i)},e}();z.default=Me;(function(e){var n=v&&v.__assign||function(){return n=Object.assign||function(r){for(var o,f=1,l=arguments.length;f<l;f++){o=arguments[f];for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(r[s]=o[s])}return r},n.apply(this,arguments)},c=v&&v.__spreadArray||function(r,o){for(var f=0,l=o.length,s=r.length;f<l;f++,s++)r[s]=o[f];return r},u=v&&v.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(e,"__esModule",{value:!0}),e.createApp=e.createAppWrapper=e.createClientApp=e.WINDOW_UNDEFINED_MESSAGE=void 0;var i=ye,a=_e,t=Z,p=q,D=W,P=be,w=Ae,N=me,ae=H,C=y,E=$,ce=u(z);e.WINDOW_UNDEFINED_MESSAGE="window is not defined. Running an app outside a browser is not supported";function ue(r,o){var f=o.apiKey,l=o.host,s=o.forceRedirect,m=s===void 0?!P.isDevelopmentClient:s,h=C.getLocation();if(P.isUnframed||!h||!f||!l||!m||!C.shouldRedirect(r))return!1;var I="https://"+l+"/apps/"+f+h.pathname+(h.search||"");return C.redirect(I),!0}var fe=function(r){return function(o){return r(n(n({},o),{version:i.getVersion(),clientInterface:{name:i.getPackageName(),version:i.getVersion()}}))}},pe=function(r){r.set(E.LifecycleHook.DispatchAction,fe)};function le(r){r.subscribe(a.Action.APP,ae.handleAppPrint),r.dispatch(w.initialize());try{N.initializeWebVitals(r)}catch(o){console.error("App-Bridge failed to initialize web-vitals",o)}}var de=function(r,o){o===void 0&&(o=[]);var f=[],l=p.createTransportListener(),s=function(m){var h=m.data,I=h.type,b=h.payload;switch(I){case"getState":{var S=f.splice(0);S.forEach(function(T){return T(b)});break}case"dispatch":{l.handleMessage(b);var F=l.handleActionDispatch(b);if(F)return;var L=i.findMatchInEnum(t.Action,b.type);L&&t.throwError(L,b);break}}};return r.subscribe(s),function(m){var h=se(m),I=ue(r.hostFrame,h);if(I)return D.mockAppBridge;var b=ve(r,h),S=l.createSubscribeHandler(b);b(E.MessageType.Unsubscribe);function F(d){return b(E.MessageType.Dispatch,d),d}for(var L=new URL("https://"+h.host).origin,T=new ce.default,O={hostOrigin:L,localOrigin:r.localOrigin,hooks:T,dispatch:function(d){return O.hooks?O.hooks.run(E.LifecycleHook.DispatchAction,F,O,d):F(d)},featuresAvailable:function(){for(var d=[],_=0;_<arguments.length;_++)d[_]=arguments[_];var g=d[0],A=Array.isArray(g)?c([],g):d;return O.getState("features").then(function(j){return A.length?A.reduce(function(M,G){return Object.keys(j).includes(G)&&(M[G]=j[G]),M},{}):j})},getState:function(d){return d&&typeof d!="string"?Promise.resolve(void 0):new Promise(function(_){f.push(_),b(E.MessageType.GetState)}).then(function(_){var g=_;if(d)for(var A=0,j=d.split(".");A<j.length;A++){var M=j[A];if(g==null||typeof g!="object"||Array.isArray(g)||!Object.keys(g).includes(M))return;g=g[M]}return g})},subscribe:S,error:function(d,_){var g=[];return i.forEachInEnum(t.Action,function(A){g.push(S(A,d,_))}),function(){g.forEach(function(A){return A()})}}},V=0,Q=o;V<Q.length;V++){var ge=Q[V];ge(T,O)}return le(O),O}};e.createClientApp=de;function se(r){var o;if(!r.host)throw t.fromAction("host must be provided",t.AppActionType.INVALID_CONFIG);if(!r.apiKey)throw t.fromAction("apiKey must be provided",t.AppActionType.INVALID_CONFIG);try{var f=atob((o=r.host)===null||o===void 0?void 0:o.replace(/_/g,"/").replace(/-/g,"+"));return n(n({},r),{host:f})}catch{var l="not a valid host, please use the value provided by Shopify";throw t.fromAction(l,t.AppActionType.INVALID_CONFIG)}}function K(r,o,f){if(f===void 0&&(f=[]),!r)throw t.fromAction(e.WINDOW_UNDEFINED_MESSAGE,t.AppActionType.WINDOW_UNDEFINED);var l=C.getLocation(),s=o||l&&l.origin;if(!s)throw t.fromAction("local origin cannot be blank",t.AppActionType.MISSING_LOCAL_ORIGIN);var m=p.fromWindow(r,s),h=e.createClientApp(m,c([pe],f));return h}e.createAppWrapper=K;function J(r){var o=C.getWindow();return!o||!o.top?D.serverAppBridge:K(o.top)(r)}e.createApp=J;function ve(r,o){return function(f,l){r.dispatch({payload:l,source:o,type:f})}}e.default=J})(k);(function(e){var n=v&&v.__createBinding||(Object.create?function(i,a,t,p){p===void 0&&(p=t),Object.defineProperty(i,p,{enumerable:!0,get:function(){return a[t]}})}:function(i,a,t,p){p===void 0&&(p=t),i[p]=a[t]}),c=v&&v.__exportStar||function(i,a){for(var t in i)t!=="default"&&!Object.prototype.hasOwnProperty.call(a,t)&&n(a,i,t)};Object.defineProperty(e,"__esModule",{value:!0});var u=k;c($,e),c(k,e),e.default=u.createClientApp})(U);(function(e){var n=v&&v.__createBinding||(Object.create?function(i,a,t,p){p===void 0&&(p=t),Object.defineProperty(i,p,{enumerable:!0,get:function(){return a[t]}})}:function(i,a,t,p){p===void 0&&(p=t),i[p]=a[t]}),c=v&&v.__exportStar||function(i,a){for(var t in i)t!=="default"&&!Object.prototype.hasOwnProperty.call(a,t)&&n(a,i,t)};Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var u=U;Object.defineProperty(e,"default",{enumerable:!0,get:function(){return u.createApp}}),c(q,e),c(U,e)})(ee);x.exports=ee;var Ne=x.exports;const Fe=Oe({__proto__:null},[Ne]);export{Fe as i};
