function h(c=!0){return c&&console.log("[SFETCH] Creating session fetch for App Bridge v4"),async(n,i={})=>{console.log("[SFETCH] Fetching:",n,i);const{method:u="GET",headers:l={},body:o,responseType:p,...f}=i,g={method:u,headers:{"Content-Type":"application/json",...l},credentials:"include",body:o?typeof o=="string"?o:JSON.stringify(o):void 0},s=await fetch(n,g);console.log("[SFETCH] Response:",s.status,s.statusText);let e;if(p==="text")e=await s.text();else{const t=await s.text();try{e=t?JSON.parse(t):null}catch{e={error:(t==null?void 0:t.slice(0,500))||"Non-JSON response"}}}if(!s.ok){if(s.status===402&&e){const r=new Error(e.error||e.message||"Payment Required");throw r.status=402,Object.assign(r,e),r}const t=(e==null?void 0:e.error)||(e==null?void 0:e.message)||`HTTP ${s.status}`,a=new Error(t);throw a.status=s.status,a}return e}}export{h as m};
