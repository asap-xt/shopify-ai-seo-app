import{r as e,j as t,R as n}from"./react-vendor-BLtYaay5.js";import{m as s}from"./sessionFetch-D9zn2iVF.js";import{I as i,T as o}from"./TrialActivationModal-CmZNJenq.js";import{T as a}from"./TokenPurchaseModal-ChVK648j.js";import{A as r}from"./AIEOScoreCard-Bx9NX2zA.js";import{g as l}from"./usePlanHierarchy-CpsbOjPs.js";import{a as d,d as c,T as u,L as h,C as g,B as p,I as x,b as m,e as j,f as b,D as v,h as y,n as S,M as f}from"./polaris-BgbORwUH.js";import"./app-bridge-DUY42B6P.js";import"./vendor-L4_WdQez.js";import"./index-SIhijMOo.js";function w({shop:w}){var k,A,P,C,I,R;const D=w||((e,t="")=>{try{return new URLSearchParams(window.location.search).get(e)||t}catch{return t}})("shop",""),M=e=>{const t=new URLSearchParams(window.location.search),n=t.toString()?`?${t.toString()}`:"";window.location.href=`${e}${n}`},[T,$]=e.useState(""),U=e.useMemo(()=>s(),[]),[O,q]=e.useState(null),[J,z]=e.useState(""),[E,L]=e.useState(!1),[B,F]=e.useState(null),[W,N]=e.useState(""),[G,H]=e.useState(!1),[Q,Y]=e.useState(!1),[_,V]=e.useState(!1),[K,X]=e.useState(!1),[Z,ee]=e.useState(null),[te,ne]=e.useState(!1),[se,ie]=e.useState(null),[oe,ae]=e.useState({}),[re,le]=e.useState(!1),[de,ce]=e.useState(0),[ue,he]=e.useState({}),[ge,pe]=e.useState(!1),[xe,me]=e.useState(0),[je,be]=e.useState(null),[ve,ye]=e.useState(null),[Se,fe]=e.useState(null),[we,ke]=e.useState({totalProducts:0,optimizedProducts:0,totalCollections:0,optimizedCollections:0}),[Ae,Pe]=e.useState(""),[Ce,Ie]=e.useState(""),[Re,De]=e.useState(null),[Me,Te]=e.useState(null),[$e,Ue]=e.useState([]),[Oe,qe]=e.useState(null),[Je,ze]=e.useState(null),[Ee,Le]=e.useState([]),[Be,Fe]=e.useState(null),[We,Ne]=e.useState(""),[Ge,He]=e.useState(""),[Qe,Ye]=e.useState(null),[_e,Ve]=e.useState(null),[Ke,Xe]=e.useState(new Set),[Ze,et]=e.useState({}),[tt,nt]=e.useState(()=>{try{return"true"===localStorage.getItem(`dismissedReviewBanner_${D}`)}catch{return!1}}),[st,it]=e.useState(()=>{try{return"true"===localStorage.getItem(`clickedReviewRate_${D}`)}catch{return!1}}),[ot,at]=e.useState(["","",""]),[rt,lt]=e.useState(null),[dt,ct]=e.useState(!1);e.useEffect(()=>{D&&(xt(),mt(),jt(),pt(),ut(),ht())},[D,U]);const ut=async()=>{var e;try{const t=await U(`/api/ai-testing/available-bots?shop=${D}`);Ue(t.bots||[]);const n=null==(e=t.bots)?void 0:e.find(e=>e.available);n&&!Oe&&qe(n.id)}catch(t){}},ht=async()=>{try{const e=await U(`/api/ai-testing/store-insights?shop=${D}`);ze(e),Le(e.prompts||[])}catch(e){}},gt=async(e=null,t=null,n=null)=>{if(!Oe)return void $("Please select an AI model first");const s=e||(null==Be?void 0:Be.question)||We;if(s){Xe(e=>new Set([...e,t])),Ye(null),Ve(null);try{const i=await U("/api/ai-testing/run-bot-test",{method:"POST",body:{shop:D,botId:Oe,prompt:s,customPrompt:e?null:We||null}});i.success?(Ye(i),Ve(i.usage),n&&et(e=>({...e,[n]:{promptId:t,response:i.response,bot:i.bot,usage:i.usage}})),mt()):$(i.error||"Test failed")}catch(i){if(402===i.status)return i.trialRestriction&&i.requiresActivation?(ee(i),V(!0)):i.requiresPurchase&&(ee(i),Y(!0)),void Ye(null);if(403===i.status)return void $(`${i.requiredPlan||"Higher"} plan required for this bot`);$("Failed to run AI bot test")}finally{Xe(e=>{const n=new Set(e);return n.delete(t),n})}}else $("Please select or enter a question")},pt=()=>{try{const e=localStorage.getItem(`ai-test-results-${D}`);if(e){const t=JSON.parse(e);t.results&&t.timestamp&&(ae(t.results),De(new Date(t.timestamp)))}const t=localStorage.getItem(`ai-validation-results-${D}`);if(t){const e=JSON.parse(t);e.results&&he(e.results),e.timestamp&&Te(new Date(e.timestamp))}}catch(e){}};e.useEffect(()=>{const e=()=>{!document.hidden&&D&&mt()};return document.addEventListener("visibilitychange",e),()=>{document.removeEventListener("visibilitychange",e)}},[D,U]);const xt=async()=>{var e,t,n;try{const s=await U(`/api/billing/info?shop=${D}`),i=(null==(e=null==s?void 0:s.subscription)?void 0:e.plan)||"Starter";q(i),be((null==(t=null==s?void 0:s.tokens)?void 0:t.balance)||0),ye((null==(n=null==s?void 0:s.subscription)?void 0:n.trialEndsAt)||null)}catch(s){q("Starter"),be(0)}},mt=async()=>{var e,t;try{const n=await U(`/api/billing/info?shop=${D}`);be((null==(e=null==n?void 0:n.tokens)?void 0:e.balance)||0),ye((null==(t=null==n?void 0:n.subscription)?void 0:t.trialEndsAt)||null)}catch(n){}},jt=async()=>{var e,t,n,s,i,o;try{let r=null,l=!1;try{const e=localStorage.getItem(`dashboard-stats-${D}`);if(e){const t=JSON.parse(e);(t.timestamp?Date.now()-new Date(t.timestamp).getTime():1/0)<3e5&&(r=t,t.storeUrl||(l=!0))}}catch(a){}if(!r||l){const l=await U(`/api/dashboard/stats?shop=${D}`);r={totalProducts:(null==(e=null==l?void 0:l.products)?void 0:e.total)||0,optimizedProducts:(null==(t=null==l?void 0:l.products)?void 0:t.optimized)||0,totalCollections:(null==(n=null==l?void 0:l.collections)?void 0:n.total)||0,optimizedCollections:(null==(s=null==l?void 0:l.collections)?void 0:s.optimized)||0,storeName:(null==(i=null==l?void 0:l.store)?void 0:i.name)||"",storeUrl:(null==(o=null==l?void 0:l.store)?void 0:o.primaryDomain)||"",timestamp:(new Date).toISOString()};try{localStorage.setItem(`dashboard-stats-${D}`,JSON.stringify(r))}catch(a){}}ke({totalProducts:r.totalProducts||0,optimizedProducts:r.optimizedProducts||0,totalCollections:r.totalCollections||0,optimizedCollections:r.optimizedCollections||0}),r.storeUrl&&Pe(r.storeUrl),r.storeName&&Ie(r.storeName)}catch(a){}},bt=e.useMemo(()=>!tt&&!st&&(Se||0)>50,[tt,st,Se]);return t.jsxs(t.Fragment,{children:[t.jsxs(d,{gap:"400",children:[t.jsx(c,{tone:"info",children:t.jsx(u,{children:"Test how AI models discover and understand your store content. Check if your structured data and AI Discovery features are working correctly."})}),t.jsx(r,{testResults:oe,aiTestResults:ue,stats:we,onScoreCalculated:e=>fe(e)}),bt&&t.jsx(c,{title:"Help shape the future of AI Search",tone:"success",action:{content:"Rate indexAIze",onAction:()=>{try{localStorage.setItem(`clickedReviewRate_${D}`,"true"),it(!0),window.open("https://apps.shopify.com/indexaize-unlock-ai-search#modal-show=WriteReviewModal","_blank")}catch(e){}}},onDismiss:()=>{try{localStorage.setItem(`dismissedReviewBanner_${D}`,"true"),nt(!0)}catch(e){}},children:t.jsx(u,{children:"You've successfully optimized your store for AI engines. Your feedback helps us build better tools for the Shopify community."})}),t.jsxs(h,{children:[t.jsx(h.Section,{variant:"oneHalf",children:t.jsx(g,{children:t.jsx(p,{padding:"300",children:t.jsxs(d,{gap:"400",children:[t.jsxs(x,{align:"space-between",blockAlign:"center",children:[t.jsxs(d,{gap:"100",children:[t.jsx(u,{as:"h3",variant:"headingMd",children:"Basic GEO Tests"}),t.jsx(u,{variant:"bodySm",tone:"subdued",children:"Quick check if endpoints are accessible and returning data"})]}),t.jsx(m,{onClick:async()=>{le(!0),ce(0),ae({});try{const e=await U("/api/ai-testing/run-tests",{method:"POST",body:{shop:D}});e.results?(ae(e.results),ce(100),(e=>{try{const t={results:e,timestamp:(new Date).toISOString()};localStorage.setItem(`ai-test-results-${D}`,JSON.stringify(t)),De(new Date)}catch(t){}})(e.results),$("Basic tests completed!")):$("Testing failed. Please try again.")}catch(e){$("Failed to run tests. Please try again.")}finally{le(!1)}},loading:re,disabled:re,children:re?"Testing...":"Run Basic Tests"})]}),Re&&Object.keys(oe).length>0&&!re&&t.jsx(c,{tone:"info",children:t.jsxs(u,{variant:"bodySm",children:["These results are from ",Re.toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),". Run Basic Tests again to refresh."]})}),re&&t.jsx(p,{children:t.jsxs(d,{gap:"200",children:[t.jsx(u,{variant:"bodySm",children:"Testing endpoints..."}),t.jsx(j,{progress:de,size:"small"})]})}),Object.keys(oe).length>0&&t.jsx(d,{gap:"300",children:Object.entries(oe).map(([e,s],i)=>{const o=i===Object.entries(oe).length-1;return t.jsxs(n.Fragment,{children:[t.jsx(x,{align:"space-between",blockAlign:"center",children:t.jsxs(d,{gap:"100",children:[t.jsxs(x,{gap:"200",blockAlign:"center",children:[t.jsx(u,{variant:"bodyMd",fontWeight:"semibold",children:s.name}),"success"===s.status&&t.jsx(b,{tone:"success",children:"OK"}),"fair"===s.status&&t.jsx(b,{tone:"info",children:"Fair"}),"poor"===s.status&&t.jsx(b,{tone:"warning",children:"Poor"}),"warning"===s.status&&t.jsx(b,{tone:"critical",children:"Warning"}),"error"===s.status&&t.jsx(b,{tone:"critical",children:"Failed"}),"locked"===s.status&&t.jsx(b,{children:"Locked"})]}),t.jsx(u,{variant:"bodySm",tone:"subdued",children:s.message}),s.actionLink&&t.jsx(m,{size:"slim",onClick:()=>M(s.actionLink),children:"basicSitemap"===e?"Go to Sitemap":"aiSitemap"===e?"Go to Settings":"Go"})]})}),!o&&t.jsx(v,{})]},e)})}),0===Object.keys(oe).length&&!re&&t.jsx(c,{tone:"info",children:t.jsx(u,{children:'Click "Run Basic Tests" to check if your AI Discovery endpoints are configured correctly.'})})]})})})}),t.jsx(h.Section,{variant:"oneHalf",children:t.jsx(g,{children:t.jsx(p,{padding:"300",children:t.jsxs(d,{gap:"400",children:[t.jsxs(x,{align:"space-between",blockAlign:"center",children:[t.jsxs(d,{gap:"100",children:[t.jsx(u,{as:"h3",variant:"headingMd",children:"AI-Powered Validation"}),t.jsx(u,{variant:"bodySm",tone:"subdued",children:"Deep analysis with AI bot"}),O&&t.jsx(u,{variant:"bodySm",tone:"subdued",children:"Requires: Professional+ plan & pay-per-use tokens"})]}),t.jsx(m,{onClick:async()=>{if(l(O)<1)return ee({message:"AI-powered validation requires Professional plan or higher",requiredPlan:"Professional",currentPlan:O||"Starter"}),void H(!0);pe(!0),me(0),he({});try{const t=await U("/api/ai-testing/ai-validate",{method:"POST",body:{shop:D,endpointResults:oe}});if(t&&t.results){he(t.results),me(100);try{const e={results:t.results,timestamp:(new Date).toISOString()};localStorage.setItem(`ai-validation-results-${D}`,JSON.stringify(e)),Te(new Date)}catch(e){}if(t.aiEOScore){const e=t.aiEOScore;fe(e),$(`AI validation completed! Score: ${e.score||"N/A"}/100 (${t.tokensUsed||0} tokens used)`)}else fe(null),$(`AI validation completed! (${t.tokensUsed||0} tokens used)`);mt()}else fe(null),$("AI validation failed. Please try again.")}catch(t){if(402===t.status){if(t.trialRestriction&&t.requiresActivation)return ee(t),void V(!0);if(t.requiresUpgrade)return ee(t),void H(!0);if(t.requiresPurchase)return ee(t),void Y(!0)}$("Failed to run AI validation. Please try again.")}finally{pe(!1)}},loading:ge,disabled:ge||0===Object.keys(oe).length,variant:"primary",children:ge?"Validating...":"Test with AI Bot"})]}),Me&&Object.keys(ue).length>0&&!ge&&t.jsx(c,{tone:"info",children:t.jsxs(u,{variant:"bodySm",children:["These results are from ",Me.toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),". Test with AI Bot again to refresh."]})}),ge&&t.jsx(p,{children:t.jsxs(d,{gap:"200",children:[t.jsx(u,{variant:"bodySm",children:"AI is analyzing your endpoints..."}),t.jsx(j,{progress:xe,size:"small",tone:"primary"})]})}),Object.keys(ue).length>0&&t.jsxs(d,{gap:"300",children:[ue.productsJson&&t.jsxs(t.Fragment,{children:[t.jsx(x,{align:"space-between",blockAlign:"center",children:t.jsxs(d,{gap:"100",children:[t.jsxs(x,{gap:"200",blockAlign:"center",children:[t.jsx(u,{variant:"bodyMd",fontWeight:"semibold",children:"Products JSON Feed"}),"excellent"===ue.productsJson.rating&&t.jsx(b,{tone:"success",children:"Excellent"}),"good"===ue.productsJson.rating&&t.jsx(b,{tone:"success",children:"Good"}),"fair"===ue.productsJson.rating&&t.jsx(b,{tone:"warning",children:"Fair"}),"poor"===ue.productsJson.rating&&t.jsx(b,{tone:"critical",children:"Poor"}),"locked"===ue.productsJson.rating&&t.jsx(b,{children:"ðŸ”’ Locked"}),"unavailable"===ue.productsJson.rating&&t.jsx(b,{tone:"critical",children:"âŒ Unavailable"})]}),t.jsx(u,{variant:"bodySm",children:ue.productsJson.feedback}),ue.productsJson.suggestions&&t.jsxs(u,{variant:"bodySm",tone:"subdued",children:["ðŸ’¡ ",ue.productsJson.suggestions]})]})}),t.jsx(v,{})]}),ue.storeMetadata&&t.jsxs(t.Fragment,{children:[t.jsx(x,{align:"space-between",blockAlign:"center",children:t.jsxs(d,{gap:"100",children:[t.jsxs(x,{gap:"200",blockAlign:"center",children:[t.jsx(u,{variant:"bodyMd",fontWeight:"semibold",children:"Store Metadata"}),"excellent"===ue.storeMetadata.rating&&t.jsx(b,{tone:"success",children:"Excellent"}),"good"===ue.storeMetadata.rating&&t.jsx(b,{tone:"success",children:"Good"}),"fair"===ue.storeMetadata.rating&&t.jsx(b,{tone:"warning",children:"Fair"}),"poor"===ue.storeMetadata.rating&&t.jsx(b,{tone:"critical",children:"Poor"}),"locked"===ue.storeMetadata.rating&&t.jsx(b,{children:"ðŸ”’ Locked"}),"unavailable"===ue.storeMetadata.rating&&t.jsx(b,{tone:"critical",children:"âŒ Unavailable"})]}),t.jsx(u,{variant:"bodySm",children:ue.storeMetadata.feedback}),ue.storeMetadata.suggestions&&t.jsxs(u,{variant:"bodySm",tone:"subdued",children:["ðŸ’¡ ",ue.storeMetadata.suggestions]})]})}),t.jsx(v,{})]}),ue.welcomePage&&t.jsxs(t.Fragment,{children:[t.jsx(x,{align:"space-between",blockAlign:"center",children:t.jsxs(d,{gap:"100",children:[t.jsxs(x,{gap:"200",blockAlign:"center",children:[t.jsx(u,{variant:"bodyMd",fontWeight:"semibold",children:"AI Welcome Page"}),"excellent"===ue.welcomePage.rating&&t.jsx(b,{tone:"success",children:"Excellent"}),"good"===ue.welcomePage.rating&&t.jsx(b,{tone:"success",children:"Good"}),"fair"===ue.welcomePage.rating&&t.jsx(b,{tone:"warning",children:"Fair"}),"poor"===ue.welcomePage.rating&&t.jsx(b,{tone:"critical",children:"Poor"}),"locked"===ue.welcomePage.rating&&t.jsx(b,{children:"ðŸ”’ Locked"}),"unavailable"===ue.welcomePage.rating&&t.jsx(b,{tone:"critical",children:"âŒ Unavailable"})]}),t.jsx(u,{variant:"bodySm",children:ue.welcomePage.feedback}),ue.welcomePage.suggestions&&t.jsxs(u,{variant:"bodySm",tone:"subdued",children:["ðŸ’¡ ",ue.welcomePage.suggestions]})]})}),t.jsx(v,{})]}),ue.collectionsJson&&t.jsxs(t.Fragment,{children:[t.jsx(x,{align:"space-between",blockAlign:"center",children:t.jsxs(d,{gap:"100",children:[t.jsxs(x,{gap:"200",blockAlign:"center",children:[t.jsx(u,{variant:"bodyMd",fontWeight:"semibold",children:"Collections JSON Feed"}),"excellent"===ue.collectionsJson.rating&&t.jsx(b,{tone:"success",children:"Excellent"}),"good"===ue.collectionsJson.rating&&t.jsx(b,{tone:"success",children:"Good"}),"fair"===ue.collectionsJson.rating&&t.jsx(b,{tone:"warning",children:"Fair"}),"poor"===ue.collectionsJson.rating&&t.jsx(b,{tone:"critical",children:"Poor"}),"locked"===ue.collectionsJson.rating&&t.jsx(b,{children:"ðŸ”’ Locked"}),"unavailable"===ue.collectionsJson.rating&&t.jsx(b,{tone:"critical",children:"âŒ Unavailable"})]}),t.jsx(u,{variant:"bodySm",children:ue.collectionsJson.feedback}),ue.collectionsJson.suggestions&&t.jsxs(u,{variant:"bodySm",tone:"subdued",children:["ðŸ’¡ ",ue.collectionsJson.suggestions]})]})}),t.jsx(v,{})]}),ue.aiSitemap&&t.jsxs(t.Fragment,{children:[t.jsx(x,{align:"space-between",blockAlign:"center",children:t.jsxs(d,{gap:"100",children:[t.jsxs(x,{gap:"200",blockAlign:"center",children:[t.jsx(u,{variant:"bodyMd",fontWeight:"semibold",children:"AI-Enhanced Sitemap"}),"excellent"===ue.aiSitemap.rating&&t.jsx(b,{tone:"success",children:"Excellent"}),"good"===ue.aiSitemap.rating&&t.jsx(b,{tone:"success",children:"Good"}),"fair"===ue.aiSitemap.rating&&t.jsx(b,{tone:"warning",children:"Fair"}),"poor"===ue.aiSitemap.rating&&t.jsx(b,{tone:"critical",children:"Poor"}),"locked"===ue.aiSitemap.rating&&t.jsx(b,{children:"ðŸ”’ Locked"}),"unavailable"===ue.aiSitemap.rating&&t.jsx(b,{tone:"critical",children:"âŒ Unavailable"})]}),t.jsx(u,{variant:"bodySm",children:ue.aiSitemap.feedback}),ue.aiSitemap.suggestions&&t.jsxs(u,{variant:"bodySm",tone:"subdued",children:["ðŸ’¡ ",ue.aiSitemap.suggestions]})]})}),t.jsx(v,{})]}),ue.schemaData&&t.jsx(x,{align:"space-between",blockAlign:"center",children:t.jsxs(d,{gap:"100",children:[t.jsxs(x,{gap:"200",blockAlign:"center",children:[t.jsx(u,{variant:"bodyMd",fontWeight:"semibold",children:"Advanced Schema Data"}),"excellent"===ue.schemaData.rating&&t.jsx(b,{tone:"success",children:"Excellent"}),"good"===ue.schemaData.rating&&t.jsx(b,{tone:"success",children:"Good"}),"fair"===ue.schemaData.rating&&t.jsx(b,{tone:"warning",children:"Fair"}),"poor"===ue.schemaData.rating&&t.jsx(b,{tone:"critical",children:"Poor"}),"locked"===ue.schemaData.rating&&t.jsx(b,{children:"ðŸ”’ Locked"}),"unavailable"===ue.schemaData.rating&&t.jsx(b,{tone:"critical",children:"âŒ Unavailable"})]}),t.jsx(u,{variant:"bodySm",children:ue.schemaData.feedback}),ue.schemaData.suggestions&&t.jsxs(u,{variant:"bodySm",tone:"subdued",children:["ðŸ’¡ ",ue.schemaData.suggestions]})]})})]}),0===Object.keys(ue).length&&!ge&&t.jsx(c,{tone:"info",children:t.jsx(u,{children:0===Object.keys(oe).length?"Run Basic Tests first, then use AI validation for deep analysis":'Click "Test with AI Bot" to get AI-powered feedback on your endpoint data quality'})}),!O&&t.jsx(c,{tone:"warning",children:t.jsx(u,{children:"Loading plan information..."})})]})})})})]}),t.jsx(g,{children:t.jsx(p,{padding:"400",children:t.jsxs(d,{gap:"400",children:[t.jsxs(x,{align:"space-between",blockAlign:"center",children:[t.jsxs(d,{gap:"100",children:[t.jsx(u,{as:"h3",variant:"headingMd",children:"Select AI Model"}),t.jsx(u,{variant:"bodySm",tone:"subdued",children:"Choose which AI model to use for testing"})]}),null!==je&&t.jsxs(b,{tone:je>100?"success":je>0?"warning":"critical",children:[je.toLocaleString()," tokens"]})]}),t.jsx("div",{style:{display:"grid",gridTemplateColumns:`repeat(${Math.min($e.length||5,5)}, 1fr)`,gap:"10px"},children:$e.map(e=>t.jsx("div",{onClick:()=>e.available&&qe(e.id),style:{padding:"12px 10px",borderRadius:"8px",border:Oe===e.id?"2px solid var(--p-color-border-interactive)":"1px solid var(--p-color-border-subdued)",background:Oe===e.id?"var(--p-color-bg-surface-selected)":"var(--p-color-bg-surface)",cursor:e.available?"pointer":"not-allowed",opacity:e.available?1:.5,transition:"all 0.15s ease",position:"relative",textAlign:"center",minWidth:0},children:t.jsxs(d,{gap:"100",children:[t.jsxs(x,{align:"center",blockAlign:"center",gap:"200",children:[t.jsx(u,{variant:"bodySm",fontWeight:"semibold",children:e.name}),Oe===e.id&&e.available&&t.jsx("div",{style:{width:"18px",height:"18px",borderRadius:"50%",background:"var(--p-color-bg-fill-success)",display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontSize:"11px",flexShrink:0},children:"âœ“"})]}),!e.available&&t.jsx(b,{size:"small",children:e.requiredPlan})]})},e.id))})]})})}),t.jsx(g,{children:t.jsx(p,{padding:"400",children:t.jsxs(d,{gap:"400",children:[t.jsxs(d,{gap:"100",children:[t.jsx(u,{as:"h3",variant:"headingMd",children:"AI Data Quality"}),t.jsx(u,{variant:"bodySm",tone:"subdued",children:"Analyze how AI bots see your store's structured data"})]}),t.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(280px, 1fr))",gap:"12px"},children:Ee.filter(e=>"AI Data Quality"===e.category).map(e=>t.jsx(p,{padding:"300",background:"bg-surface-secondary",borderRadius:"200",children:t.jsxs(d,{gap:"200",children:[t.jsx(u,{variant:"bodyMd",fontWeight:"medium",children:e.description}),t.jsx(m,{size:"slim",onClick:()=>gt(e.question,e.id,"AI Data Quality"),loading:Ke.has(e.id),disabled:!Oe||Ke.has(e.id),children:Ke.has(e.id)?"Checking...":"Check"})]})},e.id))}),Ze["AI Data Quality"]&&t.jsx(p,{padding:"400",background:"bg-surface-secondary",borderRadius:"200",children:t.jsxs(d,{gap:"300",children:[t.jsxs(x,{align:"space-between",blockAlign:"center",children:[t.jsxs(u,{variant:"bodyMd",fontWeight:"semibold",children:[null==(k=Ze["AI Data Quality"].bot)?void 0:k.name," Response"]}),t.jsxs(u,{variant:"bodySm",tone:"subdued",children:[null==(P=null==(A=Ze["AI Data Quality"].usage)?void 0:A.tokensUsed)?void 0:P.toLocaleString()," tokens"]})]}),t.jsx("div",{style:{maxHeight:"400px",overflowY:"auto",whiteSpace:"pre-wrap",lineHeight:"1.6",padding:"12px",backgroundColor:"var(--p-color-bg-surface)",borderRadius:"8px",fontSize:"14px"},children:Ze["AI Data Quality"].response}),t.jsxs(x,{align:"end",gap:"200",children:[t.jsx(m,{size:"slim",onClick:()=>{navigator.clipboard.writeText(Ze["AI Data Quality"].response),$("Response copied to clipboard")},children:"Copy"}),t.jsx(m,{size:"slim",onClick:()=>et(e=>{const t={...e};return delete t["AI Data Quality"],t}),children:"Close"})]})]})})]})})}),t.jsx(g,{children:t.jsx(p,{padding:"400",children:t.jsxs(d,{gap:"400",children:[t.jsxs(d,{gap:"100",children:[t.jsx(u,{as:"h3",variant:"headingMd",children:"AI Shopping Assistant"}),t.jsx(u,{variant:"bodySm",tone:"subdued",children:"Ask anything about your store - see how AI helps customers find products and answers their questions"})]}),t.jsx(p,{padding:"300",background:"bg-surface-secondary",borderRadius:"200",children:t.jsxs(d,{gap:"200",children:[t.jsx(u,{variant:"bodyMd",fontWeight:"medium",children:"Ask about your store"}),t.jsx(y,{value:Ge,onChange:He,placeholder:"e.g., looking for a red dress, do you ship to Germany, gifts under $50...",autoComplete:"off",multiline:2,connectedRight:t.jsx(m,{onClick:()=>{const e=(null==Je?void 0:Je.publicDomain)||"this store";gt(`A customer asks: "${Ge}".\nBased on ${e}'s product catalog and store information:\n1. Answer the customer's question accurately and helpfully.\n2. If products are relevant, recommend the BEST matching ones with details.\n3. For EVERY product mentioned, include the direct URL (https://${e}/products/[handle]).\n4. For any store page or collection mentioned, include the direct URL.\n5. Highlight special features, quality, or value.\n6. If the question is about policies (shipping, returns, etc.), provide specific details from the store data.\nAnswer in the same language the customer used. Be helpful and specific!`,"discovery-custom","Product Discovery")},loading:Ke.has("discovery-custom"),disabled:!Oe||!Ge.trim()||Ke.has("discovery-custom"),children:Ke.has("discovery-custom")?"Thinking...":"Ask AI"})})]})}),Ze["Product Discovery"]&&t.jsx(p,{padding:"400",background:"bg-surface-secondary",borderRadius:"200",children:t.jsxs(d,{gap:"300",children:[t.jsxs(x,{align:"space-between",blockAlign:"center",children:[t.jsxs(u,{variant:"bodyMd",fontWeight:"semibold",children:[null==(C=Ze["Product Discovery"].bot)?void 0:C.name," Response"]}),t.jsxs(u,{variant:"bodySm",tone:"subdued",children:[null==(R=null==(I=Ze["Product Discovery"].usage)?void 0:I.tokensUsed)?void 0:R.toLocaleString()," tokens"]})]}),t.jsx("div",{style:{maxHeight:"400px",overflowY:"auto",whiteSpace:"pre-wrap",lineHeight:"1.6",padding:"12px",backgroundColor:"var(--p-color-bg-surface)",borderRadius:"8px",fontSize:"14px"},children:Ze["Product Discovery"].response}),t.jsxs(x,{align:"end",gap:"200",children:[t.jsx(m,{size:"slim",onClick:()=>{navigator.clipboard.writeText(Ze["Product Discovery"].response),$("Response copied to clipboard")},children:"Copy"}),t.jsx(m,{size:"slim",onClick:()=>et(e=>{const t={...e};return delete t["Product Discovery"],t}),children:"Close"})]})]})})]})})}),t.jsx(g,{children:t.jsx(p,{padding:"400",children:t.jsxs(d,{gap:"400",children:[t.jsx(x,{align:"space-between",blockAlign:"center",children:t.jsxs(d,{gap:"100",children:[t.jsxs(x,{gap:"200",blockAlign:"center",children:[t.jsx(u,{as:"h3",variant:"headingMd",children:"Competitive Analysis"}),t.jsx(b,{tone:"info",children:"Growth Plus+"})]}),t.jsx(u,{variant:"bodySm",tone:"subdued",children:"Compare your AI-readiness with competitors"})]})}),l(O)>=l("growth_plus")?t.jsxs(d,{gap:"300",children:[t.jsx(u,{variant:"bodyMd",children:"Enter up to 3 competitor store URLs:"}),ot.map((e,n)=>t.jsx(y,{label:`Competitor ${n+1}`,labelHidden:!0,placeholder:`e.g., competitor${n+1}.com`,value:e,onChange:e=>{const t=[...ot];t[n]=e,at(t)},autoComplete:"off"},n)),t.jsx(m,{primary:!0,onClick:async()=>{const e=ot.filter(e=>e.trim());if(0!==e.length){ct(!0),lt(null);try{const t=await U("/api/ai-testing/competitive-analysis",{method:"POST",body:{shop:D,competitors:e}});t.error?t.requiredPlan?$(`This feature requires ${t.requiredPlan} plan`):$(t.error):lt(t)}catch(t){$("Failed to analyze competitors")}finally{ct(!1)}}else $("Please enter at least one competitor URL")},loading:dt,disabled:dt||ot.every(e=>!e.trim()),children:dt?"Analyzing...":"Compare Stores"}),rt&&t.jsx(p,{paddingBlockStart:"400",children:t.jsxs(d,{gap:"400",children:[t.jsx(c,{tone:"ahead"===(null==(vt=rt.summary)?void 0:vt.position)?"success":"behind"===(null==(yt=rt.summary)?void 0:yt.position)?"warning":"info",children:t.jsxs(d,{gap:"200",children:[t.jsxs(u,{fontWeight:"semibold",children:["Your Score: ",null==(St=rt.myStore)?void 0:St.score,"/100 vs Competitors Avg: ",null==(ft=rt.summary)?void 0:ft.avgCompetitorScore,"/100"]}),t.jsx(u,{children:null==(wt=rt.summary)?void 0:wt.recommendation})]})}),t.jsx(p,{background:"bg-surface-secondary",padding:"300",borderRadius:"200",style:{overflowX:"auto"},children:t.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:"14px"},children:[t.jsx("thead",{children:t.jsxs("tr",{style:{borderBottom:"2px solid var(--p-color-border)"},children:[t.jsx("th",{style:{textAlign:"left",padding:"8px",fontWeight:"600"},children:"Criterion"}),t.jsx("th",{style:{textAlign:"center",padding:"8px",fontWeight:"600",backgroundColor:"var(--p-color-bg-success-subdued)"},children:"Your Store"}),null==(kt=rt.competitors)?void 0:kt.map((e,n)=>{var s;return t.jsx("th",{style:{textAlign:"center",padding:"8px",fontWeight:"600"},children:null==(s=e.domain)?void 0:s.replace(/^https?:\/\//,"").substring(0,20)},n)})]})}),t.jsxs("tbody",{children:[["robotsTxt","sitemap","productsJson","structuredData","aiEndpoints"].map(e=>{var n,s,i,o,a,r,l,d,c,u,h;return t.jsxs("tr",{style:{borderBottom:"1px solid var(--p-color-border)"},children:[t.jsxs("td",{style:{padding:"8px"},children:["robotsTxt"===e&&"robots.txt","sitemap"===e&&"Sitemap","productsJson"===e&&"Products JSON","structuredData"===e&&"Structured Data","aiEndpoints"===e&&"AI Endpoints"]}),t.jsxs("td",{style:{textAlign:"center",padding:"8px",backgroundColor:"var(--p-color-bg-success-subdued)"},children:["excellent"===(null==(s=null==(n=rt.myStore)?void 0:n.criteria[e])?void 0:s.status)&&t.jsx(b,{tone:"success",children:"Excellent"}),"good"===(null==(o=null==(i=rt.myStore)?void 0:i.criteria[e])?void 0:o.status)&&t.jsx(b,{tone:"success",children:"Good"}),"basic"===(null==(r=null==(a=rt.myStore)?void 0:a.criteria[e])?void 0:r.status)&&t.jsx(b,{tone:"info",children:"Basic"}),"missing"===(null==(d=null==(l=rt.myStore)?void 0:l.criteria[e])?void 0:d.status)&&t.jsx(b,{tone:"critical",children:"Missing"}),"n/a"===(null==(u=null==(c=rt.myStore)?void 0:c.criteria[e])?void 0:u.status)&&t.jsx(b,{children:"N/A"})]}),null==(h=rt.competitors)?void 0:h.map((n,s)=>{var i,o,a,r,l,d,c,u,h,g,p,x;return t.jsxs("td",{style:{textAlign:"center",padding:"8px"},children:["excellent"===(null==(o=null==(i=n.criteria)?void 0:i[e])?void 0:o.status)&&t.jsx(b,{tone:"success",children:"Excellent"}),"good"===(null==(r=null==(a=n.criteria)?void 0:a[e])?void 0:r.status)&&t.jsx(b,{tone:"success",children:"Good"}),"basic"===(null==(d=null==(l=n.criteria)?void 0:l[e])?void 0:d.status)&&t.jsx(b,{tone:"info",children:"Basic"}),"missing"===(null==(u=null==(c=n.criteria)?void 0:c[e])?void 0:u.status)&&t.jsx(b,{tone:"critical",children:"Missing"}),"unavailable"===(null==(g=null==(h=n.criteria)?void 0:h[e])?void 0:g.status)&&t.jsx(b,{children:"N/A"}),"error"===(null==(x=null==(p=n.criteria)?void 0:p[e])?void 0:x.status)&&t.jsx(b,{tone:"warning",children:"Error"})]},s)})]},e)}),t.jsxs("tr",{style:{fontWeight:"600",backgroundColor:"var(--p-color-bg-surface-secondary)"},children:[t.jsx("td",{style:{padding:"8px"},children:"Total Score"}),t.jsx("td",{style:{textAlign:"center",padding:"8px",backgroundColor:"var(--p-color-bg-success-subdued)"},children:t.jsxs(b,{tone:"success",children:[null==(At=rt.myStore)?void 0:At.score,"/100"]})}),null==(Pt=rt.competitors)?void 0:Pt.map((e,n)=>t.jsx("td",{style:{textAlign:"center",padding:"8px"},children:t.jsxs(b,{tone:e.score>50?"info":"warning",children:[e.score,"/100"]})},n))]})]})]})}),t.jsx(m,{variant:"plain",onClick:()=>lt(null),children:"Clear Results"})]})})]}):t.jsx(c,{tone:"warning",children:t.jsxs(u,{children:["Competitive Analysis requires Growth Plus plan or higher. ",t.jsx(m,{variant:"plain",onClick:()=>M("/billing"),children:"Upgrade now"})]})})]})})})]}),T&&t.jsx(S,{content:T,onDismiss:()=>$("")}),t.jsx(f,{open:E,onClose:()=>L(!1),title:`Test with ${null==B?void 0:B.name}`,primaryAction:{content:"Open AI Bot",url:null==B?void 0:B.url,external:!0},secondaryActions:[{content:"Copy Prompt",onAction:()=>{const e=Ae||Ce||D;navigator.clipboard.writeText(`I want to learn more about ${e}. Based on their website, what do they sell and what kind of business are they?`),$("Prompt copied to clipboard!")}}],children:t.jsx(f.Section,{children:t.jsxs(d,{gap:"300",children:[t.jsx(u,{variant:"bodyMd",children:'1. Click "Copy Prompt" (left button)'}),t.jsxs(u,{variant:"bodyMd",children:['2. Click "Open AI Bot" (right button) to visit ',null==B?void 0:B.name]}),t.jsx(u,{variant:"bodyMd",children:"3. Paste the prompt and send"}),t.jsxs(p,{background:"bg-surface-secondary",padding:"300",borderRadius:"200",children:[t.jsx(u,{variant:"bodyMd",fontWeight:"semibold",children:"Prompt to test:"}),t.jsx(p,{paddingBlockStart:"200",children:t.jsxs(u,{variant:"bodyMd",as:"p",children:["I want to learn more about ",Ae||Ce||D,". Based on their website, what do they sell and what kind of business are they?"]})})]}),t.jsx(c,{tone:"info",children:t.jsx(u,{children:"The AI bot will search your website and use your optimized store data to answer."})})]})})}),t.jsx(f,{open:te,onClose:()=>ne(!1),title:"Upgrade Required",primaryAction:{content:"View Plans",onAction:()=>{const e=new URLSearchParams(window.location.search),t=e.toString()?`?${e.toString()}`:"";window.location.href=`/billing${t}`}},secondaryActions:[{content:"Cancel",onAction:()=>ne(!1)}],children:t.jsx(f.Section,{children:t.jsxs(d,{gap:"300",children:[t.jsxs(u,{variant:"bodyMd",children:[t.jsx("strong",{children:null==se?void 0:se.endpoint})," requires ",t.jsx("strong",{children:null==se?void 0:se.requiredPlan})," plan or higher."]}),t.jsxs(u,{variant:"bodyMd",tone:"subdued",children:["Your current plan: ",t.jsx("strong",{children:null==se?void 0:se.currentPlan})]}),t.jsx(c,{tone:"info",children:t.jsx(u,{children:"Upgrade to access this advanced AI Discovery feature."})})]})})}),t.jsx(f,{open:G,onClose:()=>H(!1),title:"Upgrade Required",primaryAction:{content:"View Plans",onAction:()=>{const e=new URLSearchParams(window.location.search),t=e.toString()?`?${e.toString()}`:"";window.location.href=`/billing${t}`}},secondaryActions:[{content:"Cancel",onAction:()=>H(!1)}],children:t.jsx(f.Section,{children:t.jsxs(d,{gap:"300",children:[t.jsxs(u,{variant:"bodyMd",children:["AI Testing requires ",t.jsx("strong",{children:(null==Z?void 0:Z.minimumPlan)||"Professional"})," plan or higher."]}),t.jsxs(u,{variant:"bodyMd",tone:"subdued",children:["Your current plan: ",t.jsx("strong",{children:(null==Z?void 0:Z.currentPlan)||"Starter"})]}),t.jsx(c,{tone:"info",children:t.jsx(u,{children:"Upgrade to test AI responses with real store data."})})]})})}),t.jsx(i,{open:Q,onClose:()=>{Y(!1),ee(null),mt()},tokensRequired:(null==Z?void 0:Z.tokensRequired)||0,tokensAvailable:(null==Z?void 0:Z.tokensAvailable)||0,tokensNeeded:(null==Z?void 0:Z.tokensNeeded)||0,feature:"ai-testing-simulation",shop:D,needsUpgrade:!1,returnTo:"/ai-testing",onBuyTokens:()=>{Y(!1),X(!0)}}),Z&&t.jsx(o,{open:_,onClose:()=>{V(!1),ee(null)},feature:Z.feature||"ai-testing-simulation",trialEndsAt:Z.trialEndsAt,currentPlan:Z.currentPlan||O,tokensRequired:Z.tokensRequired||0,onActivatePlan:async()=>{try{const e=await U("/api/billing/activate",{method:"POST",body:JSON.stringify({shop:D,endTrial:!0,returnTo:"/ai-testing"})});if(e.requiresApproval&&e.confirmationUrl)return void(window.top.location.href=e.confirmationUrl);window.location.reload()}catch(e){const t=new URLSearchParams(window.location.search),n=t.get("host"),s=t.get("embedded");window.location.href=`/billing?shop=${encodeURIComponent(D)}&embedded=${s}&host=${encodeURIComponent(n)}`}},onPurchaseTokens:()=>{V(!1),X(!0)}}),t.jsx(a,{open:K,onClose:()=>{X(!1),ee(null),mt()},shop:D,returnTo:"/ai-testing",inTrial:!!(null==Z?void 0:Z.trialEndsAt)})]});var vt,yt,St,ft,wt,kt,At,Pt}export{w as default};
