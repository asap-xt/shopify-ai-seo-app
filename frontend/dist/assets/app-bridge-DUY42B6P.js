var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function t(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var n={},r={},o={},i={},a={},u={},c={},s={},p={};Object.defineProperty(p,"__esModule",{value:!0}),p.default=function e(t,n){if(null==n)return n;if(void 0===t||!Object.prototype.isPrototypeOf.call(Object.getPrototypeOf(t),n)||"Object"!==n.constructor.name&&"Array"!==n.constructor.name)return n;var r={};return Object.keys(n).forEach(function(o){Object.prototype.hasOwnProperty.call(t,o)?"object"!=typeof t[o]||Array.isArray(t[o])?r[o]=n[o]:r[o]=e(t[o],n[o]):r[o]=n[o]}),Object.keys(t).forEach(function(e){Object.prototype.hasOwnProperty.call(n,e)||(r[e]=t[e])}),Object.setPrototypeOf(r,Object.getPrototypeOf(t)),r};var l={};Object.defineProperty(l,"__esModule",{value:!0}),l.SEPARATOR=l.PREFIX=void 0,l.PREFIX="APP",l.SEPARATOR="::";var f,d,h,y={};f=y,Object.defineProperty(f,"__esModule",{value:!0}),f.ComponentType=f.Group=void 0,(d=f.Group||(f.Group={})).AuthCode="AuthCode",d.Button="Button",d.ButtonGroup="ButtonGroup",d.Cart="Cart",d.Client="Client",d.ContextualSaveBar="ContextualSaveBar",d.Error="Error",d.Features="Features",d.FeedbackModal="FeedbackModal",d.Fullscreen="Fullscreen",d.LeaveConfirmation="LeaveConfirmation",d.Link="Link",d.Loading="Loading",d.Menu="Menu",d.Modal="Modal",d.Navigation="Navigation",d.Performance="Performance",d.Pos="Pos",d.Print="Print",d.ResourcePicker="Resource_Picker",d.unstable_Picker="unstable_Picker",d.Scanner="Scanner",d.SessionToken="SessionToken",d.Share="Share",d.TitleBar="TitleBar",d.Toast="Toast",d.MarketingExternalActivityTopBar="MarketingExternalActivityTopBar",d.WebVitals="WebVitals",(h=f.ComponentType||(f.ComponentType={})).Button="Button",h.ButtonGroup="ButtonGroup",function(t){var n=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.updateActionFromPayload=t.isValidOptionalString=t.isValidOptionalNumber=t.forEachInEnum=t.getMergedProps=t.findMatchInEnum=t.getEventNameSpace=t.NonSnakeCaseGroup=t.actionWrapper=void 0;var r=n(p),o=l,i=y;function a(e,t){var n=r.default(e,t);return n||Object.assign(e,t)}t.actionWrapper=function(e){return e},t.NonSnakeCaseGroup=[i.Group.AuthCode,i.Group.Button,i.Group.ButtonGroup,i.Group.Cart,i.Group.Error,i.Group.Features,i.Group.Fullscreen,i.Group.Link,i.Group.Loading,i.Group.Menu,i.Group.Modal,i.Group.Navigation,i.Group.Pos,i.Group.Print,i.Group.ResourcePicker,i.Group.Scanner,i.Group.SessionToken,i.Group.Share,i.Group.TitleBar,i.Group.Toast,i.Group.unstable_Picker],t.getEventNameSpace=function(e,n,r){if(n.startsWith(""+o.PREFIX+o.SEPARATOR))return n;var i=function(e){return t.NonSnakeCaseGroup.includes(e)?e.toUpperCase():(n=e,n.replace(/([A-Z])/g,function(e,t,n){return(0===n?"":"_")+e[0].toLowerCase()})).toUpperCase();var n}(e);if(r){var a=r.subgroups,u=r.type;a&&a.length>0&&(i+=i.length>0?o.SEPARATOR:"",a.forEach(function(e,t){i+=""+e.toUpperCase()+(t<a.length-1?o.SEPARATOR:"")})),u!==e&&u&&(i+=""+(i.length>0?o.SEPARATOR:"")+u.toUpperCase())}return i&&(i+=""+(i.length>0?o.SEPARATOR:"")+n.toUpperCase()),""+o.PREFIX+o.SEPARATOR+i},t.findMatchInEnum=function(e,t){var n=Object.keys(e).find(function(n){return t===e[n]});return n?e[n]:void 0},t.getMergedProps=a,t.forEachInEnum=function(e,t){Object.keys(e).forEach(function(n){t(e[n])})},t.isValidOptionalNumber=function(e){return null==e||"number"==typeof e},t.isValidOptionalString=function(e){return null==e||"string"==typeof e},t.updateActionFromPayload=function(e,t){return e.id===t.id&&(Object.assign(e,a(e,t)),!0)}}(s);var b={},v={};!function(e){var t,n,r;Object.defineProperty(e,"__esModule",{value:!0}),e.LifecycleHook=e.PermissionType=e.MessageType=void 0,(t=e.MessageType||(e.MessageType={})).GetState="getState",t.Dispatch="dispatch",t.Subscribe="subscribe",t.Unsubscribe="unsubscribe",(n=e.PermissionType||(e.PermissionType={})).Dispatch="Dispatch",n.Subscribe="Subscribe",(r=e.LifecycleHook||(e.LifecycleHook={})).UpdateAction="UpdateAction",r.DispatchAction="DispatchAction"}(v);var g={};function O(e,t,n){var r=e.findIndex(function(e){return e===t});return r>=0&&(e.splice(r,1),n&&n(t),!0)}Object.defineProperty(g,"__esModule",{value:!0}),g.removeFromCollection=g.addAndRemoveFromCollection=void 0,g.addAndRemoveFromCollection=function(e,t,n){return e.push(t),function(){return O(e,t,n)}},g.removeFromCollection=O;var P={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.permissionAction=e.isErrorEventName=e.throwError=e.invalidOriginAction=e.fromAction=e.AppBridgeError=e.AppActionType=e.Action=void 0;var t,n,r,o=y,i=s;(n=t=e.Action||(e.Action={})).INVALID_ACTION="APP::ERROR::INVALID_ACTION",n.INVALID_ACTION_TYPE="APP::ERROR::INVALID_ACTION_TYPE",n.INVALID_PAYLOAD="APP::ERROR::INVALID_PAYLOAD",n.INVALID_OPTIONS="APP::ERROR::INVALID_OPTIONS",n.UNEXPECTED_ACTION="APP::ERROR::UNEXPECTED_ACTION",n.PERSISTENCE="APP::ERROR::PERSISTENCE",n.UNSUPPORTED_OPERATION="APP::ERROR::UNSUPPORTED_OPERATION",n.NETWORK="APP::ERROR::NETWORK",n.PERMISSION="APP::ERROR::PERMISSION",n.FAILED_AUTHENTICATION="APP::ERROR::FAILED_AUTHENTICATION",n.INVALID_ORIGIN="APP::ERROR::INVALID_ORIGIN",(r=e.AppActionType||(e.AppActionType={})).INVALID_CONFIG="APP::ERROR::INVALID_CONFIG",r.MISSING_CONFIG="APP::APP_ERROR::MISSING_CONFIG",r.MISSING_APP_BRIDGE_MIDDLEWARE="APP::APP_ERROR::MISSING_APP_BRIDGE_MIDDLEWARE",r.WINDOW_UNDEFINED="APP::APP_ERROR::WINDOW_UNDEFINED",r.REDUX_REINSTANTIATED="APP::APP_ERROR::REDUX_REINSTANTIATED",r.MISSING_LOCAL_ORIGIN="APP::APP_ERROR::MISSING_LOCAL_ORIGIN",r.MISSING_HOST_PROVIDER="APP::APP_ERROR::MISSING_HOST_PROVIDER",r.MISSING_ROUTER_CONTEXT="APP::APP_ERROR::MISSING_ROUTER_CONTEXT",r.MISSING_HISTORY_BLOCK="APP::APP_ERROR::MISSING_HISTORY_BLOCK";var a=function(){return function(e){this.name="AppBridgeError",this.message=e,"function"==typeof Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error(this.message).stack}}();function u(e,t,n){var r=new a(e?t+": "+e:t);return r.action=n,r.type=t,r}e.AppBridgeError=a,a.prototype=Object.create(Error.prototype),e.fromAction=u,e.invalidOriginAction=function(e){return i.actionWrapper({group:o.Group.Error,payload:{message:e,type:t.INVALID_ORIGIN},type:t.INVALID_ORIGIN})},e.throwError=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n,r,o=e[0];throw"string"==typeof e[1]?n=e[1]:(r=e[1],n=e[2]||""),u(n,o,r)},e.isErrorEventName=function(e){return"string"==typeof i.findMatchInEnum(t,e)},e.permissionAction=function(e,n){return function(e,t,n){var r=t.payload;return i.actionWrapper({type:e,group:o.Group.Error,payload:{action:t,message:n,type:e,id:r&&r.id?r.id:void 0}})}(t.PERMISSION,e,n||"Action is not permitted")}}(P);var A={};function m(e){return Array.from(e).map(function(e){return("00"+e.toString(16)).slice(-2)}).join("")}function E(e){if("function"==typeof Uint8Array&&"object"==typeof window&&window.crypto){var t=new Uint8Array(e),n=window.crypto.getRandomValues(t);if(n)return n}return Array.from(new Array(e),function(){return 255*Math.random()|0})}function _(){var e=E(1),t=E(2);return e[0]&=191,t[0]&=79,[m(E(4)),"-",m(E(2)),"-",m(t),"-",m(e),m(E(1)),"-",m(E(6))].join("")}Object.defineProperty(A,"__esModule",{value:!0}),A.generateUuid=void 0,A.generateUuid=_,A.default=_;var S=e&&e.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),M=e&&e.__assign||function(){return M=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},M.apply(this,arguments)},T=e&&e.__spreadArray||function(e,t){for(var n=0,r=t.length,o=e.length;n<r;n++,o++)e[o]=t[n];return e},I=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(b,"__esModule",{value:!0}),b.unsubscribeActions=b.ActionSetWithChildren=b.ActionSet=void 0;var w=v,N=g,R=P,j=y,C=I(A),D=s,U=function(){function e(e,t,n,r){var o=this;this.app=e,this.type=t,this.group=n,this.subgroups=[],this.subscriptions=[],e||R.throwError(R.Action.INVALID_ACTION,"Missing required `app`"),this.id=r||C.default(),this.defaultGroup=n;var i=this.set;this.set=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return o.app.hooks?(e=o.app.hooks).run.apply(e,T([w.LifecycleHook.UpdateAction,i,o],t)):i.apply(o,t)}}return e.prototype.set=function(){},Object.defineProperty(e.prototype,"component",{get:function(){return{id:this.id,subgroups:this.subgroups,type:this.type}},enumerable:!1,configurable:!0}),e.prototype.updateSubscription=function(e,t,n){var r,o=e.eventType,i=e.callback,a=e.component;return(r=this.subscriptions.findIndex(function(t){return t===e}))>=0?this.subscriptions[r].unsubscribe():r=void 0,this.group=t,this.subgroups=n,Object.assign(a,{subgroups:this.subgroups}),this.subscribe(o,i,a,r)},e.prototype.error=function(e){var t=this,n=[];return D.forEachInEnum(R.Action,function(r){n.push(t.subscriptions.length),t.subscribe(r,e)}),function(){n.map(function(e){return t.subscriptions[e]}).forEach(function(e){N.removeFromCollection(t.subscriptions,e,function(e){e.unsubscribe()})})}},e.prototype.subscribe=function(e,t,n,r){var o,i=this,a=n||this.component,u=e.toUpperCase(),c="number"==typeof r?t:t.bind(this);o=R.isErrorEventName(e)?D.getEventNameSpace(j.Group.Error,e,M(M({},a),{type:""})):D.getEventNameSpace(this.group,e,a);var s=this.app.subscribe(o,c,n?n.id:this.id),p={eventType:u,unsubscribe:s,callback:c,component:a,updateSubscribe:function(e,t){return i.updateSubscription(p,e,t)}};return"number"==typeof r&&r>=0&&r<this.subscriptions.length?this.subscriptions[r]=p:this.subscriptions.push(p),s},e.prototype.unsubscribe=function(e){return void 0===e&&(e=!1),k(this.subscriptions,this.defaultGroup,e),this},e}();b.ActionSet=U;var G=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.children=[],t}return S(t,e),t.prototype.unsubscribe=function(e,n){return void 0===e&&(e=!0),void 0===n&&(n=!1),k(this.subscriptions,this.defaultGroup,n),this.children.forEach(function(n){n instanceof t?n.unsubscribe(e,!e):n.unsubscribe(!e)}),this},t.prototype.getChild=function(e){var t=this.children.findIndex(function(t){return t.id===e});return t>=0?this.children[t]:void 0},t.prototype.getChildIndex=function(e){return this.children.findIndex(function(t){return t.id===e})},t.prototype.getChildSubscriptions=function(e,t){return this.subscriptions.filter(function(n){return n.component.id===e&&(!t||t===n.eventType)})},t.prototype.addChild=function(e,n,r){var o=this,i=e.subscriptions;return this.getChild(e.id)||this.children.push(e),!i||n===e.group&&r===e.subgroups||(i.forEach(function(e){(0,e.updateSubscribe)(n,r)}),Object.assign(e,{group:n,subgroups:r}),e instanceof t&&e.children.forEach(function(e){return o.addChild(e,n,r)})),this},t.prototype.removeChild=function(e){var t=this;return N.removeFromCollection(this.children,this.getChild(e),function(){t.subscriptions.filter(function(t){return t.component.id===e}).forEach(function(e){N.removeFromCollection(t.subscriptions,e,function(e){e.unsubscribe()})})}),this},t.prototype.subscribeToChild=function(e,t,n){var r=this,o=n.bind(this);if(t instanceof Array)return t.forEach(function(t){return r.subscribeToChild(e,t,n)}),this;if("string"!=typeof t)return this;var i=t.toUpperCase(),a=this.getChildSubscriptions(e.id,i);if(a.length>0)a.forEach(function(t){return t.updateSubscribe(r.group,e.subgroups)});else{var u={id:e.id,subgroups:e.subgroups,type:e.type};this.subscribe(i,o,u)}return this},t.prototype.getUpdatedChildActions=function(e,t){if(0!==e.length){for(var n=e.filter(function(e,t,n){return t===n.indexOf(e)}),r=n.map(function(e){return e.id}),o=t.filter(function(e){return r.indexOf(e.id)<0});o.length>0;){if(!(i=o.pop()))break;this.removeChild(i.id)}return n}for(;t.length>0;){var i;if(!(i=t.pop()))break;this.removeChild(i.id)}},t}(U);function k(e,t,n){void 0===n&&(n=!1),e.forEach(function(e){n?(0,e.updateSubscribe)(t,[]):(0,e.unsubscribe)()}),n||(e.length=0)}b.ActionSetWithChildren=G,b.unsubscribeActions=k,function(t){var n=e&&e.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),r=e&&e.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.Button=t.update=t.clickButton=t.Style=t.Icon=t.Action=void 0;var o,i,a=s,u=b,c=y;function p(e,t,n){var r=t.id,i=a.getEventNameSpace(e,o.CLICK,t),u={id:r,payload:n};return a.actionWrapper({type:i,group:e,payload:u})}function l(e,t,n){var i=t.id,u=n.label,c=a.getEventNameSpace(e,o.UPDATE,t),s=r(r({},n),{id:i,label:u});return a.actionWrapper({type:c,group:e,payload:s})}(i=o=t.Action||(t.Action={})).CLICK="CLICK",i.UPDATE="UPDATE",(t.Icon||(t.Icon={})).Print="print",(t.Style||(t.Style={})).Danger="danger",t.clickButton=p,t.update=l;var f=function(e){function t(t,n){var r=e.call(this,t,c.ComponentType.Button,c.Group.Button)||this;return r.disabled=!1,r.loading=!1,r.plain=!1,r.set(n,!1),r}return n(t,e),Object.defineProperty(t.prototype,"options",{get:function(){return{disabled:this.disabled,icon:this.icon,label:this.label,style:this.style,loading:this.loading,plain:this.plain}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"payload",{get:function(){return r(r({},this.options),{id:this.id})},enumerable:!1,configurable:!0}),t.prototype.set=function(e,t){void 0===t&&(t=!0);var n=a.getMergedProps(this.options,e),r=n.label,i=n.disabled,u=n.icon,c=n.style,s=n.loading,p=n.plain;return this.label=r,this.disabled=Boolean(i),this.icon=u,this.style=c,this.loading=Boolean(s),this.plain=Boolean(p),t&&this.dispatch(o.UPDATE),this},t.prototype.dispatch=function(e,t){switch(e){case o.CLICK:this.app.dispatch(p(this.group,this.component,t));break;case o.UPDATE:var n=l(this.group,this.component,this.payload);this.app.dispatch(n)}return this},t}(u.ActionSet);t.Button=f}(c),Object.defineProperty(u,"__esModule",{value:!0}),u.getSingleButton=void 0;var L=c;u.getSingleButton=function(e,t,n,r){return e.addChild(t,e.group,n),e.subscribeToChild(t,L.Action.UPDATE,r),t.payload},function(t){var n=e&&e.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),r=e&&e.__assign||function(){return r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},r.apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0}),t.ModalIframe=t.ModalMessage=t.Modal=t.isMessageModal=t.isIframeModal=t.data=t.update=t.clickFooterButton=t.updateModalSize=t.closeModal=t.openModal=t.Size=t.Action=void 0;var o,i,a,p,l=u,f=s,d=b,h=y,v=c;(i=o=t.Action||(t.Action={})).OPEN="APP::MODAL::OPEN",i.CLOSE="APP::MODAL::CLOSE",i.UPDATE="APP::MODAL::UPDATE",i.UPDATE_CONTENT="APP::MODAL::CONTENT::UPDATE",i.FOOTER_BUTTON_CLICK="APP::MODAL::FOOTER::BUTTON::CLICK",i.FOOTER_BUTTON_UPDATE="APP::MODAL::FOOTER::BUTTON::UPDATE",i.UPDATE_SIZE="APP::MODAL::UPDATE_SIZE",i.DATA="APP::MODAL::DATA",(p=a=t.Size||(t.Size={})).Small="small",p.Medium="medium",p.Large="large",p.Full="full",p.Auto="auto";var g={group:h.Group.Modal,subgroups:["Footer"],type:h.ComponentType.Button};function O(e){return f.actionWrapper({group:h.Group.Modal,payload:e,type:o.OPEN})}function P(e){return f.actionWrapper({group:h.Group.Modal,payload:e,type:o.CLOSE})}function A(e){return f.actionWrapper({payload:e,group:h.Group.Modal,type:o.UPDATE})}function m(e){return f.actionWrapper({payload:e,group:h.Group.Modal,type:o.DATA})}t.openModal=O,t.closeModal=P,t.updateModalSize=function(e){return f.actionWrapper({group:h.Group.Modal,payload:e,type:o.UPDATE_SIZE})},t.clickFooterButton=function(e,t){var n=r({id:e},g);return v.clickButton(h.Group.Modal,n,t)},t.update=A,t.data=m,t.isIframeModal=function(e){return"string"==typeof e.url||"string"==typeof e.path},t.isMessageModal=function(e){return"string"==typeof e.message};var E=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.size=a.Small,t}return n(t,e),Object.defineProperty(t.prototype,"footer",{get:function(){if(this.footerPrimary||this.footerSecondary)return{buttons:{primary:this.footerPrimary,secondary:this.footerSecondary}}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"footerOptions",{get:function(){if(this.footerPrimaryOptions||this.footerSecondaryOptions)return{buttons:{primary:this.footerPrimaryOptions,secondary:this.footerSecondaryOptions}}},enumerable:!1,configurable:!0}),t.prototype.close=function(){this.app.dispatch(P({id:this.id}))},t.prototype.setFooterPrimaryButton=function(e,t){var n=this,r=g.subgroups;this.footerPrimaryOptions=this.getChildButton(e,this.footerPrimaryOptions),this.footerPrimary=this.footerPrimaryOptions?l.getSingleButton(this,this.footerPrimaryOptions,r,function(e){n.updatePrimaryFooterButton(e,t)}):void 0},t.prototype.setFooterSecondaryButtons=function(e,t){var n=this,r=g.subgroups,o=e||[],i=this.footerOptions&&this.footerOptions.buttons.secondary||[];this.footerSecondaryOptions=this.getUpdatedChildActions(o,i),this.footerSecondary=this.footerSecondaryOptions?this.footerSecondaryOptions.map(function(e){return l.getSingleButton(n,e,r,function(e){n.updateSecondaryFooterButton(e,t)})}):void 0},t.prototype.getChildButton=function(e,t){var n=e?[e]:[],r=t?[t]:[],o=this.getUpdatedChildActions(n,r);return o?o[0]:void 0},t.prototype.updatePrimaryFooterButton=function(e,t){this.footer&&this.footer.buttons.primary&&f.updateActionFromPayload(this.footer.buttons.primary,e)&&t()},t.prototype.updateSecondaryFooterButton=function(e,t){if(this.footer&&this.footer.buttons&&this.footer.buttons.secondary){for(var n,r=0,o=this.footer.buttons.secondary;r<o.length;r++){var i=o[r];if(n=f.updateActionFromPayload(i,e))break}n&&t()}},t}(d.ActionSetWithChildren);t.Modal=E;var _=function(e){function t(t,n){var r=e.call(this,t,h.Group.Modal,h.Group.Modal)||this;return r.set(n,!1),r}return n(t,e),Object.defineProperty(t.prototype,"payload",{get:function(){return r(r({},this.options),{footer:this.footer,id:this.id})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return{footer:this.footerOptions,message:this.message,size:this.size,title:this.title}},enumerable:!1,configurable:!0}),t.prototype.set=function(e,t){var n=this;void 0===t&&(t=!0);var r=f.getMergedProps(this.options,e),i=r.title,a=r.footer,u=r.message,c=r.size;return this.title=i,this.message=u,this.size=c,this.setFooterPrimaryButton(a?a.buttons.primary:void 0,function(){n.dispatch(o.UPDATE)}),this.setFooterSecondaryButtons(a?a.buttons.secondary:void 0,function(){n.dispatch(o.UPDATE)}),t&&this.dispatch(o.UPDATE),this},t.prototype.dispatch=function(e){switch(e){case o.OPEN:this.app.dispatch(O(this.payload));break;case o.CLOSE:this.close();break;case o.UPDATE:this.app.dispatch(A(this.payload))}return this},t}(E);t.ModalMessage=_;var S=function(e){function t(t,n){var r=e.call(this,t,h.Group.Modal,h.Group.Modal)||this;return r.set(n,!1),r}return n(t,e),Object.defineProperty(t.prototype,"payload",{get:function(){return r(r({},this.options),{footer:this.footer,id:this.id})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return{footer:this.footerOptions,path:this.path,size:this.size,title:this.title,url:this.url,loading:this.loading}},enumerable:!1,configurable:!0}),t.prototype.set=function(e,t){var n=this;void 0===t&&(t=!0);var r=f.getMergedProps(this.options,e),i=r.title,a=r.footer,u=r.path,c=r.url,s=r.size,p=r.loading;return this.title=i,this.url=c,this.path=u,this.size=s,this.loading=p,this.setFooterPrimaryButton(a?a.buttons.primary:void 0,function(){n.dispatch(o.UPDATE)}),this.setFooterSecondaryButtons(a?a.buttons.secondary:void 0,function(){n.dispatch(o.UPDATE)}),t&&this.dispatch(o.UPDATE),this},t.prototype.dispatch=function(e,t){switch(e){case o.OPEN:this.app.dispatch(O(this.payload));break;case o.CLOSE:this.close();break;case o.UPDATE:this.app.dispatch(A(this.payload));break;case o.DATA:this.app.dispatch(m(t||{}))}return this},t}(E);t.ModalIframe=S}(a),function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.create=e.Modal=e.isMessageModal=e.data=e.update=e.clickFooterButton=e.updateModalSize=e.closeModal=e.openModal=e.Size=e.Action=e.isIframeModal=e.ModalMessage=e.ModalIframe=void 0;var t=a;Object.defineProperty(e,"ModalIframe",{enumerable:!0,get:function(){return t.ModalIframe}}),Object.defineProperty(e,"ModalMessage",{enumerable:!0,get:function(){return t.ModalMessage}}),Object.defineProperty(e,"isIframeModal",{enumerable:!0,get:function(){return t.isIframeModal}});var n=a;Object.defineProperty(e,"Action",{enumerable:!0,get:function(){return n.Action}}),Object.defineProperty(e,"Size",{enumerable:!0,get:function(){return n.Size}}),Object.defineProperty(e,"openModal",{enumerable:!0,get:function(){return n.openModal}}),Object.defineProperty(e,"closeModal",{enumerable:!0,get:function(){return n.closeModal}}),Object.defineProperty(e,"updateModalSize",{enumerable:!0,get:function(){return n.updateModalSize}}),Object.defineProperty(e,"clickFooterButton",{enumerable:!0,get:function(){return n.clickFooterButton}}),Object.defineProperty(e,"update",{enumerable:!0,get:function(){return n.update}}),Object.defineProperty(e,"data",{enumerable:!0,get:function(){return n.data}}),Object.defineProperty(e,"isMessageModal",{enumerable:!0,get:function(){return n.isMessageModal}}),Object.defineProperty(e,"Modal",{enumerable:!0,get:function(){return n.Modal}});e.create=function(e,n){return t.isIframeModal(n)?new t.ModalIframe(e,n):new t.ModalMessage(e,n)}}(i);var F={},B={},x={};Object.defineProperty(x,"__esModule",{value:!0}),x.isPermitted=x.getPermissionKey=x.isPerformanceOrWebVitalsAction=x.isAppMessage=x.isAppBridgeAction=void 0;var W=v,V=l,z=s;function H(e){return e.replace(new RegExp("^"+V.PREFIX+V.SEPARATOR+"\\w+"+V.SEPARATOR),"")}x.isAppBridgeAction=function(e){return e instanceof Object&&Object.prototype.hasOwnProperty.call(e,"type")&&e.type.toString().startsWith(V.PREFIX)},x.isAppMessage=function(e){if("object"!=typeof e||!e.data||"object"!=typeof e.data)return!1;var t=e.data;return Object.prototype.hasOwnProperty.call(t,"type")&&void 0!==z.findMatchInEnum(W.MessageType,t.type)},x.isPerformanceOrWebVitalsAction=function(e){return e.type.match(/^APP::(PERFORMANCE|WEB_VITALS)::/)},x.getPermissionKey=H,x.isPermitted=function(e,t,n){var r=t.group,o=t.type;if(!r||!Object.prototype.hasOwnProperty.call(e,r))return!1;var i=e[r];if(!i)return!1;var a=H(o);return!!i[a]&&!0===i[a][n]};var X={};!function(e){var t,n;Object.defineProperty(e,"__esModule",{value:!0}),e.isUnframed=e.isClient=e.isServer=void 0,e.isServer="undefined"==typeof window,e.isClient=!e.isServer,e.isUnframed=e.isClient&&(null===(n=null===(t=window.navigator)||void 0===t?void 0:t.userAgent)||void 0===n?void 0:n.indexOf("Unframed"))>0}(X),function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.createTransportListener=e.fromWindow=e.fromFrame=e.Context=void 0;var t,n=P,r=x,o=v,i=g,a=X;(t=e.Context||(e.Context={})).Modal="Modal",t.Main="Main",e.fromFrame=function(e,t,o){var u=[],c=e.host,s=e.window;if(!c)throw n.fromAction("App frame is undefined",n.AppActionType.WINDOW_UNDEFINED);return a.isUnframed&&window.MobileWebView&&Object.assign(window.MobileWebView,{postMessageToIframe:function(e,t){null==s||s.postMessage(e,t),function(e){return null!==e&&"object"==typeof e&&!Array.isArray(e)&&"dispatch"===e.type&&"object"==typeof e.payload}(e)&&c.postMessage(JSON.stringify(e.payload),location.origin)},updateIframeUrl:function(n){var r=window.location,o=(e.window||{}).location;try{new URL(n).origin===t&&o?o.replace(n):r.href=n}catch(i){}}}),c.addEventListener("message",function(e){if(e.source!==c&&r.isAppMessage(e))if(e.origin===t)if(a.isUnframed&&window.MobileWebView){p=JSON.stringify({id:"unframed://fromClient",origin:t,data:e.data});window.MobileWebView.postMessage(p)}else for(var o=0,i=u;o<i.length;o++){(0,i[o])(e)}else{var p,l="Message origin '"+e.origin+"' does not match app origin '"+t+"'.",f={type:"dispatch",payload:p=n.invalidOriginAction(l)};null==s||s.postMessage(f,e.origin)}}),{context:o,localOrigin:t,frameWindow:s,hostFrame:c,dispatch:function(e){null==s||s.postMessage(e,t)},subscribe:function(e){return i.addAndRemoveFromCollection(u,e)}}},e.fromWindow=function(e,t){var n=[];return void 0!==typeof window&&window.addEventListener("message",function(t){if((window!==e||a.isUnframed)&&t.source===e&&(r.isAppBridgeAction(t.data.payload)||r.isAppMessage(t)))for(var o=0,i=n;o<i.length;o++){(0,i[o])(t)}}),{localOrigin:t,hostFrame:e,dispatch:function(n){var r;if(null===(r=n.source)||void 0===r?void 0:r.host)if(a.isUnframed&&window&&window.MobileWebView){var o=JSON.stringify({id:"unframed://fromClient",origin:t,data:n});window.MobileWebView.postMessage(o)}else{var i=new URL("https://"+n.source.host).origin;e.postMessage(n,i)}},subscribe:function(e){return i.addAndRemoveFromCollection(n,e)}}},e.createTransportListener=function(){var e=[],t={};return{createSubscribeHandler:function(n){return function(){if(arguments.length<2)return i.addAndRemoveFromCollection(e,{callback:arguments[0]});var r=Array.from(arguments),a=r[0],u=r[1],c=r[2],s={callback:u,id:c},p={type:a,id:c};return Object.prototype.hasOwnProperty.call(t,a)||(t[a]=[]),n&&n(o.MessageType.Subscribe,p),i.addAndRemoveFromCollection(t[a],s,function(){n&&n(o.MessageType.Unsubscribe,p)})}},handleMessage:function(t){e.forEach(function(e){return e.callback(t)})},handleActionDispatch:function(e){var n=e.type,r=e.payload,o=!1;if(Object.prototype.hasOwnProperty.call(t,n))for(var i=0,a=t[n];i<a.length;i++){var u=a[i],c=u.id,s=u.callback;!(r&&r.id===c)&&c||(s(r),o=!0)}return o}}}}(B),function(t){var n=e&&e.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),r=e&&e.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),r(B,t)}(F);var q={},K={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.isDevelopmentClient=e.isProduction=e.isDevelopment=e.isUnframed=e.isServer=e.isClient=void 0;var t=X,n=X;Object.defineProperty(e,"isClient",{enumerable:!0,get:function(){return n.isClient}}),Object.defineProperty(e,"isServer",{enumerable:!0,get:function(){return n.isServer}}),Object.defineProperty(e,"isUnframed",{enumerable:!0,get:function(){return n.isUnframed}}),e.isDevelopment="undefined"!=typeof process&&{}&&!1,e.isProduction=!e.isDevelopment,e.isDevelopmentClient=e.isDevelopment&&t.isClient}(K),Object.defineProperty(q,"__esModule",{value:!0}),q.isShopifyPing=q.isShopifyPOS=q.isShopifyMobile=q.isShopifyEmbedded=q.isMobile=void 0;var Y=K;function Q(){return"undefined"!=typeof navigator&&navigator.userAgent.indexOf("Shopify Mobile")>=0}function Z(){return"undefined"!=typeof navigator&&navigator.userAgent.indexOf("Shopify POS")>=0}function J(){return"undefined"!=typeof navigator&&navigator.userAgent.indexOf("Shopify Ping")>=0}q.isMobile=function(){return Q()||Z()||J()},q.isShopifyEmbedded=function(){return Y.isClient&&window.top!==window.self||Y.isUnframed},q.isShopifyMobile=Q,q.isShopifyPOS=Z,q.isShopifyPing=J;var $=e&&e.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(t){i(t)}}function u(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,u)}c((r=r.apply(e,t||[])).next())})},ee=e&&e.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(u){i=[6,u],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}};Object.defineProperty(o,"__esModule",{value:!0}),o.createMutationObserver=o.setupModalAutoSizing=void 0;var te=i,ne=F,re=q,oe="app-bridge-utils-modal-auto-size",ie=function(){if("undefined"==typeof document)return null;var e=document.createElement("style");return e.type="text/css",e.innerHTML="."+oe+" { overflow: hidden; height: auto; min-height: auto; }",e}();function ae(e,t){if("undefined"!=typeof document){var n,r=-1,o=new MutationObserver(function(){n&&window.clearTimeout(n);n=window.setTimeout(i,16)});return o.observe(document,{attributes:!0,attributeOldValue:!1,characterData:!0,characterDataOldValue:!1,childList:!0,subtree:!0}),i(),o}function i(){var n=document.body.scrollHeight;n!==r&&(r=n,e.dispatch(te.updateModalSize({id:t,height:String(n)})))}}o.setupModalAutoSizing=function(e){return $(this,void 0,void 0,function(){function t(){r&&(r(),r=void 0)}function n(n){var o=n.context,i=n.modal.id;return re.isMobile()||o!==ne.Context.Modal?(t(),t):(r||(r=function(e,t){if(!ie)return function(){};var n=document.getElementsByTagName("head")[0],r=document.body.classList;n.appendChild(ie),r.add(oe);var o=ae(e,t);return function(){r.remove(oe),n.contains(ie)&&n.removeChild(ie),o&&o.disconnect()}}(e,i)),t)}var r;return ee(this,function(r){switch(r.label){case 0:return[4,e.getState().then(n)];case 1:return r.sent(),[2,t]}})})},o.createMutationObserver=ae;var ue={},ce={},se={},pe={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.respond=e.request=e.Action=void 0;var t,n,r=s,o=y;(n=t=e.Action||(e.Action={})).REQUEST="APP::SESSION_TOKEN::REQUEST",n.RESPOND="APP::SESSION_TOKEN::RESPOND",e.request=function(){return r.actionWrapper({group:o.Group.SessionToken,type:t.REQUEST})},e.respond=function(e){return r.actionWrapper({payload:e,group:o.Group.SessionToken,type:t.RESPOND})}}(pe),function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.respond=e.request=e.Action=void 0;var t=pe;Object.defineProperty(e,"Action",{enumerable:!0,get:function(){return t.Action}}),Object.defineProperty(e,"request",{enumerable:!0,get:function(){return t.request}}),Object.defineProperty(e,"respond",{enumerable:!0,get:function(){return t.respond}})}(se);var le={},fe={};const de={name:"@shopify/app-bridge",version:"3.7.10"};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.getPackageName=e.getVersion=e.getMergedProps=e.updateActionFromPayload=e.isValidOptionalString=e.isValidOptionalNumber=e.NonSnakeCaseGroup=e.getEventNameSpace=e.forEachInEnum=e.findMatchInEnum=e.actionWrapper=void 0;var t=s;Object.defineProperty(e,"actionWrapper",{enumerable:!0,get:function(){return t.actionWrapper}}),Object.defineProperty(e,"findMatchInEnum",{enumerable:!0,get:function(){return t.findMatchInEnum}}),Object.defineProperty(e,"forEachInEnum",{enumerable:!0,get:function(){return t.forEachInEnum}}),Object.defineProperty(e,"getEventNameSpace",{enumerable:!0,get:function(){return t.getEventNameSpace}}),Object.defineProperty(e,"NonSnakeCaseGroup",{enumerable:!0,get:function(){return t.NonSnakeCaseGroup}}),Object.defineProperty(e,"isValidOptionalNumber",{enumerable:!0,get:function(){return t.isValidOptionalNumber}}),Object.defineProperty(e,"isValidOptionalString",{enumerable:!0,get:function(){return t.isValidOptionalString}}),Object.defineProperty(e,"updateActionFromPayload",{enumerable:!0,get:function(){return t.updateActionFromPayload}}),Object.defineProperty(e,"getMergedProps",{enumerable:!0,get:function(){return t.getMergedProps}});var n=de;e.getVersion=function(){return n.version},e.getPackageName=function(){return n.name}}(fe);var he={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ComponentType=e.Group=void 0;var t=y;Object.defineProperty(e,"Group",{enumerable:!0,get:function(){return t.Group}}),Object.defineProperty(e,"ComponentType",{enumerable:!0,get:function(){return t.ComponentType}})}(he),function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.networkAction=e.persistenceAction=e.unsupportedOperationAction=e.unexpectedAction=e.invalidAction=e.invalidActionType=e.invalidPayload=e.Message=e.fromAction=e.Action=e.permissionAction=e.isErrorEventName=e.throwError=e.invalidOriginAction=e.AppBridgeError=e.AppActionType=void 0;var t=P;Object.defineProperty(e,"Action",{enumerable:!0,get:function(){return t.Action}}),Object.defineProperty(e,"fromAction",{enumerable:!0,get:function(){return t.fromAction}});var n,r=fe,o=he,i=P;function a(e,t,n){var i=t.payload;return r.actionWrapper({type:e,group:o.Group.Error,payload:{action:t,message:n,type:e,id:i&&i.id?i.id:void 0}})}Object.defineProperty(e,"AppActionType",{enumerable:!0,get:function(){return i.AppActionType}}),Object.defineProperty(e,"AppBridgeError",{enumerable:!0,get:function(){return i.AppBridgeError}}),Object.defineProperty(e,"invalidOriginAction",{enumerable:!0,get:function(){return i.invalidOriginAction}}),Object.defineProperty(e,"throwError",{enumerable:!0,get:function(){return i.throwError}}),Object.defineProperty(e,"isErrorEventName",{enumerable:!0,get:function(){return i.isErrorEventName}}),Object.defineProperty(e,"permissionAction",{enumerable:!0,get:function(){return i.permissionAction}}),(n=e.Message||(e.Message={})).MISSING_PAYLOAD="Missing payload",n.INVALID_PAYLOAD_ID="Id in payload is missing or invalid",e.invalidPayload=function(e,n){return a(t.Action.INVALID_PAYLOAD,e,n||"The action's payload is missing required properties or has invalid properties")},e.invalidActionType=function(e,n){return r.actionWrapper({group:o.Group.Error,payload:{action:e,message:n||"The action type is invalid or unsupported",type:t.Action.INVALID_ACTION_TYPE},type:t.Action.INVALID_ACTION_TYPE})},e.invalidAction=function(e,n){return r.actionWrapper({group:o.Group.Error,payload:{action:e,message:n||"The action's has missing/invalid values for `group`, `type` or `version`",type:t.Action.INVALID_ACTION},type:t.Action.INVALID_ACTION})},e.unexpectedAction=function(e,n){return r.actionWrapper({group:o.Group.Error,payload:{action:e,message:n||"Action cannot be called at this time",type:t.Action.UNEXPECTED_ACTION},type:t.Action.UNEXPECTED_ACTION})},e.unsupportedOperationAction=function(e,n){return a(t.Action.UNSUPPORTED_OPERATION,e,n||"The action type is unsupported")},e.persistenceAction=function(e,n){return a(t.Action.PERSISTENCE,e,n||"Action cannot be persisted on server")},e.networkAction=function(e,n){return a(t.Action.NETWORK,e,n||"Network error")}}(le);var ye=e&&e.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),be=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),ve=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&ye(t,e,n);return be(t,e),t},ge=e&&e.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(t){i(t)}}function u(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,u)}c((r=r.apply(e,t||[])).next())})},Oe=e&&e.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(u){i=[6,u],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}};Object.defineProperty(ce,"__esModule",{value:!0}),ce.getSessionToken=void 0;var Pe=ve(se),Ae=le;ce.getSessionToken=function(e){return ge(this,void 0,void 0,function(){return Oe(this,function(t){return[2,new Promise(function(t,n){var r=e.subscribe(Pe.Action.RESPOND,function(e){var o=e.sessionToken;o?t(o):n(Ae.fromAction("Failed to retrieve a session token",Ae.Action.FAILED_AUTHENTICATION)),r()});e.dispatch(Pe.request())})]})})};var me={},Ee=e&&e.__assign||function(){return Ee=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Ee.apply(this,arguments)},_e=e&&e.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(t){i(t)}}function u(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,u)}c((r=r.apply(e,t||[])).next())})},Se=e&&e.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(u){i=[6,u],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}};Object.defineProperty(me,"__esModule",{value:!0}),me.authenticatedFetch=void 0;var Me=ce;me.authenticatedFetch=function(e,t){var n=this;return void 0===t&&(t=fetch),function(r,o){return void 0===o&&(o={}),_e(n,void 0,void 0,function(){var n,i,a;return Se(this,function(u){switch(u.label){case 0:return[4,Me.getSessionToken(e)];case 1:return n=u.sent(),(i=new Headers(o.headers)).append("Authorization","Bearer "+n),i.append("X-Requested-With","XMLHttpRequest"),a={},i.forEach(function(e,t){a[t]=e}),[2,t(r,Ee(Ee({},o),{headers:a}))]}})})}},function(t){var n=e&&e.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),r=e&&e.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),r(ce,t),r(me,t)}(ue);var Te={},Ie={},we={},Ne={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.respond=e.Action=void 0;var t,n,r=s,o=y;(n=t=e.Action||(e.Action={})).REQUEST="APP::AUTH_CODE::REQUEST",n.RESPOND="APP::AUTH_CODE::RESPOND",e.respond=function(e){return r.actionWrapper({payload:e,group:o.Group.AuthCode,type:t.RESPOND})}}(Ne),function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.request=e.Action=e.respond=void 0;var t=Ne;Object.defineProperty(e,"Action",{enumerable:!0,get:function(){return t.Action}});var n=fe,r=he,o=Ne;Object.defineProperty(e,"respond",{enumerable:!0,get:function(){return o.respond}}),e.request=function(e){return n.actionWrapper({group:r.Group.AuthCode,type:t.Action.REQUEST,payload:{id:e}})}}(we);var Re={};!function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.generateUuid=void 0;var t=A;Object.defineProperty(e,"generateUuid",{enumerable:!0,get:function(){return t.generateUuid}}),e.default=t.generateUuid}(Re);var je=e&&e.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),Ce=e&&e.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),De=e&&e.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&je(t,e,n);return Ce(t,e),t},Ue=e&&e.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(t){i(t)}}function u(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,u)}c((r=r.apply(e,t||[])).next())})},Ge=e&&e.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(u){i=[6,u],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},ke=e&&e.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ie,"__esModule",{value:!0}),Ie.getAuthorizationCodePayload=void 0;var Le=De(we),Fe=le,Be=ke(Re);Ie.getAuthorizationCodePayload=function(e){return Ue(this,void 0,void 0,function(){return Ge(this,function(t){return[2,new Promise(function(t,n){var r=Be.default(),o=e.subscribe(Le.Action.RESPOND,function(e){if("needsExchange"===(null==e?void 0:e.status))t(e);else n(Fe.fromAction("Failed to retrieve an authorization code",Fe.Action.FAILED_AUTHENTICATION));o()},r);e.dispatch(Le.request(r))})]})})};var xe={},We=e&&e.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function a(e){try{c(r.next(e))}catch(t){i(t)}}function u(e){try{c(r.throw(e))}catch(t){i(t)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,u)}c((r=r.apply(e,t||[])).next())})},Ve=e&&e.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(u){i=[6,u],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}};Object.defineProperty(xe,"__esModule",{value:!0}),xe.userAuthorizedFetch=void 0;var ze=Ie;function He(e){var t=e.headers.get("X-Shopify-API-Request-Failure-Unauthorized");return!!t&&"true"===t.toLowerCase()}xe.userAuthorizedFetch=function(e){var t=this,n=e.app,r=e.callbackUri,o=void 0===r?"auth/shopify/callback":r,i=e.isAuthorizationCodeRequired,a=void 0===i?He:i,u=e.fetchOperation;return function(e,r){return We(t,void 0,void 0,function(){var t,i,c,s,p,l,f;return Ve(this,function(d){switch(d.label){case 0:return[4,u(e,r)];case 1:return t=d.sent(),a(t)?[4,ze.getAuthorizationCodePayload(n)]:[2,t];case 2:return i=d.sent(),c=i.code,s=i.hmac,p=i.shop,l=i.timestamp,f=encodeURI("https://"+window.location.hostname+"/"+o+"?code="+c+"&hmac="+s+"&shop="+p+"&timestamp="+l),[4,u(f,{})];case 3:if(!d.sent().ok)throw new Error("Failed to authorize request.");return[2,u(e,r)]}})})}},function(t){var n=e&&e.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),r=e&&e.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),r(Ie,t),r(xe,t)}(Te),function(t){var n=e&&e.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),r=e&&e.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),r(o,t),r(q,t),r(ue,t),r(Te,t)}(r),function(t){var n=e&&e.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=e&&e.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),o(r,t)}(n);export{n as a,t as g};
