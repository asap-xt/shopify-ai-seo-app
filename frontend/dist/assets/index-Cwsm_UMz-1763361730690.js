const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Dashboard-14b0KFnn-1763361730690.js","assets/app-bridge-B3ZBNaUq-1763361730690.js","assets/react-vendor-tAaa2TlE-1763361730690.js","assets/sessionFetch-CpdIU_Ze-1763361730690.js","assets/usePlanHierarchy-BjUEvxZF-1763361730690.js","assets/polaris-CxjldItW-1763361730690.js","assets/BulkEdit-BLa9q2eZ-1763361730690.js","assets/useShopApi-yPnmSmd3-1763361730690.js","assets/StoreMetadataBanner-y-pTOp0K-1763361730690.js","assets/InsufficientTokensModal-MHYzzTIX-1763361730690.js","assets/TrialActivationModal-Bw-niKLW-1763361730690.js","assets/Collections-ZtehGVgu-1763361730690.js","assets/Sitemap-3BDENnUC-1763361730690.js","assets/StoreMetadata-B-iVNhNv-1763361730690.js","assets/SchemaData-D3cv47e4-1763361730690.js","assets/Settings-CYDb765J-1763361730690.js","assets/AiTesting-CcjLeRhP-1763361730690.js","assets/Billing-DaYUHd58-1763361730690.js","assets/CleanUninstall-B_MM0ilG-1763361730690.js","assets/ContactSupport-Dy3tmxEH-1763361730690.js"])))=>i.map(i=>d[i]);
import{j as e}from"./app-bridge-B3ZBNaUq-1763361730690.js";import{a as J,r as p,R as f}from"./react-vendor-tAaa2TlE-1763361730690.js";import{B as P,I as V,T as A,C as W,A as I,F as T,P as O}from"./polaris-CxjldItW-1763361730690.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))l(r);new MutationObserver(r=>{for(const t of r)if(t.type==="childList")for(const o of t.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&l(o)}).observe(document,{childList:!0,subtree:!0});function i(r){const t={};return r.integrity&&(t.integrity=r.integrity),r.referrerPolicy&&(t.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?t.credentials="include":r.crossOrigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function l(r){if(r.ep)return;r.ep=!0;const t=i(r);fetch(r.href,t)}})();var B,k=J;B=k.createRoot,k.hydrateRoot;const G="modulepreload",Q=function(n){return"/"+n},C={},u=function(a,i,l){let r=Promise.resolve();if(i&&i.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),s=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));r=Promise.allSettled(i.map(c=>{if(c=Q(c),c in C)return;C[c]=!0;const h=c.endsWith(".css"),_=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${_}`))return;const d=document.createElement("link");if(d.rel=h?"stylesheet":G,h||(d.as="script"),d.crossOrigin="",d.href=c,s&&d.setAttribute("nonce",s),document.head.appendChild(d),h)return new Promise((x,m)=>{d.addEventListener("load",x),d.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${c}`)))})}))}function t(o){const s=new Event("vite:preloadError",{cancelable:!0});if(s.payload=o,window.dispatchEvent(s),!s.defaultPrevented)throw o}return r.then(o=>{for(const s of o||[])s.status==="rejected"&&t(s.reason);return a().catch(t)})},b=(...n)=>{},D=(n,a="")=>{if(!(typeof window>"u"||!window.gtag))try{window.gtag("event","page_view",{page_path:n,page_title:a||document.title,page_location:window.location.href}),b("[ANALYTICS] Page view tracked:",n)}catch(i){console.error("[ANALYTICS] Error tracking page view:",i)}};function X({sectionTitle:n,lang:a,setLang:i,t:l}){return e.jsx(P,{padding:"400",borderBlockEndWidth:"025",borderColor:"border",background:"bg",children:e.jsx(V,{align:"space-between",blockAlign:"center",children:e.jsx(A,{as:"h1",variant:"headingLg",children:n})})})}const $="en",L={en:()=>u(()=>import("./en-DY--Skhq-1763361730690.js"),[]),de:()=>u(()=>import("./de-BYtsvH6H-1763361730690.js"),[]),es:()=>u(()=>import("./es-Cshzw9pa-1763361730690.js"),[]),fr:()=>u(()=>import("./fr-DGTXCiho-1763361730690.js"),[])},q=Object.keys(L);function Z(){try{const n=localStorage.getItem("app_lang");return q.includes(n)?n:null}catch{return null}}function ee(n){try{localStorage.setItem("app_lang",n)}catch{}}function te(){const[n,a]=p.useState(()=>Z()||$),[i,l]=p.useState({});p.useEffect(()=>{let t=!1;async function o(){const c=await(L[n]||L[$])();t||l(c.default||c)}return o(),ee(n),()=>{t=!0}},[n]);const r=p.useMemo(()=>(t,o="")=>{const s=t==null?void 0:t.split(".").reduce((c,h)=>c&&c[h]!==void 0?c[h]:void 0,i);return s!=null?String(s):o||t},[i]);return{lang:n,setLang:a,t:r,dict:i,langs:q}}const ne=f.lazy(()=>u(()=>import("./Dashboard-14b0KFnn-1763361730690.js"),__vite__mapDeps([0,1,2,3,4,5]))),re=f.lazy(()=>u(()=>import("./BulkEdit-BLa9q2eZ-1763361730690.js"),__vite__mapDeps([6,1,2,7,8,5,9,10]))),oe=f.lazy(()=>u(()=>import("./Collections-ZtehGVgu-1763361730690.js"),__vite__mapDeps([11,1,2,3,8,5,9,10]))),ae=f.lazy(()=>u(()=>import("./Sitemap-3BDENnUC-1763361730690.js"),__vite__mapDeps([12,1,2,3,5]))),se=f.lazy(()=>u(()=>import("./StoreMetadata-B-iVNhNv-1763361730690.js"),__vite__mapDeps([13,1,2,3,5]))),ie=f.lazy(()=>u(()=>import("./SchemaData-D3cv47e4-1763361730690.js"),__vite__mapDeps([14,1,2,3,4,5]))),ce=f.lazy(()=>u(()=>import("./Settings-CYDb765J-1763361730690.js"),__vite__mapDeps([15,1,2,3,9,5,4]))),le=f.lazy(()=>u(()=>import("./AiTesting-CcjLeRhP-1763361730690.js"),__vite__mapDeps([16,1,2,3,9,5,10,4]))),de=f.lazy(()=>u(()=>import("./Billing-DaYUHd58-1763361730690.js"),__vite__mapDeps([17,1,2,5]))),ue=f.lazy(()=>u(()=>import("./CleanUninstall-B_MM0ilG-1763361730690.js"),__vite__mapDeps([18,1,2,3,5]))),pe=f.lazy(()=>u(()=>import("./ContactSupport-Dy3tmxEH-1763361730690.js"),__vite__mapDeps([19,1,2,7,5]))),z={Polaris:{ResourceList:{sortingLabel:"Sort by"}}},F=(n,a="")=>{try{return new URLSearchParams(window.location.search).get(n)||a}catch{return a}};function he(){const n=l=>l.replace(/^\/apps\/[^/]+/,"").replace(/^\/indexaize-unlock-ai-search/,"")||"/",[a,i]=p.useState(()=>n(window.location.pathname));return p.useEffect(()=>{const l=()=>{const o=n(window.location.pathname);console.log("[useRoute] Location changed to:",o),i(o),D(o)};window.addEventListener("popstate",l);let r=window.location.pathname;const t=setInterval(()=>{window.location.pathname!==r&&(r=window.location.pathname,l())},50);return()=>{window.removeEventListener("popstate",l),clearInterval(t)}},[]),p.useEffect(()=>{D(a)},[]),{path:a}}function fe({active:n,shop:a}){n==="/"||n.startsWith("/dashboard"),n.startsWith("/ai-seo"),n.startsWith("/billing"),n.startsWith("/settings");const l=new URLSearchParams(window.location.search).get("host"),r=new URLSearchParams;a&&r.set("shop",a),l&&r.set("host",l);const t=r.toString()?`?${r.toString()}`:"";return e.jsxs("ui-nav-menu",{children:[e.jsx("a",{href:`/${t}`,rel:"home",children:"Home"}),e.jsx("a",{href:`/dashboard${t}`,children:"Dashboard"}),e.jsx("a",{href:`/ai-seo${t}`,children:"Search Optimization for AI"}),e.jsx("a",{href:`/settings${t}`,children:"Settings"}),e.jsx("a",{href:`/ai-testing${t}`,children:"AI Testing"}),e.jsx("a",{href:`/billing${t}`,children:"Plans & Billing"}),e.jsx("a",{href:`/clean-uninstall${t}`,children:"Clean & Uninstall"}),e.jsx("a",{href:`/contact-support${t}`,children:"Contact Support"})]})}const me=f.memo(({shop:n,plan:a})=>{const i=n||F("shop",""),l=window.location.pathname,t=(()=>{const s=l.replace(/^\/apps\/new-ai-seo/,"");return s==="/ai-seo"||s==="/ai-seo/products"?"products":s==="/ai-seo/collections"?"collections":s==="/ai-seo/sitemap"?"sitemap":s==="/ai-seo/store-metadata"?"store-metadata":s==="/ai-seo/schema-data"?"schema-data":"products"})(),o=s=>{const c=new URLSearchParams(window.location.search),h=c.toString()?`?${c.toString()}`:"";return s==="products"?`/ai-seo${h}`:`/ai-seo/${s}${h}`};return e.jsxs("div",{children:[e.jsx(P,{paddingBlockEnd:"400",children:e.jsx(W,{children:e.jsx(P,{padding:"200",children:e.jsxs(V,{gap:"100",children:[e.jsx("a",{href:o("products"),style:{padding:"8px 16px",borderRadius:"4px",backgroundColor:t==="products"?"#008060":"#f6f6f7",color:t==="products"?"white":"#202223",textDecoration:"none",display:"inline-block"},children:"Products"}),e.jsx("a",{href:o("collections"),style:{padding:"8px 16px",borderRadius:"4px",backgroundColor:t==="collections"?"#008060":"#f6f6f7",color:t==="collections"?"white":"#202223",textDecoration:"none",display:"inline-block"},children:"Collections"}),e.jsx("a",{href:o("sitemap"),style:{padding:"8px 16px",borderRadius:"4px",backgroundColor:t==="sitemap"?"#008060":"#f6f6f7",color:t==="sitemap"?"white":"#202223",textDecoration:"none",display:"inline-block"},children:"Sitemap"}),e.jsx("a",{href:o("store-metadata"),style:{padding:"8px 16px",borderRadius:"4px",backgroundColor:t==="store-metadata"?"#008060":"#f6f6f7",color:t==="store-metadata"?"white":"#202223",textDecoration:"none",display:"inline-block"},children:"Store metadata"}),e.jsx("a",{href:o("schema-data"),style:{padding:"8px 16px",borderRadius:"4px",backgroundColor:t==="schema-data"?"#008060":"#f6f6f7",color:t==="schema-data"?"white":"#202223",textDecoration:"none",display:"inline-block"},children:"Schema Data"})]})})})}),e.jsxs("div",{children:[t==="products"&&e.jsx(re,{shop:i,globalPlan:a}),t==="collections"&&e.jsx(oe,{shop:i,globalPlan:a}),t==="sitemap"&&e.jsx(ae,{shop:i}),t==="store-metadata"&&e.jsx(se,{shop:i}),t==="schema-data"&&e.jsx(ie,{shop:i})]})]})});function ge(){const{path:n}=he(),{lang:a,setLang:i,t:l}=te(),r=!!new URLSearchParams(window.location.search).get("host"),t=F("shop",""),[o,s]=p.useState(()=>{try{const _=sessionStorage.getItem(`plan_${t}`);if(_){const d=JSON.parse(_);return!d||typeof d.language_limit>"u"?(sessionStorage.removeItem(`plan_${t}`),null):d}return null}catch{return null}});p.useEffect(()=>{const _=async()=>{const x=new URLSearchParams(window.location.search),m=x.get("shop"),y=x.get("id_token");if(m&&y)try{b("[APP] Performing initial token exchange for shop:",m);const g=await fetch("/token-exchange",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({shop:m,id_token:y})});if(!g.ok){const v=await g.json();console.error("[APP] Token exchange failed:",v);return}const S=await g.json();b("[APP] Token exchange successful:",S);const w=new URL(window.location);w.searchParams.delete("id_token"),window.history.replaceState({},"",w),await d(m)}catch(g){console.error("[APP] Token exchange error:",g)}else m&&await d(m)},d=async x=>{var m;try{const g=await fetch("/graphql",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:`
          query PlansMe($shop:String!) {
            plansMe(shop:$shop) {
              shop
              plan
              planKey
              priceUsd
              product_limit
              language_limit
              collection_limit
              providersAllowed
              modelsSuggested
              subscriptionStatus
              trial {
                active
                ends_at
                days_left
              }
            }
          }
        `,variables:{shop:x}})});if(g.status===202&&(await g.json()).error==="token_exchange_required"){b("[APP] Token exchange required, but no id_token available"),window.location.href=`/auth?shop=${encodeURIComponent(x)}`;return}if(!g.ok){console.error("[APP] Failed to load plans:",await g.text());return}const S=await g.json(),w=(m=S==null?void 0:S.data)==null?void 0:m.plansMe;if(w){s(w);try{sessionStorage.setItem(`plan_${x}`,JSON.stringify(w))}catch(E){console.error("[APP] Failed to cache plan:",E)}const M=window.location.pathname.includes("/billing");if((w.subscriptionStatus==="pending"||!w.plan)&&!M){b("[APP] No active subscription, redirecting to billing...");try{localStorage.removeItem(`onboardingOpen_${x}`)}catch(H){console.error("[APP] Failed to clear onboarding state:",H)}const E=new URLSearchParams(window.location.search),K=E.get("host"),Y=E.get("embedded");window.location.href=`/billing?shop=${encodeURIComponent(x)}&embedded=${Y}&host=${encodeURIComponent(K)}`;return}}}catch(y){console.error("[APP] Error loading initial data:",y)}};_()},[]);const c=p.useMemo(()=>n.startsWith("/ai-seo")?"Search Optimization for AI":n.startsWith("/billing")?"Plans & Billing":n.startsWith("/settings")?"Settings":n.startsWith("/ai-testing")?"AI Testing":n.startsWith("/clean-uninstall")?"Clean & Uninstall":n.startsWith("/contact-support")?"Contact Support":"Dashboard",[n]),h=()=>{const _=n.replace(/^\/apps\/new-ai-seo/,"");return _==="/"||_==="/dashboard"?e.jsx(ne,{shop:t}):_.startsWith("/ai-seo")?e.jsx(me,{shop:t,plan:o}):n==="/billing"?e.jsx(de,{shop:t}):n==="/settings"?e.jsx(ce,{shop:t}):n==="/contact-support"?e.jsx(pe,{shop:t}):n==="/ai-testing"?e.jsx(le,{shop:t}):n==="/clean-uninstall"?e.jsx(ue,{shop:t}):e.jsx(W,{children:e.jsxs(P,{padding:"400",children:[e.jsx(A,{variant:"headingMd",children:"Page not found"}),e.jsx(P,{paddingBlockStart:"200",children:e.jsxs(A,{children:['The page "',n,'" does not exist.']})})]})})};return o?e.jsxs(I,{i18n:z,children:[r&&e.jsx(fe,{active:n,shop:t}),e.jsx(T,{children:e.jsxs(O,{children:[e.jsx(X,{sectionTitle:c,lang:a,setLang:i,t:l,shop:t}),h()]})})]}):e.jsx(I,{i18n:z,children:e.jsx(T,{children:e.jsx(O,{children:e.jsx(P,{padding:"400",children:e.jsx(A,{children:"Loading..."})})})})})}const R=new URLSearchParams(window.location.search),U=R.get("host"),j=R.get("shop"),N=R.get("embedded")==="1";function _e(){const[n,a]=p.useState(!1),i=p.useMemo(()=>window.__SHOPIFY_API_KEY?window.__SHOPIFY_API_KEY:"2749a2f6d38ff5796ed256b5c9dc70a1",[]);return p.useEffect(()=>{setTimeout(()=>a(!0),100)},[]),!N||!U||!j?e.jsxs("div",{style:{padding:"20px",textAlign:"center"},children:[e.jsx("h1",{children:"Error: App must be loaded from Shopify Admin"}),e.jsxs("p",{children:["Shop: ",j||"Missing"]}),e.jsxs("p",{children:["Host: ",U||"Missing"]}),e.jsxs("p",{children:["Embedded: ",N?"Yes":"No"]}),e.jsx("a",{href:`https://admin.shopify.com/store/${j==null?void 0:j.replace(".myshopify.com","")}/apps`,children:"Go to Shopify Admin"})]}):i?n?e.jsx(ge,{}):e.jsx("div",{children:"Loading..."}):e.jsxs("div",{style:{padding:"20px",textAlign:"center"},children:[e.jsx("h1",{children:"Configuration Error"}),e.jsx("p",{children:"Shopify API key is not configured."}),e.jsx("p",{children:"Please contact support."})]})}B(document.getElementById("root")).render(e.jsx(_e,{}));export{b as d};
