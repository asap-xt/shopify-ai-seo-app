import{j as e,r as n}from"./react-vendor-BXVC7v0l.js";import{M as i,a,d as t,T as o,I as r,B as s,f as d,D as l,x as c,b as u,h}from"./polaris-leLMpU_u.js";function b({open:n,onClose:d,feature:l,tokensRequired:c,tokensAvailable:u,tokensNeeded:h,shop:b,needsUpgrade:p=!1,minimumPlan:g=null,currentPlan:m=null,returnTo:x="/billing",onBuyTokens:j=null}){const y={"ai-seo-product-basic":"AI Search Optimization (Products)","ai-seo-product-enhanced":"AI Search Optimization (Products - Enhanced)","ai-seo-collection":"AI Search Optimization (Collections)","ai-testing-simulation":"AI Testing & Simulation","ai-schema-advanced":"Advanced Schema Data","ai-sitemap-optimized":"AI-Optimized Sitemap"}[l]||"This feature";return e.jsx(i,{open:n,onClose:d,title:"ðŸ’³ Insufficient Tokens",primaryAction:{content:j?"Buy Tokens":"Go to Billing",onAction:()=>{if(j)return void j();const e=new URLSearchParams(window.location.search);e.delete("returnTo");const n=e.toString()?`?${e.toString()}`:"",i=n?"&":"?";window.location.href=`/billing${n}${i}returnTo=${encodeURIComponent(x)}`}},secondaryActions:[{content:"Cancel",onAction:d}],children:e.jsx(i.Section,{children:e.jsxs(a,{gap:"400",children:[e.jsx(t,{tone:"warning",children:e.jsxs(a,{gap:"200",children:[e.jsx(o,{variant:"bodyMd",fontWeight:"semibold",children:"You don't have enough tokens to use AI Enhancement"}),e.jsxs(r,{gap:"400",align:"space-between",blockAlign:"center",children:[e.jsxs(s,{children:[e.jsx(o,{variant:"bodySm",tone:"subdued",children:"Current balance:"}),e.jsxs(o,{variant:"headingSm",fontWeight:"bold",children:[(null==u?void 0:u.toLocaleString())||0," tokens"]})]}),e.jsxs(s,{children:[e.jsx(o,{variant:"bodySm",tone:"subdued",children:"Required:"}),e.jsxs(o,{variant:"headingSm",fontWeight:"bold",children:[((u||0)+(h||0)).toLocaleString()," tokens"]})]}),e.jsxs(s,{children:[e.jsx(o,{variant:"bodySm",tone:"subdued",children:"You need:"}),e.jsx(o,{variant:"headingSm",fontWeight:"bold",as:"span",children:e.jsxs("span",{style:{color:"#D82C0D"},children:[(null==h?void 0:h.toLocaleString())||0," more"]})})]})]})]})}),e.jsx(s,{background:"bg-surface-secondary",padding:"400",borderRadius:"200",children:e.jsxs(a,{gap:"200",children:[e.jsx(o,{variant:"headingMd",children:y}),e.jsx(o,{variant:"bodySm",tone:"subdued",children:"âœ… Buy tokens to use this AI-enhanced feature"}),p&&g&&e.jsxs(o,{variant:"bodySm",tone:"subdued",children:["âœ¨ Or upgrade to ",g," plan to get tokens included"]})]})}),p&&g&&e.jsx(t,{tone:"info",children:e.jsxs(a,{gap:"200",children:[e.jsxs(o,{variant:"bodyMd",fontWeight:"semibold",children:["ðŸ’¡ Upgrade to ",g," to get tokens included"]}),e.jsxs(o,{variant:"bodySm",children:["Current plan: ",e.jsx("strong",{children:m})]}),e.jsxs(o,{variant:"bodySm",tone:"subdued",children:[g," plans include AI tokens every month. Or you can purchase tokens separately while staying on your current plan."]})]})}),e.jsx(s,{background:"bg-surface-secondary",padding:"300",borderRadius:"200",children:e.jsxs(a,{gap:"100",children:[e.jsx(o,{variant:"bodySm",tone:"subdued",children:"ðŸ’¡ Tokens enable AI-powered features like AI Enhancement and AI Testing"}),e.jsx(o,{variant:"bodySm",tone:"subdued",children:"â™»ï¸ Tokens never expire and roll over indefinitely"}),e.jsx(o,{variant:"bodySm",tone:"subdued",children:"ðŸ›’ Purchase tokens or upgrade your plan from the Billing page"})]})})]})})})}function p({open:c,onClose:u,feature:h,trialEndsAt:b,currentPlan:p,tokensRequired:g,onActivatePlan:m,onPurchaseTokens:x}){const[j,y]=n.useState(null),[v,f]=n.useState(!1),S={"ai-seo-product-basic":"AI SEO Optimization (Products)","ai-seo-product-enhanced":"AI SEO Optimization (Products - Enhanced)","ai-seo-collection":"AI SEO Optimization (Collections)","ai-testing-simulation":"AI Testing & Simulation","ai-schema-advanced":"Advanced Schema Data","ai-sitemap-optimized":"AI-Optimized Sitemap"}[h]||"This feature";return e.jsx(i,{open:c,onClose:u,title:"ðŸ”“ Activate Feature",primaryAction:{content:v?"Processing...":"plan"===j?"Activate Plan":"tokens"===j?"Purchase Tokens":"Continue",disabled:!j,loading:v,onAction:async()=>{f(!0);try{"plan"===j?await m():"tokens"===j&&await x()}catch(e){}finally{f(!1)}}},secondaryActions:[{content:"Cancel",onAction:u,disabled:v}],children:e.jsx(i.Section,{children:e.jsxs(a,{gap:"400",children:[e.jsx(s,{background:"bg-surface-secondary",padding:"400",borderRadius:"200",children:e.jsxs(a,{gap:"200",children:[e.jsx(o,{variant:"headingMd",children:S}),e.jsx(o,{variant:"bodySm",tone:"subdued",children:"This AI-enhanced feature requires tokens or an active plan."}),g>0&&e.jsxs(r,{align:"space-between",children:[e.jsx(o,{variant:"bodySm",children:"Estimated cost:"}),e.jsxs(d,{tone:"info",children:[g.toLocaleString()," tokens"]})]})]})}),e.jsx(t,{tone:"info",children:e.jsxs(a,{gap:"200",children:[e.jsx(o,{variant:"bodyMd",fontWeight:"semibold",children:"You are currently in trial period"}),e.jsxs(o,{variant:"bodySm",children:["Trial ends: ",new Date(b).toLocaleDateString()]}),e.jsxs(o,{variant:"bodySm",children:["Current plan: ",e.jsx("strong",{children:p})]})]})}),e.jsx(l,{}),e.jsxs(a,{gap:"300",children:[e.jsx(o,{variant:"headingMd",children:"Choose how to proceed:"}),e.jsx(s,{padding:"400",borderWidth:"025",borderColor:"plan"===j?"border-brand":"border",borderRadius:"200",background:"plan"===j?"bg-surface-selected":"bg-surface",onClick:()=>y("plan"),style:{cursor:"pointer"},children:e.jsxs(a,{gap:"200",children:[e.jsxs(r,{align:"space-between",blockAlign:"center",children:[e.jsxs(r,{gap:"200",blockAlign:"center",children:[e.jsx(o,{variant:"bodyLg",children:"plan"===j?"âœ…":"â¬œ"}),e.jsx(o,{variant:"bodyMd",fontWeight:"semibold",children:"End Trial & Activate Plan"})]}),"plan"===j&&e.jsx(d,{tone:"success",children:"Selected"})]}),e.jsxs(o,{variant:"bodySm",tone:"subdued",children:["â€¢ Immediate billing for your ",p," plan"]}),e.jsx(o,{variant:"bodySm",tone:"subdued",children:"â€¢ Unlock all plan features now"}),e.jsx(o,{variant:"bodySm",tone:"subdued",children:"â€¢ You can purchase additional tokens anytime"}),"growth extra"===p||"enterprise"===p?e.jsx(o,{variant:"bodySm",tone:"success",fontWeight:"semibold",children:"â€¢ Includes monthly tokens in plan price"}):null]})}),e.jsx(s,{padding:"400",borderWidth:"025",borderColor:"tokens"===j?"border-brand":"border",borderRadius:"200",background:"tokens"===j?"bg-surface-selected":"bg-surface",onClick:()=>y("tokens"),style:{cursor:"pointer"},children:e.jsxs(a,{gap:"200",children:[e.jsxs(r,{align:"space-between",blockAlign:"center",children:[e.jsxs(r,{gap:"200",blockAlign:"center",children:[e.jsx(o,{variant:"bodyLg",children:"tokens"===j?"âœ…":"â¬œ"}),e.jsx(o,{variant:"bodyMd",fontWeight:"semibold",children:"Purchase Tokens Only"})]}),"tokens"===j&&e.jsx(d,{tone:"success",children:"Selected"})]}),e.jsxs(o,{variant:"bodySm",tone:"subdued",children:["â€¢ Your trial continues until ",new Date(b).toLocaleDateString()]}),e.jsx(o,{variant:"bodySm",tone:"subdued",children:"â€¢ One-time purchase (starting from $5)"}),e.jsx(o,{variant:"bodySm",tone:"subdued",children:"â€¢ Tokens never expire"}),e.jsx(o,{variant:"bodySm",tone:"subdued",children:"â€¢ Plan activates automatically after trial"})]})})]}),"plan"===j&&e.jsx(t,{tone:"warning",children:e.jsx(o,{variant:"bodySm",children:"Your trial will end immediately and you will be charged for the first billing period."})})]})})})}const g=[10,20,50,100];function m({open:d,onClose:b,shop:p,returnTo:m="/billing",inTrial:x=!1}){const[j,y]=n.useState(""),[v,f]=n.useState(g[0]),[S,k]=n.useState(!1),[A,w]=n.useState(null),T=()=>{y(""),f(g[0]),w(null),b()};return e.jsx(i,{open:d,onClose:T,title:"Purchase Tokens",primaryAction:{content:S?"Processing...":"Purchase",loading:S,onAction:async()=>{const e=parseFloat(j||v);if(!e||e<5||e%5!=0)w("Please enter a valid amount (minimum $5, multiples of $5)");else try{k(!0),w(null);const n=await fetch("/api/billing/tokens/purchase",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({shop:p,amount:e,returnTo:m})}),i=await n.json();if(!n.ok)throw new Error(i.error||"Failed to purchase tokens");i.confirmationUrl&&(window.top.location.href=i.confirmationUrl)}catch(n){w(n.message),k(!1)}}},secondaryActions:[{content:"Cancel",onAction:T}],children:e.jsx(i.Section,{children:e.jsxs(a,{gap:"400",children:[e.jsx(o,{variant:"headingMd",children:"Select Amount"}),e.jsx(c,{variant:"segmented",children:g.map(n=>e.jsxs(u,{pressed:v===n&&!j,onClick:()=>{f(n),y("")},children:["$",n]},n))}),e.jsx(o,{variant:"bodyMd",tone:"subdued",children:"Or enter a custom amount (multiples of $5)"}),e.jsx(h,{type:"number",value:j,onChange:e=>{y(e),f(null)},placeholder:"Enter amount",prefix:"$",min:5,step:5,autoComplete:"off"}),e.jsx(s,{background:"bg-surface-secondary",padding:"400",borderRadius:"200",children:e.jsxs(a,{gap:"200",children:[e.jsxs(r,{align:"space-between",children:[e.jsx(o,{variant:"bodyMd",children:"Amount"}),e.jsxs(o,{variant:"bodyMd",fontWeight:"semibold",children:["$",j||v]})]}),e.jsxs(r,{align:"space-between",children:[e.jsx(o,{variant:"bodyMd",children:"Tokens"}),e.jsx(o,{variant:"bodyMd",fontWeight:"semibold",children:(e=>{const n=.15*e/.16;return Math.floor(1e6*n)})(parseFloat(j||v)||0).toLocaleString()})]}),e.jsx(l,{}),e.jsx(o,{variant:"bodySm",tone:"subdued",children:"Tokens never expire and roll over indefinitely"})]})}),x&&e.jsx(t,{tone:"info",children:e.jsx("p",{children:"Your trial will continue after purchasing tokens."})}),A&&e.jsx(t,{tone:"critical",children:e.jsx("p",{children:A})})]})})})}export{b as I,p as T,m as a};
