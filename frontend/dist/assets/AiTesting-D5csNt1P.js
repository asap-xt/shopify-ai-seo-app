import{r as c,j as e,R as ke}from"./react-vendor-6uwpMgJP.js";import{m as Te}from"./sessionFetch-C95wjxRc.js";import{I as Pe}from"./InsufficientTokensModal-CWgAibhb.js";import{T as Ie}from"./TrialActivationModal-D5G7vt1Y.js";import{A as Ce}from"./AIEOScoreCard-Du5U_y-o.js";import{g as ae}from"./usePlanHierarchy-BjUEvxZF.js";import{a as d,d as j,T as t,L as V,C as z,B as b,I as l,b as h,e as re,f as r,D as k,h as Me,k as Re,M as C}from"./polaris-B96_d87K.js";import"./app-bridge-ugs9K9zh.js";import"./vendor-BC2YhXnC.js";import"./index-x4Nl581N.js";const Ee=(J,o="")=>{try{return new URLSearchParams(window.location.search).get(J)||o}catch{return o}};function Qe({shop:J}){const o=J||Ee("shop",""),oe=i=>{const s=new URLSearchParams(window.location.search),a=s.toString()?`?${s.toString()}`:"";window.location.href=`${i}${a}`},[Q,m]=c.useState(""),S=c.useMemo(()=>Te(),[]),[v,Y]=c.useState(null),[H,T]=c.useState(""),[le,K]=c.useState(!1),[f,ce]=c.useState(null),[$,de]=c.useState(""),[he,M]=c.useState(!1),[ue,U]=c.useState(!1),[ge,G]=c.useState(!1),[u,y]=c.useState(null),[pe,X]=c.useState(!1),[w,De]=c.useState(null),[A,F]=c.useState({}),[P,Z]=c.useState(!1),[xe,_]=c.useState(0),[n,L]=c.useState({}),[R,ee]=c.useState(!1),[me,se]=c.useState(0),[B,N]=c.useState(null),[Oe,te]=c.useState(null),[$e,W]=c.useState(null),[je,be]=c.useState({totalProducts:0,optimizedProducts:0,totalCollections:0,optimizedCollections:0}),[ne,ie]=c.useState(null);c.useEffect(()=>{o&&(ye(),E(),we(),Se())},[o,S]);const Se=()=>{try{const i=localStorage.getItem(`ai-test-results-${o}`);if(i){const a=JSON.parse(i);a.results&&a.timestamp&&(F(a.results),ie(new Date(a.timestamp)))}const s=localStorage.getItem(`ai-validation-results-${o}`);if(s){const a=JSON.parse(s);a.results&&L(a.results)}}catch(i){console.error("[AI-TESTING] Error loading saved test results:",i)}},fe=i=>{try{const s={results:i,timestamp:new Date().toISOString()};localStorage.setItem(`ai-test-results-${o}`,JSON.stringify(s)),ie(new Date)}catch(s){console.error("[AI-TESTING] Error saving test results:",s)}};c.useEffect(()=>{const i=()=>{!document.hidden&&o&&E()};return document.addEventListener("visibilitychange",i),()=>{document.removeEventListener("visibilitychange",i)}},[o,S]);const ye=async()=>{var i,s,a;try{const g=await S(`/api/billing/info?shop=${o}`),x=((i=g==null?void 0:g.subscription)==null?void 0:i.plan)||"Starter";Y(x),N(((s=g==null?void 0:g.tokens)==null?void 0:s.balance)||0),te(((a=g==null?void 0:g.subscription)==null?void 0:a.trialEndsAt)||null)}catch(g){console.error("[AI-TESTING] Error loading billing info:",g),Y("Starter"),N(0)}},E=async()=>{var i,s;try{const a=await S(`/api/billing/info?shop=${o}`);N(((i=a==null?void 0:a.tokens)==null?void 0:i.balance)||0),te(((s=a==null?void 0:a.subscription)==null?void 0:s.trialEndsAt)||null)}catch(a){console.error("[AI-TESTING] Error loading token balance:",a)}},we=async()=>{var i,s,a,g;try{let x=null;try{const p=localStorage.getItem(`dashboard-stats-${o}`);if(p){const O=JSON.parse(p);(O.timestamp?Date.now()-new Date(O.timestamp).getTime():1/0)<5*60*1e3&&(x=O)}}catch(p){console.error("[AI-TESTING] Error loading stats from localStorage:",p)}if(!x){const p=await S(`/api/dashboard/stats?shop=${o}`);x={totalProducts:((i=p==null?void 0:p.products)==null?void 0:i.total)||0,optimizedProducts:((s=p==null?void 0:p.products)==null?void 0:s.optimized)||0,totalCollections:((a=p==null?void 0:p.collections)==null?void 0:a.total)||0,optimizedCollections:((g=p==null?void 0:p.collections)==null?void 0:g.optimized)||0,timestamp:new Date().toISOString()};try{localStorage.setItem(`dashboard-stats-${o}`,JSON.stringify(x))}catch(O){console.error("[AI-TESTING] Error saving stats to localStorage:",O)}}be({totalProducts:x.totalProducts||0,optimizedProducts:x.optimizedProducts||0,totalCollections:x.totalCollections||0,optimizedCollections:x.optimizedCollections||0})}catch(x){console.error("[AI-TESTING] Error loading stats:",x)}},I=i=>{if(!v)return!1;const s=ae(v);switch(i){case"productsJson":return s>=0;case"storeMetadata":return s>=1;case"welcomePage":case"collectionsJson":return s>=2;case"aiSitemap":return s>=3;case"schemaData":return s>=4;case"meta":return s>=0;case"claude":return s>=0;case"gemini":return s>=1;case"chatgpt":return s>=2;case"perplexity":return s>=3;case"deepseek":return s>=4;default:return!1}},q=(i,s)=>{ce({name:i,url:s}),K(!0)},Ae=async()=>{Z(!0),_(0),F({});try{const i=await S("/api/ai-testing/run-tests",{method:"POST",body:{shop:o}});i.results?(F(i.results),_(100),fe(i.results),m("Basic tests completed!")):m("Testing failed. Please try again.")}catch(i){console.error("[AI-TESTING] Error running tests:",i),m("Failed to run tests. Please try again.")}finally{Z(!1)}},ve=async()=>{if(ae(v)<1){y({message:"AI-powered validation requires Professional plan or higher",requiredPlan:"Professional",currentPlan:v||"Starter"}),M(!0);return}ee(!0),se(0),L({});try{const s=await S("/api/ai-testing/ai-validate",{method:"POST",body:{shop:o,endpointResults:A}});if(s&&s.results){L(s.results),se(100);try{const a={results:s.results,timestamp:new Date().toISOString()};localStorage.setItem(`ai-validation-results-${o}`,JSON.stringify(a))}catch(a){console.error("[AI-TESTING] Error saving AI test results:",a)}if(s.aiEOScore){const a=s.aiEOScore;W(a),m(`AI validation completed! Score: ${a.score||"N/A"}/100 (${s.tokensUsed||0} tokens used)`)}else W(null),m(`AI validation completed! (${s.tokensUsed||0} tokens used)`);E()}else W(null),m("AI validation failed. Please try again.")}catch(s){if(s.status===402){if(s.trialRestriction&&s.requiresActivation){y(s),G(!0);return}if(s.requiresUpgrade){y(s),M(!0);return}if(s.requiresPurchase){y(s),U(!0);return}}m("Failed to run AI validation. Please try again.")}finally{ee(!1)}},D=async(i,s=null)=>{try{T("Generating AI response...");let a=`/api/ai-discovery/simulate?shop=${o}&type=${i}`;s&&(a+=`&question=${encodeURIComponent(s)}`);const g=await S(a,{method:"GET"});T(g.response||"No response generated")}catch(a){if(console.error("[AI-TESTING] Simulation error:",a),a.status===402){if(a.trialRestriction&&a.requiresActivation){y(a),G(!0),T("");return}if(a.requiresUpgrade){y(a),M(!0),T("");return}if(a.requiresPurchase){y(a),U(!0),T("");return}}T("Error generating response. Please try again."),m("Failed to simulate AI response")}};return e.jsxs(e.Fragment,{children:[e.jsxs(d,{gap:"400",children:[e.jsx(j,{tone:"info",children:e.jsx(t,{children:"Test how AI models discover and understand your store content. Check if your structured data and AI Discovery features are working correctly."})}),e.jsx(Ce,{testResults:A,aiTestResults:n,stats:je}),e.jsxs(V,{children:[e.jsx(V.Section,{variant:"oneHalf",children:e.jsx(z,{children:e.jsx(b,{padding:"300",children:e.jsxs(d,{gap:"400",children:[e.jsxs(l,{align:"space-between",blockAlign:"center",children:[e.jsxs(d,{gap:"100",children:[e.jsx(t,{as:"h3",variant:"headingMd",children:"ðŸ”§ Basic AIEO Tests"}),e.jsx(t,{variant:"bodySm",tone:"subdued",children:"Quick check if endpoints are accessible and returning data"})]}),e.jsx(h,{onClick:Ae,loading:P,disabled:P,children:P?"Testing...":"Run Basic Tests"})]}),ne&&Object.keys(A).length>0&&!P&&e.jsx(j,{tone:"info",children:e.jsxs(t,{variant:"bodySm",children:["These results are from ",ne.toLocaleString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),". Run Basic Tests again to refresh."]})}),P&&e.jsx(b,{children:e.jsxs(d,{gap:"200",children:[e.jsx(t,{variant:"bodySm",children:"Testing endpoints..."}),e.jsx(re,{progress:xe,size:"small"})]})}),Object.keys(A).length>0&&e.jsx(d,{gap:"300",children:Object.entries(A).map(([i,s],a)=>{const g=a===Object.entries(A).length-1;return e.jsxs(ke.Fragment,{children:[e.jsx(l,{align:"space-between",blockAlign:"center",children:e.jsxs(d,{gap:"100",children:[e.jsxs(l,{gap:"200",blockAlign:"center",children:[e.jsx(t,{variant:"bodyMd",fontWeight:"semibold",children:s.name}),s.status==="success"&&e.jsx(r,{tone:"success",children:"âœ“ OK"}),s.status==="warning"&&e.jsx(r,{tone:"warning",children:"âš ï¸ Warning"}),s.status==="error"&&e.jsx(r,{tone:"critical",children:"âœ— Failed"}),s.status==="locked"&&e.jsx(r,{children:"ðŸ”’ Locked"})]}),e.jsx(t,{variant:"bodySm",tone:"subdued",children:s.message}),s.actionLink&&e.jsx(h,{size:"slim",onClick:()=>oe(s.actionLink),children:i==="basicSitemap"?"Go to Sitemap":i==="aiSitemap"?"Go to Settings":"Go"})]})}),!g&&e.jsx(k,{})]},i)})}),Object.keys(A).length===0&&!P&&e.jsx(j,{tone:"info",children:e.jsx(t,{children:'Click "Run Basic Tests" to check if your AI Discovery endpoints are configured correctly.'})})]})})})}),e.jsx(V.Section,{variant:"oneHalf",children:e.jsx(z,{children:e.jsx(b,{padding:"300",children:e.jsxs(d,{gap:"400",children:[e.jsxs(l,{align:"space-between",blockAlign:"center",children:[e.jsxs(d,{gap:"100",children:[e.jsxs(l,{gap:"200",blockAlign:"center",children:[e.jsx(t,{as:"h3",variant:"headingMd",children:"ðŸ¤– AI-Powered Validation"}),B!==null&&e.jsxs(r,{tone:B>50?"success":"warning",children:[B," tokens"]}),e.jsx(h,{size:"micro",onClick:()=>E(),accessibilityLabel:"Refresh token balance",children:"ðŸ”„"})]}),e.jsx(t,{variant:"bodySm",tone:"subdued",children:"Deep analysis with AI bot"}),v&&e.jsx(t,{variant:"bodySm",tone:"subdued",children:"Requires: Professional+ plan & pay-per-use tokens"})]}),e.jsx(h,{onClick:ve,loading:R,disabled:R||Object.keys(A).length===0,variant:"primary",children:R?"Validating...":"Test with AI Bot"})]}),R&&e.jsx(b,{children:e.jsxs(d,{gap:"200",children:[e.jsx(t,{variant:"bodySm",children:"AI is analyzing your endpoints..."}),e.jsx(re,{progress:me,size:"small",tone:"primary"})]})}),Object.keys(n).length>0&&e.jsxs(d,{gap:"300",children:[n.productsJson&&e.jsxs(e.Fragment,{children:[e.jsx(l,{align:"space-between",blockAlign:"center",children:e.jsxs(d,{gap:"100",children:[e.jsxs(l,{gap:"200",blockAlign:"center",children:[e.jsx(t,{variant:"bodyMd",fontWeight:"semibold",children:"Products JSON Feed"}),n.productsJson.rating==="excellent"&&e.jsx(r,{tone:"success",children:"ðŸ¤– Excellent"}),n.productsJson.rating==="good"&&e.jsx(r,{tone:"success",children:"ðŸ¤– Good"}),n.productsJson.rating==="fair"&&e.jsx(r,{tone:"warning",children:"ðŸ¤– Fair"}),n.productsJson.rating==="poor"&&e.jsx(r,{tone:"critical",children:"ðŸ¤– Poor"}),n.productsJson.rating==="locked"&&e.jsx(r,{children:"ðŸ”’ Locked"}),n.productsJson.rating==="unavailable"&&e.jsx(r,{tone:"critical",children:"âŒ Unavailable"})]}),e.jsx(t,{variant:"bodySm",children:n.productsJson.feedback}),n.productsJson.suggestions&&e.jsxs(t,{variant:"bodySm",tone:"subdued",children:["ðŸ’¡ ",n.productsJson.suggestions]})]})}),e.jsx(k,{})]}),n.storeMetadata&&e.jsxs(e.Fragment,{children:[e.jsx(l,{align:"space-between",blockAlign:"center",children:e.jsxs(d,{gap:"100",children:[e.jsxs(l,{gap:"200",blockAlign:"center",children:[e.jsx(t,{variant:"bodyMd",fontWeight:"semibold",children:"Store Metadata"}),n.storeMetadata.rating==="excellent"&&e.jsx(r,{tone:"success",children:"ðŸ¤– Excellent"}),n.storeMetadata.rating==="good"&&e.jsx(r,{tone:"success",children:"ðŸ¤– Good"}),n.storeMetadata.rating==="fair"&&e.jsx(r,{tone:"warning",children:"ðŸ¤– Fair"}),n.storeMetadata.rating==="poor"&&e.jsx(r,{tone:"critical",children:"ðŸ¤– Poor"}),n.storeMetadata.rating==="locked"&&e.jsx(r,{children:"ðŸ”’ Locked"}),n.storeMetadata.rating==="unavailable"&&e.jsx(r,{tone:"critical",children:"âŒ Unavailable"})]}),e.jsx(t,{variant:"bodySm",children:n.storeMetadata.feedback}),n.storeMetadata.suggestions&&e.jsxs(t,{variant:"bodySm",tone:"subdued",children:["ðŸ’¡ ",n.storeMetadata.suggestions]})]})}),e.jsx(k,{})]}),n.welcomePage&&e.jsxs(e.Fragment,{children:[e.jsx(l,{align:"space-between",blockAlign:"center",children:e.jsxs(d,{gap:"100",children:[e.jsxs(l,{gap:"200",blockAlign:"center",children:[e.jsx(t,{variant:"bodyMd",fontWeight:"semibold",children:"AI Welcome Page"}),n.welcomePage.rating==="excellent"&&e.jsx(r,{tone:"success",children:"ðŸ¤– Excellent"}),n.welcomePage.rating==="good"&&e.jsx(r,{tone:"success",children:"ðŸ¤– Good"}),n.welcomePage.rating==="fair"&&e.jsx(r,{tone:"warning",children:"ðŸ¤– Fair"}),n.welcomePage.rating==="poor"&&e.jsx(r,{tone:"critical",children:"ðŸ¤– Poor"}),n.welcomePage.rating==="locked"&&e.jsx(r,{children:"ðŸ”’ Locked"}),n.welcomePage.rating==="unavailable"&&e.jsx(r,{tone:"critical",children:"âŒ Unavailable"})]}),e.jsx(t,{variant:"bodySm",children:n.welcomePage.feedback}),n.welcomePage.suggestions&&e.jsxs(t,{variant:"bodySm",tone:"subdued",children:["ðŸ’¡ ",n.welcomePage.suggestions]})]})}),e.jsx(k,{})]}),n.collectionsJson&&e.jsxs(e.Fragment,{children:[e.jsx(l,{align:"space-between",blockAlign:"center",children:e.jsxs(d,{gap:"100",children:[e.jsxs(l,{gap:"200",blockAlign:"center",children:[e.jsx(t,{variant:"bodyMd",fontWeight:"semibold",children:"Collections JSON Feed"}),n.collectionsJson.rating==="excellent"&&e.jsx(r,{tone:"success",children:"ðŸ¤– Excellent"}),n.collectionsJson.rating==="good"&&e.jsx(r,{tone:"success",children:"ðŸ¤– Good"}),n.collectionsJson.rating==="fair"&&e.jsx(r,{tone:"warning",children:"ðŸ¤– Fair"}),n.collectionsJson.rating==="poor"&&e.jsx(r,{tone:"critical",children:"ðŸ¤– Poor"}),n.collectionsJson.rating==="locked"&&e.jsx(r,{children:"ðŸ”’ Locked"}),n.collectionsJson.rating==="unavailable"&&e.jsx(r,{tone:"critical",children:"âŒ Unavailable"})]}),e.jsx(t,{variant:"bodySm",children:n.collectionsJson.feedback}),n.collectionsJson.suggestions&&e.jsxs(t,{variant:"bodySm",tone:"subdued",children:["ðŸ’¡ ",n.collectionsJson.suggestions]})]})}),e.jsx(k,{})]}),n.aiSitemap&&e.jsxs(e.Fragment,{children:[e.jsx(l,{align:"space-between",blockAlign:"center",children:e.jsxs(d,{gap:"100",children:[e.jsxs(l,{gap:"200",blockAlign:"center",children:[e.jsx(t,{variant:"bodyMd",fontWeight:"semibold",children:"AI-Enhanced Sitemap"}),n.aiSitemap.rating==="excellent"&&e.jsx(r,{tone:"success",children:"ðŸ¤– Excellent"}),n.aiSitemap.rating==="good"&&e.jsx(r,{tone:"success",children:"ðŸ¤– Good"}),n.aiSitemap.rating==="fair"&&e.jsx(r,{tone:"warning",children:"ðŸ¤– Fair"}),n.aiSitemap.rating==="poor"&&e.jsx(r,{tone:"critical",children:"ðŸ¤– Poor"}),n.aiSitemap.rating==="locked"&&e.jsx(r,{children:"ðŸ”’ Locked"}),n.aiSitemap.rating==="unavailable"&&e.jsx(r,{tone:"critical",children:"âŒ Unavailable"})]}),e.jsx(t,{variant:"bodySm",children:n.aiSitemap.feedback}),n.aiSitemap.suggestions&&e.jsxs(t,{variant:"bodySm",tone:"subdued",children:["ðŸ’¡ ",n.aiSitemap.suggestions]})]})}),e.jsx(k,{})]}),n.schemaData&&e.jsx(l,{align:"space-between",blockAlign:"center",children:e.jsxs(d,{gap:"100",children:[e.jsxs(l,{gap:"200",blockAlign:"center",children:[e.jsx(t,{variant:"bodyMd",fontWeight:"semibold",children:"Advanced Schema Data"}),n.schemaData.rating==="excellent"&&e.jsx(r,{tone:"success",children:"ðŸ¤– Excellent"}),n.schemaData.rating==="good"&&e.jsx(r,{tone:"success",children:"ðŸ¤– Good"}),n.schemaData.rating==="fair"&&e.jsx(r,{tone:"warning",children:"ðŸ¤– Fair"}),n.schemaData.rating==="poor"&&e.jsx(r,{tone:"critical",children:"ðŸ¤– Poor"}),n.schemaData.rating==="locked"&&e.jsx(r,{children:"ðŸ”’ Locked"}),n.schemaData.rating==="unavailable"&&e.jsx(r,{tone:"critical",children:"âŒ Unavailable"})]}),e.jsx(t,{variant:"bodySm",children:n.schemaData.feedback}),n.schemaData.suggestions&&e.jsxs(t,{variant:"bodySm",tone:"subdued",children:["ðŸ’¡ ",n.schemaData.suggestions]})]})})]}),Object.keys(n).length===0&&!R&&e.jsx(j,{tone:"info",children:e.jsx(t,{children:Object.keys(A).length===0?"Run Basic Tests first, then use AI validation for deep analysis":'Click "Test with AI Bot" to get AI-powered feedback on your endpoint data quality'})}),!v&&e.jsx(j,{tone:"warning",children:e.jsx(t,{children:"Loading plan information..."})})]})})})})]}),e.jsx(z,{children:e.jsx(b,{padding:"300",children:e.jsxs(d,{gap:"400",children:[e.jsx(t,{as:"h3",variant:"headingMd",children:"Test with Real AI Bots"}),e.jsx(t,{variant:"bodyMd",tone:"subdued",children:"Manually test your store with real AI search engines"}),e.jsxs(d,{gap:"200",children:[e.jsxs(l,{align:"space-between",children:[e.jsx(t,{children:"Meta AI Search"}),I("meta")?e.jsx(h,{onClick:()=>q("Meta AI","https://www.meta.ai/"),size:"slim",children:"Test"}):e.jsx(h,{disabled:!0,size:"slim",children:"Plan upgrade required"})]}),e.jsxs(l,{align:"space-between",children:[e.jsx(t,{children:"Claude AI Search"}),I("claude")?e.jsx(h,{onClick:()=>q("Claude AI","https://claude.ai/"),size:"slim",children:"Test"}):e.jsx(h,{disabled:!0,size:"slim",children:"Plan upgrade required"})]}),e.jsxs(l,{align:"space-between",children:[e.jsx(t,{children:"Gemini AI Search"}),I("gemini")?e.jsx(h,{onClick:()=>q("Gemini AI","https://gemini.google.com/"),size:"slim",children:"Test"}):e.jsx(h,{disabled:!0,size:"slim",children:"Plan upgrade required"})]}),e.jsxs(l,{align:"space-between",children:[e.jsx(t,{children:"ChatGPT Web Search"}),I("chatgpt")?e.jsx(h,{url:`https://chat.openai.com/?q=What+products+does+${o}+sell%3F+Tell+me+about+this+business+and+what+they+offer`,external:!0,size:"slim",children:"Test"}):e.jsx(h,{disabled:!0,size:"slim",children:"Plan upgrade required"})]}),e.jsxs(l,{align:"space-between",children:[e.jsx(t,{children:"Perplexity AI Search"}),I("perplexity")?e.jsx(h,{url:`https://www.perplexity.ai/search?q=What+products+does+${o}+sell%3F+Tell+me+about+this+business+and+what+they+offer`,external:!0,size:"slim",children:"Test"}):e.jsx(h,{disabled:!0,size:"slim",children:"Plan upgrade required"})]}),e.jsxs(l,{align:"space-between",children:[e.jsx(t,{children:"DeepSeek AI Search"}),I("deepseek")?e.jsx(h,{onClick:()=>q("DeepSeek AI","https://chat.deepseek.com/"),size:"slim",children:"Test"}):e.jsx(h,{disabled:!0,size:"slim",children:"Plan upgrade required"})]})]}),e.jsx(j,{tone:"info",children:e.jsxs(t,{children:[e.jsx("strong",{children:"How to test with AI bots:"}),e.jsx("br",{}),"â€¢ ",e.jsx("strong",{children:"Perplexity & ChatGPT:"}),' Click "Test" - they support URL parameters',e.jsx("br",{}),"â€¢ ",e.jsx("strong",{children:"Meta AI, Claude, Gemini, DeepSeek:"}),' Click "Test" to open a modal with the prompt to copy']})})]})})}),e.jsx(z,{children:e.jsx(b,{padding:"300",children:e.jsxs(d,{gap:"300",children:[e.jsx(t,{as:"h4",variant:"headingSm",children:"AI Search Simulation"}),e.jsx(t,{variant:"bodyMd",tone:"subdued",children:"Test how AI bots would respond to questions about your store based on your structured data."}),e.jsx(j,{tone:"info",children:e.jsxs(d,{gap:"100",children:[e.jsx(t,{variant:"bodySm",fontWeight:"semibold",children:"Simulation Details:"}),e.jsxs(t,{variant:"bodySm",children:["â€¢ ",e.jsx("strong",{children:"Data Source:"})," Your store's products, collections, and metadata"]}),e.jsxs(t,{variant:"bodySm",children:["â€¢ ",e.jsx("strong",{children:"Response Style:"})," Concise (2-3 sentences), natural language"]}),e.jsxs(t,{variant:"bodySm",children:["â€¢ ",e.jsx("strong",{children:"Best For:"})," General store info, products, categories, contact details"]}),e.jsxs(t,{variant:"bodySm",children:["â€¢ ",e.jsx("strong",{children:"Limitations:"})," May not have real-time data (current stock, active promotions, exact shipping times)"]})]})}),e.jsxs(d,{gap:"200",children:[e.jsxs(l,{align:"space-between",children:[e.jsx(t,{children:"What products does this store sell?"}),e.jsx(h,{onClick:()=>D("products"),size:"slim",children:"Simulate Response"})]}),e.jsxs(l,{align:"space-between",children:[e.jsx(t,{children:"Tell me about this business"}),e.jsx(h,{onClick:()=>D("business"),size:"slim",children:"Simulate Response"})]}),e.jsxs(l,{align:"space-between",children:[e.jsx(t,{children:"What categories does this store have?"}),e.jsx(h,{onClick:()=>D("categories"),size:"slim",children:"Simulate Response"})]}),e.jsxs(l,{align:"space-between",children:[e.jsx(t,{children:"What is this store's contact information?"}),e.jsx(h,{onClick:()=>D("contact"),size:"slim",children:"Simulate Response"})]})]}),e.jsx(k,{}),e.jsxs(d,{gap:"200",children:[e.jsx(t,{variant:"headingSm",children:"Ask Your Own Question"}),e.jsx(Me,{label:"",value:$,onChange:de,placeholder:"e.g., What are your return policies? Do you ship internationally?",autoComplete:"off",connectedRight:e.jsx(h,{onClick:()=>{$.trim()?D("custom",$):m("Please enter a question")},disabled:!$.trim(),children:"Ask AI"})})]}),H&&e.jsxs(b,{background:"bg-surface-secondary",padding:"300",borderRadius:"200",children:[e.jsx(t,{variant:"bodyMd",fontWeight:"semibold",children:"AI Bot Response:"}),e.jsx(b,{paddingBlockStart:"200",children:e.jsx(t,{variant:"bodyMd",children:H})})]})]})})})]}),Q&&e.jsx(Re,{content:Q,onDismiss:()=>m("")}),e.jsx(C,{open:le,onClose:()=>K(!1),title:`Test with ${f==null?void 0:f.name}`,primaryAction:{content:"Open AI Bot",url:f==null?void 0:f.url,external:!0},secondaryActions:[{content:"Copy Prompt",onAction:()=>{navigator.clipboard.writeText(`What products does ${o} sell? Tell me about this business and what they offer.`),m("Prompt copied to clipboard!")}}],children:e.jsx(C.Section,{children:e.jsxs(d,{gap:"300",children:[e.jsx(t,{variant:"bodyMd",children:'1. Click "Copy Prompt" (left button)'}),e.jsxs(t,{variant:"bodyMd",children:['2. Click "Open AI Bot" (right button) to visit ',f==null?void 0:f.name]}),e.jsx(t,{variant:"bodyMd",children:"3. Paste the prompt and send"}),e.jsxs(b,{background:"bg-surface-secondary",padding:"300",borderRadius:"200",children:[e.jsx(t,{variant:"bodyMd",fontWeight:"semibold",children:"Prompt to test:"}),e.jsx(b,{paddingBlockStart:"200",children:e.jsxs(t,{variant:"bodyMd",as:"p",children:["What products does ",o," sell? Tell me about this business and what they offer."]})})]}),e.jsx(j,{tone:"info",children:e.jsx(t,{children:"The AI bot will search the web and use your store's structured data to answer."})})]})})}),e.jsx(C,{open:pe,onClose:()=>X(!1),title:"Upgrade Required",primaryAction:{content:"View Plans",onAction:()=>{const i=new URLSearchParams(window.location.search),s=i.toString()?`?${i.toString()}`:"";window.location.href=`/billing${s}`}},secondaryActions:[{content:"Cancel",onAction:()=>X(!1)}],children:e.jsx(C.Section,{children:e.jsxs(d,{gap:"300",children:[e.jsxs(t,{variant:"bodyMd",children:[e.jsx("strong",{children:w==null?void 0:w.endpoint})," requires ",e.jsx("strong",{children:w==null?void 0:w.requiredPlan})," plan or higher."]}),e.jsxs(t,{variant:"bodyMd",tone:"subdued",children:["Your current plan: ",e.jsx("strong",{children:w==null?void 0:w.currentPlan})]}),e.jsx(j,{tone:"info",children:e.jsx(t,{children:"Upgrade to access this advanced AI Discovery feature."})})]})})}),e.jsx(C,{open:he,onClose:()=>M(!1),title:"Upgrade Required",primaryAction:{content:"View Plans",onAction:()=>{const i=new URLSearchParams(window.location.search),s=i.toString()?`?${i.toString()}`:"";window.location.href=`/billing${s}`}},secondaryActions:[{content:"Cancel",onAction:()=>M(!1)}],children:e.jsx(C.Section,{children:e.jsxs(d,{gap:"300",children:[e.jsxs(t,{variant:"bodyMd",children:["AI Testing requires ",e.jsx("strong",{children:(u==null?void 0:u.minimumPlan)||"Professional"})," plan or higher."]}),e.jsxs(t,{variant:"bodyMd",tone:"subdued",children:["Your current plan: ",e.jsx("strong",{children:(u==null?void 0:u.currentPlan)||"Starter"})]}),e.jsx(j,{tone:"info",children:e.jsx(t,{children:"Upgrade to test AI responses with real store data."})})]})})}),e.jsx(Pe,{open:ue,onClose:()=>{U(!1),y(null),E()},tokensRequired:(u==null?void 0:u.tokensRequired)||0,tokensAvailable:(u==null?void 0:u.tokensAvailable)||0,tokensNeeded:(u==null?void 0:u.tokensNeeded)||0,feature:"ai-testing-simulation",shop:o,needsUpgrade:!1,returnTo:"/ai-testing"}),u&&e.jsx(Ie,{open:ge,onClose:()=>{G(!1),y(null)},feature:u.feature||"ai-testing-simulation",trialEndsAt:u.trialEndsAt,currentPlan:u.currentPlan||v,tokensRequired:u.tokensRequired||0,onActivatePlan:async()=>{try{const i=await S("/api/billing/activate",{method:"POST",body:JSON.stringify({shop:o,endTrial:!0,returnTo:"/ai-testing"})});if(i.requiresApproval&&i.confirmationUrl){window.top.location.href=i.confirmationUrl;return}window.location.reload()}catch(i){console.error("[AI-TESTING] âŒ Activation failed:",i);const s=new URLSearchParams(window.location.search),a=s.get("host"),g=s.get("embedded");window.location.href=`/billing?shop=${encodeURIComponent(o)}&embedded=${g}&host=${encodeURIComponent(a)}`}},onPurchaseTokens:()=>{const i=new URLSearchParams(window.location.search),s=i.get("host"),a=i.get("embedded");window.location.href=`/billing?shop=${encodeURIComponent(o)}&embedded=${a}&host=${encodeURIComponent(s)}&returnTo=${encodeURIComponent("/ai-testing")}`}})]})}export{Qe as default};
