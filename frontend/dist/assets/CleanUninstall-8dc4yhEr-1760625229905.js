import{j as e}from"./app-bridge-8HmHBxlZ-1760625229905.js";import{r as l}from"./react-vendor-tAaa2TlE-1760625229905.js";import{m as O}from"./index-CouBuSG_-1760625229905.js";import{d as t,C as L,a as d,I as s,T as n,h as P,D as h,f as o,B as D,M as p,k as B}from"./polaris-CRu-4Osh-1760625229905.js";function q(){var f,y,b,v,A,S,M,C,w,k;const x=((a,E="")=>{try{return new URLSearchParams(window.location.search).get(a)||E}catch{return E}})("shop",""),T=l.useMemo(()=>O(),[]),[U,r]=l.useState(!1),[c,u]=l.useState(!1),[i,N]=l.useState(null),[I,j]=l.useState(!1),[g,m]=l.useState("");return e.jsxs(t,{gap:"400",children:[e.jsx(L,{children:e.jsx(d,{padding:"600",children:e.jsxs(t,{gap:"600",children:[e.jsxs(s,{align:"space-between",blockAlign:"center",children:[e.jsxs(t,{gap:"200",children:[e.jsx(n,{as:"h1",variant:"headingLg",children:"🗑️ Clean & Uninstall"}),e.jsx(n,{variant:"bodyMd",tone:"subdued",children:"Prepare your store for app uninstallation"})]}),e.jsx(P,{tone:"critical",children:"DANGER ZONE"})]}),e.jsx(h,{}),e.jsx(o,{status:"warning",title:"Before you uninstall",children:e.jsx("p",{children:"We recommend cleaning up all app data from your store before uninstalling. This ensures no unused metafields or configurations are left behind."})}),e.jsxs(t,{gap:"400",children:[e.jsx(n,{variant:"headingMd",children:"What will be removed:"}),e.jsx(d,{paddingInlineStart:"400",children:e.jsxs(t,{gap:"200",children:[e.jsxs(s,{gap:"200",blockAlign:"start",children:[e.jsx(n,{variant:"bodyMd",children:"•"}),e.jsx(n,{variant:"bodyMd",children:"All SEO metafield definitions (seo_ai namespace)"})]}),e.jsxs(s,{gap:"200",blockAlign:"start",children:[e.jsx(n,{variant:"bodyMd",children:"•"}),e.jsx(n,{variant:"bodyMd",children:"All AI-generated content (titles, descriptions, bullets, FAQs)"})]}),e.jsxs(s,{gap:"200",blockAlign:"start",children:[e.jsx(n,{variant:"bodyMd",children:"•"}),e.jsx(n,{variant:"bodyMd",children:"Product & Collection SEO data (from Translate & Adapt)"})]}),e.jsxs(s,{gap:"200",blockAlign:"start",children:[e.jsx(n,{variant:"bodyMd",children:"•"}),e.jsx(n,{variant:"bodyMd",children:"Store metadata configurations (brand voice, policies, target audience)"})]}),e.jsxs(s,{gap:"200",blockAlign:"start",children:[e.jsx(n,{variant:"bodyMd",children:"•"}),e.jsx(n,{variant:"bodyMd",children:"Advanced schema data"})]}),e.jsxs(s,{gap:"200",blockAlign:"start",children:[e.jsx(n,{variant:"bodyMd",children:"•"}),e.jsx(n,{variant:"bodyMd",children:"All metafield definitions created by this app"})]})]})})]}),e.jsx(h,{}),e.jsxs(t,{gap:"300",children:[e.jsx(n,{variant:"headingMd",children:"How it works:"}),e.jsx(d,{paddingInlineStart:"400",children:e.jsxs("ol",{style:{margin:0,paddingLeft:"20px"},children:[e.jsx("li",{children:'Click "Clean & Prepare for Uninstall" button below'}),e.jsx("li",{children:"Confirm that you want to remove all app data"}),e.jsx("li",{children:"Wait for the cleanup process to complete"}),e.jsx("li",{children:"Follow the instructions to complete uninstall in Shopify Admin"})]})})]}),e.jsx(h,{}),e.jsx(s,{gap:"200",children:e.jsx(D,{variant:"primary",tone:"critical",size:"large",onClick:()=>r(!0),children:"Clean & Prepare for Uninstall"})}),e.jsx(o,{status:"info",children:e.jsxs("p",{children:["💡 ",e.jsx("strong",{children:"Important:"})," This action will NOT uninstall the app automatically. After cleaning, you'll receive instructions on how to complete the uninstall process in Shopify Admin."]})})]})})}),U&&e.jsx(p,{open:!0,title:"⚠️ Confirm Data Cleanup",onClose:()=>!c&&r(!1),primaryAction:{content:c?"Cleaning...":"Yes, Clean Everything",onAction:async()=>{u(!0);try{console.log("[UNINSTALL] Starting cleanup...");const a=await T(`/api/store/prepare-uninstall?shop=${x}`,{method:"POST",shop:x});console.log("[UNINSTALL] Cleanup result:",a),N(a),r(!1),j(!0)}catch(a){console.error("[UNINSTALL] Cleanup error:",a),m("Error cleaning app data: "+a.message),r(!1)}finally{u(!1)}},loading:c,destructive:!0},secondaryActions:[{content:"Cancel",onAction:()=>r(!1),disabled:c}],children:e.jsx(p.Section,{children:e.jsxs(t,{gap:"400",children:[e.jsx(o,{status:"critical",title:"This action cannot be undone!",children:e.jsx("p",{children:"All SEO content, metafields, and app configurations will be permanently deleted from your Shopify store."})}),e.jsx(n,{variant:"bodyMd",children:e.jsx("strong",{children:"Are you sure you want to proceed?"})}),e.jsx(n,{variant:"bodyMd",tone:"subdued",children:"This will remove:"}),e.jsx(d,{paddingInlineStart:"400",children:e.jsxs("ul",{style:{margin:0,paddingLeft:"20px"},children:[e.jsx("li",{children:"All product SEO metafields (titles, descriptions, bullets, FAQs)"}),e.jsx("li",{children:"All collection SEO metafields"}),e.jsx("li",{children:"Product & Collection SEO data (from Translate & Adapt)"}),e.jsx("li",{children:"Store metadata (brand voice, policies, target audience)"}),e.jsx("li",{children:"Advanced schema data"}),e.jsx("li",{children:"All metafield definitions created by this app"})]})})]})})}),I&&i&&e.jsx(p,{open:!0,title:"✅ App Data Cleaned Successfully",onClose:()=>j(!1),primaryAction:{content:"Go to Apps & Sales Channels",onAction:()=>{window.open("https://admin.shopify.com/store/"+x.replace(".myshopify.com","")+"/settings/apps","_blank")}},secondaryActions:[{content:"Close",onAction:()=>j(!1)}],children:e.jsx(p.Section,{children:e.jsxs(t,{gap:"400",children:[e.jsx(o,{status:"success",title:"Cleanup completed!",children:e.jsx("p",{children:"All app data has been removed from your Shopify store."})}),e.jsx(n,{variant:"headingMd",children:"Cleanup Summary:"}),e.jsxs(t,{gap:"200",children:[e.jsxs(s,{gap:"200",blockAlign:"start",children:[e.jsx(n,{variant:"bodyMd",children:"✓"}),e.jsxs(n,{variant:"bodyMd",children:["Metafield definitions deleted: ",e.jsx("strong",{children:((y=(f=i.results)==null?void 0:f.metafieldDefinitions)==null?void 0:y.deleted)||0})]})]}),e.jsxs(s,{gap:"200",blockAlign:"start",children:[e.jsx(n,{variant:"bodyMd",children:"✓"}),e.jsxs(n,{variant:"bodyMd",children:["Product SEO data cleared: ",e.jsx("strong",{children:((v=(b=i.results)==null?void 0:b.productSeoData)==null?void 0:v.cleared)||0})]})]}),e.jsxs(s,{gap:"200",blockAlign:"start",children:[e.jsx(n,{variant:"bodyMd",children:"✓"}),e.jsxs(n,{variant:"bodyMd",children:["Collection SEO data cleared: ",e.jsx("strong",{children:((S=(A=i.results)==null?void 0:A.collectionSeoData)==null?void 0:S.cleared)||0})]})]}),e.jsxs(s,{gap:"200",blockAlign:"start",children:[e.jsx(n,{variant:"bodyMd",children:"✓"}),e.jsxs(n,{variant:"bodyMd",children:["Store metadata: ",e.jsx("strong",{children:(C=(M=i.results)==null?void 0:M.storeMetadata)!=null&&C.deleted?"Removed":"Not found"})]})]}),e.jsxs(s,{gap:"200",blockAlign:"start",children:[e.jsx(n,{variant:"bodyMd",children:"✓"}),e.jsxs(n,{variant:"bodyMd",children:["Advanced schemas: ",e.jsx("strong",{children:(k=(w=i.results)==null?void 0:w.advancedSchemas)!=null&&k.deleted?"Removed":"Not found"})]})]})]}),e.jsx(h,{}),e.jsx(n,{variant:"headingMd",children:"Next Steps:"}),e.jsx(d,{paddingInlineStart:"400",children:e.jsxs("ol",{style:{margin:0,paddingLeft:"20px"},children:[e.jsxs("li",{children:["Go to ",e.jsx("strong",{children:"Settings → Apps and sales channels"})]}),e.jsxs("li",{children:["Find ",e.jsx("strong",{children:'"NEW AI SEO"'})," in the list"]}),e.jsxs("li",{children:["Click the ",e.jsx("strong",{children:"three dots (•••)"})," menu"]}),e.jsxs("li",{children:["Select ",e.jsx("strong",{children:'"Uninstall"'})]}),e.jsx("li",{children:"Confirm the uninstallation"})]})}),e.jsx(o,{status:"info",children:e.jsx("p",{children:"💡 Your store data is now clean. You can safely uninstall the app without leaving behind any unused metafields or configurations."})})]})})}),g&&e.jsx(B,{content:g,onDismiss:()=>m("")})]})}export{q as default};
