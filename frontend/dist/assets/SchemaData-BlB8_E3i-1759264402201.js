import{j as e}from"./app-bridge-CFGxy0pD-1759264402201.js";import{r as m}from"./react-vendor-tAaa2TlE-1759264402201.js";import{m as ee}from"./index-Dlp84G4A-1759264402201.js";import{C as j,a as l,d,r as se,T as n,h as E,t as te,I as h,g as k,B as c,u as g,i as ae,D as ne,k as ie}from"./polaris-C8EQiB-P-1759264402201.js";const q=(f,t="")=>{try{return new URLSearchParams(window.location.search).get(f)||t}catch{return t}};function de({shop:f}){const t=f||q("shop","");console.log("[SCHEMA-DATA] shopProp:",f),console.log('[SCHEMA-DATA] qs("shop"):',q("shop","")),console.log("[SCHEMA-DATA] final shop:",t),console.log("[SCHEMA-DATA] window.location.search:",window.location.search);const[w,L]=m.useState(0),[P,y]=m.useState(!0),[o,G]=m.useState({organization:null,website:null,products:[]}),[D,b]=m.useState(""),S=m.useMemo(()=>ee(),[]),[_,F]=m.useState(""),[T,U]=m.useState(null),[R,A]=m.useState(""),[W,H]=m.useState(!1),[p,B]=m.useState(null);m.useEffect(()=>{t&&(O(),N())},[t,S]);const N=async()=>{var a,s;try{const u=await S("/graphql",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:`
        query PlansMe($shop:String!) {
          plansMe(shop:$shop) {
            shop
            plan
            planKey
          }
        }
      `,variables:{shop:t}})});console.log("[SCHEMA-DATA] Plan data:",u),U((s=(a=u==null?void 0:u.data)==null?void 0:a.plansMe)==null?void 0:s.plan)}catch(r){console.error("[SCHEMA-DATA] Error loading plan:",r)}},I=a=>{if(console.log("[SCHEMA-DATA] isFeatureAvailable - currentPlan:",T),console.log("[SCHEMA-DATA] isFeatureAvailable - feature:",a),!T)return console.log("[SCHEMA-DATA] No current plan, returning false"),!1;const s=["Starter","Professional","Growth","Growth Extra","Enterprise"],r=s.indexOf(T);switch(console.log("[SCHEMA-DATA] Plan hierarchy:",s),console.log("[SCHEMA-DATA] Current plan index:",r),a){case"productsJson":return r>=0;case"welcomePage":return r>=2;case"collectionsJson":return r>=2;case"aiSitemap":return r>=3;case"schemaData":return r>=4;default:return!1}},C=a=>{switch(a){case"productsJson":return"Starter";case"welcomePage":return"Growth";case"collectionsJson":return"Growth";case"aiSitemap":return"Growth Extra";case"schemaData":return"Enterprise";default:return"Starter"}},v=async a=>{A("Loading simulation...");try{if(["Starter","Professional","Growth","Growth Extra","Enterprise"].indexOf(T)>=3){A("Loading AI simulation with Gemini...");const i=await S("/api/ai/simulate-response",{method:"POST",headers:{"X-Shop":t},body:{questionType:a,shop:t,context:{organization:o.organization,website:o.website}}});console.log("[SCHEMA-DATA] AI simulation response:",i),i&&i.aiResponse?A(i.aiResponse):i&&i.error?(console.error("[SCHEMA-DATA] AI simulation error:",i.error),A(`AI simulation error: ${i.error}. Using basic simulation.`),await M(a)):(console.warn("[SCHEMA-DATA] Unexpected AI simulation response:",i),A("AI simulation temporarily unavailable. Using basic simulation."),await M(a))}else await M(a)}catch(s){console.error("[SCHEMA-DATA] Error in AI simulation:",s),A("Error loading simulation data. Please try again.")}},$=(a,s)=>{B({name:a,url:s}),H(!0)},J=()=>{const a=`What products does ${t} sell? Tell me about this business and what they offer.`;navigator.clipboard.writeText(a).then(()=>{b("Prompt copied to clipboard!")}).catch(()=>{b("Failed to copy prompt")})},X=()=>{p!=null&&p.url&&window.open(p.url,"_blank")},M=async a=>{let s="";switch(a){case"products":const r=await S(`/api/products/list?shop=${t}&limit=5&optimized=true`,{headers:{"X-Shop":t}});if(r!=null&&r.products&&r.products.length>0){const i=r.products.slice(0,3).map(x=>x.title).join(", ");s=`Based on the structured data, ${t} sells ${r.products.length} optimized products including: ${i}${r.products.length>3?" and more.":"."}`}else s=`I can see that ${t} is a store, but I don't have detailed product information available in the structured data. The store may need to generate AI optimization data for their products.`;break;case"business":try{const i=await S(`/api/store/metadata?shop=${t}`,{headers:{"X-Shop":t}});if(i!=null&&i.seoMetadata){const x=JSON.parse(i.seoMetadata),Q=x.storeName||i.shopName||t,Z=x.fullDescription||i.description||"an online store";if(s=`${Q} is ${Z.toLowerCase()}.`,x.keywords&&x.keywords.length>0&&(s+=` They specialize in: ${x.keywords.slice(0,3).join(", ")}.`),i.aiMetadata){const z=JSON.parse(i.aiMetadata);z.businessType&&(s+=` This is a ${z.businessType}.`),z.shippingInfo&&(s+=` Shipping: ${z.shippingInfo}.`)}}else o.organization?(s=`${o.organization.name||t} is a business that ${o.organization.description?`offers ${o.organization.description.toLowerCase()}`:"operates an online store"}.`,o.organization.url&&(s+=` You can visit them at ${o.organization.url}.`)):s=`${t} appears to be an online store, but I don't have detailed business information available in the structured data. The store may need to configure their store metadata or organization schema.`}catch(i){console.error("[SCHEMA-DATA] Error fetching store metadata:",i),o.organization?(s=`${o.organization.name||t} is a business that ${o.organization.description?`offers ${o.organization.description.toLowerCase()}`:"operates an online store"}.`,o.organization.url&&(s+=` You can visit them at ${o.organization.url}.`)):s=`${t} appears to be an online store, but I don't have detailed business information available in the structured data. The store may need to configure their organization schema.`}break;case"categories":const u=await S(`/collections/list-graphql?shop=${t}&limit=5`,{headers:{"X-Shop":t}});if(u!=null&&u.collections&&u.collections.length>0){const i=u.collections.slice(0,3).map(x=>x.title).join(", ");s=`${t} has ${u.collections.length} product categories including: ${i}${u.collections.length>3?" and more.":"."}`}else s=`I can see that ${t} is a store, but I don't have detailed category information available in the structured data. The store may need to generate collections data.`;break;case"contact":if(o.organization&&o.organization.contactPoint){const i=o.organization.contactPoint;s=`For ${o.organization.name||t}, you can contact them`,i.telephone&&(s+=` by phone at ${i.telephone}`),i.email&&(s+=` or by email at ${i.email}`),s+="."}else s=`I can see that ${t} is a store, but I don't have contact information available in the structured data. The store may need to configure their organization schema with contact details.`;break;default:s="I don't have enough information to provide a detailed response about this store."}A(s)},O=async()=>{y(!0);try{console.log("[SCHEMA-DATA] loadSchemas - shop:",t);const a=`/api/schema/preview?shop=${encodeURIComponent(t)}`;console.log("[SCHEMA-DATA] loadSchemas - url:",a);const s=await S(a,{headers:{"X-Shop":t}});console.log("[SCHEMA-DATA] loadSchemas - response:",s),s.ok?(G(s.schemas),V(s.schemas)):b(`Error: ${s.error}`)}catch(a){console.error("[SCHEMA-DATA] loadSchemas - error:",a),b(`Failed to load schemas: ${a.message}`)}finally{y(!1)}},V=a=>{const s=[];a.organization&&s.push(a.organization),a.website&&s.push(a.website);const r=`<script type="application/ld+json">
${JSON.stringify(s,null,2)}
<\/script>`;F(r)},Y=async()=>{y(!0);try{console.log("[SCHEMA-DATA] handleRegenerate - shop:",t);const a=`/api/schema/generate?shop=${encodeURIComponent(t)}`;console.log("[SCHEMA-DATA] handleRegenerate - url:",a);const s=await S(a,{method:"POST",headers:{"X-Shop":t},body:{shop:t}});console.log("[SCHEMA-DATA] handleRegenerate - response:",s),s.ok?(b("Schemas regenerated successfully!"),O()):b(`Error: ${s.error}`)}catch(a){console.error("[SCHEMA-DATA] handleRegenerate - error:",a),b(`Failed to regenerate: ${a.message}`)}finally{y(!1)}},K=[{id:"overview",content:"Overview",accessibilityLabel:"Overview"},{id:"installation",content:"Installation",accessibilityLabel:"Installation"},{id:"ai-testing",content:"AI Testing",accessibilityLabel:"AI Testing"}];return P?e.jsx(j,{children:e.jsx(l,{padding:"400",children:e.jsxs(d,{gap:"400",align:"center",children:[e.jsx(se,{}),e.jsx(n,{children:"Loading schema data..."})]})})}):e.jsxs(e.Fragment,{children:[e.jsx(j,{children:e.jsx(l,{padding:"400",children:e.jsxs(d,{gap:"400",children:[e.jsx(n,{as:"h3",variant:"headingMd",children:"Schema.org Structured Data"}),e.jsx(E,{tone:"info",children:e.jsx(n,{children:"Schema.org structured data helps AI models understand your store content better, improving your visibility and search results."})}),e.jsxs(te,{tabs:K,selected:w,onSelect:L,children:[w===0&&e.jsx(l,{paddingBlockStart:"400",children:e.jsxs(d,{gap:"400",children:[e.jsx(j,{children:e.jsx(l,{padding:"300",children:e.jsxs(d,{gap:"300",children:[e.jsxs(h,{align:"space-between",children:[e.jsx(n,{as:"h4",variant:"headingSm",children:"Organization Schema"}),e.jsx(k,{tone:o.organization?"success":"warning",children:o.organization?"Active":"Not configured"})]}),!o.organization&&e.jsx(n,{as:"p",tone:"subdued",children:"Configure organization details in Store Metadata to enable this schema."})]})})}),e.jsx(j,{children:e.jsx(l,{padding:"300",children:e.jsxs(d,{gap:"300",children:[e.jsxs(h,{align:"space-between",children:[e.jsx(n,{as:"h4",variant:"headingSm",children:"WebSite Schema"}),e.jsx(k,{tone:o.website?"success":"warning",children:o.website?"Active":"Not configured"})]}),!o.website&&e.jsx(n,{as:"p",tone:"subdued",children:"Website schema is automatically generated from your store information."})]})})}),e.jsx(j,{children:e.jsx(l,{padding:"300",children:e.jsxs(d,{gap:"300",children:[e.jsxs(h,{align:"space-between",children:[e.jsx(n,{as:"h4",variant:"headingSm",children:"Product Schemas"}),e.jsx(k,{tone:"success",children:"Auto-generated"})]}),e.jsxs(n,{tone:"subdued",children:["Product schemas are automatically generated from your AI Optimisation data when pages load.",o.products.length>0&&` ${o.products.length} products have SEO data.`]})]})})}),e.jsxs(h,{gap:"300",children:[e.jsx(c,{onClick:Y,loading:P,children:"Regenerate Schemas"}),e.jsx(c,{variant:"plain",url:"https://developers.google.com/search/docs/appearance/structured-data",children:"Learn about Schema.org"})]})]})}),w===1&&e.jsx(l,{paddingBlockStart:"400",children:e.jsxs(d,{gap:"400",children:[e.jsx(j,{children:e.jsx(l,{padding:"300",children:e.jsxs(d,{gap:"300",children:[e.jsx(n,{as:"h4",variant:"headingSm",children:"Theme Installation"}),e.jsxs(g,{type:"number",children:[e.jsx(g.Item,{children:"Go to your Shopify Admin → Online Store → Themes"}),e.jsx(g.Item,{children:'Click "Actions" → "Edit code" on your current theme'}),e.jsxs(g.Item,{children:["Open the file: ",e.jsx("code",{children:"layout/theme.liquid"})]}),e.jsxs(g.Item,{children:["Add this code before the closing ",e.jsx("code",{children:"</head>"})," tag:"]})]}),e.jsx(l,{background:"bg-surface-secondary",padding:"200",borderRadius:"200",children:e.jsx("pre",{style:{fontSize:"12px",overflow:"auto",whiteSpace:"pre-wrap"},children:`{% comment %} Organization & WebSite Schema - AI SEO App {% endcomment %}
${_}

{% comment %} Product Schema - Dynamic {% endcomment %}
{% if template contains 'product' %}
  {% assign seo_bullets = product.metafields.seo_ai.bullets %}
  {% assign seo_faq = product.metafields.seo_ai.faq %}
  {% assign seo_data = product.metafields.seo_ai['seo__' | append: request.locale.iso_code] | default: product.metafields.seo_ai.seo__en %}
  
  {% if seo_data %}
    <script type="application/ld+json">
    {{ seo_data.jsonLd | json }}
    <\/script>
  {% endif %}
{% endif %}`})}),e.jsx(E,{tone:"warning",children:e.jsx(n,{children:"Always backup your theme before making changes!"})})]})})}),e.jsx(j,{children:e.jsx(l,{padding:"300",children:e.jsxs(d,{gap:"300",children:[e.jsx(n,{as:"h4",variant:"headingSm",children:"Testing Your Installation"}),e.jsxs(g,{children:[e.jsx(g.Item,{children:"After installation, visit your store's homepage and product pages"}),e.jsx(g.Item,{children:"View the page source (right-click → View Source)"}),e.jsxs(g.Item,{children:["Search for ",e.jsx("code",{children:"application/ld+json"})," to find your schemas"]}),e.jsx(g.Item,{children:"Use the Validation tab to test with Google's tools"})]})]})})})]})}),w===2&&e.jsx(l,{paddingBlockStart:"400",children:e.jsxs(d,{gap:"400",children:[e.jsx(j,{children:e.jsx(l,{padding:"300",children:e.jsxs(d,{gap:"300",children:[e.jsx(n,{as:"h4",variant:"headingSm",children:"AI Search Testing Tools"}),e.jsx(ae,{label:"Test URL",value:`https://${t}`,readOnly:!0,helpText:"Use this URL to test how AI bots understand your store"}),e.jsx(ne,{}),e.jsxs(d,{gap:"200",children:[e.jsxs(h,{align:"space-between",children:[e.jsx(n,{children:"Perplexity AI Search"}),e.jsx(c,{url:`https://www.perplexity.ai/search?q=What+products+does+${t}+sell%3F+Tell+me+about+this+business+and+what+they+offer`,external:!0,size:"slim",children:"Test"})]}),e.jsxs(h,{align:"space-between",children:[e.jsx(n,{children:"ChatGPT Web Search"}),e.jsx(c,{url:`https://chat.openai.com/?q=What+products+does+${t}+sell%3F+Tell+me+about+this+business+and+what+they+offer`,external:!0,size:"slim",children:"Test"})]}),e.jsxs(h,{align:"space-between",children:[e.jsx(n,{children:"Claude AI Search"}),I("welcomePage")?e.jsx(c,{onClick:()=>$("Claude AI","https://claude.ai/"),size:"slim",children:"Test"}):e.jsxs(c,{disabled:!0,size:"slim",children:[C("welcomePage"),"+ Required"]})]}),e.jsxs(h,{align:"space-between",children:[e.jsx(n,{children:"Gemini AI Search"}),I("welcomePage")?e.jsx(c,{onClick:()=>$("Gemini AI","https://gemini.google.com/"),size:"slim",children:"Test"}):e.jsxs(c,{disabled:!0,size:"slim",children:[C("welcomePage"),"+ Required"]})]}),e.jsxs(h,{align:"space-between",children:[e.jsx(n,{children:"Meta AI Search"}),I("aiSitemap")?e.jsx(c,{onClick:()=>$("Meta AI","https://www.meta.ai/"),size:"slim",children:"Test"}):e.jsxs(c,{disabled:!0,size:"slim",children:[C("aiSitemap"),"+ Required"]})]}),e.jsxs(h,{align:"space-between",children:[e.jsx(n,{children:"DeepSeek AI Search"}),I("schemaData")?e.jsx(c,{onClick:()=>$("DeepSeek AI","https://chat.deepseek.com/"),size:"slim",children:"Test"}):e.jsxs(c,{disabled:!0,size:"slim",children:[C("schemaData"),"+ Required"]})]})]}),e.jsx(E,{tone:"info",children:e.jsxs(n,{children:[e.jsx("strong",{children:"How to test with AI bots:"}),e.jsx("br",{}),"• ",e.jsx("strong",{children:"Perplexity & ChatGPT:"}),' Click "Test" - they support URL parameters',e.jsx("br",{}),"• ",e.jsx("strong",{children:"Claude, Gemini, Meta AI, DeepSeek:"}),' Click "Test" to open a modal with the prompt to copy']})})]})})}),e.jsx(j,{children:e.jsx(l,{padding:"300",children:e.jsxs(d,{gap:"300",children:[e.jsx(n,{as:"h4",variant:"headingSm",children:"AI Search Simulation"}),e.jsx(n,{variant:"bodyMd",tone:"subdued",children:"Test how AI bots would respond to questions about your store based on your structured data."}),e.jsxs(d,{gap:"200",children:[e.jsxs(h,{align:"space-between",children:[e.jsx(n,{children:"What products does this store sell?"}),e.jsx(c,{onClick:()=>v("products"),size:"slim",children:"Simulate Response"})]}),e.jsxs(h,{align:"space-between",children:[e.jsx(n,{children:"Tell me about this business"}),e.jsx(c,{onClick:()=>v("business"),size:"slim",children:"Simulate Response"})]}),e.jsxs(h,{align:"space-between",children:[e.jsx(n,{children:"What categories does this store have?"}),e.jsx(c,{onClick:()=>v("categories"),size:"slim",children:"Simulate Response"})]}),e.jsxs(h,{align:"space-between",children:[e.jsx(n,{children:"What is this store's contact information?"}),e.jsx(c,{onClick:()=>v("contact"),size:"slim",children:"Simulate Response"})]})]}),R&&e.jsxs(l,{background:"bg-surface-secondary",padding:"300",borderRadius:"200",children:[e.jsx(n,{variant:"bodyMd",fontWeight:"semibold",children:"AI Bot Response:"}),e.jsx(l,{paddingBlockStart:"200",children:e.jsx(n,{variant:"bodyMd",children:R})})]})]})})})]})})]})]})})}),D&&e.jsx(ie,{content:D,onDismiss:()=>b("")}),e.jsx(Modal,{open:W,onClose:()=>H(!1),title:`Test with ${p==null?void 0:p.name}`,primaryAction:{content:`Open ${p==null?void 0:p.name}`,onAction:X},secondaryActions:[{content:"Copy Prompt",onAction:J}],children:e.jsx(Modal.Section,{children:e.jsxs(d,{gap:"400",children:[e.jsxs(n,{children:["Copy the prompt below and paste it into ",p==null?void 0:p.name," to test how it responds to questions about your store:"]}),e.jsx(l,{background:"bg-surface-secondary",padding:"300",borderRadius:"200",children:e.jsxs(n,{as:"pre",variant:"bodyMd",children:["What products does ",t," sell? Tell me about this business and what they offer."]})}),e.jsx(n,{variant:"bodySm",tone:"subdued",children:"This prompt will help you see how AI bots understand and respond to questions about your store's products and business information."})]})})})]})}export{de as default};
