import{r as e,j as n}from"./react-vendor-BLtYaay5.js";import{M as o,a as s,T as t,w as a,b as r,h as i,B as l,I as c,D as d,d as h}from"./polaris-DLzuUptG.js";const u=[10,20,50,100];function p({open:p,onClose:m,shop:j,returnTo:x="/billing",inTrial:f=!1}){const[b,g]=e.useState(""),[y,v]=e.useState(u[0]),[w,S]=e.useState(!1),[T,k]=e.useState(null),M=()=>{g(""),v(u[0]),k(null),m()};return n.jsx(o,{open:p,onClose:M,title:"Purchase Tokens",primaryAction:{content:w?"Processing...":"Purchase",loading:w,onAction:async()=>{const e=parseFloat(b||y);if(!e||e<5||e%5!=0)k("Please enter a valid amount (minimum $5, multiples of $5)");else try{S(!0),k(null);const n=await fetch("/api/billing/tokens/purchase",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({shop:j,amount:e,returnTo:x})}),o=await n.json();if(!n.ok)throw new Error(o.error||"Failed to purchase tokens");o.confirmationUrl&&(window.top.location.href=o.confirmationUrl)}catch(n){k(n.message),S(!1)}}},secondaryActions:[{content:"Cancel",onAction:M}],children:n.jsx(o.Section,{children:n.jsxs(s,{gap:"400",children:[n.jsx(t,{variant:"headingMd",children:"Select Amount"}),n.jsx(a,{variant:"segmented",children:u.map(e=>n.jsxs(r,{pressed:y===e&&!b,onClick:()=>{v(e),g("")},children:["$",e]},e))}),n.jsx(t,{variant:"bodyMd",tone:"subdued",children:"Or enter a custom amount (multiples of $5)"}),n.jsx(i,{type:"number",value:b,onChange:e=>{g(e),v(null)},placeholder:"Enter amount",prefix:"$",min:5,step:5,autoComplete:"off"}),n.jsx(l,{background:"bg-surface-secondary",padding:"400",borderRadius:"200",children:n.jsxs(s,{gap:"200",children:[n.jsxs(c,{align:"space-between",children:[n.jsx(t,{variant:"bodyMd",children:"Amount"}),n.jsxs(t,{variant:"bodyMd",fontWeight:"semibold",children:["$",b||y]})]}),n.jsxs(c,{align:"space-between",children:[n.jsx(t,{variant:"bodyMd",children:"Tokens"}),n.jsx(t,{variant:"bodyMd",fontWeight:"semibold",children:(e=>{const n=.15*e/.16;return Math.floor(1e6*n)})(parseFloat(b||y)||0).toLocaleString()})]}),n.jsx(d,{}),n.jsx(t,{variant:"bodySm",tone:"subdued",children:"Tokens never expire and roll over indefinitely"})]})}),f&&n.jsx(h,{tone:"info",children:n.jsx("p",{children:"Your trial will continue after purchasing tokens."})}),T&&n.jsx(h,{tone:"critical",children:n.jsx("p",{children:T})})]})})})}export{p as T};
