import{j as e}from"./app-bridge-BZ2EDl-Q-1760682474808.js";import{r}from"./react-vendor-tAaa2TlE-1760682474808.js";import{m as V}from"./index-B1OlDfef-1760682474808.js";import{C as k,a as p,d as l,T as s,f as m,i as u,B as n,D as O,I as o,k as J,M as j}from"./polaris-BTxteoZ--1760682474808.js";const Y=(I,t="")=>{try{return new URLSearchParams(window.location.search).get(I)||t}catch{return t}};function Z({shop:I}){var G,z,D;const t=I||Y("shop",""),[P,w]=r.useState(""),T=r.useMemo(()=>V(),[]),[R,W]=r.useState(null),[$,g]=r.useState(""),[U,M]=r.useState(!1),[d,B]=r.useState(null),[y,F]=r.useState(""),[L,v]=r.useState(!1),[N,C]=r.useState(!1),[i,q]=r.useState(null);r.useEffect(()=>{t&&E()},[t,T]);const E=async()=>{var c,h;try{const x=await T("/graphql",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:`
        query PlansMe($shop:String!) {
          plansMe(shop:$shop) {
            shop
            plan
            planKey
          }
        }
      `,variables:{shop:t}})});console.log("[AI-TESTING] Plan data:",x),W((h=(c=x==null?void 0:x.data)==null?void 0:c.plansMe)==null?void 0:h.plan)}catch(a){console.error("[AI-TESTING] Error loading plan:",a)}},f=c=>{if(!R)return!1;const a=["Starter","Professional","Growth","Growth Extra","Enterprise"].indexOf(R);switch(c){case"productsJson":return a>=0;case"welcomePage":return a>=2;case"aiSitemap":return a>=2;case"schemaData":return a>=4;default:return!1}},S=c=>{switch(c){case"welcomePage":return"Growth";case"aiSitemap":return"Growth";case"schemaData":return"Enterprise";default:return"Professional"}},A=(c,h)=>{B({name:c,url:h}),M(!0)},b=async(c,h=null)=>{try{g("Generating AI response...");let a=`/api/ai-discovery/simulate?shop=${t}&type=${c}`;h&&(a+=`&question=${encodeURIComponent(h)}`);const x=await T(a,{method:"GET"});g(x.response||"No response generated")}catch(a){if(console.error("[AI-TESTING] Simulation error:",a),console.log("[AI-TESTING] Error status:",a.status),console.log("[AI-TESTING] Error requiresUpgrade:",a.requiresUpgrade),console.log("[AI-TESTING] Error requiresPurchase:",a.requiresPurchase),a.status===402){if(a.requiresUpgrade){q(a),v(!0),g("");return}if(a.requiresPurchase){q(a),C(!0),g("");return}}g("Error generating response. Please try again."),w("Failed to simulate AI response")}};return e.jsxs(e.Fragment,{children:[e.jsx(k,{children:e.jsx(p,{padding:"400",children:e.jsxs(l,{gap:"400",children:[e.jsx(s,{as:"h2",variant:"headingLg",children:"AI Testing"}),e.jsx(m,{tone:"info",children:e.jsx(s,{children:"Test how AI models discover and understand your store content. Check if your structured data and AI Discovery features are working correctly."})}),e.jsx(k,{children:e.jsx(p,{padding:"300",children:e.jsxs(l,{gap:"400",children:[e.jsx(s,{as:"h3",variant:"headingMd",children:"AI Discovery Endpoints"}),e.jsx(s,{variant:"bodyMd",tone:"subdued",children:"These are the URLs that AI bots use to discover and understand your store content."}),e.jsx(u,{label:"Products JSON Feed",value:`https://${t}/apps/new-ai-seo/ai/products.json?shop=${t}`,readOnly:!0,autoComplete:"off",connectedRight:e.jsx(n,{url:`https://${t}/apps/new-ai-seo/ai/products.json?shop=${t}`,external:!0,children:"View"}),helpText:"Bulk product data for AI consumption"}),e.jsx(u,{label:"AI Sitemap",value:`https://${t}/apps/new-ai-seo/ai/sitemap-feed.xml?shop=${t}`,readOnly:!0,autoComplete:"off",connectedRight:e.jsx(n,{url:`https://${t}/apps/new-ai-seo/ai/sitemap-feed.xml?shop=${t}`,external:!0,children:"View"}),helpText:"Optimized sitemap for AI bots"}),e.jsx(u,{label:"Store Metadata (AI Search)",value:`https://${t}/apps/new-ai-seo/ai/store-metadata.json?shop=${t}`,readOnly:!0,autoComplete:"off",connectedRight:e.jsx(n,{url:`https://${t}/apps/new-ai-seo/ai/store-metadata.json?shop=${t}`,external:!0,children:"View"}),helpText:"Organization schema & AI metadata"}),e.jsx(u,{label:"AI Welcome Page",value:`https://${t}/apps/new-ai-seo/ai/welcome?shop=${t}`,readOnly:!0,autoComplete:"off",connectedRight:e.jsx(n,{url:`https://${t}/apps/new-ai-seo/ai/welcome?shop=${t}`,external:!0,children:"View"}),helpText:"Landing page for AI bots"}),e.jsx(u,{label:"Collections JSON Feed",value:`https://${t}/apps/new-ai-seo/ai/collections-feed.json?shop=${t}`,readOnly:!0,autoComplete:"off",connectedRight:e.jsx(n,{url:`https://${t}/apps/new-ai-seo/ai/collections-feed.json?shop=${t}`,external:!0,children:"View"}),helpText:"Category data for better AI understanding"}),e.jsx(u,{label:"robots.txt (Dynamic)",value:`https://${t}/apps/new-ai-seo/ai/robots-dynamic?shop=${t}`,readOnly:!0,autoComplete:"off",connectedRight:e.jsx(n,{url:`https://${t}/apps/new-ai-seo/ai/robots-dynamic?shop=${t}`,external:!0,children:"View"}),helpText:"Use this URL to test how AI bots understand your store"}),e.jsx(O,{}),e.jsxs(l,{gap:"200",children:[e.jsxs(o,{align:"space-between",children:[e.jsx(s,{children:"Perplexity AI Search"}),e.jsx(n,{url:`https://www.perplexity.ai/search?q=What+products+does+${t}+sell%3F+Tell+me+about+this+business+and+what+they+offer`,external:!0,size:"slim",children:"Test"})]}),e.jsxs(o,{align:"space-between",children:[e.jsx(s,{children:"ChatGPT Web Search"}),e.jsx(n,{url:`https://chat.openai.com/?q=What+products+does+${t}+sell%3F+Tell+me+about+this+business+and+what+they+offer`,external:!0,size:"slim",children:"Test"})]}),e.jsxs(o,{align:"space-between",children:[e.jsx(s,{children:"Claude AI Search"}),f("welcomePage")?e.jsx(n,{onClick:()=>A("Claude AI","https://claude.ai/"),size:"slim",children:"Test"}):e.jsxs(n,{disabled:!0,size:"slim",children:[S("welcomePage"),"+ Required"]})]}),e.jsxs(o,{align:"space-between",children:[e.jsx(s,{children:"Gemini AI Search"}),f("welcomePage")?e.jsx(n,{onClick:()=>A("Gemini AI","https://gemini.google.com/"),size:"slim",children:"Test"}):e.jsxs(n,{disabled:!0,size:"slim",children:[S("welcomePage"),"+ Required"]})]}),e.jsxs(o,{align:"space-between",children:[e.jsx(s,{children:"Meta AI Search"}),f("aiSitemap")?e.jsx(n,{onClick:()=>A("Meta AI","https://www.meta.ai/"),size:"slim",children:"Test"}):e.jsxs(n,{disabled:!0,size:"slim",children:[S("aiSitemap"),"+ Required"]})]}),e.jsxs(o,{align:"space-between",children:[e.jsx(s,{children:"DeepSeek AI Search"}),f("schemaData")?e.jsx(n,{onClick:()=>A("DeepSeek AI","https://chat.deepseek.com/"),size:"slim",children:"Test"}):e.jsxs(n,{disabled:!0,size:"slim",children:[S("schemaData"),"+ Required"]})]})]}),e.jsx(m,{tone:"info",children:e.jsxs(s,{children:[e.jsx("strong",{children:"How to test with AI bots:"}),e.jsx("br",{}),"• ",e.jsx("strong",{children:"Perplexity & ChatGPT:"}),' Click "Test" - they support URL parameters',e.jsx("br",{}),"• ",e.jsx("strong",{children:"Claude, Gemini, Meta AI, DeepSeek:"}),' Click "Test" to open a modal with the prompt to copy']})})]})})}),e.jsx(k,{children:e.jsx(p,{padding:"300",children:e.jsxs(l,{gap:"300",children:[e.jsx(s,{as:"h4",variant:"headingSm",children:"AI Search Simulation"}),e.jsx(s,{variant:"bodyMd",tone:"subdued",children:"Test how AI bots would respond to questions about your store based on your structured data."}),e.jsx(m,{tone:"info",children:e.jsxs(l,{gap:"100",children:[e.jsx(s,{variant:"bodySm",fontWeight:"semibold",children:"Simulation Details:"}),e.jsxs(s,{variant:"bodySm",children:["• ",e.jsx("strong",{children:"AI Model:"})," Google Gemini 2.5 Flash Lite"]}),e.jsxs(s,{variant:"bodySm",children:["• ",e.jsx("strong",{children:"Data Source:"})," Your store's products, collections, and metadata"]}),e.jsxs(s,{variant:"bodySm",children:["• ",e.jsx("strong",{children:"Response Style:"})," Concise (2-3 sentences), natural language"]}),e.jsxs(s,{variant:"bodySm",children:["• ",e.jsx("strong",{children:"Best For:"})," General store info, products, categories, contact details"]}),e.jsxs(s,{variant:"bodySm",children:["• ",e.jsx("strong",{children:"Limitations:"})," May not have real-time data (current stock, active promotions, exact shipping times)"]})]})}),e.jsxs(l,{gap:"200",children:[e.jsxs(o,{align:"space-between",children:[e.jsx(s,{children:"What products does this store sell?"}),e.jsx(n,{onClick:()=>b("products"),size:"slim",children:"Simulate Response"})]}),e.jsxs(o,{align:"space-between",children:[e.jsx(s,{children:"Tell me about this business"}),e.jsx(n,{onClick:()=>b("business"),size:"slim",children:"Simulate Response"})]}),e.jsxs(o,{align:"space-between",children:[e.jsx(s,{children:"What categories does this store have?"}),e.jsx(n,{onClick:()=>b("categories"),size:"slim",children:"Simulate Response"})]}),e.jsxs(o,{align:"space-between",children:[e.jsx(s,{children:"What is this store's contact information?"}),e.jsx(n,{onClick:()=>b("contact"),size:"slim",children:"Simulate Response"})]})]}),e.jsx(O,{}),e.jsxs(l,{gap:"200",children:[e.jsx(s,{variant:"headingSm",children:"Ask Your Own Question"}),e.jsx(u,{label:"",value:y,onChange:F,placeholder:"e.g., What are your return policies? Do you ship internationally?",autoComplete:"off",connectedRight:e.jsx(n,{onClick:()=>{y.trim()?b("custom",y):w("Please enter a question")},disabled:!y.trim(),children:"Ask AI"})})]}),$&&e.jsxs(p,{background:"bg-surface-secondary",padding:"300",borderRadius:"200",children:[e.jsx(s,{variant:"bodyMd",fontWeight:"semibold",children:"AI Bot Response:"}),e.jsx(p,{paddingBlockStart:"200",children:e.jsx(s,{variant:"bodyMd",children:$})})]})]})})})]})})}),P&&e.jsx(J,{content:P,onDismiss:()=>w("")}),e.jsx(j,{open:U,onClose:()=>M(!1),title:`Test with ${d==null?void 0:d.name}`,primaryAction:{content:"Copy Prompt",onAction:()=>{navigator.clipboard.writeText(`What products does ${t} sell? Tell me about this business and what they offer.`),w("Prompt copied to clipboard!")}},secondaryActions:[{content:"Open AI Bot",url:d==null?void 0:d.url,external:!0}],children:e.jsx(j.Section,{children:e.jsxs(l,{gap:"300",children:[e.jsx(s,{variant:"bodyMd",children:'1. Click "Copy Prompt" below'}),e.jsxs(s,{variant:"bodyMd",children:['2. Click "Open AI Bot" to visit ',d==null?void 0:d.name]}),e.jsx(s,{variant:"bodyMd",children:"3. Paste the prompt and send"}),e.jsxs(p,{background:"bg-surface-secondary",padding:"300",borderRadius:"200",children:[e.jsx(s,{variant:"bodyMd",fontWeight:"semibold",children:"Prompt to test:"}),e.jsx(p,{paddingBlockStart:"200",children:e.jsxs(s,{variant:"bodyMd",as:"p",children:["What products does ",t," sell? Tell me about this business and what they offer."]})})]}),e.jsx(m,{tone:"info",children:e.jsx(s,{children:"The AI bot will search the web and use your store's structured data to answer."})})]})})}),e.jsx(j,{open:L,onClose:()=>v(!1),title:"Upgrade Required",primaryAction:{content:"View Plans",onAction:()=>window.location.href="/billing"},secondaryActions:[{content:"Cancel",onAction:()=>v(!1)}],children:e.jsx(j.Section,{children:e.jsxs(l,{gap:"300",children:[e.jsxs(s,{variant:"bodyMd",children:["AI Testing requires ",e.jsx("strong",{children:(i==null?void 0:i.minimumPlan)||"Professional"})," plan or higher."]}),e.jsxs(s,{variant:"bodyMd",tone:"subdued",children:["Your current plan: ",e.jsx("strong",{children:(i==null?void 0:i.currentPlan)||"Starter"})]}),e.jsx(m,{tone:"info",children:e.jsx(s,{children:"Upgrade to test AI responses with real store data and Gemini 2.5 Flash Lite."})})]})})}),e.jsx(j,{open:N,onClose:()=>C(!1),title:"Insufficient Tokens",primaryAction:{content:"Buy Tokens",onAction:()=>window.location.href="/billing"},secondaryActions:[{content:"Cancel",onAction:()=>C(!1)}],children:e.jsx(j.Section,{children:e.jsxs(l,{gap:"300",children:[e.jsx(s,{variant:"bodyMd",children:"You need more tokens to use AI Testing."}),e.jsx(p,{background:"bg-surface-secondary",padding:"300",borderRadius:"200",children:e.jsxs(l,{gap:"200",children:[e.jsxs(o,{align:"space-between",children:[e.jsx(s,{variant:"bodySm",children:"Required:"}),e.jsxs(s,{variant:"bodySm",fontWeight:"semibold",children:[((G=i==null?void 0:i.tokensRequired)==null?void 0:G.toLocaleString())||0," tokens"]})]}),e.jsxs(o,{align:"space-between",children:[e.jsx(s,{variant:"bodySm",children:"Available:"}),e.jsxs(s,{variant:"bodySm",children:[((z=i==null?void 0:i.tokensAvailable)==null?void 0:z.toLocaleString())||0," tokens"]})]}),e.jsxs(o,{align:"space-between",children:[e.jsx(s,{variant:"bodySm",children:"Needed:"}),e.jsxs(s,{variant:"bodySm",fontWeight:"semibold",tone:"critical",children:[((D=i==null?void 0:i.tokensNeeded)==null?void 0:D.toLocaleString())||0," tokens"]})]})]})}),e.jsx(m,{tone:"info",children:e.jsx(s,{children:"Purchase tokens to continue using AI features. Tokens never expire."})})]})})})]})}export{Z as default};
