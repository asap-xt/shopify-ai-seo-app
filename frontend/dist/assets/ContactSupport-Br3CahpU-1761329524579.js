import{j as a}from"./app-bridge-BlJuIrvP-1761329524579.js";import{r as f}from"./react-vendor-tAaa2TlE-1761329524579.js";import{u as I}from"./useShopApi-sJ5IA9G8-1761329524579.js";import{a as b,e as w,T as p,d as W,C as R,I as T,j as k,y as A,B as z}from"./polaris-D_oFq8zg-1761329524579.js";class x{constructor(s=0,t="Network Error"){this.status=s,this.text=t}}const G=()=>{if(!(typeof localStorage>"u"))return{get:e=>Promise.resolve(localStorage.getItem(e)),set:(e,s)=>Promise.resolve(localStorage.setItem(e,s)),remove:e=>Promise.resolve(localStorage.removeItem(e))}},n={origin:"https://api.emailjs.com",blockHeadless:!1,storageProvider:G()},P=e=>e?typeof e=="string"?{publicKey:e}:e.toString()==="[object Object]"?e:{}:{},J=(e,s="https://api.emailjs.com")=>{if(!e)return;const t=P(e);n.publicKey=t.publicKey,n.blockHeadless=t.blockHeadless,n.storageProvider=t.storageProvider,n.blockList=t.blockList,n.limitRate=t.limitRate,n.origin=t.origin||s},_=async(e,s,t={})=>{const o=await fetch(n.origin+e,{method:"POST",headers:t,body:s}),i=await o.text(),c=new x(o.status,i);if(o.ok)return c;throw c},q=(e,s,t)=>{if(!e||typeof e!="string")throw"The public key is required. Visit https://dashboard.emailjs.com/admin/account";if(!s||typeof s!="string")throw"The service ID is required. Visit https://dashboard.emailjs.com/admin";if(!t||typeof t!="string")throw"The template ID is required. Visit https://dashboard.emailjs.com/admin/templates"},$=e=>{if(e&&e.toString()!=="[object Object]")throw"The template params have to be the object. Visit https://www.emailjs.com/docs/sdk/send/"},C=e=>e.webdriver||!e.languages||e.languages.length===0,M=()=>new x(451,"Unavailable For Headless Browser"),Q=(e,s)=>{if(!Array.isArray(e))throw"The BlockList list has to be an array";if(typeof s!="string")throw"The BlockList watchVariable has to be a string"},Y=e=>{var s;return!((s=e.list)!=null&&s.length)||!e.watchVariable},X=(e,s)=>e instanceof FormData?e.get(s):e[s],B=(e,s)=>{if(Y(e))return!1;Q(e.list,e.watchVariable);const t=X(s,e.watchVariable);return typeof t!="string"?!1:e.list.includes(t)},F=()=>new x(403,"Forbidden"),Z=(e,s)=>{if(typeof e!="number"||e<0)throw"The LimitRate throttle has to be a positive number";if(s&&typeof s!="string")throw"The LimitRate ID has to be a non-empty string"},ee=async(e,s,t)=>{const o=Number(await t.get(e)||0);return s-Date.now()+o},E=async(e,s,t)=>{if(!s.throttle||!t)return!1;Z(s.throttle,s.id);const o=s.id||e;return await ee(o,s.throttle,t)>0?!0:(await t.set(o,Date.now().toString()),!1)},H=()=>new x(429,"Too Many Requests"),te=async(e,s,t,o)=>{const i=P(o),c=i.publicKey||n.publicKey,g=i.blockHeadless||n.blockHeadless,d=i.storageProvider||n.storageProvider,y={...n.blockList,...i.blockList},m={...n.limitRate,...i.limitRate};return g&&C(navigator)?Promise.reject(M()):(q(c,e,s),$(t),t&&B(y,t)?Promise.reject(F()):await E(location.pathname,m,d)?Promise.reject(H()):_("/api/v1.0/email/send",JSON.stringify({lib_version:"4.4.1",user_id:c,service_id:e,template_id:s,template_params:t}),{"Content-type":"application/json"}))},se=e=>{if(!e||e.nodeName!=="FORM")throw"The 3rd parameter is expected to be the HTML form element or the style selector of the form"},ae=e=>typeof e=="string"?document.querySelector(e):e,re=async(e,s,t,o)=>{const i=P(o),c=i.publicKey||n.publicKey,g=i.blockHeadless||n.blockHeadless,d=n.storageProvider||i.storageProvider,y={...n.blockList,...i.blockList},m={...n.limitRate,...i.limitRate};if(g&&C(navigator))return Promise.reject(M());const l=ae(t);q(c,e,s),se(l);const h=new FormData(l);return B(y,h)?Promise.reject(F()):await E(location.pathname,m,d)?Promise.reject(H()):(h.append("lib_version","4.4.1"),h.append("service_id",e),h.append("template_id",s),h.append("user_id",c),_("/api/v1.0/email/send-form",h))},ie={init:J,send:te,sendForm:re,EmailJSResponseStatus:x},L=[{label:"Bug Report",value:"bug_report"},{label:"Feature Request",value:"feature_request"},{label:"Billing Issue",value:"billing_issue"},{label:"General Question",value:"general_question"},{label:"Technical Support",value:"technical_support"}];function de({shop:e}){const{api:s}=I(),[t,o]=f.useState({name:"",email:"",subject:"general_question",message:"",file:null}),[i,c]=f.useState(!1),[g,d]=f.useState(null),[y,m]=f.useState(""),[l,h]=f.useState(null),j=e||((r,u="")=>{try{return new URLSearchParams(window.location.search).get(r)||u}catch{return u}})("shop","");f.useEffect(()=>{O()},[j]);const O=async()=>{try{const r=await s(`/api/shop/info?shop=${encodeURIComponent(j)}`);h(r),o(u=>({...u,name:(r==null?void 0:r.name)||"",email:(r==null?void 0:r.email)||""}))}catch(r){console.error("[ContactSupport] Error loading shop info:",r)}},S=(r,u)=>{o(v=>({...v,[r]:u}))},V=r=>{r.length>0&&o(u=>({...u,file:r[0]}))},D=()=>t.name.trim()?t.email.trim()?t.message.trim()?!0:(d("error"),m("Please enter your message"),!1):(d("error"),m("Please enter your email"),!1):(d("error"),m("Please enter your name"),!1),K=async r=>{var u;if(r.preventDefault(),!!D()){c(!0),d(null),m("");try{const v={name:t.name,email:t.email,subject:((u=L.find(U=>U.value===t.subject))==null?void 0:u.label)||t.subject,message:t.message,shop_name:(l==null?void 0:l.name)||j,shop_url:`https://${j}`,time:new Date().toLocaleString()},N=await ie.send("service_c8j657n","template_zrftkfg",v,"-0N7g1SCh9fSknb6q");console.log("[ContactSupport] Email sent successfully:",N),d("success"),m("Message sent successfully! We'll get back to you within 24 hours."),o({name:(l==null?void 0:l.name)||"",email:(l==null?void 0:l.email)||"",subject:"general_question",message:"",file:null})}catch(v){console.error("[ContactSupport] Error sending email:",v),d("error"),m("Failed to send message. Please try again or contact us directly.")}finally{c(!1)}}};return a.jsx(b,{padding:"400",children:a.jsxs(w,{gap:"400",children:[a.jsx(p,{as:"h1",variant:"headingLg",children:"Contact Support"}),a.jsx(p,{variant:"bodyMd",tone:"subdued",children:"Need help? Send us a message and we'll get back to you within 24 hours."}),g&&a.jsx(W,{tone:g==="success"?"success":"critical",children:y}),a.jsx(R,{children:a.jsx(b,{padding:"400",children:a.jsx("form",{onSubmit:K,children:a.jsxs(w,{gap:"400",children:[a.jsxs(T,{gap:"400",wrap:!0,children:[a.jsx(b,{flexGrow:1,children:a.jsx(k,{label:"Name",value:t.name,onChange:r=>S("name",r),placeholder:"Your name",required:!0,disabled:i})}),a.jsx(b,{flexGrow:1,children:a.jsx(k,{label:"Email",type:"email",value:t.email,onChange:r=>S("email",r),placeholder:"your@email.com",required:!0,disabled:i})})]}),a.jsx(A,{label:"Subject",options:L,value:t.subject,onChange:r=>S("subject",r),disabled:i}),a.jsx(k,{label:"Message",value:t.message,onChange:r=>S("message",r),multiline:4,placeholder:"Describe your issue or question...",required:!0,disabled:i}),a.jsxs(b,{children:[a.jsx(p,{as:"label",variant:"bodyMd",fontWeight:"medium",children:"Attach File (Optional)"}),a.jsx(b,{paddingBlockStart:"100",children:a.jsx("input",{type:"file",accept:"image/*,.pdf,.doc,.docx,.txt",onChange:r=>V(r.target.files),disabled:i,style:{padding:"8px",border:"1px solid #d1d5db",borderRadius:"4px",fontSize:"14px",width:"100%"}})}),a.jsx(p,{variant:"bodySm",tone:"subdued",children:"Maximum file size: 5MB"})]}),a.jsx(T,{gap:"200",align:"end",children:a.jsx(z,{variant:"primary",submit:!0,loading:i,disabled:i,children:i?"Sending...":"Send Message"})})]})})})}),a.jsx(R,{children:a.jsx(b,{padding:"400",children:a.jsxs(w,{gap:"200",children:[a.jsx(p,{as:"h3",variant:"headingMd",children:"Other Ways to Reach Us"}),a.jsx(p,{variant:"bodyMd",tone:"subdued",children:"• Email: support@shopify-ai-seo.com"}),a.jsx(p,{variant:"bodyMd",tone:"subdued",children:"• Response time: Within 24 hours"}),a.jsxs(p,{variant:"bodyMd",tone:"subdued",children:["• Include your shop name: ",j]})]})})})]})})}export{de as default};
