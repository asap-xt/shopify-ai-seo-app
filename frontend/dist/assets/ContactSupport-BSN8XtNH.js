import{r as e,j as a}from"./react-vendor-BXVC7v0l.js";import{e as s}from"./vendor-Cs_VgJ2r.js";import{u as l}from"./useShopApi-BPGAW5iN.js";import{B as i,a as n,T as r,d as t,C as o,I as d,h as u,z as c,b as m}from"./polaris-DIPq0--Z.js";import"./app-bridge-DUY42B6P.js";const h=[{label:"Bug Report",value:"bug_report"},{label:"Feature Request",value:"feature_request"},{label:"Billing Issue",value:"billing_issue"},{label:"General Question",value:"general_question"},{label:"Technical Support",value:"technical_support"}];function p({shop:p}){const{api:g}=l(),[b,f]=e.useState({name:"",email:"",subject:"general_question",message:"",file:null}),[j,x]=e.useState(!1),[y,v]=e.useState(null),[S,w]=e.useState(""),[_,z]=e.useState(null),q=p||((e,a="")=>{try{return new URLSearchParams(window.location.search).get(e)||a}catch{return a}})("shop","");e.useEffect(()=>{M()},[q]);const M=async()=>{try{const e=await g(`/api/shop/info?shop=${encodeURIComponent(q)}`);z(e),f(a=>({...a,name:(null==e?void 0:e.name)||"",email:(null==e?void 0:e.email)||""}))}catch(e){}},C=(e,a)=>{f(s=>({...s,[e]:a}))};return a.jsx(i,{padding:"400",children:a.jsxs(n,{gap:"400",children:[a.jsx(r,{variant:"bodyMd",tone:"subdued",children:"Need help? Send us a message and we'll get back to you within 24 hours."}),y&&a.jsx(t,{tone:"success"===y?"success":"critical",children:S}),a.jsx(o,{children:a.jsx(i,{padding:"400",children:a.jsx("form",{onSubmit:async e=>{var a;if(e.preventDefault(),b.name.trim()?b.email.trim()?b.message.trim()||(v("error"),w("Please enter your message"),0):(v("error"),w("Please enter your email"),0):(v("error"),w("Please enter your name"),0)){x(!0),v(null),w("");try{let e={name:b.name,email:b.email,subject:(null==(a=h.find(e=>e.value===b.subject))?void 0:a.label)||b.subject,message:b.message,shop_name:(null==_?void 0:_.name)||q,shop_url:`https://${q}`,time:(new Date).toLocaleString()};if(b.file)try{const a=await(l=b.file,new Promise((e,a)=>{const s=new FileReader;s.readAsDataURL(l),s.onload=()=>e(s.result),s.onerror=e=>a(e)}));e.file_name=b.file.name,e.file_size=`${(b.file.size/1024).toFixed(1)} KB`,e.file_type=b.file.type,e.file_data=a}catch(i){e.message+=`\n\nðŸ“Ž ATTACHED FILE (conversion failed):\nName: ${b.file.name}\nSize: ${(b.file.size/1024).toFixed(1)} KB\nType: ${b.file.type}`}await s.send("service_c8j657n","template_zrftkfg",e,"-0N7g1SCh9fSknb6q");v("success"),w("Message sent successfully! We'll get back to you within 24 hours."),f({name:(null==_?void 0:_.name)||"",email:(null==_?void 0:_.email)||"",subject:"general_question",message:"",file:null})}catch(i){v("error"),w(`Failed to send message: ${i.message||"Unknown error"}`)}finally{x(!1)}var l}},children:a.jsxs(n,{gap:"400",children:[a.jsxs(d,{gap:"400",wrap:!0,children:[a.jsx(i,{flexGrow:1,children:a.jsx(u,{label:"Name",value:b.name,onChange:e=>C("name",e),placeholder:"Your name",required:!0,disabled:j})}),a.jsx(i,{flexGrow:1,children:a.jsx(u,{label:"Email",type:"email",value:b.email,onChange:e=>C("email",e),placeholder:"your@email.com",required:!0,disabled:j})})]}),a.jsx(c,{label:"Subject",options:h,value:b.subject,onChange:e=>C("subject",e),disabled:j}),a.jsx(u,{label:"Message",value:b.message,onChange:e=>C("message",e),multiline:4,placeholder:"Describe your issue or question...",required:!0,disabled:j}),a.jsxs(i,{children:[a.jsx(r,{as:"label",variant:"bodyMd",fontWeight:"medium",children:"Attach File (Optional)"}),a.jsx(i,{paddingBlockStart:"100",children:a.jsx("input",{type:"file",onChange:e=>(e=>{if(e.length>0){const a=e[0];if(a.size>512e3)return v("error"),void w("File size must be less than 500KB");f(e=>({...e,file:a}))}})(e.target.files),disabled:j,style:{padding:"8px",border:"1px solid #d1d5db",borderRadius:"4px",fontSize:"14px",width:"100%"}})}),a.jsx(r,{variant:"bodySm",tone:"subdued",children:"Any file type allowed â€¢ Maximum file size: 500KB"})]}),a.jsx(d,{gap:"200",align:"end",children:a.jsx(m,{variant:"primary",submit:!0,loading:j,disabled:j,children:j?"Sending...":"Send Message"})})]})})})}),a.jsx(o,{children:a.jsx(i,{padding:"400",children:a.jsxs(n,{gap:"200",children:[a.jsx(r,{as:"h3",variant:"headingMd",children:"Other Ways to Reach Us"}),a.jsx(r,{variant:"bodyMd",tone:"subdued",children:"â€¢ Email: indexaize@gmail.com"}),a.jsx(r,{variant:"bodyMd",tone:"subdued",children:"â€¢ Response time: Within 24 hours"}),a.jsxs(r,{variant:"bodyMd",tone:"subdued",children:["â€¢ Include your shop name: ",q]})]})})})]})})}export{p as default};
