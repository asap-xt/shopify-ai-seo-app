import{j as e}from"./app-bridge-lQpXPbhX-1760292930035.js";import{r as n}from"./react-vendor-tAaa2TlE-1760292930035.js";import{m as pt}from"./index-kHepumjb-1760292930035.js";import{U as ft}from"./UpgradeModal-D9Um1BJc-1760292930035.js";import{M as p,d as x,h as Te,T as o,I as S,a as u,B as L,D as ce,n as mt,i as Re,e as Pe,f as De,g as re,C as Be,S as St,P as xt,j as jt,R as bt,k as yt,m as Et,E as Ct}from"./polaris-ZAUS23Ee-1760292930035.js";const ze=[10,20,50,100];function vt({open:P,onClose:c,feature:j,tokensRequired:m,tokensAvailable:te,tokensNeeded:G,onPurchaseTokens:se,needsUpgrade:D=!1,minimumPlan:J=null,currentPlan:f=null}){const[v,b]=n.useState(""),[M,de]=n.useState(ze[0]),[Q,A]=n.useState(!1),V=C=>{const he=C*.6;return Math.floor(he/.1*1e6)},E=async()=>{A(!0);try{await se(parseFloat(v||M))}catch(C){console.error("[Insufficient Tokens Modal] Purchase failed:",C)}finally{A(!1)}},B=parseFloat(v||M),z=V(B),W=z>=G,ue={"ai-seo-product-basic":"AI SEO Optimization (Products)","ai-seo-product-enhanced":"AI SEO Optimization (Products - Enhanced)","ai-seo-collection":"AI SEO Optimization (Collections)","ai-testing-simulation":"AI Testing & Simulation","ai-schema-advanced":"Advanced Schema Data","ai-sitemap-optimized":"AI-Optimized Sitemap"}[j]||"This feature";return e.jsx(p,{open:P,onClose:c,title:"ðŸ’³ Insufficient Tokens",primaryAction:{content:Q?"Processing...":"Purchase Tokens",loading:Q,onAction:E},secondaryActions:[{content:"Cancel",onAction:c,disabled:Q}],children:e.jsx(p.Section,{children:e.jsxs(x,{gap:"400",children:[e.jsx(Te,{tone:"warning",children:e.jsxs(x,{gap:"200",children:[e.jsx(o,{variant:"bodyMd",fontWeight:"semibold",children:"You don't have enough tokens"}),e.jsxs(S,{gap:"400",children:[e.jsxs(u,{children:[e.jsx(o,{variant:"bodySm",tone:"subdued",children:"Required:"}),e.jsxs(o,{variant:"bodyMd",fontWeight:"semibold",children:[m.toLocaleString()," tokens"]})]}),e.jsxs(u,{children:[e.jsx(o,{variant:"bodySm",tone:"subdued",children:"Available:"}),e.jsxs(o,{variant:"bodyMd",fontWeight:"semibold",children:[te.toLocaleString()," tokens"]})]}),e.jsxs(u,{children:[e.jsx(o,{variant:"bodySm",tone:"subdued",children:"Needed:"}),e.jsxs(o,{variant:"bodyMd",fontWeight:"semibold",tone:"critical",children:[G.toLocaleString()," tokens"]})]})]})]})}),D&&J&&e.jsx(Te,{tone:"info",children:e.jsxs(x,{gap:"200",children:[e.jsxs(o,{variant:"bodyMd",fontWeight:"semibold",children:["ðŸ’¡ Upgrade to ",J,"+"]}),e.jsxs(o,{variant:"bodySm",children:["Current plan: ",e.jsx("strong",{children:f})]}),e.jsxs(o,{variant:"bodySm",tone:"subdued",children:[J," plans include AI tokens and unlock advanced AI features. You can also purchase tokens separately while staying on your current plan."]}),e.jsx(u,{paddingBlockStart:"200",children:e.jsx(L,{url:"/billing",variant:"primary",size:"slim",children:"View Plans & Upgrade"})})]})}),e.jsx(ce,{}),e.jsx(u,{background:"bg-surface-secondary",padding:"400",borderRadius:"200",children:e.jsxs(x,{gap:"200",children:[e.jsx(o,{variant:"headingMd",children:ue}),e.jsx(o,{variant:"bodySm",tone:"subdued",children:"Purchase tokens to unlock this AI-enhanced feature"})]})}),e.jsxs(x,{gap:"300",children:[e.jsx(o,{variant:"headingMd",children:"Select Amount"}),e.jsx(mt,{variant:"segmented",fullWidth:!0,children:ze.map(C=>e.jsxs(L,{pressed:M===C&&!v,onClick:()=>{de(C),b("")},size:"large",children:["$",C]},C))}),e.jsx(o,{variant:"bodySm",tone:"subdued",children:"Or enter a custom amount (multiples of $5)"}),e.jsx(Re,{type:"number",value:v,onChange:C=>{b(C),de(null)},placeholder:"Enter amount",prefix:"$",min:5,step:5,autoComplete:"off"})]}),e.jsx(ce,{}),e.jsx(u,{background:W?"bg-surface-success":"bg-surface-secondary",padding:"400",borderRadius:"200",children:e.jsxs(x,{gap:"200",children:[e.jsxs(S,{align:"space-between",children:[e.jsx(o,{variant:"bodyMd",children:"Amount"}),e.jsxs(o,{variant:"bodyMd",fontWeight:"semibold",children:["$",B.toFixed(2)]})]}),e.jsxs(S,{align:"space-between",children:[e.jsx(o,{variant:"bodyMd",children:"You'll receive"}),e.jsxs(o,{variant:"bodyMd",fontWeight:"semibold",children:[z.toLocaleString()," tokens"]})]}),e.jsxs(S,{align:"space-between",children:[e.jsx(o,{variant:"bodyMd",children:"New balance"}),e.jsxs(o,{variant:"bodyMd",fontWeight:"semibold",children:[(te+z).toLocaleString()," tokens"]})]}),e.jsx(ce,{}),W?e.jsx(S,{align:"center",blockAlign:"center",gap:"200",children:e.jsx(o,{variant:"bodySm",tone:"success",fontWeight:"semibold",children:"âœ“ Enough to use this feature"})}):e.jsx(S,{align:"center",blockAlign:"center",gap:"200",children:e.jsxs(o,{variant:"bodySm",tone:"critical",fontWeight:"semibold",children:["âš  Still not enough (need ",(G-z).toLocaleString()," more)"]})})]})}),e.jsx(u,{background:"bg-surface-secondary",padding:"300",borderRadius:"200",children:e.jsxs(x,{gap:"100",children:[e.jsx(o,{variant:"bodySm",tone:"subdued",children:"ðŸ’¡ Tokens are used for AI-powered features"}),e.jsx(o,{variant:"bodySm",tone:"subdued",children:"â™»ï¸ Tokens never expire and roll over indefinitely"})]})})]})})})}const At=(P,c="")=>{try{return new URLSearchParams(window.location.search).get(P)||c}catch{return c}};function $t({shop:P}){const c=P||At("shop","");console.log("[COLLECTIONS] Component initialized with shop:",c,"shopProp:",P);const j=n.useMemo(()=>pt(),[]),[m,te]=n.useState([]),[G,se]=n.useState(!1),[D,J]=n.useState(0),[f,v]=n.useState([]),[b,M]=n.useState(!1),[de,Q]=n.useState(""),[A,V]=n.useState(""),[E,B]=n.useState("all"),[z,W]=n.useState(!1),[xe,ue]=n.useState(""),[C,he]=n.useState([]),[w,Y]=n.useState([]),[O,je]=n.useState([]),[ge,R]=n.useState(!1),[T,I]=n.useState({current:0,total:0,percent:0}),[be,F]=n.useState(""),[_,ye]=n.useState([]),[Ot,kt]=n.useState(!1),[Lt,wt]=n.useState(null),[It,Mt]=n.useState(!1),[Tt,Ne]=n.useState(""),[Ue,ne]=n.useState(!1),[K,q]=n.useState([]),[Ee,Ce]=n.useState(!1),[$e,X]=n.useState(!1),[We,oe]=n.useState(!1),[ve,ae]=n.useState([]),[N,le]=n.useState({}),[Fe,ie]=n.useState(!1),[Ke,pe]=n.useState(!1),[Ae,Pt]=n.useState({}),[qe,fe]=n.useState(!1),[Oe,me]=n.useState(null),[He,ke]=n.useState(!1),[Le,y]=n.useState(""),[Ge,Z]=n.useState(!1),[Je,Se]=n.useState(!1),[Qe,we]=n.useState(!1),[H,Ie]=n.useState(null),[Ve,Me]=n.useState("starter"),[Ye,Dt]=n.useState({processing:!1,current:0,total:0,currentItem:"",results:null});n.useEffect(()=>{if(!c)return;j("/graphql",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:`
      query PlansMe($shop:String!) {
        plansMe(shop:$shop) {
          modelsSuggested
        }
      }
    `,variables:{shop:c}})}).then(s=>{var l,i,d;if((l=s==null?void 0:s.errors)!=null&&l.length)throw new Error(((i=s.errors[0])==null?void 0:i.message)||"GraphQL error");const a=(d=s==null?void 0:s.data)==null?void 0:d.plansMe,r=(a==null?void 0:a.modelsSuggested)||["google/gemini-1.5-flash"];he(r.map(h=>({label:h,value:h}))),ue(r[0])}).catch(s=>y(`Error loading models: ${s.message}`))},[c,j]),n.useEffect(()=>{c&&(console.log("[COLLECTIONS] Loading languages for shop:",c),j(`/api/languages/shop/${c}?shop=${c}`).then(t=>{console.log("[COLLECTIONS] Languages API data:",t);const s=(t==null?void 0:t.shopLanguages)||["en"];console.log("[COLLECTIONS] Extracted languages:",s),je(s),Y([])}).catch(t=>{console.error("[COLLECTIONS] Languages API error:",t),je(["en"]),Y([])}))},[c,j]);const U=n.useCallback(async()=>{var t;se(!0);try{console.log("[COLLECTIONS] Shop value:",c),console.log("[COLLECTIONS] Shop prop:",P),console.log("[COLLECTIONS] URL search params:",window.location.search);const a=`/collections/list-graphql?${new URLSearchParams({shop:c,...A&&{search:A},...E!=="all"&&{optimized:E}})}`;console.log("[COLLECTIONS] Using GraphQL endpoint:",a);const r=await j(a);console.log("[COLLECTIONS] API Response data:",r),((t=r==null?void 0:r.collections)==null?void 0:t.length)>0&&(console.log("[COLLECTIONS] First collection optimizedLanguages:",r.collections[0].optimizedLanguages),console.log("[COLLECTIONS] First collection full data:",r.collections[0]));let l=r.collections||[];if(A){const i=A.toLowerCase();l=l.filter(d=>d.title.toLowerCase().includes(i)||d.handle.toLowerCase().includes(i))}E!=="all"&&(l=l.filter(i=>E==="true"?i.hasSeoData:!i.hasSeoData)),te(l),J(l.length)}catch(s){y(`Error loading collections: ${s.message}`)}finally{se(!1)}},[c,A,E,j]);n.useEffect(()=>{c&&(U(),X(!1))},[c,E,U]),n.useEffect(()=>{const t=setTimeout(()=>{c&&U()},500);return()=>clearTimeout(t)},[A]);const _e=n.useCallback(t=>{v(t);const s=t.some(a=>{const r=m.find(l=>l.id===a);return r==null?void 0:r.hasSeoData});X(s),t.length===0&&M(!1)},[m]),Xe=n.useCallback(t=>{if(M(t),t){v(m.map(a=>a.id));const s=m.some(a=>a.hasSeoData);X(s)}else v([]),X(!1)},[m]),Ze=async t=>{ke(!0);try{const s=`/collections/${t.split("/").pop()}/seo-data?shop=${encodeURIComponent(c)}`,a=await j(s);me(a),fe(!0)}catch(s){y((s==null?void 0:s.status)===404?"No SEO data found for this collection":"Failed to load SEO data")}finally{ke(!1)}},et=()=>{if(f.length===0&&!b){y("Please select collections first");return}pe(!0)},tt=async()=>{try{R(!0),Q("Checking eligibility...");const t=await j("/ai-enhance/check-eligibility",{method:"POST",shop:c,body:{shop:c}});if(!t.eligible){Me(t.currentPlan||"starter"),Z(!1),Se(!0);return}Z(!1);const a=m.filter(d=>f.includes(d.id)).filter(d=>{var h;return((h=d.optimizedLanguages)==null?void 0:h.length)>0}),r=a.length;I({current:0,total:r,percent:0});const l={};for(let d=0;d<a.length;d++){const h=a[d];F(h.title);try{const g=h.optimizedLanguages||[];if(g.length===0){console.log(`No optimized languages for ${h.title}, skipping`),l[h.id]={success:!1,skipped:!0,error:"No optimized languages"};continue}console.log(`Enhancing ${h.title} for languages:`,g);const $=await j(`/ai-enhance/collection/${encodeURIComponent(h.id)}`,{method:"POST",shop:c,body:{shop:c,languages:g}});l[h.id]={success:$.ok,skipped:!1,data:$,error:$.ok?null:$.error||"Enhancement failed"}}catch(g){if(console.error("Error enhancing collection:",h.id,g),g.status===402||g.requiresPurchase||g.trialRestriction){R(!1),Ie(g),Me(g.currentPlan||"starter"),g.needsUpgrade?Se(!0):we(!0);return}l[h.id]={success:!1,skipped:!1,error:g.message}}const k=d+1,ee=Math.round(k/r*100);I({current:k,total:r,percent:ee})}le(l),ie(!0);const i=Object.values(l).filter(d=>d.success).length;y(`Enhanced ${i} collections`),await U()}catch(t){console.error("AI Enhance error:",t),y("Failed to enhance collections")}finally{R(!1),F("")}},st=async()=>{if(!w.length){y("Please select at least one language");return}pe(!1),R(!0),I({current:0,total:0,percent:0}),ye([]),le({});try{const t=b?m:m.filter(l=>f.includes(l.id)),s=t.length;I({current:0,total:s,percent:0});const a={};for(let l=0;l<t.length;l++){const i=t[l];F(i.title);try{const k=await j("/seo/generate-collection-multi",{method:"POST",shop:c,body:JSON.stringify({shop:c,collectionId:i.id,model:xe,languages:w})});a[i.id]={success:!0,data:k}}catch(k){a[i.id]={success:!1,error:k.message},ye(ee=>[...ee,{collection:i.title,error:k.message}])}const d=l+1,h=Math.round(d/s*100);I({current:d,total:s,percent:h})}le(a),ie(!0);const r=Object.values(a).filter(l=>l.success).length;y(`Generated optimization for ${r} collections`)}catch(t){y(`Error: ${t.message}`)}finally{R(!1),F("")}},nt=async()=>{var t,s;R(!0),I({current:0,total:0,percent:0});try{const a=Object.entries(N).filter(([l,i])=>i.success),r=a.length;I({current:0,total:r,percent:0});for(let l=0;l<a.length;l++){const[i,d]=a[l],h=m.find(g=>g.id===i);if(!h)continue;F(h.title);try{if(console.log("Applying SEO for collection:",i),console.log("Result data:",d.data),console.log("Results array:",(t=d.data)==null?void 0:t.results),!((s=d.data)!=null&&s.results)||!Array.isArray(d.data.results))throw new Error("Invalid results structure");const g=await j("/seo/apply-collection-multi",{method:"POST",shop:c,body:{shop:c,collectionId:i,results:d.data.results.map($=>({language:$.language,seo:$.data})),options:{updateTitle:!0,updateDescription:!0,updateSeo:!0,updateMetafields:!0}}});if(!(g!=null&&g.ok))throw new Error((g==null?void 0:g.error)||"Apply failed")}catch(g){console.error("Apply error for collection:",i,g),_.push({id:h.id,title:h.title,message:g.message})}const k=l+1,ee=Math.round(k/r*100);I({current:k,total:r,percent:ee})}y("Optimization applied successfully!"),ie(!1),le({}),v([]),await U(),M(!1)}catch(a){y(`Error applying optimization: ${a.message}`)}finally{R(!1),F("")}},ot=async(t=[])=>{console.log("[DELETE-SEO-BULK] ===== BULK DELETE START ====="),console.log("[DELETE-SEO-BULK] Languages to delete:",t),console.log("[DELETE-SEO-BULK] Selected items:",f),console.log("[DELETE-SEO-BULK] Select all pages:",b),Ce(!0),Ne("");try{const s=b?m:m.filter(i=>f.includes(i.id)),a=s.length*t.length;let r=0;const l=[];for(const i of s)for(const d of t)try{console.log(`[DELETE-SEO-BULK] Deleting ${d} for ${i.title} (${i.id})`);const h=await j("/collections/delete-seo",{method:"DELETE",shop:c,body:{shop:c,collectionId:i.id,language:d}});console.log(`[DELETE-SEO-BULK] Success for ${i.title} - ${d}:`,h)}catch(h){console.error(`[DELETE-SEO-BULK] Failed to delete ${d} for ${i.title}:`,h),l.push({id:i.id,title:i.title,message:h.message})}finally{r++,I({current:r,total:a,percent:Math.round(r/a*100)})}y(`Deleted optimization for ${t.join(", ").toUpperCase()}`),setTimeout(async()=>{await U(),v([]),M(!1),X(!1)},100)}catch(s){console.error("[DELETE-SEO-BULK] Error:",s),y(`Delete error: ${s.message}`)}finally{console.log("[DELETE-SEO-BULK] ===== BULK DELETE END ====="),Ce(!1),ae([]),q([])}},at=t=>{var i,d;const s=((i=N[t.id])==null?void 0:i.success)||Ae[t.id],a=((d=N[t.id])==null?void 0:d.data)||Ae[t.id],r=t.optimizedLanguages||[];console.log(`[COLLECTIONS] Rendering collection "${t.title}":`,{optimizedLanguages:r,availableLanguages:O,hasSeoData:t.hasSeoData});const l=e.jsx(u,{width:"40px",height:"40px",background:"surface-neutral",borderRadius:"200"});return e.jsx(Et,{id:t.id,url:"",media:l,accessibilityLabel:`View details for ${t.title}`,children:e.jsxs(S,{gap:"400",align:"center",blockAlign:"center",wrap:!1,children:[e.jsxs(u,{style:{flex:"1 1 30%",minWidth:"200px"},children:[e.jsx(o,{variant:"bodyMd",fontWeight:"semibold",children:t.title}),e.jsxs(o,{variant:"bodySm",tone:"subdued",children:["Handle: ",t.handle]})]}),e.jsx(u,{style:{flex:"0 0 15%",minWidth:"100px",textAlign:"center"},children:e.jsxs(o,{variant:"bodyMd",children:[t.productsCount," products"]})}),e.jsx(u,{style:{flex:"0 0 25%",minWidth:"160px"},children:t.hasSeoData?e.jsx(S,{gap:"100",children:O.map(h=>e.jsx(re,{tone:r.includes(h)?"success":"subdued",size:"small",children:h.toUpperCase()},h))}):e.jsx(re,{tone:"subdued",children:"No AI Search Optimisation"})}),e.jsxs(u,{style:{flex:"0 0 15%",minWidth:"120px"},children:[s&&e.jsx(L,{size:"slim",onClick:()=>{me(a),fe(!0)},children:"Preview JSON"}),!s&&t.hasSeoData&&e.jsx(L,{size:"slim",loading:He,onClick:()=>Ze(t.id),children:"Preview JSON"})]})]})})},lt=ge&&!Ye.processing&&e.jsx(p,{open:ge,title:"Processing Collections",onClose:()=>{},noScroll:!0,children:e.jsx(p.Section,{children:e.jsxs(x,{gap:"400",children:[e.jsx(o,{variant:"bodyMd",children:be?`Processing: ${be}`:"Preparing..."}),e.jsx(Pe,{progress:T.percent}),e.jsxs(o,{variant:"bodySm",tone:"subdued",children:[T.current," of ",T.total," collections (",T.percent,"%)"]})]})})}),it=e.jsx(p,{open:Ke,title:"Select Languages",primaryAction:{content:"Generate Optimization for AI Search",onAction:st,disabled:w.length===0},secondaryActions:[{content:"Cancel",onAction:()=>pe(!1)}],children:e.jsx(p.Section,{children:e.jsxs(x,{gap:"300",children:[e.jsxs(o,{variant:"bodyMd",children:["Select languages to generate AI Search Optimisation for ",b?"all":f.length," selected collections:"]}),e.jsx(u,{paddingBlockStart:"200",children:e.jsx(S,{gap:"200",wrap:!0,children:O.map(t=>e.jsx(De,{label:t.toUpperCase(),checked:w.includes(t),onChange:s=>{Y(s?[...w,t]:w.filter(a=>a!==t))}},t))})}),e.jsx(u,{paddingBlockStart:"200",children:e.jsx(L,{plain:!0,onClick:()=>{Y(w.length===O.length?[]:[...O])},children:w.length===O.length?"Deselect all":"Select all"})})]})})}),rt=e.jsx(p,{open:Fe&&!ge,title:"AI Search Optimisation Results",primaryAction:{content:"Apply Optimisation",onAction:nt,disabled:!Object.values(N).some(t=>t.success)},secondaryActions:[{content:"Cancel",onAction:()=>ie(!1)}],children:e.jsx(p.Section,{children:e.jsxs(x,{gap:"300",children:[e.jsxs(S,{gap:"400",children:[e.jsxs(u,{children:[e.jsx(o,{variant:"bodyMd",fontWeight:"semibold",children:"Successful:"}),e.jsx(o,{variant:"headingLg",fontWeight:"bold",tone:"success",children:Object.values(N).filter(t=>t.success&&!t.skipped).length})]}),e.jsxs(u,{children:[e.jsx(o,{variant:"bodyMd",fontWeight:"semibold",children:"Skipped:"}),e.jsx(o,{variant:"headingLg",fontWeight:"bold",tone:"info",children:Object.values(N).filter(t=>t.skipped).length})]}),e.jsxs(u,{children:[e.jsx(o,{variant:"bodyMd",fontWeight:"semibold",children:"Failed:"}),e.jsx(o,{variant:"headingLg",fontWeight:"bold",tone:"critical",children:Object.values(N).filter(t=>!t.success&&!t.skipped).length})]})]}),_.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(ce,{}),e.jsx(o,{variant:"bodyMd",fontWeight:"semibold",children:"Errors:"}),e.jsxs(u,{maxHeight:"200px",overflowY:"scroll",children:[_.slice(0,10).map((t,s)=>e.jsxs(o,{variant:"bodySm",tone:"critical",children:[t.collection,": ",t.error]},s)),_.length>10&&e.jsxs(o,{variant:"bodySm",tone:"subdued",children:["... and ",_.length-10," more errors"]})]})]})]})})}),ct=e.jsx(p,{open:qe,title:"SEO Data Preview",secondaryActions:[{content:"Close",onAction:()=>{fe(!1),me(null)}}],children:e.jsx(p.Section,{children:e.jsx(u,{children:e.jsx("pre",{style:{whiteSpace:"pre-wrap",wordBreak:"break-word",fontSize:"12px",backgroundColor:"#f6f6f7",padding:"12px",borderRadius:"4px",maxHeight:"400px",overflow:"auto"},children:Oe?JSON.stringify(Oe,null,2):""})})})}),dt=e.jsx(p,{open:Ue,title:"Delete Optimization for AI Search",onClose:()=>{ne(!1),q([])},primaryAction:{content:"Continue",onAction:()=>{ae(K),ne(!1),oe(!0)},disabled:K.length===0},secondaryActions:[{content:"Cancel",onAction:()=>{ne(!1),q([])}}],children:e.jsx(p.Section,{children:e.jsxs(x,{gap:"400",children:[e.jsxs(o,{variant:"bodyMd",children:["Select languages to delete AI Search Optimisation from ",b?D:f.length," selected collections:"]}),e.jsx(u,{paddingBlockStart:"200",children:e.jsx(S,{gap:"400",wrap:!1,children:O.map(t=>e.jsxs("label",{style:{display:"flex",alignItems:"center",cursor:"pointer",userSelect:"none"},children:[e.jsx("input",{type:"checkbox",checked:K.includes(t),onChange:s=>{q(s.target.checked?[...K,t]:K.filter(a=>a!==t))},style:{marginRight:"8px",width:"18px",height:"18px",cursor:"pointer"}}),e.jsx(o,{variant:"bodyMd",children:t.toUpperCase()})]},t))})}),e.jsx(u,{children:e.jsx(L,{plain:!0,onClick:()=>{q(K.length===O.length?[]:[...O])},children:"Select all"})}),e.jsx(u,{paddingBlockStart:"300",children:e.jsx(o,{variant:"bodySm",children:"Warning: This will permanently delete AI Search Optimisation data for selected languages."})})]})})}),ut=e.jsx(p,{open:We,title:"Confirm Deletion",onClose:()=>{oe(!1),ae([])},primaryAction:{content:"Delete",destructive:!0,onAction:async()=>{oe(!1),setTimeout(()=>{ot(ve)},100)}},secondaryActions:[{content:"Cancel",onAction:()=>{oe(!1),ae([]),q([])}}],children:e.jsx(p.Section,{children:e.jsxs(x,{gap:"400",children:[e.jsx(o,{variant:"bodyMd",children:"Are you sure you want to delete AI Search Optimisation for the following languages?"}),e.jsx(u,{paddingBlockStart:"200",children:e.jsx(S,{gap:"200",children:ve.map(t=>e.jsx(re,{tone:"warning",children:t.toUpperCase()},t))})}),e.jsxs(o,{variant:"bodyMd",children:["This will delete optimisation from ",b?D:f.length," selected collections."]}),e.jsx(u,{paddingBlockStart:"200",children:e.jsx(o,{variant:"bodySm",tone:"critical",children:"This action cannot be undone."})})]})})}),ht=Ee&&e.jsx(p,{open:Ee,title:"Deleting SEO Data",onClose:()=>{},noScroll:!0,children:e.jsx(p.Section,{children:e.jsxs(x,{gap:"400",children:[e.jsx(o,{variant:"bodyMd",children:"Deleting selected languages..."}),e.jsx(Pe,{progress:T.percent}),e.jsxs(o,{variant:"bodySm",tone:"subdued",children:[T.current," of ",T.total," operations (",T.percent,"%)"]})]})})}),gt=e.jsx(Ct,{heading:"No collections found",action:{content:"Clear filters",onAction:()=>{V(""),B("all"),U()}},image:"https://cdn.shopify.com/s/files/1/0262/4071/2726/files/emptystate-files.png",children:e.jsx("p",{children:"Try adjusting your filters or search terms"})});return e.jsxs(e.Fragment,{children:[e.jsx(Be,{children:e.jsxs(u,{padding:"400",children:[e.jsxs(S,{gap:"400",align:"space-between",blockAlign:"start",wrap:!1,children:[e.jsx(u,{minWidth:"400px",maxWidth:"600px",children:e.jsx(x,{gap:"200",children:e.jsx(Re,{label:"",placeholder:"Search by collection name...",value:A,onChange:V,prefix:e.jsx(St,{}),clearButton:!0,onClearButtonClick:()=>V("")})})}),e.jsxs(x,{gap:"200",children:[e.jsx(L,{primary:!0,onClick:et,disabled:f.length===0&&!b,children:"Generate Optimization for AI Search"}),f.length===0&&!b||!m.filter(a=>f.includes(a.id)).some(a=>{var r;return((r=a.optimizedLanguages)==null?void 0:r.length)>0})?null:e.jsx(L,{onClick:()=>Z(!0),disabled:f.length===0&&!b,children:"AI Enhanced add-ons for AI Search"}),e.jsx(L,{outline:!0,destructive:!0,onClick:()=>ne(!0),disabled:f.length===0||!$e,children:"Delete Optimization for AI Search"})]})]}),D>0&&e.jsx(u,{paddingBlockStart:"300",children:e.jsx(De,{label:`Select all ${D} collections`,checked:b,onChange:Xe})})]})}),e.jsx(u,{paddingBlockStart:"400",children:e.jsxs(Be,{children:[e.jsxs(u,{padding:"400",borderBlockEndWidth:"025",borderColor:"border",children:[e.jsx(S,{gap:"200",wrap:!0,children:e.jsx(xt,{active:z,activator:e.jsx(L,{disclosure:"down",onClick:()=>W(!z),removeUnderline:!0,children:e.jsxs(S,{gap:"100",blockAlign:"center",children:[e.jsx("span",{children:"AI Search Status"}),E!=="all"&&e.jsx(u,{onClick:t=>{t.stopPropagation(),B("all")},children:e.jsx(o,{as:"span",tone:"subdued",children:"âœ•"})})]})}),onClose:()=>W(!1),children:e.jsx(u,{padding:"300",minWidth:"200px",children:e.jsx(jt,{title:"AI Search Status",titleHidden:!0,choices:[{label:"All collections",value:"all"},{label:"Has AI Search Optimisation",value:"true"},{label:"No AI Search Optimisation",value:"false"}],selected:[E],onChange:t=>{B(t[0]),W(!1)}})})})}),E!=="all"&&e.jsx(u,{paddingBlockStart:"200",children:e.jsx(S,{gap:"100",wrap:!0,children:e.jsx(re,{onRemove:()=>B("all"),children:E==="true"?"Has AI Search Optimisation":"No AI Search Optimisation"})})})]}),e.jsx(bt,{resourceName:{singular:"collection",plural:"collections"},items:m,renderItem:at,selectedItems:f,onSelectionChange:_e,selectable:!0,loading:G,totalItemsCount:D,emptyState:gt,showHeader:!1})]})}),lt,it,rt,ct,dt,ut,ht,e.jsx(p,{open:Ge,onClose:()=>Z(!1),title:"AI Enhanced add-ons for AI Search",primaryAction:{content:"Start AI Enhancement",onAction:tt},secondaryActions:[{content:"Cancel",onAction:()=>Z(!1)}],children:e.jsx(p.Section,{children:e.jsxs(x,{gap:"300",children:[e.jsxs(o,{variant:"bodyMd",children:["AI enhancement will improve bullets and FAQ for ",m.filter(t=>{var s;return f.includes(t.id)&&((s=t.optimizedLanguages)==null?void 0:s.length)>0}).length," collections."]}),e.jsx(o,{variant:"bodySm",tone:"subdued",children:"Note: AI enhancement is only available for Growth Extra and Enterprise plans."})]})})}),e.jsx(ft,{open:Je,onClose:()=>Se(!1),featureName:"AI Enhancement",currentPlan:Ve}),H&&e.jsx(vt,{open:Qe,onClose:()=>{we(!1),Ie(null)},tokensRequired:H.tokensRequired,tokensAvailable:H.tokensAvailable,feature:"AI-Enhanced Collection",shop:c,needsUpgrade:H.needsUpgrade,minimumPlan:H.minimumPlanForFeature,currentPlan:H.currentPlan}),Le&&e.jsx(yt,{content:Le,onDismiss:()=>y("")})]})}export{$t as default};
