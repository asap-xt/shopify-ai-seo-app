[build]
builder = "NIXPACKS"
buildCommand = "echo '=== CLEAN BUILD TIMESTAMP: 2025-11-29T12:45 ===' && rm -rf frontend/dist frontend/node_modules/.vite frontend/.vite && npm install && cd frontend && rm -rf dist node_modules/.vite .vite && npm install && npm run build && echo '=== VERIFYING SINGLE INDEX FILE ===' && ls -la dist/assets/index-*.js && grep -o 'index-[a-zA-Z0-9_-]*\\.js' dist/index.html && cd .."

[deploy]
startCommand = "npm start"
restartPolicyType = "ON_FAILURE"
restartPolicyMaxRetries = 10

[healthcheck]
path = "/health"
port = 8080
initialDelaySeconds = 10
timeoutSeconds = 30
periodSeconds = 10
successThreshold = 1
failureThreshold = 3