[build]
builder = "NIXPACKS"
buildCommand = "rm -rf frontend/dist frontend/node_modules/.vite frontend/.vite && npm install && cd frontend && rm -rf dist node_modules/.vite .vite && npm install && npm run build && rm -f dist/assets/index-7C12H-UM-*.js dist/assets/react-vendor-tAaa2TlE-*.js dist/assets/app-bridge-B5-rAdx8-*.js dist/assets/polaris-BtthT4kO-*.js && echo '=== CHECKING INDEX.HTML ===' && grep -o 'index-[a-zA-Z0-9_-]*\\.js' dist/index.html && echo '=== BUILD COMPLETE ===' && cd .."

[deploy]
startCommand = "npm start"
restartPolicyType = "ON_FAILURE"
restartPolicyMaxRetries = 10

[healthcheck]
path = "/health"
port = 8080
initialDelaySeconds = 10
timeoutSeconds = 30
periodSeconds = 10
successThreshold = 1
failureThreshold = 3