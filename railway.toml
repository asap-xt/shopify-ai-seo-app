[build]
builder = "NIXPACKS"
buildCommand = "rm -rf frontend/dist frontend/node_modules/.vite frontend/.vite && npm install && cd frontend && rm -rf dist node_modules/.vite .vite && npm install && npm run build && echo 'BUILD_FILES:' && ls -la dist/assets/*.js | head -5 && cd .."

[deploy]
startCommand = "npm start"
restartPolicyType = "ON_FAILURE"
restartPolicyMaxRetries = 10

[healthcheck]
path = "/health"
port = 8080
initialDelaySeconds = 10
timeoutSeconds = 30
periodSeconds = 10
successThreshold = 1
failureThreshold = 3